registerNamespace("$SB");new function(){if(typeof $SB.SearchBox!=="function")return;$SB.renderModes=new $Enum("HOME","HOTMAIL","OTHER","CONTACTLIST","DOCUMENTS");var d=false;$SB.logEvent=function(b,a){$BSI.reportEvent("search.general",{SearchType:b+(a?"_"+a:""),SearchMethod:d?"enter":"click"});d=false};var c=$SB.SearchBox.prototype,a=$SB.renderModes,l=/%20/g,h="c_search_i",e="c_ms";c.getContentHeader=function(){var b=this;if(typeof b.contentHeader==="undefined")b.contentHeader=b[(!$SBC.auth?"bing":b.renderMode===a.HOME?"secondary":"primary")+"MenuItem"];return b.contentHeader};c.getEmailHeader=function(){var a=this;if(typeof a.emailHeader==="undefined")a.emailHeader=a.isEmailMode()?a.primaryMenuItem:null;return a.emailHeader};c.getHeaders=function(){var a=this;if(typeof a.headers==="undefined"){var d=["primary","secondary","bing"],c;a.headers=[];for(var b=0;b<d.length;b++)if(c=a[d[b]+"MenuItem"])a.headers.push(c)}return a.headers};c.isEmailMode=function(){return $SBC.auth&&(this.renderMode===a.HOME||this.renderMode===a.HOTMAIL)};function f(a){return a.encodeUrl().replace(l,"+")}function m(d,c){var b=d.renderMode;if(b==a.DOCUMENTS)return g(c);if(b==a.OTHER)return i(c);return null}function k(c,b){switch(c.renderMode){case a.HOME:case a.DOCUMENTS:return i(b);case a.OTHER:return g(b);case a.HOTMAIL:case a.CONTACTLIST:default:return null}}var o=$SB.getBingUrl=function(b){var a=$SB.formCode;return $SBC.bingUrl+"?q="+f(b)+(a?"&form="+a.encodeUrl():"")};function b(a){return a.getElementsByTagName("A")[0]}function i(a){return j(a,"people")}function g(a){return j(a,"documents")}function j(b,a){return $SBC.homeSerp+"?query="+f(b)+"&consumerid="+$SB.consumer.encodeUrl()+"&mkt="+$Config.mkt.encodeUrl()+(a?"&scope="+a.encodeUrl():"")}var n=function(j,cb){var eb=this,c=j,A=$(j.searchBoxId),i=V(),H=j.hasInitialQuery,F=false,n=null,s=cb,C=false,z=null,q=null,g=null,Z=j.getEmailHeader(),K=j.getContentHeader(),db=false,G=false,f=j.isEmailMode()?$SB.MailSearchHelper:null,u="H_search_contacts",D="H_search_documents",I="H_search_email",U="H_search_contact_list",l="H_search_bing",y={HOME:[I,u,l],HOTMAIL:[I,l],OTHER:[u,D,l],CONTACTLIST:[U,l],DOCUMENTS:[D,u,l]};function ab(){var e=c.getHeaders(),d=c.renderMode;$f.addEvent(b(e[0]),"onclick",function(b){$SB.logEvent(y[d][0]);if(typeof c.searchEmailFunc!="function"){v(c.getValue());if(d==a.OTHER||d==a.DOCUMENTS)return true;if($B.IE_M6){$(c.formId).submit();return $f.cancelEvent(b)}else{c.submitForm();return true}}else{c.searchEmailFunc(c.getValue());r();return $f.cancelEvent(b)}});$f.addEvent(b(e[1]),"onclick",function(){v(c.getValue());$SB.logEvent(y[d][1]);r();return true});e[2]&&$f.addEvent(b(e[2]),"onclick",function(){v(c.getValue());$SB.logEvent(y[d][2]);r();return true});!c.usesForm&&$f.addEvent($(c.submitId),"onclick",function(a){c.searchEmailFunc(c.getValue());r();return $f.cancelEvent(a)});$f.addEvent(A,"onfocus",bb);$f.addEvent(A,"onfocus",t);$f.addEvent(A,"onkeyup",t)}function r(){var a=i.binding;a&&a.isOpen()&&a.hide()}function bb(a){J(a);E();if(H){t(a);H=false}}function E(){if(!C)s.initialize(P);C=true}function J(e){if(F)return;F=true;var b=6;$B.rtl&&(b=7);($B.IE||$B.Chrome||$B.Safari)&&(b=5);var c={x:-3,y:b};$menu.bind(e,0,c,1,1,0,undefined,0,0,0,0,0,"click");var a=i.binding;a&&a.EnterEvent.attach(function(){d=true});a&&s.onTab&&a.TabEvent.attach(function(b){s.onTab(b,a)})}function V(){var f=$(c.formId),g=c.renderMode,d=$SBC.firstHead,b=$SBC.secondHead,e=$SBC.bingHead,a=_ce("ul");a.className="c_m t_hovl c_search_menu";a.setAttribute("id",c.idPrefix+"menu");a.setAttribute("sutra","searchboxdropdown");c.primaryMenuItem=w(a,"t_hov",d,1,0,"SearchEmail");b&&(c.secondaryMenuItem=w(a,0,b,1,0,0));c.bingMenuItem=w(a,0,e,0,1,0);f.appendChild(a);return a}function w(f,b,e,c,d,g){var a=_ce("li");g&&a.setAttribute("aId","SearchEmail");a.setAttribute("sutra","searchboxitem");a.innerHTML='<a href="javascript:;" target="'+(d?"_blank":"_top")+'" '+'class="'+(b?b+" ":"")+'c_search_heading">'+e.encodeHtml()+"</a>"+(c?'<span class="c_ms"></span>':"");f.appendChild(a);return a}function t(a){J(a);E();X()}function X(){if(z===null){z=setTimeout(function(){if(q!==null){B(q);q=null}z=null},$SBC.queryInterval);B(c.getValue())}else q=c.getValue()}function B(a){if(a===n)return;n=a;if(!Y(a)&&Q(a)){if(!s.getMatches(p(a))){L(a,true);!G&&x(true);G=true}}else P([],p(a))}function v(e){var a=c.getHeaders(),g=b(a[0]),f=a.length>2&&b(a[1]),h=b(a[a.length-1]),d;(d=m(c,e))&&g.setAttribute("href",d);f&&(d=k(c,e))&&f.setAttribute("href",d);h.setAttribute("href",o(e))}function P(b,g){if(p(n)!==g)return;var e=K;x(false);O();var f=L(n,false);c.renderMode===a.HOTMAIL&&(b.length=Math.min(b.length,$SBC.max-f));for(var d=0;d<b.length;d++)e=M(b[d],e);T(b.length,n);N()}function p(a){return f?f.removeKeywords(a):a}function Y(a){return p(a).trim().length===0}function L(g,d){if(f){var a=f.getMailItems(g,c),e=Z;d&&O();for(var b=0;b<a.length;b++)e=M(a[b],e);d&&N();return a.length}return 0}function T(d,e){if(f&&c.renderMode===a.HOTMAIL)b(c.getEmailHeader()).innerHTML=f.getHeaderText(d,e).encodeHtml()}function Q(b){if(f&&c.renderMode===a.HOTMAIL)return f.queryStartsWithKeyword(b)!=="subject:";return true}function N(){W();i.binding.update()}function O(){var a=0,b=i.childNodes,d=null,e=c.getHeaders();while(b.length>a){d=b[a].className;if(d===h){i.removeChild(b[a]);b=i.childNodes}else a++}for(var a=0;a<e.length-1;a++)S(e[a])}function S(c){var a=null,b=c.childNodes;for(a=0;a<b.length;a++)if(b[a].className===e){c.removeChild(b[a]);break}}function W(){var f=c.getHeaders(),a=null,b=null;for(var d=1;d<f.length;d++){a=f[d].previousSibling;while(a.nodeType!==1)a=a.previousSibling;b=_ce("SPAN");b.className=e;a.appendChild(b)}}function M(c,b){var a=_ce("LI");a.setAttribute("sutra","searchboxitem");a.className=h;a.appendChild(c);i.insertBefore(a,b.nextSibling);return a}function x(a){R();g.style.display=a?"inline":"none";a&&setTimeout(function(){x(false)},$SBC.lt)}function R(){if(g===null){g=new Image;g.setAttribute("src",$SBC.ldImg);g.style.display="none";g.className="c_search_ld";b(K).appendChild(g)}}ab()};$SB.bindAllSearchBoxes=function(c){for(var b in $SB.sbs)if(!FunctionHelper.isSpecialMember($SB.sbs,b)){var a=$SB.sbs[b];new n(a,new c(a));$Config.isINT&&$(a.statusId).setAttribute("status","Ready")}}};new function(){var L="<strong>",M="</strong>",n=new $Enum("documents","picw"),c="setAttribute",E={canary:$SBC.canary,bicild:""},o="javascript:;",b;function F(a){return function(e,f){var c=a(e),d=a(f),b=0;if(c>d)b=1;else if(c<d)b=-1;return b}}function x(f,e,g){var a={},c=[e,E];switch(f){case n.documents:a.scope="documentsearch"}a.callback="$SB."+g;for(var b=0;b<c.length;b++)for(var d in c[b])a[d]=c[b][d];return $SBC.ufs+"?"+$Utility.serialize(a)}function m(a){if(!a)return false;return $Network.extractHost(a).endsWith("live"+($Config.isINT?"-int":"")+".com")}var p=" !\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~",I=new RegExp("["+p.escapeRegex()+"]","ig");function k(d){var b=[],a=null,c=null;if(d){b.push(a=d.lTrim());while((c=a.search(I))!=-1)b.push(a=a.substring(c+1).lTrim())}return b}function g(k,l,g,d,i,b,f,h,j,e){var a=_ce("A");if(b)a.className=b;a[c]("title",k);a[c]("target",f?"_blank":"_top");a[c]("href",l);$f.addEvent(a,"onclick",function(c){var b=g(c);$menu.closeCurrent();$SB.logEvent(h,a.sbindex||"");return b});d&&a.appendChild(d);a.appendChild(i);a.sbbinding=j;e&&(a.sbindex=e);return a}function t(f,h,g,e,b){var a=new Image,d=B(f,a,e);$f.addEvent(a,"onload",C(a));a.className="c_search_imgpad c_search_img"+(b?" "+b:"");a[c]("alt",h);a[c]("src",$ssl.ensureSSLImageUrl(G(f,g,e)));d&&$f.addEvent(a,"onerror",d);return a}function G(c,b,a){if(c.defaultImage)return a;return b}function C(a){return function b(){a.style.visibility="inherit";$f.removeEvent(a,"onload",b)}}function B(a,b,e){if(a.defaultImage)return null;return function d(){a.defaultImage=true;b[c]("src",$ssl.ensureSSLImageUrl(e));$f.removeEvent(b,"onerror",d)}}function l(b){var a=_ce("SPAN");a.className="c_search_txt";a.innerHTML=b;return a}var w={a:/[\xE0-\xE4]/ig,e:/[\xE8-\xEB]/ig,i:/[\xED-\xEF]/ig,o:/[\xF3-\xF5]/ig,u:/[\xF9-\xFC]/ig,n:/\xF1/ig,y:/\xFF/ig,c:/\xE7/ig};function i(a){a=a.toLowerCase();for(var b in w)if(!FunctionHelper.isSpecialMember(b))a=a.replace(w[b],b);return a}var e="\ue000",f="\ue001";function j(a,b,d){var c=h.match(a)?h.highlight(a,b):r(a,b,d);return c.encodeHtml().replace(new RegExp(e.encodeHtml(),"g"),L).replace(new RegExp(f.encodeHtml(),"g"),M)}function r(c,q,o){var m=[q].concat(q.split(" ")),b=new Array(c.length+2),r="(^|\\s"+(o?"|@":"")+(!o?"|["+p.escapeRegex()+"]":"")+")";for(var a=0;a<b.length;a++)b[a]=0;for(var a=0;a<m.length;a++){var s=m[a],l=i(c).replace(new RegExp(r+"("+i(s).escapeRegex()+")","ig"),"$1"+e+"$2"+f),n=0,d=0,h=0;while((n=l.indexOf(e,d))!=-1){d=l.indexOf(f,d+1);h+=2;for(var k=n-h+2;k<d-h+1;k++)b[k+1]=1}}var g=[];for(var a=1;a<b.length;a++)if(b[a]!=b[a-1])g.push(a-1);var j=0;for(var a=0;a<g.length;a++){j=g[a]+a;c=c.substr(0,j)+(a%2?f:e)+c.substr(j)}return c}var q=$SB.MailSearchHelper=new function(){var c=this,b={FROM:$SBC.from,SUBJECT:$SBC.subject,TO:$SBC.to},h={NORMAL:$SBC.emailHead,FROM:$SBC.emailFrom,TO:$SBC.emailTo},e=[b.FROM,b.SUBJECT,b.TO],a=["from:","subject:","to:"],f=null;c.keywords=b;c.getMailItems=function(f,q){var r=d(f),n=[];if(!c.queryStartsWithKeyword(r)){var p=null,b=null,k;for(var h=0;h<e.length;h++){b=e[h];p=['<span class="c_search_k">',b,"</span> <strong>",f.encodeHtml(),"</strong>"].join("");k=g(i(b,f),o,j(a[h],f,q),null,l(p),null,false,m(b),null,null);k.sbmail={k:b.trim(),q:f.trim()};n.push(k)}}return n};c.removeKeywords=function(a){return a.replace(k(),"")};c.getHeaderText=function(e,f){var b=null;if(e&&(b=c.queryStartsWithKeyword(d(f)))&&b!==a[1])switch(b){case a[0]:return h.FROM;case a[2]:return h.TO}return h.NORMAL};c.queryStartsWithKeyword=function(c){c=d(c);for(var b=0;b<a.length;b++)if(c.startsWith(d(a[b]))||c.startsWith(d(e[b])))return a[b];return null};function k(){if(!f){var b=a.clone();b.addRange(e);f=new RegExp("^\\s*("+b.join("|")+")","ig")}return f}function m(a){switch(a){case b.FROM:return "HM_from";case b.TO:return "HM_to";case b.SUBJECT:return "HM_subject";default:return ""}}function j(b,c,a){return function(d){a.searchEmailFunc(i(b,c));return $f.cancelEvent(d)}}function i(a,b){return a+" "+b}function d(a){return a.toLowerCase()}},h=new function(){var b=this,g=new RegExp("([\\uAC00-\\uD7AF])","g"),n=44032,h=4352,i=4449,j=4519,p=e,a=f,d={"\u3131":"\u1100","\u3132":"\u1101","\u3134":"\u1102","\u3137":"\u1103","\u3138":"\u1104","\u3139":"\u1105","\u3141":"\u1106","\u3142":"\u1107","\u3143":"\u1108","\u3145":"\u1109","\u3146":"\u110a","\u3147":"\u110b","\u3148":"\u110c","\u3149":"\u110d","\u314a":"\u110e","\u314b":"\u110f","\u314c":"\u1110","\u314d":"\u1111","\u314e":"\u1112"},l=k(d),o=new RegExp("([\\u1100-\\u1112][\\u1161-\\u1175][\\u11A8-\\u11C2]{0,1})","g"),m=new RegExp("([\\u1100-\\u1112]"+a+"{0,1}[\\u1161-\\u1175]"+a+"{0,1}[\\u11A8-\\u11C2]{0,1})","g");b.expand=function(a){a=a.replace(l,function(a){return d[a]});return a.replace(g,function(f){var a=f.charCodeAt(0)-n,b=Math.floor(a/588),e=Math.floor((a-b*588)/28),d=a%28;return c(b+h)+c(e+i)+(d?c(d+j):"")})};b.highlight=function(e,f){var d=r(b.expand(e),b.expand(f),0);return d.replace(m,function(b){return b.replace(a,"")+(b.match(a)?a:"")}).replace(o,function(a){var b=a.charCodeAt(0)-h,d=a.charCodeAt(1)-i,e=a.length>2?a.charCodeAt(2)-j:0;return c(b*588+d*28+e+44032)})};b.match=function(a){return a.match(g)};function c(a){return String.fromCharCode(a)}function k(){var a=["(["];for(var b in d)a.push(b);a.push("])");return new RegExp(a.join(""),"g")}},a=function(d,b,c){var a=this;a.key=d;a.weight=b;a.order=c},d=new function(){var b=this,a=new $Enum("VIEWPHOTOS","SEARCHEMAIL","SENDEMAIL","SENDMESSAGE","DOCSEDIT","DOCSPROPERTY"),c=new function(){var b=this;b[a.VIEWPHOTOS]=$SBC.viewPhotos;b[a.SEARCHEMAIL]=$SBC.searchEmail;b[a.SENDEMAIL]=$SBC.sendEmail;b[a.SENDMESSAGE]=$SBC.sendMsg;b[a.DOCSEDIT]=$SBC.docsEdit;b[a.DOCSPROPERTY]=$SBC.docsProperty};b.actionTypes=a;b.isActionPosition=function(a){return a===0};b.getActionNode=function(b,h,a,i,d){var f=function(b){if(a)return a(b);return true},e=c[b];return g(e,h,f,null,document.createTextNode(e),"c_search_ai"+(d?" "+d:""),i,"QA_"+b,null,null)}},K=function(){var b=this,m=$SBC.docsBase+"/default.png",i={query:"*","ds.OwnedByMe":"1","ds.Acled":"1",maxitems:"4000","ds.o.WordWheelView":"1"},f=d.actionTypes,e=d.getActionNode,h="c_search_d";b.localStorageKey="documents";b.getResults=function(c){var b=c.SearchResponse.DocumentSearch||[];for(var a=0;a<b.length;a++)b[a].sbid=a;return b};b.getSource=function(a){return x(n.documents,i,a)};b.comparer=function(a,b){return a.sbid-b.sbid};b.matchField=function(a){return a.t};b.getHtml=function(c,e){var b=[];for(var a=0;a<c.length;a++){b.push(p(c[a],e,a+1));d.isActionPosition(a)&&r(b,c[a])}return b};b.getKeysAndWeights=function(f){var d=k(f.t.toLowerCase()),c=[],b=d.length;b&&c.push(new a(d[0],1.5,1));for(var e=1;e<b-1;e++)c.push(new a(d[e],1,e+1));b&&c.push(new a(d[b-1],.5,b));return c};b.autoComplete=function(a){return a.t};b.compareParents=null;b.isValid=function(){return true};function r(b,c){var d=e(f.DOCSEDIT,$SBC.docsAction.format("edit",c.id),null,false,h),a=e(f.DOCSPROPERTY,$SBC.docsAction.format("self",c.id),null,false,h);$css.add(a,"c_search_last");b.push(d);b.push(a)}function p(a,d,b){return g(c(a),v(a),function(){return true},u(a),o(a,d),null,false,"WW_documents",a,b)}function c(a){return a.t}function v(a){return $SBC.docsAction.format("view",a.id)}function u(a){var e=s(a),d=$SBC.imgsBase,b=_ce("span"),f=0;b.className="c_search_imgpad";b.appendChild(!$B.rtl&&e!=null?$IS.Create(e,8,16,16,d,d+"h/s6.png",c(a)):t(a,c(a),q(a),m,0));return b}function q(a){return $SBC.imgsBase+"ftype/"+a.ty+".png"}function s(b){var a=46;switch(b.ty){case "ppt":return a+16*2;case "doc":return a+16*3;case "xls":return a+16;case "one":return a}return null}function o(a,b){return l(j(a.t,b))}},v=function(z,Q){var e=this,y=$SBC.utfb,v=z.contactOverride,E={"cs.DisableNickNames":1,"cs.shellcontacts":1},u=d.actionTypes,b=Q,f=z,i=$SB.renderModes,s=d.getActionNode;if($SBC.https)E["cs.httpsusertileonly"]=1;e.getResults=function(c){var b=c.SearchResponse.People;for(var a=0;a<b.length;a++)b[a].id=a;return b};e.getSource=function(a){return x(n.picw,{},a)};e.comparer=F(N);e.matchField=function(a){return h(p(a))};e.getHtml=function(c,e){var b=[];for(var a=0;a<c.length;a++){b.push(L(p(c[a]),e,a+1));d.isActionPosition(a)&&O(b,p(c[a]))}return b};e.getKeysAndWeights=function(b){b=p(b);var l=h(b),e=k(l||c(b)),d=[];e[0]&&d.push(new a(e[0],1.5,1));for(var f=1;f<e.length;f++)d.push(new a(e[f],1,f+1));if(r(b)){var i=k(b.get_network().get_name());for(var g=0;g<i.length;g++)d.push(new a(i[g],.75,g+1))}else if(l&&c(b)){var j=c(b).toLowerCase();d.push(new a(j,.75,1));d.push(new a(j.split("@")[1],.5,1))}return d};e.autoComplete=function(a){var d=c(a),g=h(a),e=f.renderMode==i.HOME;return b||e&&d?d:g};e.isValid=b?function(){return true}:function(a,b){return a.pId!=b.pId};e.compareParents=b?null:function(a,b){var c=a.pId-b.pId;if(c)return c;return a.lcOrder-b.lcOrder};function L(a,d,c){return g(B(a),A(a),function(b){return H(a,b)},b||f.renderMode===i.CONTACTLIST?null:P(a),K(a,d),null,!m(A(a)),"WW_contacts",a,c)}function H(a,c){if(v)return v(a,c);if(b){var d=q.queryStartsWithKeyword(f.getValue())||"";f.searchEmailFunc(d+" "+w(a));return $f.cancelEvent(c)}return true}function O(h,d){if(G()){var a=null,e=null,b=null;switch(f.renderMode){case i.HOME:e=s(u.SEARCHEMAIL,o,function(a){f.searchEmailFunc(w(d));return $f.cancelEvent(a)},false,0);break;case i.OTHER:if(a=D(d))e=s(u.VIEWPHOTOS,a,null,!m(a),0);break;default:return}if((r(d)||!c(d))&&(a=I(d)))b=s(u.SENDMESSAGE,a,null,!m(a),0);else if(!r(d)&&(a=J(d)))b=s(u.SENDEMAIL,a,null,false,0);var g=null;if(e&&!b)g=e;else if(b)g=b;g&&$css.add(g,"c_search_last");e&&h.push(e);b&&h.push(b)}}function G(){return !b&&(f.renderMode===i.HOME||f.renderMode===i.OTHER)}function w(a){return c(a)||h(a)||""}function D(a){if(a.get_photosUrl){var b=a.get_photosUrl()||"";return b.toString()}return 0}function J(b){var a=c(b);if(a)return $SBC.sendEmailLink.replace("{address}",a.encodeUrl().encodeUrl()).replace("{ru}",window.location.href.encodeUrl().encodeUrl());return null}function I(a){if(a.get_sendMessageUrl){var b=a.get_sendMessageUrl()||"";return b.toString()}return 0}function r(a){return a.get_network&&a.get_network().get_id()!="WL"}function B(b){var d=h(b),a=c(b);return (d||a||"")+(d&&a?C(a):"")}function C(a){return $B.rtl?" - "+a:" ("+a+")"}function A(a){var d=null;if(!(v||b)){var c=a.get_profileUrl()||"";return c.toString()||$SBC.profDet.format(a.get_id())}return o}function P(a){return t(a,B(a),M(a),y,"c_search_lg")}function K(a,d){var e=h(a)||"",g=c(a)||"",b="",f="";if(r(a))b=a.get_network().get_name();else if(e)b=g;f=(e?j(e,d):j(g,d,true))+(b&&!$B.rtl?' <span class="c_search_e">('+j(b,d,!r(a))+")</span>":"");return l(f)}function M(a){var b=a.get_displayPictureUrl()||"";return b.toString()||y}function h(a){return b?a.n:a.get_fullName()}function c(a){return b?a.e:a.get_emailAddress()}function N(a){return b?a.id:p(a).get_id()}function p(a){return b?a:a.c}},s=1,H=function(r){var l=this,k=null,e=r,g=null,p=false,J=false,j=null,R=/\s+/g,I="searchCallback"+s++,G="wlxSB",a=null,O="wlximlocalstoreready",X="searchboxlocalstore",t=false,F=false,c=function(){var a=$SB.renderModes;switch(e.renderMode){case a.HOTMAIL:return new v(r,true);case a.HOME:case a.OTHER:case a.CONTACTLIST:return new v(r,false);case a.DOCUMENTS:return new K;default:return null}}(),A="cid",B="xid",f="data",d=[],fb=c.comparer;function gb(){bb()&&C();$SB[I]=Q}l.getMatches=function(l){V();if(!p){g=l;return false}W(l);var i=S(l),w=c.matchField,f=[],h=null,b=null;if(i==""){k([],l);return true}h=H(i);for(var a=0;a<h.length;a++){b=h[a];f.push({obj:b.obj,weight:w(b.obj).toLowerCase()==i?b.weight+1.5:b.weight,bucket:0})}var j=i.split(" ");if(j.length>1)for(var a=0;a<j.length;a++){h=H(j[a]);for(var q=0;q<h.length;q++){b=h[q];f.push({obj:b.obj,weight:b.weight-.1*Math.abs(a+1-b.order),bucket:a+1})}}var e=[];if(f.length){var t=c.compareParents?[Z]:[];t.addRange([z,Y]);f.sort(y(t));var d=null,m=null,o=null,n=null,v=j.length>1?j.length:0,s=function(a){d=a;m=d.bucket;o=m==0?0:1},u=function(){(!n||c.isValid(n.obj,d.obj))&&o==v&&e.push(n=d)};s(f[0]);for(var a=1;a<f.length;a++){var b=f[a];if(z(d,b)){u();s(b)}else{d.weight=d.weight+b.weight;if(m!=b.bucket){m=b.bucket;o++}}}u()}e.sort(y([ab,N]));e.length=Math.min(e.length,$SBC.max);var r=new Array(e.length);for(var a=0;a<e.length;a++)r[a]=e[a].obj;var x=c.getHtml(r,i);k(x,l);return true};l.onTab=function(m,l){var j=l.getSelectedEl(),b=j.sbbinding,f=j.sbmail;if(b||f){if(b){var a=e.getValue(),k=c.autoComplete(b),i=[],h=a.length-q.removeKeywords(a).length;d.push(k);for(var g=0;g<d.length;g++)i.push(o(d[g]));e.setValue([a.substring(0,h),h?" ":"",i.join(" ")," "].join(""))}else{d=[];e.setValue(f.k+" "+f.q+" ")}$f.cancelEvent(m)}};function y(a){return function(d,e){var c=0,b=0;while(c<a.length&&!(b=a[c++](d,e)));return b}}function Z(a,b){return c.compareParents(a.obj,b.obj)}function Y(a,b){return a.bucket-b.bucket}function z(a,b){return fb(a.obj,b.obj)}function N(b,d){var a=c.matchField;return a(b.obj).length-a(d.obj).length}function ab(a,b){return b.weight-a.weight}function W(c){var a=0,b;while(a<d.length){b=o(d[a]);if(c.indexOf(b)==-1)d.splice(a,1);else{c=c.replace(b,"");a++}}}function o(a){return a}l.initialize=function(a){!k&&(k=a);C()};function C(){if(!p&&!J){J=true;if(e.renderMode==$SB.renderModes.HOTMAIL)n();else $Do.when(O,0,P)}}function P(){b=$WLXIM;if(e.renderMode==$SB.renderModes.DOCUMENTS){a=new b.ML.Core.LocalStorageProxy(X);a.add_initialized(w)}else b.hasContacts()?u():b.addStateListener(x)}function x(){if(b.hasContacts()){b.removeStateListener(x);setTimeout(u,1)}}function cb(d,b,c){var a=this;a.pId=d;a.lcOrder=b;a.c=c}function u(){var h=[],i=b.user,d=[i.get_contacts(),i.get_emailOnlyContacts()],f=0;for(var a=0;a<d.length;a++){var k=d[a].get_count();for(var e=0;e<k;e++){var g=d[a].get_item(e).get_linkedContacts(),j=g.get_count();for(var c=0;c<j;c++)h.push(new cb(f,c,g.get_item(c)));f++}}m(h)}function w(e,d){if(t)return;t=true;if(d.get_status()!=b.ML.Core.LocalStorageStatus.initialized){a.remove_initialized(w);a=null;n()}else{$Logout.add(E);var c=L();if(!c)n();else m(c)}}function S(a){a=db(a);return a.toLowerCase().trim().replace(R," ")}function db(a){for(var b=0;b<d.length;b++)a=a.replace(o(d[b]),"");return a}function H(a){return j.matchPrefix(i(h.expand(a)))}function Q(d){var b=c.getResults(d);if(a)if(c.localStorageKey&&b)M(b);m(b)}function m(a){eb(a);p=true;if(g){l.getMatches(g);g=null}}function eb(d){j=new $Trie;for(var a=0;a<d.length;a++){var f=c.getKeysAndWeights(d[a]);for(var e=0;e<f.length;e++){var b=f[e];j.insert(i(h.expand(b.key.toLowerCase().trim())),{obj:d[a],weight:b.weight,order:b.order})}}j.sort()}function n(){$Network.fetchScript(c.getSource(I),function(){},null)}function L(){return T(c.localStorageKey)}function M(a){U(c.localStorageKey,a)}function T(b){D();return a.get_item(f)[b]}function U(d,c){D();var b=a.get_item(f);b[d]=c;a.set_item(f,b)}function D(){var b=$Config.cid,c=$Config.BSI.xid;if(b!=a.get_item(A)||c!=a.get_item(B)||typeof(a.get_item(f)!=="object")){E();a.set_item(A,b);a.set_item(B,c);a.set_item(f,{})}}function E(){a.clear()}function bb(){return $Cookie.getCookie(G,0)==="1"}function V(){if(!F){var a=new Date;a.setDate((new Date).getDate()+$SBC.dateOffset);$Cookie.setCookie(G,"1",$Config.sd,0,a,0);F=true}}gb()},u="<strong>",y="</strong>",z=/&#57344;/g,A=/&#57345;/g,D=/[\uE000\uE001]/g,J="c_search_bi",N=function(i){var b=this,d="bingCompleted"+s++,k=$SBC.bingAuto+"?JsonCallback=$SB."+d.encodeUrl()+"&Market="+$Config.mkt.encodeUrl()+"&Options=EnableHighlighting"+"&JsonType=callback"+($SB.formCode?"&form="+$SB.formCode.encodeUrl():"")+"&Query=",a=null,e=null,j=i;b.getMatches=function(b){if(!$SBC.https&&$SBC.bingSupport){a=b;$Network.fetchScript(k+b.encodeUrl(),function(){},null)}return true};b.initialize=function(a){e=a};b.onTab=null;function h(f){if(c(a)===c(f.SearchSuggestion.Query)){var g=f.SearchSuggestion.Section||[],h=Math.min($SBC.max,g.length),d=new Array(h);for(var b=0;b<h;b++)d[b]=l(g[b].Text);e(d,a)}}function l(c){var a=_ce("A"),b=f(c);a.className=J;a.setAttribute("target","_blank");a.setAttribute("href",$SB.getBingUrl(b));a.setAttribute("title",b);$f.addEvent(a,"onclick",function(){j.setValue(b);$menu.closeCurrent();$SB.logEvent("WW_bing");return true});a.innerHTML="<span>"+g(c.encodeHtml())+"</span>";return a}function g(a){return u+a.replace(z,y).replace(A,u)+y}function f(a){return a.replace(D,"")}function c(a){return a.toLowerCase().trim()}$SB[d]=h};try{$SB.bindAllSearchBoxes($SBC.auth?H:N)}catch(O){}};gAlertsImagePath=window["gAlertsImagePath"]||"";gAlertsCloseBoxAltText=window["gAlertsCloseBoxAltText"]||"";Toast=function(o,i){var d=this,c=false,k=i?i:3e3,b=null,f=false,a=null,e=null;m();function m(){a=new WebDialog(null,208,null,false,false,false,"Toast");a.setCallback(j);a.setContents(o)}function j(){d.hide();return true}this.show=function(){if(!c){l();a.show();d.recalc();c=true;e.attachEvent("onmouseenter",g);e.attachEvent("onmouseleave",h);window.attachEvent("onresize",d.recalc);b=setTimeout(this.hideTimeoutClose,k)}};this.recalc=function(){var c=WebUtilities.getViewportHeight()-a.getContents().offsetHeight-3,b="rtl"===document.body.currentStyle.direction?WebUtilities.getViewportWidth()-a.getContents().offsetWidth-27:WebUtilities.getLayoutRoot().scrollLeft,d=new WebUtilities.Point(b,c);a.setPosition(d)};function g(){f=true}function h(){f=false;if(!b&&c)d.close()}this.isShown=function(){return c};this.hide=function(){if(b){clearTimeout(b);b=null}f=false;if(c){c=false;n()}};this.hideTimeoutClose=function(){if(b){clearTimeout(b);b=null}if(!f)d.close()};this.close=function(){if(c){a.hide();d.hide()}};function l(){e=a.getRootElt();a.setImgPath(gAlertsImagePath);a.addCloseBox(gAlertsCloseBoxAltText);a.addCloseOnEscapeKey()}function n(){if(!c){e.detachEvent("onmouseenter",g);e.detachEvent("onmouseleave",h);window.detachEvent("onresize",d.recalc);document.onkeypress=null;a=e=null}}};var ToastManager=function(){var b=null;function a(){if(typeof a.caller!="undefined"&&a.caller!=a.getInstance)throw new Error("Error: There is no public constructor for ToastManager. Use ToastManager.getInstance().");this.m_visibleToast=null}a.getInstance=function(){if(b==null)b=new a;return b};a.prototype.showToast=function(a,c){if(a){var b=new Toast(a,c);this.hideVisibleToast();b.show();this.m_visibleToast=b}};a.prototype.isToastVisible=function(){return this.m_visibleToast&&this.m_visibleToast.isShown()?true:false};a.prototype.hideVisibleToast=function(){if(this.m_visibleToast!=null){this.m_visibleToast.close();this.m_visibleToast=null}};return a}();ExpandCollapse={};ExpandCollapse.initializeForStandaloneUi=function ExpandCollapse$initializeForStandaloneUi(){var a=$("folderList");if(a)a.attachEvent("onclick",function(){ExpandCollapse.onClick(App.config.excoCookieValFl)});var b=$("quickViewList");if(b)b.attachEvent("onclick",function(){ExpandCollapse.onClick(App.config.excoCookieValQv)})};ExpandCollapse.onClick=function ExpandCollapse$onClick(a){ExpandCollapse.handleClick(event.srcElement,a)};ExpandCollapse.handleClick=function ExpandCollapse$handleClick(e,d){var c=Control.getAncestorByAttr(e,"exco_hot");if(c){var a=Control.getAncestorByAttr(c,"exco_main");if(a){var b=$css.has(a,"exco_disabled");if(b)$css.remove(a,"exco_disabled");else $css.add(a,"exco_disabled");ExpandCollapse._updateCookie(d,!b);if(Page.getLayout().indexOf("Unmanaged")>=0&&UnmanagedFooter)UnmanagedFooter.resize()}}};ExpandCollapse._updateCookie=function ExpandCollapse$_updateCookie(b,d){var a=$Cookie.getCookieValues(App.config.pdCookie),c=d?"1":"0";if(a[b]!=c){a[b]=c;$Cookie.setCookieValues(App.config.pdCookie,a,$Cookie.getPermanentExpirationDate())}};$MenuCog={};$MenuCog.onBindOpen=function $MenuCog$onBindOpen(a){$MenuCog.changeCogClass(a,true)};$MenuCog.onClose=function $MenuCog$onClose(a){if(a&&a.menu&&!a.menu.isOpen())$MenuCog.changeCogClass(a,false)};$MenuCog.changeCogClass=function $MenuCog$changeCogClass(d,c){var b=$getDescendantByClass(d,"img","MenuCog");if(b)c?$css.add(b,"CogMenuOn"):$css.has(b,"CogMenuOn")&&$css.remove(b,"CogMenuOn");var a=$getNearestParentByClass(d,"lnav_topItem");if(a)c?$css.add(a,"MenuOn"):$css.has(a,"MenuOn")&&$css.remove(a,"MenuOn")};Refresher={};Refresher.isEnabled=function Refresher$isEnabled(){return !InboxPage.messageList.isBulkSelectAllState()&&!InboxPage.messageList.getHiddenBulkSelectAll()&&!AlertManager.getInstance().isAlertVisible()&&!WebDialogManager.getInstance().isDialogVisible()};Refresher.refreshInbox=function Refresher$refreshInbox(c,b){if(Refresher.isEnabled()){var e=InboxPage.folderList,a=InboxPage.createMessageListRenderingInfo(true);a.AutoSelectMessageIndex=-1;var d=!(e.isSrch||InboxPage.readingPane.isFullView)&&!InboxPage.messageList.disableRefreshForMl;InboxPage.beginRefreshInbox(true,d,a,false,null,false,false,c,b,true)}};Refresher.endRefreshInbox=function Refresher$endRefreshInbox(g,n,o){if(!Refresher.isEnabled())return;g.MessageHtml=null;var k=false,d=InboxPage.getSelectedMessageData().mids,f=d.length,m=parseInt($("messageListScrollableContainer").scrollTop),e=g.MessageListHtml,a=InboxPage.messageList;if(f>0){var c=null,h=null;if(1==f){c=$(d[0]);k=$tag(c,"INPUT")[0].checked}else{var l=a.getMessageListItemChecks();for(var b=l.length-1;b>=0;b--){var i=l[b];if(i.checked)if(null==c)c=i;else h=i}}if(c)if(!Refresher.isItemInHtml(c,e)||h&&!Refresher.isItemInHtml(h,e))g.MessageListHtml=e=null}var j=false;if(e!=null&&e!="")j=true;InboxServices._endRefreshInbox(g,n,o);if(j&&f>0){if(1==f){a.selectByMid(d[0],true,true,true);if(k)$tag($(d[0]),"INPUT")[0].checked=true}else{if(a.getItemCount()>0)a.selectByIndex(0,false,true);for(var b=f-1;b>=0;b--){$tag($(d[b]),"INPUT")[0].checked=true;a.selectByMid(d[b],true,false)}if(a.areAllItemsChecked())a.setCheckAllCheckBox(true)}$("messageListScrollableContainer").scrollTop=m}};Refresher.isItemInHtml=function Refresher$isItemInHtml(c,b){var c=InboxPage.messageList.getSelectedItem(c);if(c!=null){var a=b.indexOf(c.id);if(a>=0){var d=b.indexOf("display:none",a);if(d<0)return true;else{var e=b.indexOf(">",a);if(e>d)return false;else return true}}}return false};ManualRefresh={};ManualRefresh.refreshInbox=function ManualRefresh$refreshInbox(){if(event.srcElement)ManualRefresh._switchClasses(event.srcElement,true);Refresher.refreshInbox(ManualRefresh._endRefreshInbox,ManualRefresh._errorRefreshInbox)};ManualRefresh._endRefreshInbox=function ManualRefresh$_endRefreshInbox(c,a,b){Refresher.endRefreshInbox(c,a,b,false);ManualRefresh._endSpin()};ManualRefresh._errorRefreshInbox=function ManualRefresh$_errorRefreshInbox(){ManualRefresh._endSpin()};ManualRefresh._switchClasses=function ManualRefresh$_switchClasses(a,b){var c="IMG"==a.tagName?a:$tag(a,"IMG")[0];if(c)$replaceClass(c,b?"i_refresh":"i_refreshing",b?"i_refreshing":"i_refresh")};ManualRefresh._endSpin=function ManualRefresh$_endSpin(){if($("Refresh"))ManualRefresh._switchClasses($("Refresh"),false);if($("bt_Refresh"))ManualRefresh._switchClasses($("bt_Refresh"),false)};var DragControl=function DragControl(e,a,d,b,c){this._elt=e;this._onDragStart=a;this._onDragStop=b;this._onDrag=d;this._onTestDrag=c;this._bIsMoving=false;this._onMouseDownHandler=$CD(this,this._onMouseDown);this._onMouseUpHandler=$CD(this,this._onMouseUp);this._onMouseMoveHandler=$CD(this,this._onMouseMove);this._elt.attachEvent("onmousedown",this._onMouseDownHandler)};DragControl.prototype={sensitivity:0,_elt:null,_initMouseX:0,_initMouseY:0,_onMouseDownHandler:null,_onMouseUpHandler:null,_onMouseMoveHandler:null,_onDragStart:null,_onDrag:null,_onDragStop:null,_onTestDrag:null,_bIsMoving:false,_invoked:false,_leftButtonValue:Browser.isIE?1:0,enabled:true,userdata:null,dispose:function DragControl$dispose(){this._elt.detachEvent("onmousedown",this._onMouseDown);this._elt=null;this._onMouseDownHandler=null;this._onMouseUpHandler=null;this._onMouseMoveHandler=null;this._onDragStart=null;this._onDrag=null;this._onDragStop=null;this.userdata=null},_onMouseDown:function DragControl$_onMouseDown(){if(!this.enabled)return;var a=window.event,b={x:0,y:0,overElement:a.srcElement},c=this._onTestDrag?this._onTestDrag(b):true;if(a.button===this._leftButtonValue&&c)if(!this._bIsMoving){this._invoked=false;this._bIsMoving=true;this._elt.attachEvent("onmouseup",this._onMouseUpHandler);this._elt.attachEvent("onmousemove",this._onMouseMoveHandler);this._initMouseX=a.clientX;this._initMouseY=a.clientY;a.returnValue=false;if(this.sensitivity<=0){this._elt.setCapture();this._onDragStart([this,b]);this._invoked=true}else this.startElt=a.srcElement;try{document.selection.empty()}catch(d){}}else this._onMouseUp()},_onMouseUp:function DragControl$_onMouseUp(){if(!this.enabled)return;this._bIsMoving=false;this._elt.releaseCapture();this._elt.detachEvent("onmouseup",this._onMouseUpHandler);this._elt.detachEvent("onmousemove",this._onMouseMoveHandler);var a=window.event,b=a.clientX,c=a.clientY;if(this._invoked)this._onDragStop([this,{x:this._initMouseX-b,y:this._initMouseY-c,overElement:Browser.isFF&&$B.V<4?event._data||this._elt:Browser.isIE?a.srcElement:document.elementFromPoint(b,c)}]);this._invoked=false},_onMouseMove:function DragControl$_onMouseMove(){if(!this.enabled)return;var a=window.event;if(a.button!==this._leftButtonValue)this._onMouseUp();var b=a.clientX,c=a.clientY;if(!this._invoked){if(Math.abs(this._initMouseX-b+(this._initMouseY-c))>this.sensitivity){document.selection.empty();this._elt.setCapture();this._onDragStart([this,{x:0,y:0,overElement:this.startElt}]);this._invoked=true}}else this._onDrag([this,{x:this._initMouseX-b,y:this._initMouseY-c,overElement:Browser.isFF&&$B.V<4?event._data||this._elt:Browser.isIE?a.srcElement:document.elementFromPoint(b,c)}])}};DragControl.createClass("DragControl");var Splitter=function Splitter(e,d,c,a,b){this.elt=e;this.Events={onresizestart:new $Event,onresizecomplete:new $Event};a=a||"horizontal";if(a=="horizontal"){this._fixedSide=b||"left";this._dir={offsetLeft:"offsetLeft",width:"width",x:"x",offsetWidth:"offsetWidth"}}else{this._fixedSide=b||"top";this._dir={offsetLeft:"offsetTop",width:"height",x:"y",offsetWidth:"offsetHeight"}}this._dir.left=this._fixedSide;this._fixedWidth=d;this._anchored=c;this._drag=new DragControl(this.elt,$CD(this,this._onDragStart),$CD(this,this._onDrag),$CD(this,this._onDragEnd));this.elt.offsetParent.attachEvent("onresize",$CD(this,this._checkBoundaries));this._checkBoundaries()};Splitter.prototype={elt:null,_drag:null,_dir:null,_fixedWidth:null,_anchored:null,_fixedSide:null,leftMin:0,rightMin:0,_min:0,_max:0,dispose:function Splitter$dispose(){this._drag.dispose();this.elt=null},_checkBoundaries:function Splitter$_checkBoundaries(){try{var a=this._dir,e=this.elt.offsetParent[a.offsetWidth]-this.elt[a.offsetWidth];if(this._fixedSide=="right"||this._fixedSide=="bottom"){var c=this.elt.offsetParent[a.offsetWidth]-this._fixedWidth[a.offsetLeft]-e;if(c<0)return;var b=this._fixedWidth[a.offsetWidth]-c;if(b<this.leftMin)b=this.leftMin;this._fixedWidth.style[a.width]=Resize.convertToEm(b)+"em";var d=this.elt.offsetParent[a.offsetWidth]-this._fixedWidth[a.offsetLeft];this.elt.style[a.left]=Resize.convertToEm(d)+"em";this._anchored.style[a.left]=Resize.convertToEm(d+this.elt[a.offsetWidth])+"em"}else{var c=this._fixedWidth[a.offsetLeft]+this._fixedWidth[a.offsetWidth]-e;if(c<0)return;var b=this._fixedWidth[a.offsetWidth]-c;if(b<this.leftMin)b=this.leftMin;this._fixedWidth.style[a.width]=Resize.convertToEm(b-this._fixedWidth[a.offsetLeft])+"em";this.elt.style[a.left]=Resize.convertToEm(b)+"em";this._anchored.style[a.left]=Resize.convertToEm(b+this.elt[a.offsetWidth])+"em"}}catch(f){}},_onDragStart:function Splitter$onDragStart(e){var d=e[0],g=e[1],b=this.elt,f=b.offsetParent,a=this._dir,c=b.currentStyle[a.width];if(this._fixedSide=="right"||this._fixedSide=="bottom"){d.userdata={widthAsEm:c.indexOf("em")>0?parseFloat(c):Resize.convertToEm(parseFloat(c)),startLeft:b.offsetParent[a.offsetWidth]-b[a.offsetLeft]-b[a.offsetWidth],width:parseFloat(b[a.offsetWidth]),left:b[a.offsetLeft]+b[a.offsetWidth]-b.offsetParent[a.offsetWidth],offsetLeft:this._anchored[a.offsetLeft],oldZ:b.currentStyle.zindex,negateX:true};this._max=this._fixedWidth[a.offsetLeft]+this._fixedWidth[a.offsetWidth]-this.rightMin}else{d.userdata={widthAsEm:c.indexOf("em")>0?parseFloat(c):Resize.convertToEm(parseFloat(c)),startLeft:b[a.offsetLeft],width:parseFloat(b[a.offsetWidth]),left:b[a.offsetLeft],offsetLeft:this._fixedWidth[a.offsetLeft],oldZ:b.currentStyle.zindex,negateX:false};this._max=this._anchored[a.offsetLeft]+this._anchored[a.offsetWidth]-this.rightMin}this._min=d.userdata.offsetLeft+this.leftMin;b.style.backgroundColor="gray";b.style.zindex=1e3;this.Events.onresizestart.fire([this,{}])},_onDrag:function Splitter$onDrag(e){var f=e[0],d=e[1],a=f.userdata,b=this._dir;a.left=Math.max(Math.min(a.startLeft-(a.negateX?-d[b.x]:d[b.x]),this._max),this._min);var c=a.left;this._fixedWidth.style[b.width]=c-a.offsetLeft+"px";this.elt.style[b.left]=a.left+"px";this._anchored.style[b.left]=c+a.width+"px"},_onDragEnd:function Splitter$onDragEnd(d){var e=d[0],f=d[1];this._onDrag([e,f]);var a=e.userdata,b=Resize.convertToEm(a.left),c=this._dir;this._fixedWidth.style[c.width]=b-Resize.convertToEm(a.offsetLeft)+"em";this._anchored.style[c.left]=b+a.widthAsEm+"em";this.elt.style[c.left]=b+"em";this.elt.style.zindex=a.oldZ;this.elt.style.backgroundColor=Browser.isIE6?"white":"";this.Events.onresizecomplete.fire([this,{}])}};if(Browser.isIE6){var oldFunc=Splitter.prototype._checkBoundaries;Splitter.prototype._checkBoundaries=function Splitter$_checkBoundaries(){if(this._to)clearTimeout(this._to);else this._retry=3;var a=this;this._to=setTimeout(function(){try{a._retry--;oldFunc.call(a);clearTimeout(this._to);this._to=null}catch(b){if(a._retry>0)a._checkBoundaries()}},200)}}Splitter.createClass("Splitter");var DragNDrop=function DragNDrop(e,b,c,a,d){this.elt=e;this._onDragDropStart=b;this._onDragDropEnd=c;this._onDragDropNoTarget=a;this._drag=new DragControl(this.elt,$CD(this,this._onDragStart),$CD(this,this._onDrag),$CD(this,this._onDragEnd),d);this._drag.sensitivity=DragNDrop.MOUSE_SENSITIVITY;DragNDrop.RegisterDropTarget(this.elt,null,null,$EmptyFunction)};DragNDrop.MOUSE_SENSITIVITY=5;DragNDrop.prototype={elt:null,userdata:null,_drag:null,_clone:null,_onDragDropStart:null,_onDragDropEnd:null,_currTarget:null,_cursorDiv:null,dispose:function DragNDrop$dispose(){DragNDrop.UnRegisterDropTarget(this.elt);this._drag.dispose();this.userdata=null;this.elt=null},_onDragStart:function DragNDrop$onDragStart(d){var e=d[0],c=d[1],b=c.overElement,f={fromElement:b,data:null};this._onDragDropStart([this,c]);DragNDrop._UpdateDropTargetRegions();var g=e.userdata={startX:event.clientX-b.offsetWidth/2,startY:event.clientY-b.offsetHeight/2,fromElement:b,dragData:c.data};this._currTarget=null;event.cancelBubble=true;this._cursorDiv=document.createElement("DIV");document.body.appendChild(this._cursorDiv);var a=this._cursorDiv.style;a.cursor="pointer";a.position="absolute";a.height="20px";a.width="20px";a.zIndex=1e3},_onDrag:function DragNDrop$onDrag(c){var e=c[0],a=c[1],b=e.userdata,d={fromElement:b.fromElement,toElement:null,data:b.dragData,canDrop:false,overElement:a.overElement};this._doDragOver([a.overElement,d])},_onDragEnd:function DragNDrop$onDragEnd(c){var d=c[0],g=c[1];document.body.style.cursor="auto";var a=d.userdata,e=DragNDrop._targets,f,b={fromElement:a.fromElement,toElement:null,data:a.dragData,success:false};this._setNewCurrTarget(null,"onDragDrop",b);document.body.removeChild(this._cursorDiv);this._onDragDropEnd([this,b]);a.fromElement=null;a.toElement=null;event.cancelBubble=true;event.returnValue=false},_doDragOver:function DragNDrop$_doDragOver(h){var i=h[0],a=h[1],g=DragNDrop._targets,b;a.toElement=null;var d=event.clientX,e=event.clientY+(Browser.isSF?document.body.scrollTop:0),c=this._cursorDiv.style;if(!this._currTarget){this._onDragDropNoTarget([this,a]);c.left=d-10+"px";c.top=e-10+"px"}else if(this._currTarget.element==this.elt&&this._currTarget.region.containsPoint(d,e)){this._onDragDropNoTarget([this,a]);c.left=d-10+"px";c.top=e-10+"px";return}for(var f=g.length-1;f>=0;f--){b=g[f];if(b.region.containsPoint(d,e)){if(this._currTarget!=b){this._setNewCurrTarget(b,"onDragOut",a);a.toElement=b.element;b["onDragOver"]([this,a]);c.left="0px";c.top="0px";document.body.style.cursor="pointer";this._cursorDiv.style.cursor="pointer";return}b["onDragOver"]([this,a]);return}}if(this._currTarget){document.body.style.cursor="no-drop";this._cursorDiv.style.cursor="no-drop"}this._setNewCurrTarget(null,"onDragOut",a)},_setNewCurrTarget:function DragNDrop$_setNewCurrTarget(c,b,a){if(this._currTarget){a.toElement=this._currTarget.element;this._currTarget[b]([this,a])}this._currTarget=c}};DragNDrop._targets=[];DragNDrop.RegisterDropTarget=function DragNDrop$RegisterDropTarget(d,a,b,c){if(a==null||a===undefined)a=$EmptyFunction;if(b==null||b===undefined)b=$EmptyFunction;DragNDrop._targets.push({element:d,onDragOver:a,onDragOut:b,onDragDrop:c,region:null})};DragNDrop._UpdateDropTargetRegions=function DragNDrop$_UpdateDropTargetRegions(){var b=DragNDrop._targets,d,c=-document.getElementsByTagName("HTML")[0].scrollTop;for(var a=b.length-1;a>=0;a--)b[a].region=$getLocation(b[a].element,{y:c})};DragNDrop.UnRegisterDropTarget=function DragNDrop$RegisterDropTarget(d){var b=DragNDrop._targets,c;for(var a=b.length-1;a>=0;a--){c=b[a];if(c.element==d){c.element=null;b.splice(a,1);return}}};DragNDrop.createClass("DragNDrop");if(!window.Silverlight)window.Silverlight={};Silverlight._SAFARI_BROWSER=1;Silverlight._CHROME_BROWSER=2;Silverlight._isInstalledCache={};Silverlight.isInstalled=function(a){a=a==undefined?null:a;var h=a==null?"default":a;if(this._isInstalledCache[h]!=undefined)return this._isInstalledCache[h];var b=false,n=null;try{var j=null,k=false;if(window.ActiveXObject)try{j=new ActiveXObject("AgControl.AgControl");if(a===null)b=true;else if(j.IsVersionSupported(a))b=true;j=null}catch(m){k=true}else k=true;if(k){var l=navigator.plugins["Silverlight Plug-In"];if(l)if(a===null)b=true;else{var i=l.description;if(i==="1.0.30226.2")i="2.0.30226.2";var c=i.split(".");while(c.length>3)c.pop();while(c.length<4)c.push(0);var e=a.split(".");while(e.length>4)e.pop();var d,g,f=0;do{d=parseInt(e[f]);g=parseInt(c[f]);f++}while(f<e.length&&d===g);if(d<=g&&!isNaN(d))b=true}}}catch(m){b=false}this._isInstalledCache[h]=b;return b};Silverlight.supportedUserAgent=function(j,i,c){try{var b=null;if(i)b=i;else b=window.navigator.userAgent;var g=true,h=true;if(c){if(c&Silverlight._CHROME_BROWSER)g=false;if(c&Silverlight._SAFARI_BROWSER)h=false}var a={OS:"Unsupported",Browser:"Unsupported"};if(b.indexOf("Windows NT")>=0||b.indexOf("Mozilla/4.0 (compatible; MSIE 6.0)")>=0)a.OS="Windows";else if(b.indexOf("PPC Mac OS X")>=0)a.OS="MacPPC";else if(b.indexOf("Intel Mac OS X")>=0)a.OS="MacIntel";if(a.OS!="Unsupported")if(b.indexOf("MSIE")>=0){if(navigator.userAgent.indexOf("Win64")==-1)if(parseInt(b.split("MSIE")[1])>=6)a.Browser="MSIE"}else if(b.indexOf("Firefox")>=0){var d=b.split("Firefox/")[1].split("."),e=parseInt(d[0]);if(e>=2)a.Browser="Firefox";else{var k=parseInt(d[1]);if(e==1&&k>=5)a.Browser="Firefox"}}else if(b.indexOf("Chrome")>=0&&g){var d=b.split("Chrome/")[1].split("."),e=parseInt(d[0]);if(e>=3)a.Browser="Chrome"}else if(b.indexOf("Safari")>=0&&h)a.Browser="Safari";var f=!(a.OS=="Unsupported"||a.Browser=="Unsupported"||a.OS.indexOf("Mac")>=0&&a.Browser=="MSIE");if(j=="2.0")return f&&a.OS!="MacPPC";else if(j=="1.0")return f&&b.indexOf("Windows NT 5.0")<0;else return f}catch(l){return false}};function AdvancedSearch(){}__p=AdvancedSearch.prototype={};__p.m_content=null;__p.m_eventMgrs=null;__p.m_fromElt=null;__p.m_toElt=null;__p.m_subjectElt=null;__p.m_keywordsElt=null;__p.m_dateStartElt=null;__p.m_dateEndElt=null;__p.m_hasAttachmentElt=null;__p.m_folder=null;__p.m_isOpen=false;__p.m_search=null;__p.m_showLink=null;__p.dispose=function AdvancedSearch$dispose(){if(this.m_fromElt){var a=this.m_eventMgrs;if(a){a.forEach(function(a){a.dispose()});this.m_eventMgrs=null}Control.destroy(this);this.m_fromElt=this.m_toElt=this.m_subjectElt=this.m_keywordsElt=this.m_dateStartElt=this.m_dateEndElt=this.m_hasAttachmentElt=this.m_folder=this.m_showLink=null}};__p.isLoaded=function AdvancedSearch$isLoaded(){return this.m_fromElt!=null};__p.isOpen=function AdvancedSearch$isOpen(){return this.m_isOpen};__p.reset=function AdvancedSearch$reset(){if(this.isLoaded()){this.m_fromElt.value=this.m_toElt.value=this.m_subjectElt.value=this.m_keywordsElt.value=this.m_dateStartElt.value=this.m_dateEndElt.value="";this._updateWatermarkVisibility(this.m_dateStartElt,true);this._updateWatermarkVisibility(this.m_dateEndElt,true);this.m_hasAttachmentElt.checked=false;this.m_folder.selectedIndex=0;this.m_search=null}return this};__p.load=function AdvancedSearch$load(a){if(!this.isLoaded())DemandLoadHandler.demandLoadContent([HM.ContentId.AdvancedSearch],[$CC($CD(this,this._endInitialize),[a])]);else if(a)a.apply(this)};__p._endInitialize=function AdvancedSearch$_endInitialize(c){var b=DemandLoadHandler.getContent(HM.ContentId.AdvancedSearch),b=b&&b["advancedSearch"];if(!b)return;this.m_content=b;InboxPage.searchPane.setContent(b);this.m_eventMgrs=[];var a=this,d=["asFrm","asTo","asSbj","asKwd","asDs","asDe","asFldr","asAtt"];d.forEach(function(c){var b=$(c);if(b)a.m_eventMgrs.push(new $Event.Manager(b,{onkeypress:$CD(a,a._keyPress)}))});var e=["asDs","asDe"];e.forEach(function(d){var b=$(d);if(b){var c=[b];a.m_eventMgrs.push(new $Event.Manager(b,{onfocus:$CC($CD(a,a._hideWatermarkIfEmpty),c),onkeydown:$CC($CD(a,a._hideWatermarkIfEmpty),c),onblur:$CC($CD(a,a._showWatermarkIfEmpty),c)}))}});Control.create(this,$("advancedSearch"));this.m_fromElt=$("asFrm");this.m_toElt=$("asTo");this.m_subjectElt=$("asSbj");this.m_keywordsElt=$("asKwd");this.m_dateStartElt=$("asDs");this.m_dateEndElt=$("asDe");this.m_hasAttachmentElt=$("asAtt");this.m_folder=$("asFldr");this.m_showLink=$("asShow");var f=this.m_fromElt&&this.m_toElt&&this.m_subjectElt&&this.m_keywordsElt&&this.m_dateStartElt&&this.m_dateEndElt&&this.m_hasAttachmentElt&&this.m_folder&&this.m_showLink;if(c)c.apply(this)};__p._hideWatermarkIfEmpty=function AdvancedSearch$_hideWatermarkIfEmpty(a){if(a.value.length==0)this._updateWatermarkVisibility(a,false)};__p._showWatermarkIfEmpty=function AdvancedSearch$_showWatermarkIfEmpty(a){if(a.value.length==0)this._updateWatermarkVisibility(a,true)};__p._updateWatermarkVisibility=function AdvancedSearch$_updateWatermarkVisibility(b,a){if(!a||!document.activeElement||document.activeElement!==b){var c=$tag(b.parentNode,"label")[0];$setDisplay(c,a)}};__p.getSearch=function AdvancedSearch$getSearch(){return this.m_search};__p.setSearch=function AdvancedSearch$setSearch(a){if(this.isLoaded()){if(a){this._updateWatermarkVisibility(this.m_dateStartElt,false);this._updateWatermarkVisibility(this.m_dateEndElt,false);this.m_fromElt.value=a.From;this.m_keywordsElt.value=a.Keywords;this.m_dateStartElt.value=a.DateBegin;this.m_dateEndElt.value=a.DateEnd;this.m_subjectElt.value=a.Subject;this.m_toElt.value=a.To;this.m_hasAttachmentElt.checked=a.HasAttachment?true:false;this._updateWatermarkVisibility(this.m_dateStartElt,this.m_dateStartElt.value.length==0);this._updateWatermarkVisibility(this.m_dateEndElt,this.m_dateEndElt.value.length==0);var c=this.m_folder.options,e=c.length,d=false;for(var b=e-1;b>=0;b--)if(c[b].value==a.Folder){this.m_folder.selectedIndex=b;d=true;break}if(!d)this.m_folder.selectedIndex=0}else this.reset();this.m_search=a}return this};__p.show=function AdvancedSearch$show(){if(this.isLoaded()&&!this.isOpen()){InboxPage.searchPane.show();this.m_isOpen=true}return this};__p.focus=function AdvancedSearch$focus(){if(this.isOpen()&&this.isLoaded())try{this.m_fromElt.focus()}catch(a){}return this};__p.hide=function AdvancedSearch$hide(){this._hide(false);return this};__p.hideAndSetFocus=function AdvancedSearch$hideAndSetFocus(){this._hide(true);return this};__p._hide=function AdvancedSearch$_hide(a){if(this.isOpen()){InboxPage.searchPane.hide();if(a)this.m_showLink.focus();this.m_isOpen=false}};__p._keyPress=function AdvancedSearch$_keyPress(a){if(a.keyCode==13){Control.invokeStatic("InboxActions","advancedSearch",a);var b=a.srcElement;if(b===this.m_folder||b===this.m_hasAttachmentElt){b.blur();b.focus()}a.returnValue=false;a.cancelBubble=true;return false}return true};__p.search=function AdvancedSearch$search(){if(this.isLoaded()){var a=new HM.AdvancedSearch;a.From=this.m_fromElt.value;a.Keywords=this.m_keywordsElt.value;a.DateBegin=this.m_dateStartElt.value;a.DateEnd=this.m_dateEndElt.value;a.Subject=this.m_subjectElt.value;a.To=this.m_toElt.value;a.HasAttachment=this.m_hasAttachmentElt.checked?"true":null;a.Folder=this.m_folder.selectedIndex==0?null:this.m_folder.options[this.m_folder.selectedIndex].value;this.m_search=a;InboxPage.messageList.advancedSearch(a)}return this};AdvancedSearch.createClass("AdvancedSearch");__p=MessageList.prototype;__p.initContextMenu=function MessageList$initContextMenu(){DemandLoadHandler.demandLoadContent([HM.ContentId.MessageListContextMenu],[$CD(this,this.endInitContextMenu)])};__p.endInitContextMenu=function MessageList$endInitContextMenu(){var b=DemandLoadHandler.getContent(HM.ContentId.MessageListContextMenu),e=b&&b.contextMenu;if(!e)return;this._content=b;var c=document.createElement("div");c.innerHTML=e;var k=$("PageBottomElt");k.appendChild(c);c=null;this._cm=$("mlcm");if(!this._cm)return;this._msgListMenuEventsMgr=new $Event.Manager(this.elt,{oncontextmenu:$CD(this,this._handleContextMenuInList),onmouseover:$CD(this,this._handleMouseOverList),onmouseout:$CD(this,this._handleMouseOutList)});this._cmEventsMgr=new $Event.Manager(this._cm,{onmouseover:$CD(this,this._handleMouseOverMenu),onmouseout:$CD(this,this._handleMouseOutMenu),oncontextmenu:$CD(this,this._handleContextMenuInMenu),onclick:$CD(this,this._handleContextMenuClick)});this._contextMenuTimers=[];this._trackedSenders=[];this._menuOwner=null;this._menuSenderNames=[];this._menuSenderEmails=[];var f=$tag(this._cm,"span"),i=f.length;for(var d=0;d<i;d++){var a=f[d];if($css.has(a,"SenderEmail"))this._menuSenderEmails.push(a);else if($css.has(a,"SenderName"))this._menuSenderNames.push(a)}this._senderDiv=$("mlcm_sender");this._messageDiv=$("mlcm_message");this._headingDiv=$("mlcm_heading");this._menuSenderTitleSpans=null;this._menuMessageTitleSpans=null;if(this._senderDiv){var h=$getDescendantByClass(this._senderDiv,"div","MenuItemGroupTitle");this._menuSenderTitleSpans=$getDescendantsByClass(h,"span","SenderTitle");var j=this._menuSenderTitleSpans[1].parentNode;j.attachEvent("onclick",$CD(this,this._expandSenderItems))}if(this._messageDiv){var g=$getDescendantByClass(this._messageDiv,"div","MenuItemGroupTitle");this._menuMessageTitleSpans=$getDescendantsByClass(g,"span","MessageTitle")}this._isMenuOpen=false;this._menu=new Menu(this._cm);this._handleMenuItemDelegate=$CD(this,this._handleMenuItem);this._handleMenuHiddenDelegate=$CD(this,this._handleMenuHidden);this._menu.Events.onbuttonclick.attach(this._handleMenuItemDelegate);this._menu.Events.onhidden.attach(this._handleMenuHiddenDelegate)};__p.disposeContextMenu=function MessageList$disposeContextMenu(){if(this._handleMenuItemDelegate){this._menu.Events.onbuttonclick.detach(this._handleMenuItemDelegate);this._handleMenuItemDelegate=null}if(this._handleMenuHiddenDelegate){this._menu.Events.onhidden.detach(this._handleMenuHiddenDelegate);this._handleMenuHiddenDelegate=null}if(this._msgListMenuEventsMgr){this._msgListMenuEventsMgr.dispose();this._msgListMenuEventsMgr=null}if(this._cmEventsMgr){this._cmEventsMgr.dispose();this._cmEventsMgr=null}this._disposeMoveHandlers()};__p._handleMouseOverMenu=function MessageList$_handleMouseOverMenu(){var a=event.srcElement;if(this._menuOwner)this._cancelHoverOffTimer(this._menuOwner)};__p._handleMouseOutMenu=function MessageList$_handleMouseOutMenu(){if(this._menuOwner&&!this._menuOwner.hoverOff){var a;if(this._menuOwner.getAttribute("email"))a=InboxPage.Config.contextMenu.sndOffDelay;else a=InboxPage.Config.contextMenu.msgOffDelay;var b=this._menuOwner;this._createHoverOffTimer(b,$CC($CD(this,this._hideMenu)),a)}};__p._createHoverOnTimer=function MessageList$_createHoverOnTimer(c,a,b){this._createHoverTimer(c,a,b,"hoverOn")};__p._createHoverOffTimer=function MessageList$_createHoverOffTimer(c,a,b){this._createHoverTimer(c,a,b,"hoverOff")};__p._createHoverTimer=function MessageList$_createHoverTimer(b,d,e,a){if(b[a])return;var f=setTimeout($CD(this,function(){this._contextMenuTimers.remove(b[a]);b[a]=null;d()}),e),c={owner:b,timer:f,type:a};b[a]=c;this._contextMenuTimers.push(c)};__p._cancelHoverOnTimer=function MessageList$_cancelHoverOffTimer(a){this._cancelHoverTimer(a,"hoverOn")};__p._cancelHoverOffTimer=function MessageList$_cancelHoverOffTimer(a){this._cancelHoverTimer(a,"hoverOff")};__p._cancelHoverTimer=function MessageList$_cancelHoverOffTimer(b,a){if(b[a]){clearTimeout(b[a].timer);this._contextMenuTimers.remove(b[a]);b[a]=null}};__p._handleMouseOverList=function MessageList$_handleMouseOverList(){var b=event.srcElement,f=b.getAttribute("email"),e=b.getAttribute("nc"),d=this.getSelectedItem(b);if(!d)return;if(this._menuOwner&&this._menuOwner==d)this._cancelHoverOffTimer(d);if(f&&!e){var a=b;if(a.hoverOff&&this._menuOwner==a)this._cancelHoverOffTimer(a);if(!a.hoverOn&&(!this._menuOwner||this._menuOwner!=a)&&!Page.hasNetworkOpenRequests()){var c={};c.pos=this._getMenuEventPosition(event);a.mouseMoveHandler=function(){c.pos=InboxPage.messageList._getMenuEventPosition(event)};a.attachEvent("onmousemove",a.mouseMoveHandler);this._trackedSenders.push(a);this._createHoverOnTimer(a,$CC($CD(this,this._showSenderMenu),[a,c,true]),InboxPage.Config.contextMenu.sndOnDelay)}}};__p._handleMouseOutList=function MessageList$_handleMouseOutList(){var c=event.srcElement,d=c.getAttribute("email"),b=this.getSelectedItem(c);if(!b)return;if(this._menuOwner&&this._menuOwner==b)if(!b.hoverOff)this._createHoverOffTimer(b,$CC($CD(this,this._hideMenu)),InboxPage.Config.contextMenu.msgOffDelay);if(d){var a=c;if(a.hoverOn){a.detachEvent("onmousemove",a.mouseMoveHandler);a.mouseMoveHandler=null;this._trackedSenders.remove(a);this._cancelHoverOnTimer(a)}if(this._menuOwner&&this._menuOwner==a&&!a.hoverOff)this._createHoverOffTimer(a,$CC($CD(this,this._hideMenu)),InboxPage.Config.contextMenu.sndOffDelay)}};__p._handleContextMenuInList=function MessageList$_handleContextMenuInList(){var b=event.srcElement,a=this.getSelectedItem(b);if(!a)return;this._showMessageMenu(event);event.returnValue=false;event.cancelBubble=true};__p._handleContextMenuInMenu=function MessageList$_handleContextMenuInMenu(){event.returnValue=false;event.cancelBubble=true};__p._showSenderMenu=function MessageList$_showSenderMenu(a,f,e){var d=this.getSelectedItem(a);if(!d)return;var b=f.pos;if(a.mouseMoveHandler){a.detachEvent("onmousemove",a.mouseMoveHandler);a.mouseMoveHandler=null;this._trackedSenders.remove(a)}if(b){if(e){var c=InboxPage.Config.contextMenu.sndOffsetX;if(document.documentElement.dir=="rtl")b.x-=c;else b.x+=c;b.y+=InboxPage.Config.contextMenu.sndOffsetY}this._menuOwner=a;this._showMenu(b,{msgElt:d,senderElt:a})}};__p._showMessageMenu=function MessageList$_showMessageMenu(c){var a=this.getSelectedItem(c.srcElement);if(!a)return;var b=$tag(a,"INPUT")[0],d=b.checked;if(!d){this.selectByElem(a,true,-1,true);b.checked=true;this.updateSelectedCount()}this._menuOwner=a;var e=this._getMenuEventPosition(c);this._showMenu(e,null)};__p._getMenuEventPosition=function MessageList$_getMenuEventPosition(a){return {x:a.clientX,y:a.clientY+document.getElementsByTagName("HTML")[0].scrollTop}};__p._showMenu=function MessageList$_showMenu(w,d){var a="visible",p=MessageList.unreadClass,t=InboxPage.folderList.fid==InboxPage.Config.sysFldrs.junkFid,f=null,b=false,i=false,j=false,k=false,c=false,h=false;this._cancelMenuEvents();if(d){b=false;this._senderData=d;f=d.senderElt;var e=d.msgElt;i=!$css.has(e,p)&&!e.getAttribute("vm");j=$css.has(e,p)&&!e.getAttribute("vm");if(e.getAttribute("conv"))k=true}else{b=true;this._senderData=null;var n=this.getSelectedMessageData();h=n.isBulk;if(h){i=true;j=true;c=true}else{if(this.isOneItemSelected()){var e=$(n.mids[0]),u=MessageList.getMessageSenders(e);if(u.length>0){f=u[0];if(e.getAttribute("conv"))k=true}}else c=true;n.mids.forEach(function(b){var a=$(b);if(a.getAttribute("vm"))return;if($css.has(a,p))j=true;else i=true})}}var v=this._headingDiv;if(v){$setDisplay(v,d);if(f){var y=f.innerText,x=f.getAttribute("email");this._menuSenderNames.forEach(function(a){a.innerText=y});this._menuSenderEmails.forEach(function(a){a.innerText=x})}}var l=this._senderDiv,r=false;if(l){$css[d?"remove":"add"](l,"DisableMenuItems");$setDisplay($getDescendantByClass(this._senderDiv,"DIV","MenuItemGroupTitle"),d?false:true);var g=InboxPage.Config.sysFldrs.sentFid==InboxPage.folderList.fid||InboxPage.Config.sysFldrs.draftsFid==InboxPage.folderList.fid||!f&&!c;this._menu.setButtonProperty("sendEmailToSender",a,!c&&!g);this._menu.setButtonProperty("viewAllFromSender",a,!c&&!g);var q=!FolderQuickViewListHelper.isJunkOrDeletedFolder(InboxPage.folderList.fid);if(InboxPage.Config.isEnhancedRulesEnabled){this._menu.setButtonProperty("deleteAllFromSender",a,!h&&q&&!g);this._menu.setButtonProperty("moveAllFromSender",a,!h&&q&&!g)}r=!g&&(!c||InboxPage.Config.isEnhancedRulesEnabled&&!h&&q);$setDisplay(l,r);var o=c?this._content.forTheseSenders:this._content.forThisSender;o=Page.decode(o);this._menuSenderTitleSpans.forEach(function(a){a.innerText=o})}var s=this._messageDiv;if(s){$setDisplay(s,!d);this._menu.setButtonProperty("markAsRead",a,b&&j);this._menu.setButtonProperty("markAsUnread",a,b&&i);this._menu.setButtonProperty("moveToPopup",a,b);if(this._menu.containsButtonKey("markAsJunk"))this._menu.setButtonProperty("markAsJunk",a,b&&!t);this._menu.setButtonProperty("markAsNotJunk",a,b&&t);this._menu.setButtonProperty("deleteMsg",a,b);this._menu.setButtonProperty("viewSource",a,b);var m=c?this._content.forTheseMessages:k?this._content.forThisConversation:this._content.forThisMessage;m=Page.decode(m);this._menuMessageTitleSpans.forEach(function(a){a.innerText=m})}this._menuPos=w;this._menu.show(w);this._menu.focus();this._isMenuOpen=true};__p._prepareContextMenuForUiUpdate=function MessageList$_prepareContextMenuForUiUpdate(){this._hideMenu();this._cancelMenuEvents();this._disposeMoveHandlers()};__p._hideMenu=function MessageList$_hideMenu(){if(this._menu)this._menu.hide()};__p._cancelMenuEvents=function MessageList$_cancelMenuEvents(){if(this._contextMenuTimers){this._contextMenuTimers.forEach(function(a){clearTimeout(a.timer);a.owner[a.type]=null});this._contextMenuTimers=[]}};__p._disposeMoveHandlers=function MessageList$_disposeMoveHandlers(){if(this._trackedSenders){this._trackedSenders.forEach(function(a){if(a.mouseMoveHandler){a.detachEvent("onmousemove",a.mouseMoveHandler);a.mouseMoveHandler=null}});this._trackedSenders=[]}};__p._handleMenuItem=function MessageList$_handleMenuItem(b){var a=b[1];Control.invokeStatic("InboxActions",a.key,event,{isKbd:false,senderData:this._senderData,entryPoint:this._senderData?"Hover":"RClick"})};__p._handleMenuHidden=function MessageList$_handleMenuHidden(){this._isMenuOpen=false;this._senderData=null;this._menuOwner=null};__p._handleContextMenuClick=function MessageList$_handleContextMenuClick(){Control.invoke("Menu","_buttonOnClick",event,Control.lookup(event.srcElement,"key"));event.returnValue=false;event.cancelBubble=true};__p._expandSenderItems=function MessageList$_expandSenderItems(){var c=this._senderDiv;if(c)if($css.has(c,"DisableMenuItems"))$css.remove(c,"DisableMenuItems");this._menu.reposition(this._menuPos);event.returnValue=false;event.cancelBubble=true;var f=$getDescendantsByAttr(this._senderDiv,"LI","key"),e=f.length;if(e>0){var b=null;for(var d=0;d<e;d++){var g=f[d],h=g.getAttribute("key");if(this._menu.getButtonProperty(h,"visible")){b=g;break}}var a=b&&b.firstChild;if(a&&a.tagName=="A")$callFocus(a)}};__p=MessageList.prototype;__p.canSimulateMove=function MessageList$canSimulateMove(a,f){if(f||this.getMessageCount()>0&&this.hasConversation(a))return false;var c=this._additionalMessageCount;if(c==0&&this._messageListItems.length-a.length<=0)return false;var b=this._messageListItemsAll,e=b[b.length-1].getAttribute("eof")!=null,d=a.length<=c||e;return d};__p.simulateMove=function MessageList$simulateMove(e,u,r,s,j){var q=MessageList.doMessagesStayInView(r,s);if(q)return;e=e.clone();var c=e.length,d=[],p={};for(var b=c-1;b>=0;b--){var i=e[b],a=$(i);if(!a||!$getDisplay(a)||a.getAttribute("del")){e.splice(b,1);c--}else{d.push(a);p[i]=true}}if(c==0)return;d.forEach(function(a){$setDisplay(a,false);a.setAttribute("del","del")});var n=c;for(var b=this._messageListItems.length-1;b>=0,n>0;b--){var a=this._messageListItems[b];if(p[a.id]){this._messageListItems.splice(b,1);n--}}d=this._messageListItemsAll;var k=d.length,f=k-1;for(;f>=0;f--){var a=d[f];if($getDisplay(a))break}var l=this.getMessageCount(),h;if(InboxPage.quickViewList.qvid==InboxPage.Config.quickViews.flaggedQvid){var t=this,h=0;e.forEach(function(a){if(t.isFlagged(a))h++})}else h=c;if(l>=0){l-=h;this._setMessageCount(l)}if(this.iCt>=0)this.iCt-=h;while(++f<k&&c>0){var a=d[f];if(!$getDisplay(a)&&!a.getAttribute("del")){$clearDisplay(a);c--;this._additionalMessageCount--;this._messageListItems.push(a);if(a.getAttribute("eof"))$css.add($("mlPageNav"),"EndOfList")}}var g=$("mlPageNav");if(g&&$css.has(g,"BeginOfList")&&$css.has(g,"EndOfList")){this.setIsMoreThanOnePage(false);if(this._messageListItems.length==0)$setDisplay(g,false)}this.setCheckAllCheckBox(false);this.clearSelectionState();if(j){var i=j.MessageId||j.ConversationId;this.selectByMid(i,true,true);var o=null;for(var m=0;m<k;m++){var a=d[m];if($getDisplay(a)){o=a;break}}this._ensureVisible(o);this._ensureVisible($(i))}};InboxPage.initializeBucket1=function InboxPage$initializeBucket1(){var a=Page.getLayout()=="BottomUnmanaged";if(!a){InboxPage.initSplitter();InboxPage.initAdScroll()}InboxPage.initDragDrop();InboxPage.initContextMenu();InboxPage.initAdvancedSearch();InboxPage.initSmc();if(InboxPage.bucket2Script)window.setTimeout(function(){InboxPage.downloadBucket2()},20);else if(InboxPage.bucket3Script)window.setTimeout(function(){InboxPage.downloadBucket3()},20);else if(InboxPage.bucket4Script)window.setTimeout(function(){InboxPage.downloadBucket4()},20);else Page.pageComplete()};InboxPage.initSmc=function InboxPage$initSmc(){if(InboxPage.hasSmc){LoadingIndicator.hide();ToastManager.getInstance().showToast(InboxPage.Strings.smcMsg,InboxPage.Config.smcTimeout)}};InboxPage.downloadBucket2=function InboxPage$downloadBucket2(){Loader.load(InboxPage.bucket2Css,InboxPage.bucket2Script,InboxPage.onBucket2Download,$("bucket2"))};InboxPage.onBucket2Download=function InboxPage$onBucket2Download(){InboxPage.initializeBucket2()};InboxPage.downloadBucket3=function InboxPage$downloadBucket3(){Loader.load(InboxPage.bucket3Css,InboxPage.bucket3Script,InboxPage.onBucket3Download,$("bucket3"))};InboxPage.onBucket3Download=function InboxPage$onBucket3Download(){InboxPage.initializeBucket3()};InboxPage.downloadBucket4=function InboxPage$downloadBucket4(){Loader.load(InboxPage.bucket4Css,InboxPage.bucket4Script,InboxPage.onBucket4Download,$("bucket4"))};InboxPage.onBucket4Download=function InboxPage$onBucket4Download(){InboxPage.initializeBucket4()};InboxPage.initContextMenu=function InboxPage$initContextMenu(){if(!$B.IE_M6){var a=InboxPage.messageList;a.initContextMenu()}};InboxPage.initAdvancedSearch=function InboxPage$initAdvancedSearch(){if(!InboxPage.advancedSearch)InboxPage.advancedSearch=new AdvancedSearch};InboxPage.initSplitter=function InboxPage$initSplitter(){if(!InboxPage.masterSplitter){var b=new Splitter($("masterSplitter"),$("contentLeft"),$("contentRight"),"horizontal",Loc.LEFT);b.Events.onresizecomplete.attach(InboxPage._onMasterSplitterComplete);b.leftMin=45;b.rightMin=525;InboxPage.masterSplitter=b}if(!InboxPage.splitter&&InboxPage.isReadingPaneOn&&!InboxPage.readingPane.isFullView){var c=InboxPage.Config.readingPane.location=="Bottom"?"v":"h",d=c=="v"?"top":Loc.LEFT,a=new Splitter($("readingPaneSplitter"),$("messageListSplitPane"),$("readingPaneSplitPane"),c=="v"?"vertical":"horizontal",d);a.userdata=c;a.Events.onresizecomplete.attach(InboxPage._onSplitterComplete);if("h"==c){a.leftMin=200;a.rightMin=300}else{a.leftMin=125;a.rightMin=100}InboxPage.splitter=a}};InboxPage._onMasterSplitterComplete=function InboxPage$_onMasterSplitterComplete(){var b=parseFloat($("contentLeft").style["width"])||0,a=$Cookie.getCookieValues(App.config.pdCookie);if(a["flmlSize"]!=b){a["flmlSize"]=b;$Cookie.setCookieValues(App.config.pdCookie,a,$Cookie.getPermanentExpirationDate())}Resize._mainContentResize()};InboxPage._onSplitterComplete=function InboxPage$_onSplitterComplete(d){var f=d[0],g=d[1],b=f.userdata,e=b=="v"?"height":"width",c=parseFloat($("messageListSplitPane").style[e])||0,a=$Cookie.getCookieValues(App.config.pdCookie);if(a["mlrpDir"]!=b||a["mlrpSize"]!=c){a["mlrpDir"]=b;a["mlrpSize"]=c;$Cookie.setCookieValues(App.config.pdCookie,a,$Cookie.getPermanentExpirationDate())}InboxPage.resetReadingPaneContentHeight();Resize._mainContentResize()};InboxPage._folderListOnDragOver=function FL$_folderListOnDragOver(f){var g=f[0],d=f[1],a=d.data,e=FolderQuickViewListHelper.resolveToFolderElt(d.overElement),c=e.folderElt,b=e.targetElt;InboxPage._positionDnDVisual(a);if(!b||!a.validStart){if(a.targetElt)InboxPage._applyStyle(a.targetElt,false);a.targetElt=null;return}if(b==a.targetElt)return;if(a.targetElt)InboxPage._applyStyle(a.targetElt,false);if(c.id==a.currFid){a.targetElt=null;return}a.targetElt=b;a.toFid=c.id;InboxPage._applyStyle(b,true)};InboxPage._applyStyle=function InboxPage$_applyStyle(c,d){var b=$(d?"THEME_FL_HOVER":"THEME_FL_IDLE"),a=$getDescendantByClass(c,"A","lnav_itemLnk")||$getDescendantByClass(c,"DIV","lnav_topItem");if(a){a.style.borderColor=Browser.isIE&&b.currentStyle.borderWidth=="medium"?"":b.currentStyle.borderColor;a.style.backgroundColor=b.currentStyle.backgroundColor}};InboxPage._positionDnDVisual=function InboxPage$_positionDnDVisual(a){if(a.validStart){var b=Browser.isSF?document.body.scrollTop:document.getElementsByTagName("HTML")[0].scrollTop;a.style.top=event.clientY+b-5+"px";a.style.left=event.clientX+(Loc.isBidi?-5:5)-a.xoffset+"px"}};InboxPage._folderListOnDragOut=function InboxPage$_folderListOnDragOut(c){var e=c[0],d=c[1],a=d.data,b=a.targetElt;InboxPage._positionDnDVisual(a);if(b)InboxPage._applyStyle(b,false);a.targetElt=null};InboxPage._folderListOnDragDrop=function InboxPage$_folderListOnDragDrop(d){var e=d[0],c=d[1],b=c.data,a=b.targetElt;if(!a||!b.validStart)return;a.style.backgroundColor="transparent";InboxPage._applyStyle(a,false);Control.invokeStatic("InboxPage","_doDnDMove",event,b);c.success=true};InboxPage._doDnDMove=function InboxPage$_doDnDMove(a){Page.setPerformanceId("DD");Messages.move(a.messageData,a.currFid,a.toFid,null,null,null,null,true,false)};InboxPage._msgListOnTestDrag=function InboxPage$_msgListOnTestDrag(a){if(Browser.isFF2&&a.overElement.tagName!="A"&&a.overElement.tagName!="IMG"&&a.overElement.tagName!="INPUT")return false;if(!$("messageListSplitPane").contains(a.overElement))return false;var b=InboxPage.messageList.getSelectedItem(a.overElement);if(!b)return false;return true};InboxPage._msgListOnDragStart=function InboxPage$_msgListOnDragStart(g){var i=g[0],a=g[1];a.data={validStart:false};if(!InboxPage._msgListOnTestDrag(a))return;InboxPage.messageList.cleanUpContextMenu();var h=InboxPage.messageList.getSelectedItem(a.overElement),b=InboxPage.getSelectedMessageData(),f=h.id;if(!(b.isBulk||b.mids.exists(f))){InboxPage.messageList.selectByMid(f,true,true);b=InboxPage.messageList.getSelectedMessageData()}a.data={validStart:true,messageData:b,currFid:InboxPage.folderList.fid,targetElt:null};a.data.dragHTML=InboxPage._createDnDHTML(b.isBulk?-1:b.mids.length);a.data.xoffset=Loc.isBidi?a.data.dragHTML.offsetWidth:0;a.data.style=a.data.dragHTML.style;if(b.isBulk){var d=InboxPage.messageList.getMessageListItems();for(var c=d.length-1;c>=0;c--)InboxPage._applyAlpha(d[c],30)}else{var e=b.mids;for(var c=e.length-1;c>=0;c--)InboxPage._applyAlpha($(e[c]),30)}InboxPage._positionDnDVisual(a.data)};InboxPage._applyAlpha=function InboxPage$applyAlpha(d,a){if(Browser.isIE){var c=d.children;for(var b=c.length-1;b>=0;b--)c[b].style.filter=a==0?"":String.format("progid:DXImageTransform.Microsoft.Alpha(opacity={0})",a)}else d.style.opacity=a==0?"":"."+a};InboxPage._msgListNoTarget=function InboxPage$_msgListNoTarget(a){var c=a[0],b=a[1];InboxPage._positionDnDVisual(b.data)};InboxPage._createDnDHTML=function InboxPage$_createDnDHTML(b){var a=document.createElement("DIV");document.body.appendChild(a);var c;if(-1==b)c=Page.decode(InboxPage.Strings.dragAll);else{var e=Page.decode(1==b?InboxPage.Strings.dragSingle:InboxPage.Strings.dragMany);c=String.format(e,b)}var d=Browser.isIE&&Loc.isBidi?'style="width: 10em;"':"",f=[String.format('<div class="DragNDrop"><div class="Content" {0}>',d),c,'</div><div class="Shadow"></div></div>'];a.innerHTML=f.join("");if(Browser.isIE6||Browser.isIE&&Loc.isBidi)setTimeout(function(){var b=a.firstChild.firstChild,d=$tag(a.firstChild,"DIV"),c=d[d.length-1];c.style.height=Resize.convertToEm(b.offsetHeight)+"em";c.style.width=Resize.convertToEm(b.offsetWidth)+"em"},50);return a.firstChild};InboxPage._cleanUpDnDHTML=function InboxPage$_cleanUpDnDHTML(a){document.body.removeChild(a.parentNode)};InboxPage._msgListOnDragEnd=function InboxPage$_msgListOnDragEnd(e){var f=e[0],a=e[1];if(!a.data.validStart)return;InboxPage._cleanUpDnDHTML(a.data.dragHTML);a.data.style=null;if(a.data.messageData.isBulk){var c=InboxPage.messageList.getMessageListItems();for(var b=c.length-1;b>=0;b--)InboxPage._cleanupDragDropItem(c[b],a.success)}else{var d=a.data.messageData.mids;for(var b=d.length-1;b>=0;b--)InboxPage._cleanupDragDropItem($(d[b]),a.success)}};InboxPage._cleanupDragDropItem=function InboxPage$_cleanupDrapDropItem(c,b){if(!b){InboxPage._applyAlpha(c,0);var a=InboxPage.messageList;if(!InboxPage.isReadingPaneOn&&a.getCheckedCount()==0)a.clearSelection()}};InboxPage.initDragDrop=function InboxPage$initDragDrop(){DragNDrop.RegisterDropTarget($("folderListContainer"),InboxPage._folderListOnDragOver,InboxPage._folderListOnDragOut,InboxPage._folderListOnDragDrop);InboxPage.dnd=new DragNDrop($("messageListSplitPane"),InboxPage._msgListOnDragStart,InboxPage._msgListOnDragEnd,InboxPage._msgListNoTarget,InboxPage._msgListOnTestDrag)};InboxPage.disposeDragDrop=function InboxPage$disposeDragDrop(){InboxPage.dnd.dispose();DragNDrop.UnRegisterDropTarget($("folderListContainer"))};InboxPage.onSubmitReadingPaneOptionClicked=function InboxPage$onSubmitReadingPaneOptionClicked(a){$("ReadingPane").value=a;Page.submit("readingpane")};InboxPage.onSubmitSortConversationView=function InboxPage$onSubmitSortConversationView(a,b){InboxPage.onSubmitChangeConversationView(a,b,null,false)};InboxPage.onSubmitUpsellConversationView=function InboxPage$onSubmitUpsellConversationView(a){InboxPage.onSubmitChangeConversationView(true,"Date",a,true)};InboxPage.onSubmitChangeConversationView=function InboxPage$onSubmitChangeConversationView(e,a,c,f){var g=$("ConversationEnabled");g.value=e?"True":"False";if(!a)a=InboxPage.messageList.sBy;var b=String.format("{0}?n={1}&FolderID={2}{3}{4}&InboxSortBy={5}&InboxSortAscending={6}{7}&fav={8}",Page.SELF_PATH,Page.queryString.newNonce,InboxPage.folderList.fid,InboxPage.quickViewList.qvid?String.format("&QuickViewCategoryId={0}",InboxPage.quickViewList.qvid):"",InboxPage.messageList.fltid?String.format("&FilterCategoryId={0}",InboxPage.messageList.fltid):"",a,HM.SortBy[a]!=HM.SortBy.Date,c?String.format("&ReadMessageID={0}",c):"",InboxPage.folderList.isFavoriteSelected+"");if(f){$("ReturnUrl").value=b;var d=String.format("/mail/ConversationSetup.aspx?n={0}",Page.queryString.newNonce);Page.submit(null,d)}else Page.submit("convthreading",b)};InboxPage.MENU_BOTTOM_LEFT=0;InboxPage.MENU_TOP_LEFT=2;InboxPage.makeMenuScroll=function InboxPage$makeMenuScroll(k,o){var a=$(k+"_dropdown"),g=$getLocation(a),b=$(k+"_shadow");if(!b){var j=a.parentNode.children;for(var f=j.length-1;f>=0;f--)if($css.has(j[f],"c_shad")){b=j[f];b.id=k+"_shadow";break}}var h=false,i=document.body.clientHeight;if(InboxPage.MENU_BOTTOM_LEFT==o){if(g.top+a.scrollHeight>i){var c=i-g.top-4+"px";a.style.height=c;a.style.overflowY="scroll";b.style.height=c;h=true}}else if(InboxPage.MENU_TOP_LEFT==o){var p=$getLocation(a.parentNode),l=Math.min(i,p.top);if(a.scrollHeight+a.parentNode.scrollHeight>l){var c=l-a.parentNode.scrollHeight-4,d=0;for(var e=a.parentNode;e&&d==0;e=e.offsetParent)d=e.offsetTop;d-=c;a.style.overflowY="scroll";a.style.top=d+"px";a.style.height=c+"px";b.style.top=d+"px";b.style.height=c+"px";h=true}}if(h){var n=document.body.clientWidth,m=g.left;a.style.width=(m+a.scrollWidth>n?n-m-4:a.scrollWidth)+"px";b.style.width=a.style.width}else if(Browser.isIE){a.style.height="";a.style.width="";a.style.overflowY=""}};InboxPage.initAdScroll=function InboxPage$initAdScroll(){InboxPage._skyscraperContainer=$("SkyscraperContent");InboxPage._prevScroll=0;InboxPage._skyscraperHeight=624;InboxPage.resetSkyscraperScroll(true)};InboxPage.onMessageScroll=function InboxPage$onMessageScroll(a){InboxPage._scrollAdSync(a)};InboxPage.onMessageListScroll=function InboxPage$onMessageListScroll(a){if(!InboxPage.isReadingPaneOn)InboxPage._scrollAdSync(a)};InboxPage._scrollAdSync=function InboxPage$_scrollAdSync(a){if(InboxPage._skyscraperOverflow>0)InboxPage._skyscraperContainer.scrollTop+=a.scrollTop-InboxPage._prevScroll;InboxPage._prevScroll=a.scrollTop};InboxPage._getSkyscraperOverflow=function InboxPage$_getSkyscraperOverflow(){var a=InboxPage._skyscraperContainer;if(a!=null)return InboxPage._skyscraperHeight-a.offsetHeight;else return 0};InboxPage.resetSkyscraperScroll=function InboxPage$resetSkyscraperScroll(a){try{if(InboxPage._skyscraperContainer!=null){InboxPage._skyscraperContainer.scrollTop=0;InboxPage._skyscraperOverflow=InboxPage._getSkyscraperOverflow();if(a==true){InboxPage.resetReadingPaneContentHeight();if(!InboxPage.isReadingPaneOn)InboxPage.resetContentHeight($("messageListContentContainer"))}}}catch(b){}};InboxPage.resetReadingPaneContentHeight=function InboxPage$resetReadingPaneContentHeight(){var a=this.isReadingPaneOn&&this.readingPane.mode==ReadingPane.NOT_MESSAGE_MODE?"SelMsgPaneInner":"readingPaneContentContainer";InboxPage.resetContentHeight($(a))};InboxPage.resetContentHeight=function InboxPage$resetContentHeight(a){try{var b=InboxPage._skyscraperOverflow;if(b>0&&InboxPage._skyscraperHeight>a.offsetHeight){var c=a.parentNode.offsetHeight+b;if(Browser.isIE6)c=InboxPage._skyscraperHeight;a.style.height=c+"px"}}catch(d){}};if(!Browser.isIE)InboxPage.downloadBucket2=function InboxPage$downloadBucket2(){Loader.load(InboxPage.bucket2Css,InboxPage.bucket2Script,InboxPage.onBucket2Download)}