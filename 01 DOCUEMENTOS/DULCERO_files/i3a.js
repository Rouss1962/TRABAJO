AutoRefresh.initialize=function AutoRefresh$initialize(){AutoRefresh._emailReceivedHandler=$CD(this,AutoRefresh._emailReceived);AutoRefresh._webIMReady=false;$Do.when("wlxim",0,AutoRefresh._tryInitialize)};AutoRefresh.dispose=function AutoRefresh$dispose(){$WLXIM.removeStateListener(AutoRefresh._imStateChanged);window.detachEvent("onunload",AutoRefresh.dispose);if(AutoRefresh._webIMReady){$NewMail.dispose();$WLXIM.user.get_mailbox().remove_emailReceived(AutoRefresh._emailReceivedHandler)}};AutoRefresh._tryInitialize=function AutoRefresh$_tryInitialize(){$WLXIM.addStateListener(AutoRefresh._imStateChanged);AutoRefresh._imStateChanged();window.attachEvent("onunload",AutoRefresh.dispose)};AutoRefresh._imStateChanged=function AutoRefresh$_imStateChanged(){if($WLXIM.hasNotify()&&!AutoRefresh._webIMReady){$NewMail.init();$WLXIM.user.get_mailbox().add_emailReceived(AutoRefresh._emailReceivedHandler);AutoRefresh._webIMReady=true}};AutoRefresh._emailReceived=function AutoRefresh$_emailReceived(){if(!AutoRefresh.config.isDown&&AutoRefresh._refreshCallback){AutoRefresh._refreshCallback.call(null);$NewMail.newMail()}};AutoRefresh._refreshInbox=function AutoRefresh$_refreshInbox(){Refresher.refreshInbox(AutoRefresh._endRefreshInbox)};AutoRefresh._endRefreshInbox=function AutoRefresh$_endRefreshInbox(d,b,c,a){Refresher.endRefreshInbox(d,b,c,a);AutoRefresh.config.isDown=a};AutoRefresh._refreshCallback=AutoRefresh._refreshInbox;(function(){var g=window,b=top.document,f=g.$NewMail={},h=Res.strings.titleTmpl,c=Res.strings.titleDefault,a,d,l;f.init=function k(){d=g.$OverlayIcon;e();$Do.register("$NM.clear",e)};f.dispose=function i(){e()};f.newMail=function j(){a++;try{var e=a==0?c:String.format(h,a);if(b.title!=e)b.title=e;d.set([App.config.imgSvrUrl,"newmail",a>9?"x":a,".ico"].join(""),e)}catch(f){}};function e(){a=0;try{if(b.title!=c)b.title=c;d.clear()}catch(e){}}})();(function(){var c=window,a=c.external,b=c.$OverlayIcon={};b.clear=function d(){try{if(a.msIsSiteMode())a.msSiteModeClearIconOverlay()}catch(b){}};b.set=function e(c,b){try{if(a.msIsSiteMode())a.msSiteModeSetIconOverlay(c,b)}catch(d){}}})();InboxPage.initializeBucket3=function InboxPage$initializeBucket3(){AutoRefresh.initialize();if(InboxPage.bucket4Script)window.setTimeout(function(){InboxPage.downloadBucket4()},20);else Page.pageComplete()};InboxPage.downloadBucket4=function InboxPage$downloadBucket4(){Loader.load(InboxPage.bucket4Css,InboxPage.bucket4Script,InboxPage.onBucket4Download,$("bucket4"))};InboxPage.onBucket4Download=function InboxPage$onBucket4Download(){InboxPage.initializeBucket4()};InboxPage.onSkyscraperClose=function(){try{var a=$("SkyscraperContent");if(!a)return;a.style.display="none";InboxPage._adjustMainContentForAds("expand")}catch(b){}};InboxPage.onAdsRefresh=function(){try{var a=$("SkyscraperContent");if(!a)return;if(a.style.display=="none"){a.style.display="block";InboxPage._adjustMainContentForAds("reset")}}catch(b){}};InboxPage._adjustMainContentForAds=function(f){var a=$("MainContent"),d=a.currentStyle,c;if(d["position"]=="absolute")c=Loc.isBidi?"left":"right";else c=Loc.isBidi?"marginLeft":"marginRight";if(f=="expand"){var b=parseInt(d[c]);b=isNaN(b)?0:b;if(b>0){a.setAttribute("origRightPos",b);a.style[c]=0}}else if(f=="reset"){var e=a.getAttribute("origRightPos");if(e){a.style[c]=e+"px";a.removeAttribute("origRightPos")}}};if(!Browser.isIE)InboxPage.downloadBucket4=function InboxPage$downloadBucket4(){Loader.load(InboxPage.bucket4Css,InboxPage.bucket4Script,InboxPage.onBucket4Download)}