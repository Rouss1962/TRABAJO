// Copyright (c) Microsoft Corporation. All rights reserved.
Microsoft.Live.Core.Loader.onResourceAvailable('messenger_services_core',null,function(){Type.registerNamespace('MSM');MSM.MriCompareOptions=function(){};MSM.MriCompareOptions.prototype={none:0,address:1,epId:2,addressAndEpId:3}
MSM.MriCompareOptions.registerEnum('MSM.MriCompareOptions',true);MSM.MimeParser=function(str){this.$0={};this.$1={};var $0;var $1=str.indexOf('\r\n\r\n');if($1===-1){$0=MSH.StringHelper.substringToEnd(str,0);this.$2=String.Empty;}else{$0=MSH.StringHelper.substring(str,0,$1);this.$2=MSH.StringHelper.substringToEnd(str,$1+4);}this.$3($0);}
MSM.MimeParser.prototype={$0:null,$1:null,$2:null,$3:function($p0){var $0=0;var $1=$p0.length;while($0<$1){var $2=$p0.indexOf('\r\n',$0);if($2===-1){$2=$1;}var $3=MSH.StringHelper.substringSection($p0,$0,$2);if($3.length>0){var $4=$3.indexOf(': ');if($4!==-1){var $5=$3.substring(0,$4);var $6=MSH.StringHelper.substringToEnd($3,$4+2);this.$0[$5]=$6;this.$1[MSH.StringHelper.toLowerCase($5)]=$6;}}$0=$2+2;}},getHeaders:function(){return this.$0;},getHeader:function(name){name=MSH.StringHelper.toLowerCase(name);return this.$1[name]||null;},getBody:function(){return this.$2;},$4:function(){return Object.getKeyCount(this.$1);},getIntHeader:function(header,defaultVal){var $0=defaultVal;var $1=this.getHeader(header);if(!String.isNullOrEmpty($1)){$0=MSH.ConvertHelper.parseInt($1);}return $0;}}
MSM.MimeBuilder=function(){this.$0=[];}
MSM.MimeBuilder.prototype={$0:null,$1:null,$2:false,get_disableContentLengthHeader:function(){return this.$2;},set_disableContentLengthHeader:function(value){this.$2=value;return value;},toString:function(){var $0=new ss.StringBuilder();var $enum1=ss.IEnumerator.getEnumerator(this.$0);while($enum1.moveNext()){var $2=$enum1.get_current();$0.appendLine(String.format('{0}: {1}',$2[0],$2[1]));}var $1=MSH.StringHelper.getByteCount(this.$1);if(!this.get_disableContentLengthHeader()){$0.appendLine(String.format('{0}: {1}','Content-Length',$1));}$0.appendLine(String.Empty);if($1!==0){$0.append(this.$1);}return $0.toString();},addHeaders:function(headers){var $dict1=headers;for(var $key2 in $dict1){var $0={key:$key2,value:$dict1[$key2]};this.setStringHeader($0.key,$0.value);}},setStringHeader:function(header,val){if(!String.isNullOrEmpty(val)){this.$0.add([header,val]);}},setIntHeader:function(header,val){if(val!==-1){this.$0.add([header,val.toString()]);}},setBody:function(body){this.$1=body;}}
MSM.HttpMsnpTransportLogContext=function(module,server,debugId){this.$0=module;this.$2=server;this.$3=debugId;this.$1=String.format('[Server:{0} Debug ID:{1}]',this.$2,this.$3);}
MSM.HttpMsnpTransportLogContext.prototype={$0:null,$1:null,$2:null,$3:0,get_module:function(){return this.$0;},get_server:function(){return this.get_server();},set_server:function(value){if(this.$2!==value){this.$1=String.format('[Server:{0} Debug ID:{1}]',this.$2,this.$3);}return value;},get_context:function(){return this.$1;},set_context:function(value){this.$1=value;return value;}}
MSM.Mri=function(v){this.$1=String.Empty;this.$2=String.Empty;this.$3=String.Empty;this.$4=String.Empty;this.$6=String.Empty;var $0=MSM.Mri.tryParse(v);if($0!=null){this.$1=$0.$1;this.$5=$0.$5;this.$3=$0.$3;this.$2=$0.$2;this.$4=$0.$4;this.$6=$0.$6;}}
MSM.Mri.getIMAddressInfo=function(mri){var $0=String.Empty;var $1=0;if(!String.isNullOrEmpty(mri.get_liveId())){$0=mri.get_liveId();$1=1;}if(String.isNullOrEmpty($0)){if(!String.isNullOrEmpty(mri.$3)){$0=mri.$3;$1=mri.$5;}}var $2=MC.$create_IMAddressInfo($0,$1,0);if(!String.isNullOrEmpty(mri.get_appId())){$2.applicationId=mri.get_appId();}if(!String.isNullOrEmpty(mri.$6)){$2.network=mri.$6;}return $2;}
MSM.Mri.parseIMAddressInfoFromMriString=function(mriStr){return MSM.Mri.getIMAddressInfo(new MSM.Mri(mriStr));}
MSM.Mri.create=function(address,addressType,epId,appId,networkId){var $0=new MSM.Mri('');$0.$3=address;$0.$5=addressType;if(!String.isNullOrEmpty(epId)){$0.$2=epId;}if(!String.isNullOrEmpty(appId)){$0.$1=appId;}if(!String.isNullOrEmpty(networkId)){$0.$6=networkId;}if(addressType===10){$0.$4='IM';}return $0;}
MSM.Mri.createFromIMAddressInfo=function(address){var $0=new MSM.Mri('');$0.$3=address.address;$0.$5=address.type;if(!String.isNullOrEmpty(address.applicationId)){$0.$1=address.applicationId;}if(!String.isNullOrEmpty(address.network)){$0.$6=address.network;}if(address.type===10){$0.$4='IM';}return $0;}
MSM.Mri.tryParse=function(v){if(!String.isNullOrEmpty(v)){var $0=new MSM.Mri('');var $1=MSH.StringHelper.splitString(v,';');if($1==null){}var $enum1=ss.IEnumerator.getEnumerator($1);while($enum1.moveNext()){var $2=$enum1.get_current();if($2.startsWith('appid=')){var $3=MSH.StringHelper.substringToEnd($2,'appid='.length);if($0.get_appId()!==String.Empty||String.isNullOrEmpty($3)){return null;}$0.$1=$3;}else if($2.startsWith('epid=')){var $4=MSH.StringHelper.substringToEnd($2,'epid='.length);if($0.$2!==String.Empty||String.isNullOrEmpty($4)){return null;}$0.$2=$4;}else if($2.startsWith('path=')){var $5=MSH.StringHelper.substringToEnd($2,'path='.length);if($0.$4!==String.Empty||String.isNullOrEmpty($5)){return null;}$0.$4=$5;}else if($2.startsWith('via=14:')){$0.$6=MSH.StringHelper.substringToEnd($2,'via=14:'.length);$0.$6=MSH.StringHelper.toUpperCase($0.$6);}else{var $6=MSH.StringHelper.splitString($2,':');if(!String.isNullOrEmpty($0.$3)||$6==null||$6.length!==2){return null;}$0.$5=MSH.ConvertHelper.parseInt($6[0]);$0.$3=$6[1];if($0.$5===14){$0.$3=MSH.StringHelper.toUpperCase($0.$3);}}}return $0;}return null;}
MSM.Mri.prototype={$5:0,get_cid:function(){return(this.$5===11)?this.$3:String.Empty;},get_appId:function(){return this.$1;},get_liveId:function(){return(this.$5===1)?this.$3:String.Empty;},get_networkId:function(){return this.$6;},get_endpointId:function(){return this.$2;},get_address:function(){return this.$3;},get_addressType:function(){return this.$5;},toString:function(){var $0=new ss.StringBuilder();if(!String.isNullOrEmpty(this.$3)){$0.append(String.format('{0}:{1}',this.$5,this.$3));}if(!String.isNullOrEmpty(this.$2)){$0.append(';epid=');$0.append(this.$2);}if(!String.isNullOrEmpty(this.$4)){$0.append(';path=');$0.append(this.$4);}if(this.$5===13){$0.append(';via=14:');$0.append(MSH.StringHelper.toLowerCase(this.$6));}return $0.toString();},equals:function(other,flags){if((flags&1)!==0){if(this.$5!==other.$5||this.$3!==other.$3){return false;}if(this.$5===13){if(String.compare(this.$6,other.$6,true)!==0){return false;}}}if((flags&2)!==0){if(this.$2!==other.$2){return false;}}return true;},toConversationId:function(){var $0;switch(this.$5){case 13:$0='13:'+this.$3+';via=14:'+this.$6;break;default:$0=this.$5+':'+(this.$3||'');if(!String.isNullOrEmpty(this.$4)){$0+=(';path='+this.$4);}break;}return MSH.StringHelper.toLowerCase($0);}}
MSM.Base64=function(){}
MSM.Base64.decode=function(input){if((input.length%4)!==0){throw new Error('invalid base64 length');}var $0=new ss.StringBuilder();var $1=0;var $2=false;while($1<input.length){var $3=0;var $4=0;for(var $5=0;$5<4;$5++){$3<<=6;var $6=MSH.StringHelper.charAt(input,$1++);if($6!=='='){if($2){throw new Error('premature padding found');}var $7=MSM.Base64.$0.indexOf($6);if($7<0){throw new Error('invalid bas64 data');}$3|=$7;$4+=6;}else{$2=true;}}$0.append(MSH.StringHelper.fromCharCode(($3>>16)&255));if($4>=16){$0.append(MSH.StringHelper.fromCharCode(($3>>8)&255));}if($4>=24){$0.append(MSH.StringHelper.fromCharCode($3&255));}}return $0.toString();}
MSM.Base64.encode=function(input){var $0=new ss.StringBuilder();var $1=MSM.Base64.$1(input);for(var $2=0;$2<$1.length;$2+=3){var $3=0;var $4,$5,$6;$4=$1[$2];$3++;if(($2+$3)<$1.length){$5=$1[$2+$3];$3++;if(($2+$3)<$1.length){$6=$1[$2+$3];$3++;}else{$6=0;}}else{$5=0;$6=0;}$0.append(MSM.Base64.$0.charAt($4>>2));$0.append(MSM.Base64.$0.charAt((($4&3)<<4)|($5>>4)));if($3>1){$0.append(MSM.Base64.$0.charAt((($5&15)<<2)|($6>>6)));}else{$0.append('=');}if($3>2){$0.append(MSM.Base64.$0.charAt($6&63));}else{$0.append('=');}}return $0.toString();}
MSM.Base64.$1=function($p0){var $0=[];for(var $1=0;$1<$p0.length;$1++){var $2=MSH.StringHelper.charCodeAt($p0,$1);if($2<=127){$0.add($2);}else if(($2>127)&&($2<=2047)){$0.add(($2>>6)|192);$0.add(($2&63)|128);}else if(($2>2047)&&($2<=65535)){$0.add(($2>>12)|224);$0.add((($2>>6)&63)|128);$0.add(($2&63)|128);}else if(($2>65535)&&($2<=1114111)){$0.add(($2>>18)|224);$0.add((($2>>12)&63)|128);$0.add((($2>>6)&63)|128);$0.add(($2&63)|128);}}return $0;}
MSM.S$0=function(){};MSM.S$0.prototype={$0:0,$1:1}
MSM.S$0.registerEnum('MSM.S$0',false);MSM.IMsnpCommand=function(){};MSM.IMsnpCommand.registerInterface('MSM.IMsnpCommand');MSM.IMsnpEvents=function(){};MSM.IMsnpEvents.registerInterface('MSM.IMsnpEvents');MSM.S$1=function(){};MSM.S$1.registerInterface('MSM.S$1');MSM.MsnpStatusCode=function(){};MSM.MsnpStatusCode.prototype={success:0,invalidParameter:201,invalidFederatedUser:203,unroutableUser:204,invalidUser:205,invalidUsername:208,invalidFriendlyName:209,contactListFull:210,alreadyThere:215,notAcceptingIMs:217,notAcceptingPages:220,invalidMsisdn:232,unknownMsisdn:233,unknownKeitaiDomain:234,invalidXmlData:241,unknownP2PApp:282,unknownUunApp:283,messageTooLong:285,smsJustOutOfFunds:290,addressBookError:403,smsSubscriptionRequired:413,smsSubscriptionDisabled:414,smsOutOfFunds:415,smsDisabledMarket:416,smsDisabledGlobal:417,tryAgainLater:418,noMarketSpecified:419,internalServerError:500,upsDown:504,federatedPartnerError:508,pageModeMessageError:509,detailedError:511,smsAccountMuted:550,smsAccountDisabled:551,smsAccountMaxed:552,smsInternalServerError:580,smsCarrierInvalid:590,smsCarrierNoRoute:591,smsCarrierErrored:592,smsAddressMappingFull:593,smsIncorrectSourceCountry:594,smsMobileCacheFull:595,smsIncorrectFormat:596,smsInvalidText:597,smsMessageTooLong:598,serverUnavailable:601,pagingUnavailable:606,sessionRestricted:711,sessionOverloaded:712,userTooActive:713,notExpected:715,userRestricted:718,sessionFederated:719,userFederated:726,roamingLogoff:733,tooManyEndpoints:734,rateLimitExceeded:800,authFailed:911,timedOut:921,childWithoutFullConsent:923,managedUserLimitedAccessWrongClient:926,managedUserAccessDenied:927,authError:928,domainReserved:931,invalidContactList:933,invalidSignature:935}
MSM.MsnpStatusCode.registerEnum('MSM.MsnpStatusCode',false);MSM.ContentDocumentType=function(){};MSM.ContentDocumentType.prototype={circleDocument:0,userDocument:1,networkDocument:2}
MSM.ContentDocumentType.registerEnum('MSM.ContentDocumentType',false);MSM.NotificationType=function(){};MSM.NotificationType.prototype={partialNotify:0,fullNotify:1}
MSM.NotificationType.registerEnum('MSM.NotificationType',false);MSM.S$4=function(events,debugId,server){this.$9={};this.$A=[];this.$C=new MSM.S$7();this.$12=MSM.S$4.$0;this.$11=60;this.$17=String.Empty;this.$1F=true;this.$7=events;this.$B=debugId;this.$14=MSH.StringHelper.toLowerCase(server);this.$18=ss.Delegate.create(this,this.$2B);this.$9['X-Requested-Session-Content-Type']='text/html';this.$9['Content-Type']='text/html; charset=utf-8';this.$9['Proxy-Connection']='Keep-Alive';this.$9['Pragma']='No-Cache';this.$9['X-MSN-Auth']='Use-Cookie';}
MSM.S$4.prototype={$7:null,$8:'NS',$B:0,$D:0,$E:0,$F:null,$10:null,$11:0,$12:0,$13:false,$14:null,$15:null,$16:null,$17:null,$18:null,$19:null,$1A:0,$1B:false,$1C:false,$1D:false,$1E:null,$1F:false,$20:0,$21:null,$22:false,add_sessionChanged:function($p0){this.$23=ss.Delegate.combine(this.$23,$p0);},remove_sessionChanged:function($p0){this.$23=ss.Delegate.remove(this.$23,$p0);},$23:null,get_$24:function(){return this.$11*1000+10000;},get_$25:function(){if(this.$1F){return 15;}else{return this.$12;}},$26:function($p0){if($p0){this.$12=Math.truncate((this.$12/1.5));if(this.$12<MSM.S$4.$0){this.$12=MSM.S$4.$0;}}else{this.$12=Math.truncate((this.$12*1.5));if(this.$12>MSM.S$4.$1){this.$12=MSM.S$4.$1;}}},$27:function($p0){if(!this.$1C){if(this.$10==null){this.$29($p0);}else if(this.$1A===MSH.Timeout.infinite||this.$1A>$p0){this.$1A=$p0;this.$10.change($p0,MSH.Timeout.infinite);}}},$28:function(){this.$2A();},$29:function($p0){this.$1A=$p0;this.$10=new MSH.Timer(this.$18,null,$p0,MSH.Timeout.infinite);},$2A:function(){if(this.$10!=null){this.$10.dispose();this.$10=null;}},$2B:function($p0){this.$28();if(this.$13||this.$1C||this.$1B){return;}this.$35();},$2C:function($p0){var $0=new ss.StringBuilder();$0.append(MSCo.HttpRequest.get_defaultScheme());$0.append(this.$14);$0.append('/gateway/gateway.dll');$0.append('?');if(this.$17.length===0){$0.append('Version=1&Action=open&Server=');$0.append(this.$8);$0.append('&IP=none');$0.append('&AutoIdleTimeout=30');}else{if($p0){$0.append('Action=poll&');if(this.$1F&&this.$22){$0.append('Lifespan=');$0.append(this.$11);$0.append('&');}}$0.append('SessionID=');$0.append(this.$17);}return $0.toString();},$2D:function($p0,$p1){var $0=$p1+'=';var $1=$p0.indexOf($0);if($1!==-1){$1+=$0.length;var $2=$p0.indexOf(';',$1);if($2!==-1){return MSH.StringHelper.substringSection($p0,$1,$2);}else{return MSH.StringHelper.substringToEnd($p0,$1);}}return null;},$2E:function($p0){this.$15=$p0.getResponseHeader('X-MSNSERVER');var $0=$p0.getResponseHeader('X-MSN-Messenger');var $1=this.$2D($0,'SessionID');var $2=this.$2D($0,'Session');var $3=$p0.getResponseHeader('X-MSN-Host');if(MSH.BrowserHelper.get_hasRestrictiveProxyConnectionLimit()){if(!String.isNullOrEmpty($p0.getResponseHeader('Via'))){this.$1F=false;}}if(!String.isNullOrEmpty($3)){$3=MSH.StringHelper.toLowerCase($3);if($3!==this.$14){this.$33('HttpMsnpTransport.ParseHeaders',String.format('Updating host from {0} to {1}',this.$14,$3));this.$14=$3;this.$37();}else{$3=null;}}else{$3=null;}if($1!=null){this.$17=$1;}this.$2F($1,$3);if($2==='close'){return 1;}return 0;},$2F:function($p0,$p1){if(this.$23!=null&&($p0!=null||$p1!=null)){this.$23.invoke($p0,$p1);}},$30:function($p0){var $0=200;var $1=null;var $2=null;var $3=[];var $4=false;if(this.$1C){return;}var $5=$p0.get_state();if($5<this.$E){return;}this.$26($p0.get_hasContent());this.$1E=null;this.$13=false;if($p0.get_status()===200){this.$20=0;var $6=this.$2E($p0);if($p0.get_hasContent()){try{if(this.$C.get_$1()){this.$C.$6($p0.get_responseText());}else{this.$C.$5($p0.get_responseData());}while(this.$C.$4()){$3.add(this.$C.get_$3());this.$1D=true;this.$33('HttpMsnpTransport.OnResponse',String.format('Message received: {0} {1}',this.$C.get_$3().get_name(),MSH.StringHelper.join(this.$C.get_$3().get_allParameters())));}}catch($7){this.$34('HttpMsnpTransport.OnResponse:ParsingContent','Failed to parse response data: '+$p0.toString(),$7);throw $7;}}if($6===1){this.$34('HttpMsnpTransport.OnResponse','Connection has been closed by server.',null);this.$1B=true;this.$2A();$0=0;$4=true;}}else{this.$34('HttpMsnpTransport.OnResponse',String.format('Http error detected: {0}',$p0.get_status()),null);this.$20++;if(this.$20<5&&this.$31($p0.get_status())){if(this.$21.length>0){this.$13=true;}new MSH.Timer(ss.Delegate.create(this,function(){this.$33('HttpMsnpTransport.OnResponse',String.format('Resending request #{0}',$5));if(this.$1C){return;}this.$36(this.$2C(this.$21.length===0),this.$21,$5);}),null,1000*this.$20,MSH.Timeout.infinite);return;}this.$1B=true;this.$2A();$0=$p0.get_status();}if(this.$1B){(this).dispose();}var $enum1=ss.IEnumerator.getEnumerator($3);while($enum1.moveNext()){var $8=$enum1.get_current();this.$7.onCommand($8);}if(this.$1B){this.$7.onDisconnect($0,$4);return;}this.$1D=false;if(this.$19!=null&&this.$A.length===0){$2=this.$19;$1=MC.$create_MessengerSessionInfo(this.$14,this.$17,this.$D,null);this.$19=null;(this).dispose();}else{this.$27(this.get_$25());}if($2!=null){$2.invoke($1);}},$31:function($p0){if($p0===408){return true;}var $0=Math.floor(($p0/100));if($0===5||$0===0){return true;}return false;},$32:function($p0,$p1){},$33:function($p0,$p1){if(this.$F!=null){this.$F.set_server(this.$14);}MSH.Logger.logInfo(this.get_logContext(),$p0,$p1);},$34:function($p0,$p1,$p2){if(this.$F!=null){this.$F.set_server(this.$14);}if($p2==null){MSH.Logger.logWarning(this.get_logContext(),$p0,$p1);}else{MSH.Logger.logException(1,this.get_logContext(),$p0,$p1,$p2);}},$35:function(){this.$28();var $0=new ss.StringBuilder();while(this.$A.length>0){var $3=this.$A.dequeue();$0.append($3.toString());this.$D=$3.get_trid();}var $1=$0.toString();var $2=($1.length===0);if(!$2){this.$13=true;this.$12=MSM.S$4.$0;this.$33('HttpMsnpTransport.SendBatch',String.format('Messenge sent: {0}',$1));}this.$36(this.$2C($2),$1,++this.$E);},$36:function($p0,$p1,$p2){this.$22=true;this.$21=$p1;var $0=new MSCo.HttpRequest(1,$p0,$p1,this.$9,ss.Delegate.create(this,this.$30));this.$1E=$0;$0.set_state($p2);$0.setTimeout(this.get_$24());$0.execute();},sendCommand:function($p0){if(this.$1B){return;}if(this.$1C){return;}this.$A.enqueue($p0);if(!this.$13&&!this.$1D){this.$27(1);}},resume:function($p0){this.$17=$p0;if(this.$1C){return;}if(this.$1E==null&&!this.$1D){this.$35();}},dispose:function(){var $0=null;if(this.$1C){return;}this.$1C=true;this.$2A();$0=this.$1E;if($0!=null){$0.abort();}},pauseSession:function($p0){var $0=false;if(this.$1C){return;}if(this.$1D||this.$A.length>0){this.$19=$p0;}else{$0=true;(this).dispose();}if($0){var $1=MC.$create_MessengerSessionInfo(this.$14,this.$17,this.$D,null);$p0.invoke($1);}},setRpsTicket:function($p0){this.$16=$p0;this.$37();},setConnectionTimeout:function($p0){if($p0>0){this.$11=$p0;}},$37:function(){},get_logContext:function(){if(this.$F==null){this.$F=new MSM.HttpMsnpTransportLogContext('HttpMsnpTransport',this.$14,this.$B);}return this.$F;},get_serverName:function(){return this.$15;}}
MSM.S$6=function(fragments,onResponse){this.$0=fragments;this.$1=onResponse;}
MSM.S$6.prototype={$0:null,$1:null,get_name:function(){return this.$0[0].toString();},toString:function(){var $0=new ss.StringBuilder();var $1=this.$0.length;for(var $2=0;$2<$1-1;$2++){$0.append(this.$0[$2].toString());$0.append(' ');}if(MSM.S$5.$8(this.$0[0])){var $3=this.$0[$1-1];$0.append(MSH.StringHelper.getByteCount($3).toString());$0.append('\r\n');$0.append($3);}else{$0.append(this.$0[$1-1].toString());$0.append('\r\n');}return $0.toString();},get_trid:function(){return this.$0[1];},onComplete:function($p0,$p1){if(this.$1!=null){this.$1.invoke($p0,$p1);}}}
MSM.MsnpConnection=function(server){this.$2=new MSM.S$3(30);this.$1=MSM.MsnpConnection.$7(this,server,ss.Delegate.create(this,this.onSessionChanged));}
MSM.MsnpConnection.$7=function($p0,$p1,$p2){var $0=new MSM.S$4($p0,MSM.MsnpConnection.$8(),$p1);if($p2!=null){$0.add_sessionChanged($p2);}return $0;}
MSM.MsnpConnection.$8=function(){return MSM.MsnpConnection.$0++;}
MSM.MsnpConnection.prototype={$1:null,$3:0,$4:false,$5:null,$6:null,get_serverName:function(){return this.$1.get_serverName();},get_identity:function(){return this.$5;},set_identity:function(value){this.$5=value;if(value.authenticationInfo!=null&&value.authenticationInfo.authType===1){this.$1.setRpsTicket(value.authenticationInfo.ticket);}return value;},get_logContext:function(){if(this.$6==null){this.$6=new MC.LogContext((this.$5==null)?null:this.$5.liveId);}return this.$6;},set_logContext:function(value){this.$6=value;return value;},setConnectionTimeout:function(timeout){this.$1.setConnectionTimeout(timeout);},resume:function(sessionCookie,trid){this.$1.resume(sessionCookie);this.$3=trid;},pauseSession:function(callback){this.$1.pauseSession(callback);},get_nextTrid:function(){this.$3++;this.onTridChanged(this.$3);return this.$3;},sendCommand:function(args,callback){if(this.$4){MSH.Logger.logInfo(this.get_logContext(),'MsnpConnection.SendCommand','Received command after being disposed; ignored.');return;}var $0=new MSM.S$6(args,callback);this.$2.$2($0.get_trid(),$0);this.onSendCommand($0);},onSendCommand:function(command){this.$1.sendCommand(command);},getPendingCommand:function(trid){return this.$2.$3(trid);},onCommand:function($p0){if(this.$4){MSH.Logger.logInfo(this.get_logContext(),'MsnpConnection.OnCommand','Received command after being disposed; ignored.');return;}this.$2.$4();this.onCommandReceived($p0);},onDisconnect:function($p0,$p1){if(this.$4){MSH.Logger.logInfo(this.get_logContext(),'MsnpConnection.OnDisconnect','Received disconnect after being disposed; ignored.');return;}this.onDisconnected($p0,$p1);this.$4=true;},dispose:function(){this.$4=true;this.$1.dispose();}}
MSM.S$5=function(){}
MSM.S$5.$7=function($p0){switch($p0){case'ADL':case'DEL':case'FSL':case'MSG':case'NFY':case'NOT':case'PUT':case'RML':case'SDG':return true;}if(MSH.RegexHelper.isMatch('^[0-9]{3}$',$p0,String.Empty)){return true;}else{return false;}}
MSM.S$5.$8=function($p0){switch($p0){case'ADL':case'DEL':case'MSG':case'NFY':case'PUT':case'QRY':case'RML':case'SDG':return true;default:return false;}}
MSM.S$5.prototype={$0:false,get_$1:function(){return this.$0;},get_$2:function(){return!this.$0;},$5:function($p0){throw new Error('Invalid operation!');},$6:function($p0){throw new Error('Invalid operation!');}}
MSM.S$7=function(){MSM.S$7.initializeBase(this);this.$0=true;this.$9=String.Empty;}
MSM.S$7.prototype={$9:null,$A:null,$6:function($p0){this.$9+=$p0;},$B:function(){this.$A=null;return false;},$C:function($p0,$p1){this.$A=new MSM.MsnpServerCommand($p0,$p1);return true;},$4:function(){while(this.$9.length>0){var $0=this.$9.indexOf('\r\n');if($0<=0){return this.$B();}var $1=this.$9.substring(0,3);var $2=[];var $3=MSH.StringHelper.substringSection(this.$9,3,$0).split(' ');for(var $5=0;$5<$3.length;$5++){if($3[$5].length>0){$2.add($3[$5]);}}var $4=$0+2;if(MSM.S$5.$7($1)){var $6=$2.length-1;if($2[$6]==='OK'){}else{var $7=parseInt($2[$6]);$2.removeAt($6);var $8=$7;var $9=$4;while($7>0){if(this.$9.length<=$9){return false;}var $A=this.$9.charCodeAt($9);if($A<=127){$7--;}else if($A<=2047){$7-=2;$8--;}else if($A>=55296&&$A<=57343){$7-=2;$8--;}else{$7-=3;$8-=2;}$9++;}if($8>0){$2.add(MSH.StringHelper.substring(this.$9,$4,$8));}$4+=$8;}}this.$9=this.$9.substr($4);return this.$C($1,$2);}return this.$B();},get_$3:function(){return this.$A;}}
MSM.MsnpServerCommand=function(name,parameters){this.$0=name;this.$1=parameters;}
MSM.MsnpServerCommand.prototype={$0:null,$1:null,get_name:function(){return this.$0;},get_parameters:function(){return this.$1;},get_allParameters:function(){var $0=[];$0.addRange(MSH.CollectionHelper.toArray(this.$1));var $1=this.get_$2();if($1!=null){$0.add(this.get_$2());}return MSH.CollectionHelper.toArray($0);},get_$2:function(){return null;}}
MSM.ContentLayer=function(){}
MSM.ContentLayer.deserialize=function(payload){var $0=new MSM.MimeParser(payload);if($0.getHeader('Messaging')!=null){return MSM.MessagingLayer.create($0);}else if($0.getHeader('Publication')!=null){return MSM.PublicationLayer.create($0);}else if($0.getHeader('Notification')!=null){return MSM.NotificationLayer.create($0);}return null;}
MSM.ContentLayer.prototype={getDocumentType:function(content,docType){if(String.isNullOrEmpty(content)){return null;}switch(docType){case 0:return'application/circles+xml';case 1:return'application/user+xml';default:return null;}}}
MSM.MessagingLayer=function(headers,body){MSM.MessagingLayer.initializeBase(this);this.$5=headers;this.$6='7bit';this.$7=body||String.Empty;}
MSM.MessagingLayer.create=function(parser){var $0=parser.getHeader('Messaging');if(String.compare($0,'2.0')!==0){return null;}return new MSM.MessagingLayer(parser.getHeaders(),parser.getBody());}
MSM.MessagingLayer.prototype={$5:null,$6:null,$7:null,get_appId:function(){return this.getHeader('Application-ID');},set_appId:function(value){this.$8('Application-ID',value);return value;},get_contentEncoding:function(){return this.$6;},set_contentEncoding:function(value){this.$6=value;return value;},get_body:function(){return this.$7;},get_headers:function(){return this.$5;},getHeader:function(name){return this.$5[name]||String.Empty;},$8:function($p0,$p1){this.$5[$p0]=$p1;},serialize:function(){var $0=new MSM.MimeBuilder();$0.setStringHeader('Messaging','2.0');if(this.$6!=='7bit'){$0.setStringHeader('Content-Transfer-Encoding',this.$6);}$0.addHeaders(this.$5);$0.setBody(this.$7);return $0.toString();}}
MSM.NotificationLayer=function(uri,notifySegment,notifyType,docType,content){MSM.NotificationLayer.initializeBase(this);this.$8=uri;this.$9=notifySegment;this.$7=notifyType;this.$A=docType;this.$B=content;}
MSM.NotificationLayer.create=function(parser){var $0=parser.getHeader('Notification');var $1=parser.getHeader('Uri');var $2=parser.getHeader('Content-Type');var $3=parser.getIntHeader('NotifNum',-1);var $4=parser.getBody();var $5=parser.getHeader('NotifType');if(String.compare($0,'1.0')!==0){return null;}if($3===-1){return null;}var $6;if(String.compare($2,'application/circles+xml',true)===0){$6=0;}else if(String.compare($2,'application/user+xml',true)===0){$6=1;}else if(String.compare($2,'application/network+xml',true)===0){$6=2;}else{return null;}var $7;switch($5){case'Full':$7=1;break;case'Partial':$7=0;break;default:return null;}return new MSM.NotificationLayer($1,$3,$7,$6,$4);}
MSM.NotificationLayer.prototype={$7:0,$8:null,$9:0,$A:0,$B:null,$C:null,$D:null,get_body:function(){return this.$B;},get_documentType:function(){return this.$A;},get_uri:function(){return this.$8;},get_notificationSegment:function(){return this.$9;},get_notificationType:function(){return this.$7;},get_users:function(){if(this.$C==null){this.$E();}return this.$C;},get_pendingUsers:function(){if(this.$D==null){this.$E();}return this.$D;},serialize:function(){var $0=(this.$7===1)?'Full':'Partial';var $1=new MSM.MimeBuilder();$1.setStringHeader('Notification','1.0');$1.setStringHeader('Uri',this.$8);$1.setStringHeader('Content-Type',this.getDocumentType(this.$B,this.$A));$1.setIntHeader('NotifNum',this.$9);$1.setStringHeader('NotifType',$0);$1.setBody(this.$B);return $1.toString();},$E:function(){var $0=[];var $1=[];if(String.isNullOrEmpty(this.$B)){var $2='roster(IM)/user(';var $3=this.$8.indexOf($2);if($3!==-1){var $4=this.$8.lastIndexOf(')');var $5=MSH.StringHelper.substringSection(this.$8,$3+$2.length,$4);var $6=new MSM.Mri($5);$0.add($6);}}else{var $7=MSH.XmlHelper.parseXmlDocument(this.$B);if($7!=null){var $8=MSH.XmlHelper.selectSingleNode($7.documentElement,'roster');if($8!=null){var $9=MSH.XmlHelper.selectNodes($8,'user');if($9!=null){for(var $A=0;$A<$9.length;$A++){var $B=$9[$A];var $C=new MSM.Mri(MSH.XmlHelper.selectSingleNode($B,'id').text);var $D=MSH.XmlHelper.selectSingleNode($B,'ep/id');var $E=MSH.XmlHelper.selectSingleNode($B,'state');if($D!=null){var $F=$D.text;if(!String.isNullOrEmpty($F)){$C=MSM.Mri.create($C.get_address(),$C.get_addressType(),$F,null,null);}}if(($E!=null)&&($E.text==='Pending')){$1.add($C);}else{$0.add($C);}}}}}}this.$C=MSH.CollectionHelper.toArray($0);this.$D=MSH.CollectionHelper.toArray($1);}}
MSM.PublicationLayer=function(uri,docType,body){MSM.PublicationLayer.initializeBase(this);this.$3=uri;this.$4=body;this.$5=docType;}
MSM.PublicationLayer.create=function(parser){var $0=parser.getHeader('Publication');var $1=parser.getHeader('Uri');var $2=parser.getHeader('Content-Type')||null;var $3=parser.getBody();if(String.compare($0,'1.0')!==0||String.isNullOrEmpty($1)||String.compare($2,'application/circles+xml')!==0){return null;}return new MSM.PublicationLayer($1,0,$3);}
MSM.PublicationLayer.prototype={$3:null,$4:null,$5:0,serialize:function(){var $0=this.getDocumentType(this.$4,this.$5);var $1=new MSM.MimeBuilder();$1.setStringHeader('Publication','1.0');$1.setStringHeader('Uri',this.$3);$1.setStringHeader('Content-Type',$0);$1.setBody(this.$4);return $1.toString();}}
MSM.ReliabilityLayer=function(){}
MSM.ReliabilityLayer.deserialize=function(payload){var $0=new MSM.MimeParser(payload);var $1=$0.getHeader('Reliability')||String.Empty;if(String.compare($1,'1.0')!==0){return null;}return new MSM.ReliabilityLayer();}
MSM.ReliabilityLayer.prototype={serialize:function(){var $0=new MSM.MimeBuilder();$0.set_disableContentLengthHeader(true);$0.setStringHeader('Reliability','1.0');return $0.toString();}}
MSM.RoutingLayer=function(to,from){this.to=to;this.$E=from;}
MSM.RoutingLayer.deserialize=function(payload){var $0=new MSM.MimeParser(payload);var $1=$0.getHeader('Routing')||String.Empty;var $2=$0.getHeader('To');var $3=$0.getHeader('From');if((String.compare($1,'1.0')!==0)||($2==null)||($3==null)){return null;}var $4=MSM.RoutingLayer.$11($2);var $5=MSM.RoutingLayer.$11($3);var $6=$0.getHeader('Service-Channel')||String.Empty;var $7=2;var $8=1;if(!String.isNullOrEmpty($6)){$7=MSM.RoutingLayer.$13($6);$8=MSM.RoutingLayer.$14($6);if($7===0){return null;}}var $9=new MSM.RoutingLayer($4,$5);$9.set_service($7);$9.set_channel($8);return $9;}
MSM.RoutingLayer.$10=function($p0){if($p0){return'0';}return String.Empty;}
MSM.RoutingLayer.$11=function($p0){if($p0.startsWith('4:tel:')){return MSM.Mri.create(MSH.StringHelper.substringToEnd($p0,6),4,null,null,null);}else{return new MSM.Mri($p0);}}
MSM.RoutingLayer.$12=function($p0,$p1){var $0=String.Empty;var $1=String.Empty;var $2=String.Empty;switch($p0){case 1:$0='PE';break;case 4:$0='PD';break;case 2:$0='IM';break;}switch($p1){case 3:$1='Mobile';break;case 2:$1='Offline';break;case 1:$1='Online';break;}if(!String.isNullOrEmpty($0)){$2=$0;if(!String.isNullOrEmpty($1)){$2+='/';$2+=$1;}}return $2;}
MSM.RoutingLayer.$13=function($p0){var $0=$p0.split('/');switch($0[0]){case'IM':return 2;case'PE':return 1;case'PD':return 4;default:return 0;}}
MSM.RoutingLayer.$14=function($p0){var $0=$p0.split('/');if($0.length>1){switch($0[1]){case'Online':return 1;case'Offline':return 2;case'Mobile':return 3;default:return 0;}}return 0;}
MSM.RoutingLayer.prototype={$C:0,$D:0,to:null,$E:null,$F:false,get_to:function(){return this.to;},get_from:function(){return this.$E;},get_service:function(){return this.$C;},set_service:function(value){this.$C=value;return value;},get_channel:function(){return this.$D;},set_channel:function(value){this.$D=value;return value;},get_disableSelfFanOut:function(){return this.$F;},set_disableSelfFanOut:function(value){this.$F=value;return value;},mapInterLayerInfo:function(content){var $0=Type.safeCast(content,MSM.MessagingLayer);if($0!=null){var $1=$0.get_appId();if(!String.isNullOrEmpty($1)){var $2=MSM.Mri.create(this.$E.get_address(),this.$E.get_addressType(),this.$E.get_endpointId(),$1,this.$E.get_networkId());this.$E=$2;var $3=MSM.Mri.create(this.to.get_address(),this.to.get_addressType(),this.to.get_endpointId(),$1,this.to.get_networkId());this.to=$3;}}},serialize:function(){var $0=this.to.toString();var $1=this.$E.toString();var $2=MSM.RoutingLayer.$12(this.$C,this.$D);var $3=MSM.RoutingLayer.$10(this.$F);if(this.to.get_addressType()===4){$0=this.to.get_addressType()+':tel:'+this.to.get_address();}var $4=new MSM.MimeBuilder();$4.set_disableContentLengthHeader(true);$4.setStringHeader('Routing','1.0');$4.setStringHeader('To',$0);$4.setStringHeader('From',$1);$4.setStringHeader('Service-Channel',$2);$4.setStringHeader('Options',$3);return $4.toString();}}
MSM.PagedMessage=function(pageType,routingLayer,reliabilityLayer,contentLayer){this.$0=pageType;this.$1=routingLayer;this.$2=reliabilityLayer;this.$3=contentLayer;}
MSM.PagedMessage.createPagedMessage=function(pageType,payLoad){var $0=MSM.PagedMessage.$4(payLoad);var $1=MSM.RoutingLayer.deserialize($0[0]);if($1==null){return null;}var $2=MSM.ReliabilityLayer.deserialize($0[1]);if($2==null){return null;}var $3=null;if($0.length===3&&!String.isNullOrEmpty($0[2])){$3=MSM.ContentLayer.deserialize($0[2]);if($3==null){return null;}var $4=Type.safeCast($3,MSM.NotificationLayer);if($4!=null){if(pageType===4){if($4.get_documentType()===1){pageType=6;}else{pageType=2;}}else if(pageType===3){switch($4.get_documentType()){case 2:pageType=7;break;case 1:pageType=5;break;case 0:pageType=1;break;}}}}$1.mapInterLayerInfo($3);return new MSM.PagedMessage(pageType,$1,$2,$3);}
MSM.PagedMessage.$4=function($p0){var $0='\r\n\r\n';var $1=new Array(3);var $2=0;var $3=0;var $4;for($4=0;$4<2;$4++){$3=$p0.indexOf($0,$2);if($3===-1){break;}$1[$4]=MSH.StringHelper.substringSection($p0,$2,$3);$3=$3+$0.length;$2=$3;}if($2<$p0.length){$1[$4]=MSH.StringHelper.substringToEnd($p0,$2);}return $1;}
MSM.PagedMessage.prototype={$0:0,$1:null,$2:null,$3:null,payLoad:function(){var $0=new ss.StringBuilder();$0.append(this.$1.serialize());$0.append(this.$2.serialize());$0.append(this.$3.serialize());return $0.toString();},get_pageType:function(){return this.$0;},get_routing:function(){return this.$1;},get_reliability:function(){return this.$2;},get_content:function(){return this.$3;}}
MSM.S$2=function(key,obj,expires){this.$0=key;this.$1=obj;this.$2=expires;}
MSM.S$2.prototype={$0:0,$1:null,$2:null,$3:function($p0){return MSH.DateTimeHelper.isGreaterThanOrEqual($p0,this.$2);},get_$4:function(){return this.$0;},get_$5:function(){return this.$1;}}
MSM.S$3=function(timeoutInSeconds){this.$0=[];this.$1=timeoutInSeconds*1000;}
MSM.S$3.prototype={$1:0,$2:function($p0,$p1){var $0=MSH.DateTimeHelper.addMilliseconds(Date.get_now(),this.$1);this.$0.add(new MSM.S$2($p0,$p1,$0));},$3:function($p0){if($p0>0){for(var $0=0;$0<this.$0.length;$0++){var $1=this.$0[$0];if($1.get_$4()===$p0){var $2=$1.get_$5();this.$0.removeAt($0);return $2;}}}return null;},$4:function(){if(this.$0.length===0){return;}var $0=Date.get_now();for(var $1=0;$1<this.$0.length;$1++){var $2=this.$0[$1];if($2.$3($0)){this.$0.removeAt($1--);}}}}
MSM.MimeParser.registerClass('MSM.MimeParser');MSM.MimeBuilder.registerClass('MSM.MimeBuilder');MSM.HttpMsnpTransportLogContext.registerClass('MSM.HttpMsnpTransportLogContext',null,MC.ILogContext);MSM.Mri.registerClass('MSM.Mri');MSM.Base64.registerClass('MSM.Base64');MSM.S$4.registerClass('MSM.S$4',null,MSM.S$1);MSM.S$6.registerClass('MSM.S$6',null,MSM.IMsnpCommand);MSM.MsnpConnection.registerClass('MSM.MsnpConnection',null,MSM.IMsnpEvents,ss.IDisposable);MSM.S$5.registerClass('MSM.S$5');MSM.S$7.registerClass('MSM.S$7',MSM.S$5);MSM.MsnpServerCommand.registerClass('MSM.MsnpServerCommand');MSM.ContentLayer.registerClass('MSM.ContentLayer');MSM.MessagingLayer.registerClass('MSM.MessagingLayer',MSM.ContentLayer);MSM.NotificationLayer.registerClass('MSM.NotificationLayer',MSM.ContentLayer);MSM.PublicationLayer.registerClass('MSM.PublicationLayer',MSM.ContentLayer);MSM.ReliabilityLayer.registerClass('MSM.ReliabilityLayer');MSM.RoutingLayer.registerClass('MSM.RoutingLayer');MSM.PagedMessage.registerClass('MSM.PagedMessage');MSM.S$2.registerClass('MSM.S$2');MSM.S$3.registerClass('MSM.S$3');MSM.Base64.$0='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';MSM.S$4.$0=5*1000;MSM.S$4.$1=30*1000;MSM.MsnpConnection.$0=0;MSM.ContentLayer.contentTypeHeader='Content-Type';MSM.ContentLayer.contentTypeCircleDocument='application/circles+xml';MSM.ContentLayer.contentTypeUserDocument='application/user+xml';MSM.ContentLayer.contentTypeNetworkDocument='application/network+xml';Type.registerNamespace('MSP');MSP.P$1=function(){};MSP.P$1.prototype={$0:0,$1:1,$2:2,$3:3,$4:4}
MSP.P$1.registerEnum('MSP.P$1',false);MSP.P$2=function(){};MSP.P$2.prototype={$0:0,$1:1,$2:2,$3:4}
MSP.P$2.registerEnum('MSP.P$2',false);MSP.FslListType=function(){};MSP.FslListType.prototype={expressionProfile:512}
MSP.FslListType.registerEnum('MSP.FslListType',true);MSP.ConnectionService=function(identity,events){this.$6=MC.$create_PresenceConfigurationInfo();this.$0=identity;this.$1=events;this.$5=new MSP.P$1B(this);}
MSP.ConnectionService.prototype={$0:null,$1:null,$2:null,$3:null,$4:null,$5:null,$7:null,get_logContext:function(){if(this.$7==null){this.$7=new MC.LogContext(this.$0.liveId);}if(this.$2!=null){this.$2.set_logContext(this.$7);}return this.$7;},set_logContext:function(value){this.$7=value;if(this.$2!=null){this.$2.set_logContext(this.$7);}return value;},get_$8:function(){return this.$0;},get_serverName:function(){return(this.$2!=null)?this.$2.get_serverName():String.Empty;},get_isSignedIn:function(){return(Type.canCast(this.$5,MSP.P$23));},authenticate:function(clientId,hostName,services,transferState,onCompleted){if(String.isNullOrEmpty(hostName)){if(this.$3!=null){hostName=this.$3;}else{hostName=this.$6.hostName;}}if(transferState==null){transferState=this.$4;}this.$2=new MSP.P$25(this,hostName);this.$2.set_logContext(this.get_logContext());this.$2.set_identity(this.$0);this.$2.set_$1_8(this.$6);this.$5.$2(new MSP.P$16(this.$0,clientId,transferState,services,this.$2,onCompleted));},resumeSession:function(sessionInfo){this.$2=new MSP.P$25(this,sessionInfo.server);this.$2.set_logContext(this.get_logContext());this.$2.set_identity(this.$0);this.$2.resume(sessionInfo.sessionToken,sessionInfo.transactionID);this.updateConfiguration(this.$6);this.$C(new MSP.P$23(this));if(sessionInfo.pendingEvents!=null){var $enum1=ss.IEnumerator.getEnumerator(sessionInfo.pendingEvents);while($enum1.moveNext()){var $0=$enum1.get_current();var $1=$0[1];switch($0[0]){case'OnDatagramReceived':this.onDatagramReceived($1[0]);break;case'OnSubscribeNotificationReceived':this.onSubscribeNotificationReceived();break;}}}},publishNetworks:function(networks,operation,services,onCompleted){var $0=this.$D(networks,services);this.$5.$3(new MSP.P$1D($0,operation,this.$2,onCompleted));},updateNetworks:function(networkIds,operation,onCompleted){this.$5.$3(new MSP.P$1D(networkIds,operation,this.$2,onCompleted));},getSession:function(){if(this.$2!=null){return this.$2.get_$1_7();}return null;},$9:function($p0){this.$2=$p0;if(this.$0!=null){this.$2.set_identity(this.$0);}},notifyAddressBookChanged:function(){this.$5.$A(new MSP.P$11(this.$0,this.$2));},sendDatagram:function(page,onCompleted){this.$5.$B(new MSP.P$14(page,this.$2,onCompleted));},signIn:function(networkOperation,networks,contacts,serviceData,settings,services,onCompleted){var $0=this.$D(networks,services);var $1=this.$F(contacts);this.$5.$4(services,new MSP.P$1D($0,networkOperation,this.$2,null),new MSP.P$10($1,services,this.$2,null),new MSP.P$F(this.$0,serviceData,services,this.$2,null),new MSP.P$1E(this.$1,onCompleted));},signOut:function(userServiceData,locations,endpointIds,initiatedRemotely,onCompleted){this.$5.$5(new MSP.P$21(this.$0,userServiceData,locations,endpointIds,initiatedRemotely,this.$2,this,this.$1,onCompleted));},deleteServiceData:function(userServiceData,onCompleted){this.$5.$6(new MSP.P$19(this.$0,userServiceData,this.$2,onCompleted));},setApplicationContacts:function(contactData,signature,onCompleted){this.$5.$7(new MSP.P$27(this.$0.cid,contactData,signature,this,this.$2,onCompleted));},updateAppContactsRoleLists:function(addedAppContactIds,roles,services,onCompleted){this.$5.$8(new MSP.P$1C(addedAppContactIds,roles&MSP.P$6.$3(services),MSP.P$6.$1(services),this.$2,onCompleted));},updateAddresses:function(addresses,addedLists,removedLists,services,onCompleted){var $0=MSP.P$6.$3(services);addedLists&=$0;this.$5.$C(new MSP.P$20(addresses,addedLists,removedLists,MSP.P$6.$1(services),this.$2,onCompleted));},updateUserAddress:function(address,addedLists,removedLists,services,onCompleted){var $0=MSP.P$6.$3(services);addedLists&=$0;this.$5.$C(new MSP.P$20([address],addedLists,removedLists,MSP.P$6.$2(services),this.$2,onCompleted));},publishRoleLists:function(addresses,services,onCompleted){this.$5.$D(new MSP.P$10(addresses,services,this.$2,onCompleted));},publishServiceData:function(serviceData,services,onCompleted){this.$5.$9(new MSP.P$F(this.$0,serviceData,services,this.$2,onCompleted));},updateConfiguration:function(configuration){this.$6=configuration;if(this.$2!=null){this.$2.set_$1_8(configuration);this.$2.setConnectionTimeout(configuration.httpRequestTimeout);}},onAlertNotificationReceived:function(alert){this.$1.onAlertNotificationReceived(alert);},onNetworkStatusChanged:function(networkId,status){this.$1.onNetworkStatusChanged(networkId,status);},onSessionIdChanged:function(newSessionId){if(this.$1!=null&&this.$1!==this){this.$1.onSessionIdChanged(newSessionId);}},onTridChanged:function(newTrid){if(this.$1!=null&&this.$1!==this){this.$1.onTridChanged(newTrid);}},onServiceDataChanged:function(address,serviceData){this.$5.$E(new MSP.P$13(address,serviceData,this.$1));},onServiceDataDeleted:function(address,serviceData){this.$5.$F(new MSP.P$22(address,serviceData,this.$1));},onSettingsChanged:function(settings){this.$5.$14(new MSP.P$26(settings,this.$1));},onMailNotificationReceived:function(mailNotification){this.$5.$12(new MSP.P$18(mailNotification,this.$1));},onSubscribeNotificationReceived:function(){this.$5.$13(new MSP.P$17(this.$1));},onDatagramReceived:function(message){this.$5.$15(new MSP.P$1A(message,this.$1));},onDisconnected:function(resultCode,reason,reconnectWaitTime){this.$A();this.$5.$11(new MSP.P$15(resultCode,this.$1,reason,reconnectWaitTime));},onTransferred:function(hostName,transferState,otherEndpointRequested,cacheHostName){this.$A();this.$5.$10(new MSP.P$1F(hostName,transferState,otherEndpointRequested,cacheHostName,this,this.$1));},onSignInEventsEmpty:function(){this.$1.onSignInEventsEmpty();},$A:function(){if(this.$2!=null){this.$2.dispose();}},$B:function($p0){$p0.$2();},$C:function($p0){this.$5=$p0;if(Type.canCast(this.$5,MSP.P$1B)){this.$A();}},setTransferServer:function(server,transferState,cache){this.$3=server;this.$4=transferState;if(cache){this.$6.hostName=server;}},abort:function(){this.$A();},pauseSession:function(callback){this.$2.pauseSession(callback);},$D:function($p0,$p1){var $0=[];switch($p1){case 3:case 0:if($p0!=null){var $enum1=ss.IEnumerator.getEnumerator($p0);while($enum1.moveNext()){var $1=$enum1.get_current();if(this.$E($1)){$1.status=1;$0.add($1.id);}}}break;}return MSH.CollectionHelper.toArray($0);},$E:function($p0){if($p0.connectionType!==2){return false;}var $0=MSH.StringHelper.toLowerCase($p0.tokenState);if(($0!=='accept')&&($0!=='error')){return false;}if(!$p0.supportsIM||!$p0.imEnabled){return false;}return true;},$F:function($p0){var $0=[];for(var $1=0;$1<$p0.length;$1++){var $2=$p0[$1];for(var $3=0;$3<$2.length;$3++){var $4=$2[$3];for(var $5=0;$5<$4.addresses.length;$5++){var $6=$4.addresses[$5];$0.add($6);}}}return MSH.CollectionHelper.toArray($0);}}
MSP.P$E=function(){}
MSP.P$E.prototype={$0:false,$1:false,$2:function(){this.$0=true;this.$3();},$4:function(){if(!this.$1){this.$1=true;this.$6();}},$5:function(){if(!this.$1){this.$1=true;this.$6();}},$6:function(){if(this.$8!=null){this.$8.invoke(this,ss.EventArgs.Empty);}},add_$7:function($p0){this.$8=ss.Delegate.combine(this.$8,$p0);},remove_$7:function($p0){this.$8=ss.Delegate.remove(this.$8,$p0);},$8:null}
MSP.P$16=function(identity,clientId,transferState,services,connection,onCompleted){MSP.P$16.initializeBase(this);this.$9=identity;this.$A=clientId;this.$11=services;this.$B=transferState;this.$C=connection;this.$D=onCompleted;this.$E=(MSP.P$6.$2(services)!==0);}
MSP.P$16.prototype={$9:null,$A:null,$B:null,$C:null,$D:null,$E:false,$F:0,$10:0,$11:0,$3:function(){this.$12(0,null);},$6:function(){this.$D.invoke(this.$10);MSP.P$16.callBaseMethod(this,'$6');},$12:function($p0,$p1){if($p0!==0){this.$F=1;}switch(this.$F){case 0:this.$F=2;this.$C.$1_2E(ss.Delegate.create(this,this.$15));switch(this.$9.authenticationInfo.authType){case 1:this.$C.$1_20(this.$9.liveId,this.$A,this.$B,this.$9.experienceId,ss.Delegate.create(this,this.$16));this.$C.$1_2D(this.$9.endpointId,ss.Delegate.create(this,this.$18));this.$13();this.$14();break;case 2:this.$C.$1_20('11:'+this.$9.cid,this.$A,this.$B,this.$9.experienceId,ss.Delegate.create(this,this.$16));this.$C.$1_2B(this.$9.appId,this.$9.cid,this.$9.authenticationInfo.ticket,this.$9.endpointId,ss.Delegate.create(this,this.$18));this.$13();this.$14();break;default:this.$10=1;this.$5();break;}break;case 2:break;case 3:if(!this.$E){this.$10=0;this.$5();}break;case 4:this.$10=0;this.$5();break;case 1:this.$10=$p0;this.$5();break;}},$13:function(){if(this.$E){this.$C.$1_1E(false,[MC.$create_IMAddressInfo(this.$9.liveId,1,1)],MSP.P$6.$2(this.$11),1,ss.Delegate.create(this,this.$19));}},$14:function(){this.$C.$1_21(512,ss.Delegate.create(this,this.$17));},$15:function($p0,$p1){this.$12(($p0===0)?0:1,$p1);},$16:function($p0,$p1){this.$12(($p0===0)?0:1,$p1);},$17:function($p0,$p1){this.$12(($p0===0)?0:1,$p1);},$18:function($p0,$p1){this.$F=3;switch($p0){case 0:this.$12(0,$p1);break;case 921:case 911:this.$12(4,$p1);break;default:this.$12(1,$p1);break;}},$19:function($p0,$p1){if(this.$F!==1){this.$F=4;this.$12(($p0===0)?0:1,$p1);}}}
MSP.P$15=function(resultCode,events,reason,reconnectWaitTime){MSP.P$15.initializeBase(this);this.$9=resultCode;this.$A=events;this.$B=reason;this.$C=reconnectWaitTime;}
MSP.P$15.prototype={$9:0,$A:null,$B:0,$C:0,$3:function(){this.$A.onDisconnected(this.$9,this.$B,this.$C);}}
MSP.P$1A=function(page,events){MSP.P$1A.initializeBase(this);this.$9=page;this.$A=events;}
MSP.P$1A.prototype={$9:null,$A:null,$3:function(){this.$6();},$6:function(){this.$A.onDatagramReceived(this.$9);}}
MSP.P$19=function(identity,serviceData,connection,onCompleted){MSP.P$19.initializeBase(this);this.$9=identity;this.$A=serviceData;this.$B=connection;this.$C=onCompleted;}
MSP.P$19.prototype={$9:null,$A:null,$B:null,$C:null,$D:0,$3:function(){var $0=0;var $enum1=ss.IEnumerator.getEnumerator(this.$A.toServiceDataArray());while($enum1.moveNext()){var $1=$enum1.get_current();if($1.getAllEndpoints().length>0){$0|=$1.get_service();}}if($0!==0){var $2=MC.$create_IMAddressInfo(this.$9.liveId,1,0);var $3=new MSP.ServiceDataWriter(this.$A.toArray(),null,$0,1);var $4=MSM.Mri.createFromIMAddressInfo($2);var $5=MSM.Mri.create($2.address,$2.type,this.$9.endpointId,$2.applicationId,$2.network);var $6=$3.getPayload();if($6==null){this.$5();return;}var $7=new MSM.PagedMessage(6,new MSM.RoutingLayer($4,$5),new MSM.ReliabilityLayer(),new MSM.PublicationLayer('/user',1,$6));this.$B.$1_22($7.payLoad(),ss.Delegate.create(this,this.$E));}else{this.$5();}},$6:function(){if(this.$C!=null){this.$C.invoke(this.$D);}MSP.P$19.callBaseMethod(this,'$6');},$E:function($p0,$p1){if($p0!==0){this.$D=1;this.$4();}else{this.$5();}}}
MSP.P$18=function(mailNotification,events){MSP.P$18.initializeBase(this);this.$9=mailNotification;this.$A=events;}
MSP.P$18.prototype={$9:null,$A:null,$3:function(){this.$A.onMailNotificationReceived(this.$9);}}
MSP.P$11=function(identity,connection){MSP.P$11.initializeBase(this);this.$9=identity;this.$A=connection;}
MSP.P$11.prototype={$9:null,$A:null,$3:function(){var $0='Routing: 1.0\r\n'+'To: 1:{0}\r\n'+'From: 1:{0};epid={1}\r\n'+'Service-Channel: PD\r\n'+'Options: 0\r\n\r\n'+'Reliability: 1.0\r\n\r\n'+'Messaging: 2.0\r\n'+'MIME-Version: 1.0\r\n'+'Content-Type: Text/plain; charset=UTF-8\r\n'+'Content-Transfer-Encoding: 7bit\r\n'+'Message-Type: Signal/ForceAbchSync\r\n'+'Content-Length: 0\r\n\r\n';var $1=String.format($0,this.$9.liveId,this.$9.endpointId);this.$A.$1_28($1,ss.Delegate.create(this,this.$B));},$B:function($p0,$p1){if($p0===0){this.$5();}else{this.$4();}}}
MSP.P$10=function(addresses,services,connection,onCompleted){MSP.P$10.initializeBase(this);this.$9=addresses;this.$A=MSP.P$6.$3(services);this.$B=MSP.P$6.$1(services);this.$C=connection;this.$D=onCompleted;}
MSP.P$10.prototype={$9:null,$A:0,$B:0,$C:null,$D:null,$E:0,$F:0,$10:0,$6:function(){if(this.$D!=null){this.$D.invoke(this.$10);}MSP.P$10.callBaseMethod(this,'$6');},$3:function(){this.$E=this.$C.$1_1E(true,this.$9,this.$B,this.$A,ss.Delegate.create(this,this.$11));if(this.$E===0){this.$5();}},$11:function($p0,$p1){switch($p0){case 0:case 204:case 205:case 234:case 508:case 241:break;default:this.$10=1;break;}this.$F++;if(this.$E===this.$F){this.$5();}}}
MSP.P$F=function(identity,serviceData,services,connection,onCompleted){MSP.P$F.initializeBase(this);this.$9=MC.$create_IMAddressInfo(identity.liveId,1,0);this.$A=identity.endpointId;this.$B=serviceData;this.$C=MSP.P$6.$0(services);this.$D=connection;this.$E=onCompleted;}
MSP.P$F.prototype={$9:null,$A:null,$B:null,$C:0,$D:null,$E:null,$F:0,get_$10:function(){return this.$9;},get_$11:function(){return this.$B;},$3:function(){if(this.$C===0){this.$5();}else{var $0=new MSP.ServiceDataWriter(this.$B.toArray(),this.$A,this.$C,0);var $1=$0.getPayload();if($1==null){this.$5();return;}var $2=MSM.Mri.createFromIMAddressInfo(this.$9);var $3=MSM.Mri.create(this.$9.address,this.$9.type,this.$A,this.$9.applicationId,this.$9.network);var $4=new MSM.PagedMessage(5,new MSM.RoutingLayer($2,$3),new MSM.ReliabilityLayer(),new MSM.PublicationLayer('/user',1,$1));this.$D.$1_24($4.payLoad(),ss.Delegate.create(this,this.$13));}},$6:function(){if(this.$E!=null){this.$E.invoke(this.$F);}MSP.P$F.callBaseMethod(this,'$6');},get_$12:function(){return this.$F;},$13:function($p0,$p1){if($p0!==0){this.$F=1;this.$4();return;}this.$5();}}
MSP.P$14=function(message,connection,onCompleted){MSP.P$14.initializeBase(this);this.$9=message;this.$A=connection;this.$B=onCompleted;}
MSP.P$14.prototype={$9:null,$A:null,$B:null,$C:0,$D:null,$3:function(){switch(this.$9.datagramType){case 0:this.$A.$1_28(this.$9.payload,ss.Delegate.create(this,this.$E));break;case 1:this.$A.$1_24(this.$9.payload,ss.Delegate.create(this,this.$E));break;case 2:this.$A.$1_22(this.$9.payload,ss.Delegate.create(this,this.$E));break;default:break;}},$6:function(){this.$B.invoke(this.$C,this.$D);},$E:function($p0,$p1){if($p0===0){this.$C=0;if(this.$9.datagramType===1&&$p1!=null){this.$D=MC.DatagramInfo.createDatagramMessage(this.$9.datagramType,$p1);}this.$5();}else{switch($p0){case 217:this.$C=5;break;case 285:case 598:this.$C=2;break;case 596:case 590:case 591:this.$C=3;break;case 550:case 551:case 595:this.$C=4;break;default:this.$C=1;break;}this.$D=this.$9;this.$4();}}}
MSP.P$13=function(address,serviceData,events){MSP.P$13.initializeBase(this);this.$9=address;this.$A=serviceData;this.$B=events;}
MSP.P$13.prototype={$9:null,$A:null,$B:null,get_$C:function(){return this.$9;},get_$D:function(){return this.$A;},$3:function(){this.$B.onServiceDataChanged(this.$9,this.$A);}}
MSP.P$22=function(address,serviceData,events){MSP.P$22.initializeBase(this);this.$9=address;this.$A=serviceData;this.$B=events;}
MSP.P$22.prototype={$9:null,$A:null,$B:null,get_$C:function(){return this.$9;},get_$D:function(){return this.$A;},$3:function(){this.$B.onServiceDataDeleted(this.$9,this.$A);}}
MSP.P$27=function(userCid,contactData,signature,service,connection,onCompleted){MSP.P$27.initializeBase(this);this.$9=userCid;this.$A=contactData;this.$B=signature;this.$C=service;this.$D=connection;this.$E=onCompleted;}
MSP.P$27.prototype={$9:null,$A:null,$B:null,$C:null,$D:null,$E:null,$F:0,$3:function(){if(this.$9==null){this.$F=1;this.$5();}else{this.$D.$1_2C(this.$A,this.$B,ss.Delegate.create(this,this.$10));}},$10:function($p0,$p1){switch($p0){case 0:this.$F=0;break;case 210:this.$F=4;break;case 921:this.$F=5;break;case 933:this.$F=3;break;case 935:this.$F=2;break;case 500:this.$F=1;break;default:this.$F=1;break;}this.$5();},$6:function(){if(this.$E!=null){this.$E.invoke(this.$F);}MSP.P$27.callBaseMethod(this,'$6');}}
MSP.P$26=function(settings,events){MSP.P$26.initializeBase(this);this.$9=settings;this.$A=events;}
MSP.P$26.prototype={$9:null,$A:null,$3:function(){this.$A.onSettingsChanged(this.$9);}}
MSP.P$1E=function(events,onCompleted){MSP.P$1E.initializeBase(this);this.$9=events;this.$A=onCompleted;}
MSP.P$1E.prototype={$9:null,$A:null,$B:0,$C:null,$D:null,$E:function($p0,$p1,$p2){this.$B=$p0;this.$C=$p1;this.$D=$p2;},$3:function(){this.$A.invoke(this.$B);if(this.$B===0){this.$9.onServiceDataChanged(this.$C,this.$D);}}}
MSP.P$21=function(identity,userServiceData,locations,endpointIds,initiatedRemotely,connection,service,events,onCompleted){MSP.P$21.initializeBase(this);this.$9=identity;this.$A=userServiceData;this.$B=locations;this.$D=initiatedRemotely;this.$E=connection;this.$F=service;this.$10=events;this.$11=onCompleted;if(endpointIds!=null){this.$C=[];this.$C.addRange(endpointIds);}}
MSP.P$21.prototype={$9:null,$A:null,$B:0,$C:null,$D:false,$E:null,$F:null,$10:null,$11:null,$12:null,$13:null,$14:0,$3:function(){var $0=this.$16();if(this.get_$1A()){this.$E.$1_23(ss.Delegate.create(this,this.$15));}else if(!$0){this.$5();}},$15:function($p0,$p1){if($p0!==0){this.$14=1;}this.$5();},$16:function(){if(this.$18(8)||this.$18(2)){this.$19();if(this.$12!=null){this.$13=new MSP.P$19(this.$9,this.$12,this.$E,ss.Delegate.create(this,this.$1B));this.$13.$2();return true;}}return false;},$17:function($p0){if($p0===this.$9.endpointId){return this.get_$1A();}if(this.$18(2)){return true;}if(this.$18(8)&&this.$C.contains($p0)){return true;}return false;},$18:function($p0){return(this.$B&$p0)===$p0;},$19:function(){var $0=this.$A.imServiceData;if($0==null){return;}this.$12=new MC.ServiceDataSet([MC.$create_ServiceDataInfo(2,{},{})]);var $1=false;var $enum1=ss.IEnumerator.getEnumerator($0.getAllEndpoints());while($enum1.moveNext()){var $2=$enum1.get_current();if(this.$17($2.get_endpointId())){$0.deleteEndpoint($2.get_endpointId());if($2.get_endpointId()!==this.$9.endpointId){this.$12.addEndpoint(MC.ServiceEndpointData.createEmpty(2,$2.get_endpointId()));$1=true;}}}if(!$1){this.$12=null;}},get_$1A:function(){return this.$18(1);},$6:function(){if(this.$11!=null){this.$11.invoke(this.$14);}else if(this.$D){this.$10.onDisconnected(2,1,-1);}MSP.P$21.callBaseMethod(this,'$6');},$1B:function($p0){if(!this.get_$1A()){this.$14=$p0;if($p0!==0){this.$4();}else{this.$5();}}}}
MSP.P$17=function(events){MSP.P$17.initializeBase(this);this.$9=events;}
MSP.P$17.prototype={$9:null,$3:function(){this.$9.onSubscribeNotificationReceived();}}
MSP.P$1F=function(hostName,transferState,otherEndpointRequested,cacheHostName,service,events){MSP.P$1F.initializeBase(this);this.$9=hostName;this.$A=transferState;this.$B=otherEndpointRequested;this.$C=cacheHostName;this.$D=service;this.$E=events;}
MSP.P$1F.prototype={$9:null,$A:null,$B:false,$C:false,$D:null,$E:null,$3:function(){this.$D.setTransferServer(this.$9,this.$A,this.$C);this.$E.onTransferred(this.$9,this.$A,this.$B,this.$C);}}
MSP.P$20=function(addresses,addedLists,removedLists,services,connection,callback){this.$15=0;MSP.P$20.initializeBase(this);this.$9=addresses;this.$A=addedLists;this.$B=removedLists;this.$C=services;this.$D=connection;this.$E=callback;}
MSP.P$20.prototype={$9:null,$A:0,$B:0,$C:0,$D:null,$E:null,$F:0,$10:0,$11:0,$12:0,$13:0,$14:0,$3:function(){if(this.$B!==0){var $0=this.$16(this.$B);if($0.length>0){this.$11=this.$D.$1_26($0,this.$C,this.$B,ss.Delegate.create(this,this.$18));}if(this.$11>0){this.$F|=2;}}if(this.$A!==0){var $1=this.$16(this.$A);if($1.length>0){this.$12=this.$D.$1_1E(false,$1,this.$C,this.$A,ss.Delegate.create(this,this.$17));}if(this.$12>0){this.$F|=1;}}if(this.$F===0){this.$19(0);}},$16:function($p0){var $0=[];for(var $1=0;$1<this.$9.length;$1++){if(this.$9[$1].type!==11){$0.add(MC.$create_IMAddressInfo(this.$9[$1].address,this.$9[$1].type,$p0));}}return MSH.CollectionHelper.toArray($0);},$17:function($p0,$p1){this.$10|=1;this.$14++;this.$19($p0);},$18:function($p0,$p1){this.$10|=2;this.$13++;this.$19($p0);},$19:function($p0){if($p0!==0){this.$10|=4;}if((this.$10&4)!==0){this.$15=1;this.$4();return;}if((this.$10===this.$F)&&(this.$11===this.$13)&&(this.$12===this.$14)){this.$5();}},$6:function(){this.$E.invoke(this.$15);MSP.P$20.callBaseMethod(this,'$6');},get_$1A:function(){return this.$9;},get_$1B:function(){return this.$15===0;},get_$1C:function(){return this.$A!==0;}}
MSP.P$1C=function(addedAppContactIds,roles,services,connection,onCompleted){MSP.P$1C.initializeBase(this);this.$9=addedAppContactIds;this.$C=roles;this.$D=services;this.$A=connection;this.$B=onCompleted;}
MSP.P$1C.prototype={$9:null,$A:null,$B:null,$C:0,$D:0,$E:0,$F:0,$10:0,$3:function(){if(this.$9.length>0){var $0=[];var $enum1=ss.IEnumerator.getEnumerator(this.$9);while($enum1.moveNext()){var $1=$enum1.get_current();var $2=MC.$create_IMAddressInfo($1,11,this.$C);$0.add($2);}this.$F=this.$A.$1_1E(false,MSH.CollectionHelper.toArray($0),this.$D,this.$C,ss.Delegate.create(this,this.$11));}if(this.$F===0){this.$E=0;this.$5();}},$11:function($p0,$p1){if($p0!==0){MSH.Logger.logWarning(this.$A.get_logContext(),'UpdatedAppContactsRoleListsCommand.OnAdl','Received error response. Result code:'+$p0);this.$E=1;}this.$10++;if(this.$F===this.$10){this.$5();}},$6:function(){if(this.$B!=null){this.$B.invoke(this.$E);}MSP.P$1C.callBaseMethod(this,'$6');}}
MSP.P$1D=function(networkIds,operation,connection,callback){MSP.P$1D.initializeBase(this);this.$9=networkIds;this.$A=operation;this.$C=connection;this.$B=callback;this.$D=0;}
MSP.P$1D.prototype={$9:null,$A:0,$B:null,$C:null,$D:0,$3:function(){if(this.$9.length===0){this.$5();return;}switch(this.$A){case 1:this.$C.$1_1F(this.$9,ss.Delegate.create(this,this.$E));break;case 2:this.$C.$1_27(this.$9,ss.Delegate.create(this,this.$E));break;case 0:this.$5();break;}},$E:function($p0,$p1){switch($p0){case 0:this.$D=0;break;default:this.$D=1;MSH.Logger.logWarning(this.$C.get_logContext(),'UpdateNetworksCommand.OnResponse',String.format('Received ADL response error code: {0}',$p0));break;}this.$5();},$6:function(){if(this.$B!=null){this.$B.invoke(this.$D);}MSP.P$1D.callBaseMethod(this,'$6');}}
MSP.P$4=function(){}
MSP.P$4.$0=function($p0){var $0=MSH.StringHelper.splitChar(MSH.StringHelper.toLowerCase($p0),';');if($0.length!==2){$0=[$0[0],''];}return $0;}
MSP.P$4.$1=function($p0){return new MSP.P$C().$1C($p0);}
MSP.P$4.$2=function($p0,$p1,$p2){return $p0.replace(new RegExp($p1),$p2);}
MSP.P$4.$3=function($p0,$p1){var $0=$p0.toString(2);var $1=$p1.toString(2);var $2=new ss.StringBuilder();var $3=new ss.StringBuilder();var $4=Math.abs($0.length-$1.length);for(var $5=0;$5<$4;$5++){$3.append('0');}if($0.length<$1.length){$3.append($0);$0=$3.toString();}else if($1.length<$0.length){$3.append($1);$1=$3.toString();}for(var $6=0;$6<$0.length;$6++){$2.append((MSH.StringHelper.charAt($0,$6)===MSH.StringHelper.charAt($1,$6))?'0':'1');}return parseInt($2.toString(),2);}
MSP.P$4.$4=function($p0){return MSH.ConvertHelper.parseInt($p0);}
MSP.P$4.$5=function($p0){$p0=MSH.StringHelper.toLowerCase($p0);if($p0.startsWith('http://')){$p0=MSH.StringHelper.substringToEnd($p0,'http://'.length);var $0=$p0.indexOf('/');if($0>=0){$p0=MSH.StringHelper.substring($p0,0,$0);}}return $p0;}
MSP.P$4.$7=function($p0){if($p0.indexOf('&')<0){return $p0;}return $p0.replace(MSP.P$4.$8,function($p1_0){return($p1_0==='&')?'&amp;':$p1_0;});}
MSP.P$25=function(events,host){MSP.P$25.initializeBase(this,[host]);this.$1_2=events;this.$1_6=0;this.$1_4=MC.$create_MessengerSessionInfo(host,null,0,new Array(0));}
MSP.P$25.prototype={$1_1:21,$1_2:null,$1_3:null,$1_4:null,$1_5:false,$1_6:0,get_$1_7:function(){return this.$1_4;},get_$1_8:function(){return this.$1_3;},set_$1_8:function($p0){this.$1_3=$p0;this.setConnectionTimeout($p0.httpRequestTimeout);return $p0;},$1_9:function($p0){if($p0.length!==2){this.$1_19('ADL',$p0);return;}var $0=this.getPendingCommand(MSP.P$4.$4($p0[0]));if($0!=null){$0.onComplete(0,null);}else if($p0[1]==='OK'){}else{var $1=new MSP.P$3($p0[1]);if($1.$5()){this.$1_2.onSubscribeNotificationReceived();}}},$1_A:function($p0){if($p0.length!==2){this.$1_19('CHL',$p0);return;}var $0='PROD0090YUAUV{2B';var $1=$p0[1];var $2=new MSP.P$D().$1($1,$0,'YMM8C_H7KCQ2S_KL');this.$1_25($0,$2);this.getPendingCommand(MSP.P$4.$4($p0[0]));},$1_B:function($p0){if(($p0.length!==2)&&($p0.length!==3)){this.$1_19('DEL',$p0);return;}var $0=this.$1_17('DEL',$p0);if($0!=null){var $1=($p0.length>2)?$p0[2]:null;$0.onComplete(0,$1);}},$1_C:function($p0){if($p0.length!==3){this.$1_19('MSG',$p0);return;}if($p0[0]!=='Hotmail'||$p0[1]!=='Hotmail'){return;}var $0=new MSM.MimeParser($p0[2]);var $1=MSH.StringHelper.splitChar($0.getHeader('Content-Type'),';')[0];switch($1){case'text/x-msmsgsprofile':var $2=MC.$create_SettingsInfo();$2.hasInbox=($0.getHeader('EmailEnabled')==='1');$2.hasInboxChanged=true;this.$1_2.onSettingsChanged($2);break;case'text/x-msmsgsinitialmdatanotification':case'text/x-msmsgsactivemailnotification':case'text/x-msmsgsemailnotification':case'text/x-msmsgsoimnotification':var $3=new MSP.P$B($0);if($3.$3()){for(var $4=0;$4<$3.get_$2().length;$4++){this.$1_2.onMailNotificationReceived($3.get_$2()[$4]);}}else{MSH.Logger.logWarning(this.get_logContext(),'CsConnection.OnServerMsg','Failed to parse mail notification: '+$p0[2]);}break;case'text/x-msmsgsservicemessage':break;case'text/x-msmsgsfamilysafetysettings':break;default:break;}},$1_D:function($p0){if($p0.length!==2){this.$1_19('NFY',$p0);return;}var $0;switch($p0[0]){case'PUT':$0=3;break;case'DEL':$0=4;break;default:return;}var $1=MSM.PagedMessage.createPagedMessage($0,$p0[1]);if($1==null){return;}switch($1.get_pageType()){case 7:var $2=new MSP.P$8($1);if($2.get_$3()){this.$1_2.onNetworkStatusChanged($2.get_$4(),$2.get_$5());}else{}break;case 6:case 5:var $3=MSM.Mri.getIMAddressInfo($1.get_routing().get_from());var $4=new MSP.P$9(this.$1_3,$3,this.get_identity().liveId,($1.get_content()).get_body());if(!$4.$8()){return;}var $5=new MC.ServiceDataSet($4.get_$7());if($1.get_pageType()===5){this.$1_2.onServiceDataChanged($3,$5);}else{this.$1_2.onServiceDataDeleted($3,$5);}break;default:this.$1_2.onDatagramReceived(MC.DatagramInfo.createDatagramMessage($0,$p0[1]));break;}},$1_E:function($p0){if($p0.length!==1){this.$1_19('NOT',$p0);return;}this.$1_1A($p0[0]);},$1_F:function($p0){if($p0.length!==0&&$p0.length!==1&&$p0.length!==2){this.$1_19('OUT',$p0);return;}this.$1_5=true;if($p0.length>0){switch($p0[0]){case'OTH':this.$1_2.onDisconnected(2,1,-1);break;case'TME':this.$1_2.onDisconnected(3,4,-1);break;case'RCT':if($p0.length!==2){this.$1_19('OUT',$p0);return;}var $0=MSH.ConvertHelper.parseInt($p0[1]);this.$1_2.onDisconnected(0,5,$0);break;case'SSD':default:this.$1_2.onDisconnected(1,3,-1);break;}}else{this.$1_2.onDisconnected(1,3,-1);}},$1_10:function($p0){if(($p0.length!==2)&&($p0.length!==3)){this.$1_19('PUT',$p0);return;}var $0=this.$1_17('PUT',$p0);if($0!=null){var $1=($p0.length>2)?$p0[2]:null;$0.onComplete(0,$1);}},$1_11:function($p0){if($p0.length!==2){this.$1_19('RML',$p0);return;}var $0=this.getPendingCommand(MSP.P$4.$4($p0[0]));if($0!=null){$0.onComplete(0,null);}else{}},$1_12:function($p0){if($p0[0]!=='0'){var $0=this.$1_17('SDG',$p0);if($0!=null){$0.onComplete(500,$p0[2]);}return;}if($p0.length!==2){this.$1_19('SDG',$p0);return;}this.$1_2.onDatagramReceived(MC.DatagramInfo.createDatagramMessage(0,$p0[1]));},$1_13:function($p0){if($p0.length!==4&&$p0.length!==5){this.$1_19('USR',$p0);return;}var $0=this.getPendingCommand(MSP.P$4.$4($p0[0]));if($p0[1]==='TWN'&&$p0[2]==='S'){if($p0.length!==4){return;}}else if($p0[1]==='OK'){if($p0.length!==5){return;}var $1=($p0[3]!=='1');var $2=($p0[4]!=='0');var $3=($p0[4]==='1');if($1){MSH.Logger.logInfo(this.get_logContext(),'CsConnection.OnServerUsr','USR OK: The user\'s identity is not verified.');}var $4=MC.$create_SettingsInfo();$4.isIdentityUnverified=$1;$4.isIdentityUnverifiedChanged=true;this.$1_2.onSettingsChanged($4);}if($0!=null){$0.onComplete(0,null);}},$1_14:function($p0){if($p0.length<2){this.$1_19('VER',$p0);return;}var $0=this.getPendingCommand(MSP.P$4.$4($p0[0]));var $1=false;for(var $2=1;!$1&&$2<$p0.length;$2++){for(var $3=0;!$1&&$3<MSP.P$25.$1_0.length;$3++){if($p0[$2]===MSP.P$25.$1_0[$3]){this.$1_1=MSH.ConvertHelper.parseInt(MSH.StringHelper.substringToEnd($p0[$2],4));$1=true;}}}if($0!=null){if(!$1){$0.onComplete(500,null);}else{$0.onComplete(0,null);}}},$1_15:function($p0){if($p0.length!==6){this.$1_19('XFR',$p0);return;}var $0=this.getPendingCommand(MSP.P$4.$4($p0[0]));if($p0[1]==='NS'){this.$1_5=true;var $1=($p0[3]==='M');var $2=($p0[3]==='G');var $3=MSH.StringHelper.splitChar($p0[2],':');MSH.Logger.logInfo(this.get_logContext(),'CsConnection.OnServerXfr',String.concat('XFRed: ',$3[0],' MPOP transfer: ',$1,' Cache FQDN: ',$2));this.$1_2.onTransferred($3[0],$p0[5],$1,$2);}else{}},$1_16:function($p0,$p1){var $0=this.$1_17($p0,$p1);if($0!=null){$0.onComplete(0,$p1);}},$1_17:function($p0,$p1){if($p1.length<1){this.$1_19($p0,$p1);return null;}var $0=MSP.P$4.$4($p1[0]);return this.getPendingCommand($0);},$1_18:function($p0,$p1,$p2){var $0=this.getPendingCommand($p1);MSH.Logger.logWarning(this.get_logContext(),'CsConnection.OnServerError','Error: '+$p0+' '+$p2);if($0!=null){var $1=$p0;if($1===511){$1=500;if(!String.isNullOrEmpty($p2)){var $2='<msnp>';var $3=$p2.indexOf($2);if($3>=0){$3+=$2.length;var $4=$p2.indexOf('</msnp>',$3);if($4>=0){var $5=MSH.StringHelper.substring($p2,$3,$4-$3);$1=MSH.ConvertHelper.parseInt($5);}}}}$0.onComplete($1,$p2);}},$1_19:function($p0,$p1){MSH.Logger.logError(this.get_logContext(),'CsConnection.OnUnexpectedArgument',String.format('{0}: Unexpected number of arguments: {1}',$p0,$p1.length));},$1_1A:function($p0){$p0=MSP.P$4.$7($p0);var $0=MSH.XmlHelper.parseXmlDocument($p0);var $1=$0.documentElement;var $2;if($1==null){MSH.Logger.logWarning(this.get_logContext(),'CsConnection.OnAlert','OnAlert: Received invalid notification XML. Ignoring.');return;}if(!MSH.XmlHelper.isElement($1,'NOTIFICATION')){return;}$2=this.$1_1C($1);switch($2){case 3:case 4:case 5:case 1:break;case 2:this.$1_2.onSubscribeNotificationReceived();break;case 6:this.$1_1B($1,$2);break;}},$1_1B:function($p0,$p1){var $0=MSH.XmlHelper.selectSingleNode($p0,'FROM');var $1=MSH.XmlHelper.selectSingleNode($p0,'TO');var $2=MSH.XmlHelper.selectSingleNode($p0,'MSG/SUBSCR');var $3=MSH.XmlHelper.selectSingleNode($p0,'MSG/ACTION');var $4=MSH.XmlHelper.selectSingleNode($p0,'MSG/BODY/TEXT');var $5=MSH.XmlHelper.selectSingleNode($p0,'MSG/BODY');if($1==null||$2==null||$3==null||$5==null||$4==null){return;}var $6=MSH.XmlHelper.getAttribute($p0,'siteurl');var $7=($0!=null)?MSH.XmlHelper.getAttribute($0,'name'):String.Empty;var $8=($0!=null)?MSH.XmlHelper.getAttribute($0,'displayName'):String.Empty;var $9=MSH.XmlHelper.getAttribute($1,'name');var $A=this.$1_1D(MSH.XmlHelper.getAttribute($2,'url'),$6);var $B=this.$1_1D(MSH.XmlHelper.getAttribute($3,'url'),$6);var $C=this.$1_1D(MSH.XmlHelper.getAttribute($5,'icon'),$6);var $D=MSH.XmlHelper.getAttribute($5,'lang');var $E=$4.text;var $F=MC.$create_AlertInfo($7,$8,$9,$6,$A,$B,$C,$D,$E,Date.get_now(),$p1,false);this.$1_2.onAlertNotificationReceived($F);},$1_1C:function($p0){var $0='1236';var $1='111100110';var $2=MSH.XmlHelper.getAttribute($p0,'siteid')||String.Empty;var $3=MSH.XmlHelper.getAttribute($p0,'siteurl')||String.Empty;if($3.endsWith('contacts.msn.com')||$3.endsWith('contacts.msn-int.com')){return 2;}else if($3.endsWith('sup.live.com')||$3.endsWith('sup.live-int.com')){return 3;}else if($3.endsWith('storage.live.com')||$3.endsWith('storage.live-int.com')){return 4;}else if($2===$1&&MSP.P$4.$5($3)==='isp.messenger.msn.com'){return 5;}else if($2===$0){return 1;}else{return 6;}},$1_1D:function($p0,$p1){if(String.isNullOrEmpty($p0)){return $p0;}if($p0.startsWith('http://')||$p0.startsWith('https://')||$p0.startsWith('ftp://')){return $p0;}if(MSH.StringHelper.charAt($p0,0)==='/'){$p0=$p1+$p0;}else{$p0=$p1+'/'+$p0;}return $p0;},$1_1E:function($p0,$p1,$p2,$p3,$p4){return this.$1_2F('ADL',$p0,$p1,null,$p2,$p3,$p4);},$1_1F:function($p0,$p1){return this.$1_2F('ADL',false,null,$p0,2|1,1,$p1);},$1_20:function($p0,$p1,$p2,$p3,$p4){$p2=$p2||'0';$p3=$p3||'0';this.sendCommand(['CVR',this.get_nextTrid(),'0x0409','winnt','5.2','i386',MSCo.Configuration.get_clientId(),MSCo.Configuration.get_clientVersion(),MSH.UriHelper.messengerEncode($p1),MSH.UriHelper.messengerEncode($p0),$p2,MSH.UriHelper.messengerEncode($p3)],$p4);},$1_21:function($p0,$p1){this.sendCommand(['FSL',this.get_nextTrid(),$p0,'0'],$p1);},$1_22:function($p0,$p1){this.sendCommand(['DEL',this.get_nextTrid(),$p0],$p1);},$1_23:function($p0){this.$1_6=this.get_nextTrid();this.sendCommand(['OUT',this.$1_6],$p0);},$1_24:function($p0,$p1){this.sendCommand(['PUT',this.get_nextTrid(),$p0],$p1);},$1_25:function($p0,$p1){this.sendCommand(['QRY',this.get_nextTrid(),$p0,$p1],null);},$1_26:function($p0,$p1,$p2,$p3){return this.$1_2F('RML',false,$p0,null,$p1,$p2,$p3);},$1_27:function($p0,$p1){return this.$1_2F('RML',false,null,$p0,2|1,1,$p1);},$1_28:function($p0,$p1){this.sendCommand(['SDG',this.get_nextTrid(),$p0],$p1);},$1_29:function($p0,$p1){this.sendCommand(['USR',this.get_nextTrid(),'TWN','I',MSH.UriHelper.messengerEncode($p0)],$p1);},$1_2A:function($p0,$p1,$p2){this.sendCommand(['USR',this.get_nextTrid(),'TWN','S',MSH.UriHelper.messengerEncode($p0),$p1],$p2);},$1_2B:function($p0,$p1,$p2,$p3,$p4){this.sendCommand(['USR',this.get_nextTrid(),'DAT',String.format('11:{0};appid={1}',$p1,$p0),$p2,$p3],$p4);},$1_2C:function($p0,$p1,$p2){this.sendCommand(['USR',this.get_nextTrid(),'SHA','D',MSP.P$A.$2($p0,$p1)],$p2);},$1_2D:function($p0,$p1){this.sendCommand(['USR',this.get_nextTrid(),'WEB',$p0],$p1);},$1_2E:function($p0){this.sendCommand(['VER',this.get_nextTrid(),MSH.StringHelper.join(MSP.P$25.$1_0)],$p0);},$1_2F:function($p0,$p1,$p2,$p3,$p4,$p5,$p6){if($p4!==0){var $0=($p1)?1:0;var $1=new MSP.P$7($0,$p2,$p3,$p4,$p5).$25();for(var $2=0;$2<$1.length;$2++){this.sendCommand([$p0,this.get_nextTrid(),$1[$2]],$p6);}return $1.length;}return 0;},onDisconnected:function($p0,$p1){if(this.$1_5){return;}this.$1_5=true;if(this.$1_6!==0){var $3=this.getPendingCommand(this.$1_6);if($3!=null){$3.onComplete(0,null);return;}}MSH.Logger.logWarning(this.get_logContext(),'CsConnection.OnDisconnected',String.format('Disconnected due to error code {0}',$p0));var $0;var $1;var $2=-1;switch($p0){case 0:if($p1){$0=0;$1=3;$2=0;}else{$0=0;$1=2;}break;case 400:$0=1;$1=2;$2=0;break;default:$0=1;$1=2;break;}this.$1_2.onDisconnected($0,$1,$2);},onCommandReceived:function($p0){var $0=$p0.get_allParameters();switch($p0.get_name()){case'CVR':case'QRY':case'FSL':this.$1_16($p0.get_name(),$0);break;case'ADL':this.$1_9($0);break;case'CHL':this.$1_A($0);break;case'DEL':this.$1_B($0);break;case'MSG':this.$1_C($0);break;case'NFY':this.$1_D($0);break;case'NOT':this.$1_E($0);break;case'OUT':this.$1_F($0);break;case'PUT':this.$1_10($0);break;case'RML':this.$1_11($0);break;case'SDG':this.$1_12($0);break;case'USR':this.$1_13($0);break;case'VER':this.$1_14($0);break;case'XFR':this.$1_15($0);break;case'SBS':break;default:var $1=MSH.ConvertHelper.tryParseInt($p0.get_name());if($1<0){MSH.Logger.logInfo(this.get_logContext(),'CsConnection.OnCommandReceived','Received unknown command: '+$p0+' '+MSH.StringHelper.join($0));return;}var $2=MSP.P$4.$4($0[0]);this.$1_18($1,$2,($0.length>1)?$0[1]:null);break;}},onSessionChanged:function($p0,$p1){if($p1!=null){this.$1_4.server=$p1;}if($p0!=null){this.$1_4.sessionToken=$p0;if(this.$1_2!=null){this.$1_2.onSessionIdChanged($p0);}}},onTridChanged:function($p0){this.$1_4.transactionID=$p0;if(this.$1_2!=null){this.$1_2.onTridChanged($p0);}}}
MSP.P$6=function(){}
MSP.P$6.$0=function($p0){switch($p0){case 3:case 0:return 2|4|1|8;}return 0;}
MSP.P$6.$1=function($p0){switch($p0){case 2:case 3:case 0:return 2|1|8;}return 0;}
MSP.P$6.$2=function($p0){switch($p0){case 2:case 3:case 0:return 2|4|1|8;}return 0;}
MSP.P$6.$3=function($p0){var $0=2|4|64;switch($p0){case 2:return $0|1;case 3:case 0:return $0|32|1;}return $0;}
MSP.P$5=function(cxnService){this.$0=cxnService;}
MSP.P$5.prototype={$0:null,get_$1:function(){return this.$0;},$2:function($p0){this.$16($p0);},$3:function($p0){this.$16($p0);},$4:function($p0,$p1,$p2,$p3,$p4){this.$16($p2);this.$16($p3);this.$16($p4);},$5:function($p0){this.$16($p0);},$6:function($p0){this.$16($p0);},$7:function($p0){this.$16($p0);},$8:function($p0){this.$16($p0);},$9:function($p0){this.$16($p0);},$A:function($p0){this.$16($p0);},$B:function($p0){this.$16($p0);},$C:function($p0){this.$16($p0);},$D:function($p0){this.$16($p0);},$E:function($p0){this.$16($p0);},$F:function($p0){this.$16($p0);},$10:function($p0){this.$16($p0);},$11:function($p0){this.$16($p0);},$12:function($p0){this.$16($p0);},$13:function($p0){this.$16($p0);},$14:function($p0){this.$16($p0);},$15:function($p0){this.$16($p0);},$16:function($p0){}}
MSP.P$23=function(service){MSP.P$23.initializeBase(this,[service]);service.setTransferServer(null,null,false);this.$17={};}
MSP.P$23.prototype={$17:null,$5:function($p0){if($p0.get_$1A()){this.get_$1().$C(new MSP.P$12(this.get_$1(),$p0));}this.get_$1().$B($p0);},$6:function($p0){this.get_$1().$B($p0);},$7:function($p0){this.get_$1().$B($p0);},$8:function($p0){this.get_$1().$B($p0);},$A:function($p0){this.get_$1().$B($p0);},$E:function($p0){if(!this.$1A($p0,$p0.get_$C())){this.get_$1().$B($p0);}},$F:function($p0){if(!this.$1A($p0,$p0.get_$C())){this.get_$1().$B($p0);}},$12:function($p0){this.get_$1().$B($p0);},$15:function($p0){this.get_$1().$B($p0);},$14:function($p0){this.get_$1().$B($p0);},$13:function($p0){this.get_$1().$B($p0);},$9:function($p0){this.get_$1().$B($p0);},$B:function($p0){this.get_$1().$B($p0);},$C:function($p0){this.$18($p0);this.get_$1().$B($p0);},$D:function($p0){this.get_$1().$B($p0);},$3:function($p0){this.get_$1().$B($p0);},$10:function($p0){this.get_$1().$C(new MSP.P$1B(this.get_$1()));this.get_$1().$B($p0);},$11:function($p0){this.get_$1().$C(new MSP.P$1B(this.get_$1()));this.get_$1().$B($p0);},$18:function($p0){if($p0.get_$1C()){var $enum1=ss.IEnumerator.getEnumerator($p0.get_$1A());while($enum1.moveNext()){var $0=$enum1.get_current();var $1=MSH.ContactHelper.getIMAddressInfoKey($0);if(!Object.keyExists(this.$17,$1)){this.$17[$1]=[];}}$p0.add_$7(ss.Delegate.create(this,this.$19));}},$19:function($p0,$p1){var $0=$p0;var $enum1=ss.IEnumerator.getEnumerator($0.get_$1A());while($enum1.moveNext()){var $1=$enum1.get_current();var $2=MSH.ContactHelper.getIMAddressInfoKey($1);if(Object.keyExists(this.$17,$2)){if($0.get_$1B()){var $3=this.$17[$2];while($3.length>0){this.get_$1().$B($3.dequeue());}}delete this.$17[$2];}}$0.remove_$7(ss.Delegate.create(this,this.$19));},$1A:function($p0,$p1){var $0=MSH.ContactHelper.getIMAddressInfoKey($p1);if(Object.keyExists(this.$17,$0)){var $1=this.$17[$0];$1.enqueue($p0);return true;}else{return false;}}}
MSP.P$24=function(service){this.$1E=[];MSP.P$24.initializeBase(this,[service]);}
MSP.P$24.prototype={$17:null,$18:null,$19:null,$1A:false,$1B:false,$1C:false,$1D:false,$1F:false,$20:null,$21:null,$22:0,$4:function($p0,$p1,$p2,$p3,$p4){this.$19=$p1;this.$17=$p3;this.$18=$p2;this.$20=$p4;this.$21=this.$17.get_$11();this.$22=$p0;this.$23();if($p0===1){this.$28(0);}else{this.$24();this.$25();}},$5:function($p0){if($p0.get_$1A()){this.get_$1().$C(new MSP.P$12(this.get_$1(),$p0));}this.get_$1().$B($p0);},$E:function($p0){if(this.$21==null){this.$1E.enqueue($p0);}else{if(!MSH.ContactHelper.areIMAddressesEqual($p0.get_$C(),this.$17.get_$10())){this.$1E.enqueue($p0);}else{this.$21.updateAll($p0.get_$D().toArray());this.$1B=true;this.$25();}}},$F:function($p0){if(this.$21==null){this.$1E.enqueue($p0);}else{if(!MSH.ContactHelper.areIMAddressesEqual($p0.get_$C(),this.$17.get_$10())){this.$1E.enqueue($p0);}else{this.$21.deleteAll($p0.get_$D().toArray());}}},$15:function($p0){this.$1E.enqueue($p0);},$13:function($p0){this.$1E.enqueue($p0);},$14:function($p0){this.$1E.enqueue($p0);},$12:function($p0){this.$1E.enqueue($p0);},$10:function($p0){this.get_$1().$C(new MSP.P$1B(this.get_$1()));this.get_$1().$B($p0);},$11:function($p0){this.get_$1().$C(new MSP.P$1B(this.get_$1()));this.get_$1().$B($p0);},$23:function(){if(this.$1E.length>0){var $0=this.$1E;this.$1E=[];var $1=$0.length;for(var $2=0;$2<$1;$2++){var $3=$0.dequeue();if(Type.canCast($3,MSP.P$13)){this.$E($3);}else if(Type.canCast($3,MSP.P$22)){this.$F($3);}else{this.$1E.enqueue($3);}}}this.$1F=true;},$24:function(){if(!this.$1D){this.$1D=true;this.get_$1().$B(this.$18);this.get_$1().$B(this.$19);this.$27(0);}},$25:function(){if(!this.$1A){if(this.$1F&&this.$1B){this.$1A=true;this.$17.add_$7(ss.Delegate.create(this,this.$26));this.get_$1().$B(this.$17);}}},$26:function($p0,$p1){this.$1C=true;this.$17.remove_$7(ss.Delegate.create(this,this.$26));this.$27(this.$17.get_$12());},$27:function($p0){if(($p0!==0)||(this.$1D&&this.$1C)){this.$28($p0);}},$28:function($p0){if($p0===0){this.get_$1().$C(new MSP.P$23(this.get_$1()));}else{this.get_$1().$C(new MSP.P$1B(this.get_$1()));}this.$20.$E($p0,this.$17.get_$10(),this.$21);this.get_$1().$B(this.$20);if($p0===0){var $0=this.$1E.length;for(var $1=0;$1<$0;$1++){this.get_$1().$B(this.$1E.dequeue());}this.get_$1().onSignInEventsEmpty();}}}
MSP.P$1B=function(service){MSP.P$1B.initializeBase(this,[service]);}
MSP.P$1B.prototype={$2:function($p0){this.get_$1().$C(new MSP.P$24(this.get_$1()));this.get_$1().$B($p0);}}
MSP.P$12=function(service,signOutCommand){MSP.P$12.initializeBase(this,[service]);this.$17=signOutCommand;}
MSP.P$12.prototype={$17:null,$11:function($p0){this.get_$1().$C(new MSP.P$1B(this.get_$1()));this.$17.$5();}}
MSP.P$0=function(){};MSP.P$0.prototype={$0:0,$1:1}
MSP.P$0.registerEnum('MSP.P$0',false);MSP.ServiceDataDocumentType=function(){};MSP.ServiceDataDocumentType.prototype={put:0,del:1}
MSP.ServiceDataDocumentType.registerEnum('MSP.ServiceDataDocumentType',false);MSP.P$3=function(payload){this.$0=payload;}
MSP.P$3.prototype={$0:null,$1:null,$2:false,$3:false,get_$4:function(){return this.$1;},$5:function(){if(this.$2){return this.$3;}var $0=MSH.XmlHelper.parseXmlDocument(this.$0);var $1=$0.documentElement;if($1==null){return this.$6('Parse: Invalid XML');}if(!MSH.XmlHelper.isElement($1,'ml')){return this.$6(String.format('Parse: Unknown root node {0}',$1.nodeName));}var $2=MSH.XmlHelper.selectSingleNode($1,'d');if($2==null){return this.$6('Parse: Missing d element.');}var $3=MSH.XmlHelper.selectSingleNode($2,'c');if($3==null){return this.$6('Parse: Missing c element.');}var $4=MSH.XmlHelper.getAttribute($3,'n');var $5=MSH.XmlHelper.getAttribute($2,'n');if(($4==null)||($5==null)){return this.$6('Parse: Invalid user handle.');}var $6=String.format('{0}@{1}',$4,$5);var $7=0;var $8=MSH.XmlHelper.getAttribute($3,'t');if($8!=null){$7=MSP.P$A.$0($8);}var $9=0;var $A=MSH.XmlHelper.getAttribute($3,'l');if($A!=null){$9=MSP.P$A.$1($A);}this.$1=MC.$create_IMAddressInfo(MSH.UriHelper.decode($6),$7,$9);return this.$7();},$6:function($p0){this.$2=true;this.$3=false;return this.$3;},$7:function(){this.$2=true;this.$3=true;return this.$3;}}
MSP.P$7=function(listType,addresses,networkIds,services,listsToPublish){this.$6={};this.$7=[];this.$8=[];this.$9=[];this.$A=new ss.StringBuilder();this.$0=MC.ServiceDataHelper.allServices;this.$1=listType;this.$2=addresses;this.$3=networkIds;this.$4=services;this.$5=listsToPublish;}
MSP.P$7.prototype={$0:null,$1:0,$2:null,$3:null,$4:0,$5:0,$B:0,$C:false,$E:function(){var $0=false;if(this.$3!=null){$0=true;}if(this.$2!=null){for(var $1=0;$1<this.$2.length;$1++){var $2=this.$2[$1];var $3=this.$12($2.roleLists,0);if($3===0){}else if($2.type===13){}else if($2.type===4){$0=true;this.$8.add($2);}else{$0=true;var $4=this.$10($2.address);if($4!==''){$4=MSH.XmlHelper.xmlEscape($4);if(this.$6[$4]==null){this.$6[$4]=[];}var $5=this.$6[$4];$5.add($2);}else if(this.$F($2)){this.$7.add($2);}}}}return $0;},$F:function($p0){return($p0.type===11);},$10:function($p0){var $0=$p0.indexOf('@');if($0!==-1){return MSH.StringHelper.substringToEnd($p0,$0+1);}return'';},$11:function($p0){var $0=$p0.indexOf('@');if($0!==-1){return $p0.substring(0,$0);}return'';},$12:function($p0,$p1){$p0=$p0&(2|1|4|64|32)&this.$5;if(($p0&(2|4))===(2|4)){$p0&=~2;}$p0&=~4;if($p1!==2&&$p1!==0){$p0&=~64;}return $p0;},$13:function($p0){this.$A.append($p0);this.$B+=$p0.length;},$14:function(){if(this.$1===1){this.$13('<ml l=\"1\">');}else{this.$13('<ml>');}},$15:function($p0){this.$13('</ml>');var $0=this.$A.toString();if(this.$1===1&&!$p0){$0=MSP.P$4.$2($0,'^<ml l=\"1\">','<ml l=\"0\">');}this.$9.add($0);this.$A=new ss.StringBuilder();this.$B=0;},$16:function($p0){this.$13(String.format('<d n=\"{0}\">',$p0));},$17:function(){this.$13('</d>');},$18:function($p0){this.$13(String.format('<c n=\"{0}\" ',MSH.XmlHelper.xmlEscape(this.$11($p0.address))));this.$13(String.format('t=\"{0}\">',$p0.type));this.$19($p0.roleLists);this.$13('</c>');},$19:function($p0){for(var $0=0;$0<this.$0.length;$0++){if(this.$1B(this.$0[$0])){var $1=this.$12($p0,this.$0[$0]);if($1!==0){this.$1A($1,MC.ServiceDataHelper.formatServiceType(this.$0[$0]));}}}},$1A:function($p0,$p1){this.$13(String.format('<s l=\"{0}\" n=\"{1}\"/>',$p0,$p1));},$1B:function($p0){return($p0&this.$4)===$p0;},$1C:function(){this.$13('<n>');},$1D:function(){this.$13('</n>');},$1E:function(){this.$13('<t>');},$1F:function(){this.$13('</t>');},$20:function(){this.$13('<cids>');},$21:function(){this.$13('</cids>');},$22:function($p0){this.$13(String.format('<c n=\"{0}\">',$p0.cid));this.$19($p0.roleLists);this.$13('</c>');},$23:function($p0){this.$13(String.format('<c n=\"{0}\">',MSH.XmlHelper.xmlEscape($p0)));this.$19(this.$5);this.$13('</c>');},$24:function($p0){this.$13(String.format('<c n=\"tel:{0}\">',MSH.XmlHelper.xmlEscape($p0.address)));this.$19($p0.roleLists);this.$13('</c>');},$25:function(){if(this.$C){return MSH.StringHelper.listToArray(this.$9);}if(!this.$E()&&this.$1!==1){return MSH.StringHelper.listToArray(this.$9);}this.$14();var $dict1=this.$6;for(var $key2 in $dict1){var $0={key:$key2,value:$dict1[$key2]};this.$16($0.key);var $1=$0.value;for(var $2=0;$2<$1.length;$2++){var $3=($2===$1.length-1);this.$18($1[$2]);if(this.$B>MSP.P$7.$D){this.$17();this.$15(false);this.$14();if(!$3){this.$16($0.key);}}else if($3){this.$17();}}}if(this.$7.length>0){this.$20();for(var $4=0;$4<this.$7.length;$4++){var $5=($4===this.$7.length-1);this.$22(this.$7[$4]);if(this.$B>MSP.P$7.$D){this.$21();this.$15(false);this.$14();if(!$5){this.$20();}}else if($5){this.$21();}}}if(this.$8.length>0){this.$1E();for(var $6=0;$6<this.$8.length;$6++){var $7=($6===this.$8.length-1);this.$24(this.$8[$6]);if(this.$B>MSP.P$7.$D){this.$1F();this.$15(false);this.$14();if(!$7){this.$1E();}}else if($7){this.$1F();}}}if(this.$3!=null){this.$1C();for(var $8=0;$8<this.$3.length;$8++){var $9=($8===this.$3.length-1);this.$23(this.$3[$8]);if(this.$B>MSP.P$7.$D){this.$1D();this.$15(false);this.$14();if(!$9){this.$1C();}}else if($9){this.$1D();}}}this.$15(true);this.$C=true;return MSH.StringHelper.listToArray(this.$9);}}
MSP.P$B=function(message){this.$0=message;}
MSP.P$B.$4=function($p0){if(String.isNullOrEmpty($p0)){return 6;}switch(MSH.StringHelper.toLowerCase($p0)){case'active':return 0;case'saved':return 3;case'draft':return 4;case'trash':return 1;case'hm_bulkmail_':return 2;case'00000000-0000-0000-0000-000000000006':case'00000000-0000-0000-0000-000000000007':case'00000000-0000-0000-0000-000000000008':case'00000000-0000-0000-0000-000000000009':return 6;default:return 5;}}
MSP.P$B.prototype={$0:null,$1:null,get_$2:function(){return this.$1;},$3:function(){var $0=new MSM.MimeParser(this.$0.getBody());var $1=MSH.StringHelper.splitChar(this.$0.getHeader('Content-Type'),';')[0];switch($1){case'text/x-msmsgsinitialmdatanotification':var $2=MSH.XmlHelper.parseXmlDocument($0.getHeader('Mail-Data'));var $3=(($2!=null)?$2.documentElement:null);if($3==null){MSH.Logger.logError(MC.LogContext.get_global(),'Presence.MailNotificationParser.Parse','Unable to parse mail data: '+$0.getHeader('Mail-Data'));return false;}var $4=MSH.XmlHelper.selectSingleNode($3,'E');if($4==null){return false;}var $5=['IU','I','OU','O'];var $6=[0,0,0,0];for(var $7=0;$7<$5.length;$7++){var $8=MSH.XmlHelper.selectSingleNode($4,$5[$7]);if($8!=null){var $9=MSH.XmlHelper.xmlNodeValue($8.firstChild);if($9!=null){$6[$7]=MSH.ConvertHelper.parseInt($9);}}}this.$1=[MC.$create_MailNotificationInfo(MC.$create_MailNotificationInitialInfo($6[0],$6[1],$6[2],$6[3]),0)];return true;case'text/x-msmsgsemailnotification':var $A=MSP.P$B.$4($0.getHeader('Dest-Folder'));this.$1=[MC.$create_MailNotificationInfo(MC.$create_MailNotificationIncomingInfo($0.getHeader('From'),$0.getHeader('From-Addr'),$0.getHeader('Message-URL'),$0.getHeader('Subject'),$A,$0.getHeader('id')),1),MC.$create_MailNotificationInfo(MC.$create_MailNotificationActivityInfo($A,$A,-1),2)];return true;case'text/x-msmsgsactivemailnotification':this.$1=[MC.$create_MailNotificationInfo(MC.$create_MailNotificationActivityInfo(MSP.P$B.$4($0.getHeader('Src-Folder')),MSP.P$B.$4($0.getHeader('Dest-Folder')),MSH.ConvertHelper.parseInt($0.getHeader('Message-Delta'))),2)];return true;}return false;}}
MSP.P$C=function(){this.$12=[0,0,0,0];this.$13=[0,0];this.$14=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.$15();}
MSP.P$C.f=function($p0,$p1,$p2){return(($p0&$p1)|((~$p0)&$p2));}
MSP.P$C.g=function($p0,$p1,$p2){return(($p0&$p2)|($p1&(~$p2)));}
MSP.P$C.h=function($p0,$p1,$p2){return($p0^$p1^$p2);}
MSP.P$C.i=function($p0,$p1,$p2){return($p1^($p0|(~$p2)));}
MSP.P$C.$11=function($p0,$p1){return(($p0<<$p1)|($p0>>>(32-$p1)));}
MSP.P$C.FF=function($p0,$p1,$p2,$p3,$p4,$p5,$p6){$p0+=MSP.P$C.f($p1,$p2,$p3)+$p4+$p6;$p0=MSP.P$C.$11($p0,$p5);$p0+=$p1;return $p0;}
MSP.P$C.GG=function($p0,$p1,$p2,$p3,$p4,$p5,$p6){$p0+=MSP.P$C.g($p1,$p2,$p3)+$p4+$p6;$p0=MSP.P$C.$11($p0,$p5);$p0+=$p1;return $p0;}
MSP.P$C.HH=function($p0,$p1,$p2,$p3,$p4,$p5,$p6){$p0+=MSP.P$C.h($p1,$p2,$p3)+$p4+$p6;$p0=MSP.P$C.$11($p0,$p5);$p0+=$p1;return $p0;}
MSP.P$C.II=function($p0,$p1,$p2,$p3,$p4,$p5,$p6){$p0+=MSP.P$C.i($p1,$p2,$p3)+$p4+$p6;$p0=MSP.P$C.$11($p0,$p5);$p0+=$p1;return $p0;}
MSP.P$C.$1B=function($p0,$p1,$p2,$p3,$p4){for(var $0=0;$0<$p4;$0++){$p2[$p3+$0]=$p0[$p1+$0];}}
MSP.P$C.prototype={$15:function(){this.$13[0]=this.$13[1]=0;this.$12[0]=1732584193;this.$12[1]=4023233417;this.$12[2]=2562383102;this.$12[3]=271733878;},$16:function($p0,$p1,$p2){var $0;var $1;var $2;$1=((this.$13[0]>>>3)&63);if((this.$13[0]+=($p2<<3))<($p2<<3)){this.$13[1]++;}this.$13[1]+=($p2>>>29);$2=64-$1;if($p2>=$2){MSP.P$C.$1B($p0,$p1,this.$14,$1,$2);this.$18(this.$14,0);for($0=$2;$0+63<$p2;$0+=64){this.$18($p0,$p1+$0);}$1=0;}else{$0=0;}MSP.P$C.$1B($p0,$p1+$0,this.$14,$1,$p2-$0);},$17:function(){var $0=new Array(16);var $1=new Array(8);var $2,$3;this.$19($1,0,this.$13,0,8);$2=((this.$13[0]>>>3)&63);$3=($2<56)?(56-$2):(120-$2);this.$16(MSP.P$C.$10,0,$3);this.$16($1,0,8);this.$19($0,0,this.$12,0,16);this.$13[0]=this.$13[1]=0;this.$12[0]=0;this.$12[1]=0;this.$12[2]=0;this.$12[3]=0;this.$15();return $0;},$18:function($p0,$p1){var $0=this.$12[0],$1=this.$12[1],$2=this.$12[2],$3=this.$12[3];var $4=new Array(16);this.$1A($4,0,$p0,$p1,64);$0=MSP.P$C.FF($0,$1,$2,$3,$4[0],7,3614090360);$3=MSP.P$C.FF($3,$0,$1,$2,$4[1],12,3905402710);$2=MSP.P$C.FF($2,$3,$0,$1,$4[2],17,606105819);$1=MSP.P$C.FF($1,$2,$3,$0,$4[3],22,3250441966);$0=MSP.P$C.FF($0,$1,$2,$3,$4[4],7,4118548399);$3=MSP.P$C.FF($3,$0,$1,$2,$4[5],12,1200080426);$2=MSP.P$C.FF($2,$3,$0,$1,$4[6],17,2821735955);$1=MSP.P$C.FF($1,$2,$3,$0,$4[7],22,4249261313);$0=MSP.P$C.FF($0,$1,$2,$3,$4[8],7,1770035416);$3=MSP.P$C.FF($3,$0,$1,$2,$4[9],12,2336552879);$2=MSP.P$C.FF($2,$3,$0,$1,$4[10],17,4294925233);$1=MSP.P$C.FF($1,$2,$3,$0,$4[11],22,2304563134);$0=MSP.P$C.FF($0,$1,$2,$3,$4[12],7,1804603682);$3=MSP.P$C.FF($3,$0,$1,$2,$4[13],12,4254626195);$2=MSP.P$C.FF($2,$3,$0,$1,$4[14],17,2792965006);$1=MSP.P$C.FF($1,$2,$3,$0,$4[15],22,1236535329);$0=MSP.P$C.GG($0,$1,$2,$3,$4[1],5,4129170786);$3=MSP.P$C.GG($3,$0,$1,$2,$4[6],9,3225465664);$2=MSP.P$C.GG($2,$3,$0,$1,$4[11],14,643717713);$1=MSP.P$C.GG($1,$2,$3,$0,$4[0],20,3921069994);$0=MSP.P$C.GG($0,$1,$2,$3,$4[5],5,3593408605);$3=MSP.P$C.GG($3,$0,$1,$2,$4[10],9,38016083);$2=MSP.P$C.GG($2,$3,$0,$1,$4[15],14,3634488961);$1=MSP.P$C.GG($1,$2,$3,$0,$4[4],20,3889429448);$0=MSP.P$C.GG($0,$1,$2,$3,$4[9],5,568446438);$3=MSP.P$C.GG($3,$0,$1,$2,$4[14],9,3275163606);$2=MSP.P$C.GG($2,$3,$0,$1,$4[3],14,4107603335);$1=MSP.P$C.GG($1,$2,$3,$0,$4[8],20,1163531501);$0=MSP.P$C.GG($0,$1,$2,$3,$4[13],5,2850285829);$3=MSP.P$C.GG($3,$0,$1,$2,$4[2],9,4243563512);$2=MSP.P$C.GG($2,$3,$0,$1,$4[7],14,1735328473);$1=MSP.P$C.GG($1,$2,$3,$0,$4[12],20,2368359562);$0=MSP.P$C.HH($0,$1,$2,$3,$4[5],4,4294588738);$3=MSP.P$C.HH($3,$0,$1,$2,$4[8],11,2272392833);$2=MSP.P$C.HH($2,$3,$0,$1,$4[11],16,1839030562);$1=MSP.P$C.HH($1,$2,$3,$0,$4[14],23,4259657740);$0=MSP.P$C.HH($0,$1,$2,$3,$4[1],4,2763975236);$3=MSP.P$C.HH($3,$0,$1,$2,$4[4],11,1272893353);$2=MSP.P$C.HH($2,$3,$0,$1,$4[7],16,4139469664);$1=MSP.P$C.HH($1,$2,$3,$0,$4[10],23,3200236656);$0=MSP.P$C.HH($0,$1,$2,$3,$4[13],4,681279174);$3=MSP.P$C.HH($3,$0,$1,$2,$4[0],11,3936430074);$2=MSP.P$C.HH($2,$3,$0,$1,$4[3],16,3572445317);$1=MSP.P$C.HH($1,$2,$3,$0,$4[6],23,76029189);$0=MSP.P$C.HH($0,$1,$2,$3,$4[9],4,3654602809);$3=MSP.P$C.HH($3,$0,$1,$2,$4[12],11,3873151461);$2=MSP.P$C.HH($2,$3,$0,$1,$4[15],16,530742520);$1=MSP.P$C.HH($1,$2,$3,$0,$4[2],23,3299628645);$0=MSP.P$C.II($0,$1,$2,$3,$4[0],6,4096336452);$3=MSP.P$C.II($3,$0,$1,$2,$4[7],10,1126891415);$2=MSP.P$C.II($2,$3,$0,$1,$4[14],15,2878612391);$1=MSP.P$C.II($1,$2,$3,$0,$4[5],21,4237533241);$0=MSP.P$C.II($0,$1,$2,$3,$4[12],6,1700485571);$3=MSP.P$C.II($3,$0,$1,$2,$4[3],10,2399980690);$2=MSP.P$C.II($2,$3,$0,$1,$4[10],15,4293915773);$1=MSP.P$C.II($1,$2,$3,$0,$4[1],21,2240044497);$0=MSP.P$C.II($0,$1,$2,$3,$4[8],6,1873313359);$3=MSP.P$C.II($3,$0,$1,$2,$4[15],10,4264355552);$2=MSP.P$C.II($2,$3,$0,$1,$4[6],15,2734768916);$1=MSP.P$C.II($1,$2,$3,$0,$4[13],21,1309151649);$0=MSP.P$C.II($0,$1,$2,$3,$4[4],6,4149444226);$3=MSP.P$C.II($3,$0,$1,$2,$4[11],10,3174756917);$2=MSP.P$C.II($2,$3,$0,$1,$4[2],15,718787259);$1=MSP.P$C.II($1,$2,$3,$0,$4[9],21,3951481745);this.$12[0]+=$0;this.$12[1]+=$1;this.$12[2]+=$2;this.$12[3]+=$3;for(var $5=0;$5<$4.length;$5++){$4[$5]=0;}},$19:function($p0,$p1,$p2,$p3,$p4){var $0=$p1+$p4;for(var $1=$p3,$2=$p1;$2<$0;$1++,$2+=4){$p0[$2]=($p2[$1]&255);$p0[$2+1]=(($p2[$1]>>>8)&255);$p0[$2+2]=(($p2[$1]>>>16)&255);$p0[$2+3]=(($p2[$1]>>>24)&255);}},$1A:function($p0,$p1,$p2,$p3,$p4){var $0=$p3+$p4;for(var $1=$p1,$2=$p3;$2<$0;$1++,$2+=4){$p0[$1]=($p2[$2])|(($p2[$2+1])<<8)|(($p2[$2+2])<<16)|(($p2[$2+3])<<24);}},$1C:function($p0){var $0=new Array($p0.length);for(var $4=0;$4<$p0.length;$4++){$0[$4]=$p0.charCodeAt($4);}this.$16($0,0,$0.length);var $1=this.$17();var $2='0123456789abcdef';var $3=new ss.StringBuilder();for(var $5=0;$5<$1.length;$5++){$3.append(MSH.StringHelper.charAt($2,($1[$5]>>>4)&15));$3.append(MSH.StringHelper.charAt($2,$1[$5]&15));}return $3.toString();}}
MSP.P$D=function(){}
MSP.P$D.prototype={$0:function($p0){var $0='0123456789abcdef';var $1=new ss.StringBuilder();for(var $2=0;$2<=3;$2++){$1.append(MSH.StringHelper.charAt($0,($p0>>($2*8+4))&15));$1.append(MSH.StringHelper.charAt($0,($p0>>($2*8))&15));}return $1.toString();},$1:function($p0,$p1,$p2){var $0=$p0+$p1;var $1=$0;var $2=8-($1.length%8);if($2!==8){$1=$1.padRight($1.length+$2,'0');}var $3=$1.length/4;var $4=[];for(var $C=0,$D=0;$C<$3;$C++){$4.insert($C,0);$4[$C]=$4[$C]+MSH.StringHelper.charCodeAt($1,$D++)*1;$4[$C]=$4[$C]+MSH.StringHelper.charCodeAt($1,$D++)*256;$4[$C]=$4[$C]+MSH.StringHelper.charCodeAt($1,$D++)*65536;$4[$C]=$4[$C]+MSH.StringHelper.charCodeAt($1,$D++)*16777216;}var $5=new Array(4);var $6=MSP.P$4.$1($p0+$p2);for(var $E=0,$F=0;$E<$5.length;$E++){$5[$E]=0;$5[$E]+=MSH.ConvertHelper.parseHexInt(MSH.StringHelper.substring($6,$F,2))*1;$F+=2;$5[$E]+=MSH.ConvertHelper.parseHexInt(MSH.StringHelper.substring($6,$F,2))*256;$F+=2;$5[$E]+=MSH.ConvertHelper.parseHexInt(MSH.StringHelper.substring($6,$F,2))*65536;$F+=2;$5[$E]+=MSH.ConvertHelper.parseHexInt(MSH.StringHelper.substring($6,$F,2))*16777216;$F+=2;}var $7=new Array(2);this.$2($4,$5,$7);var $8=MSP.P$4.$3($5[0],$7[0]);var $9=MSP.P$4.$3($5[1],$7[1]);var $A=MSP.P$4.$3($5[2],$7[0]);var $B=MSP.P$4.$3($5[3],$7[1]);return this.$0($8)+this.$0($9)+this.$0($A)+this.$0($B);},$2:function($p0,$p1,$p2){var $0=2147483647;if(($p0.length<2)||(($p0.length&1)===1)){return false;}var $1=$p1[0]&$0;var $2=$p1[1]&$0;var $3=$p1[2]&$0;var $4=$p1[3]&$0;var $5=242854337;var $6=MSH.BigInt.parseDecInt(MSH.BigInt.decRadix,$1.toString());var $7=MSH.BigInt.parseDecInt(MSH.BigInt.decRadix,$2.toString());var $8=MSH.BigInt.parseDecInt(MSH.BigInt.decRadix,$3.toString());var $9=MSH.BigInt.parseDecInt(MSH.BigInt.decRadix,$4.toString());var $A=MSH.BigInt.parseDecInt(MSH.BigInt.decRadix,$5.toString());var $B=0;var $C=MSH.BigInt.parseDecInt(MSH.BigInt.decRadix,$0.toString());var $D=MSH.BigInt.parseDecInt(MSH.BigInt.decRadix,'0');var $E=MSH.BigInt.parseDecInt(MSH.BigInt.decRadix,'0');var $F=MSH.BigInt.parseDecInt(MSH.BigInt.decRadix,'0');for(var $10=0;$10<$p0.length/2;$10++){$D=MSH.BigInt.parseDecInt(MSH.BigInt.decRadix,$p0[$B++].toString());$D.multiply($A);$D.modulus($C);$E.add($D);$E.multiply($6);$E.add($7);$E.modulus($C);$F.add($E);$E.add(MSH.BigInt.parseDecInt(MSH.BigInt.decRadix,$p0[$B++].toString()));$E.multiply($8);$E.add($9);$E.modulus($C);$F.add($E);}$E.add($7);$E.modulus($C);$F.add($9);$F.modulus($C);$p2[0]=MSH.ConvertHelper.parseInt($E.toString());$p2[1]=MSH.ConvertHelper.parseInt($F.toString());return true;}}
MSP.P$A=function(){}
MSP.P$A.$0=function($p0){return MSH.ConvertHelper.parseInt($p0);}
MSP.P$A.$1=function($p0){return MSH.ConvertHelper.parseInt($p0);}
MSP.P$A.$2=function($p0,$p1){var $0=new ss.StringBuilder();$0.append('<SignedTicket ver=\"3\" keyVer=\"1\">');MSP.P$A.$3($0,'Data');$0.append(MSM.Base64.encode($p0));MSP.P$A.$4($0,'Data');MSP.P$A.$3($0,'Sig');$0.append($p1);MSP.P$A.$4($0,'Sig');MSP.P$A.$4($0,'SignedTicket');return MSM.Base64.encode($0.toString());}
MSP.P$A.$3=function($p0,$p1){$p0.append('<');$p0.append($p1);$p0.append('>');}
MSP.P$A.$4=function($p0,$p1){$p0.append('</');$p0.append($p1);$p0.append('>');}
MSP.P$8=function(message){this.$0=message;this.$6();}
MSP.P$8.prototype={$0:null,$1:0,$2:false,get_$3:function(){return this.$2;},get_$4:function(){return this.$0.get_routing().get_from().get_address();},get_$5:function(){return this.$1;},$6:function(){var $0=MSH.XmlHelper.parseXmlDocument((this.$0.get_content()).get_body());var $1=$0.documentElement;if($1==null||$1.nodeName!=='network'){MSH.Logger.logError(MC.LogContext.get_global(),'NetworkDataReader.Parse',String.format('Parse: Invalid XML {0}',this.$0.get_content()));return;}var $2=0;var $3=$1.selectSingleNode('status');if($3!=null){switch($3.text){case'SigningIn':$2=1;break;case'SignedIn':$2=2;break;case'SignedOut':$2=0;var $4=$1.selectSingleNode('details');if($4!=null){switch($4.text){case'AbnormalDisconnect':case'CredentialsFetchFailed':case'InternalServerError':$2=4;break;}}break;default:MSH.Logger.logError(MC.LogContext.get_global(),'NetworkDataReader.Parse',String.format('Invalid network status value {0}',this.$0.get_content()));return;}this.$1=$2;this.$2=true;}}}
MSP.P$9=function(configuration,sender,userLiveId,document){this.$6=configuration;this.$4=sender;this.$0=document;this.$5=(sender.type===1&&sender.address===userLiveId);}
MSP.P$9.prototype={$0:null,$1:false,$2:false,$3:null,$4:null,$5:false,$6:null,get_$7:function(){return this.$3;},$8:function(){if(this.$1){return this.$2;}var $0=MSH.XmlHelper.parseXmlDocument(this.$0);var $1=$0.documentElement;if($1==null){this.$B(String.format('Parse: Invalid XML {0}',this.$0));return this.$2;}if(!MSH.XmlHelper.isElement($1,'user')){this.$B(String.format('Parse: Invalid root node \'{0}\'',$1.nodeName));return this.$2;}var $2={};var $3={};var $enum1=ss.IEnumerator.getEnumerator($1.childNodes);while($enum1.moveNext()){var $5=$enum1.get_current();var $6=$5.nodeName;if($6!=='s'&&$6!=='sep'){continue;}var $7=MSH.XmlHelper.getAttribute($5,'n');if(String.isNullOrEmpty($7)){this.$B(String.format('Parse: Missing service name attribute in node \'{0}\'',$5.nodeName));return this.$2;}var $8=this.$9($5,$7);switch($6){case's':if(Object.keyExists($2,$7)){this.$B(String.format('Parse: Duplicate global service data nodes \'{0}\'',$7));return this.$2;}var $9=MC.ServiceDataHelper.parseServiceName($7);$2[$7]=MC.$create_ServiceDataInfo($9,$8,null);break;case'sep':var $A=MSH.XmlHelper.getAttribute($5,'epid');if(String.isNullOrEmpty($A)){this.$B(String.format('Parse: Missing epid attribute in endpoint node \'{0}\'',$5.nodeName));return this.$2;}if(!Object.keyExists($3,$7)){$3[$7]={};}else if(Object.keyExists(($3[$7]),$A)){this.$B(String.format('Parse: Duplicate epid for service data nodes \'{0}\':{1}',$7,$A));return this.$2;}($3[$7])[$A]=MC.$create_ServiceEndpointDataInfo($A,MC.ServiceDataHelper.parseServiceName($7),$8);break;}}var $4=[];var $dict2=$3;for(var $key3 in $dict2){var $B={key:$key3,value:$dict2[$key3]};if(!Object.keyExists($2,$B.key)){$4.add(MC.$create_ServiceDataInfo(MC.ServiceDataHelper.parseServiceName($B.key),{},$B.value));}else{($2[$B.key]).endpointData=$B.value;$4.add($2[$B.key]);delete $2[$B.key];}}var $dict4=$2;for(var $key5 in $dict4){var $C={key:$key5,value:$dict4[$key5]};($C.value).endpointData={};$4.add($C.value);}this.$3=MSH.CollectionHelper.toArray($4);this.$C();return this.$2;},$9:function($p0,$p1){var $0={};var $enum1=ss.IEnumerator.getEnumerator($p0.childNodes);while($enum1.moveNext()){var $1=$enum1.get_current();var $2=$1.nodeName;switch($2){case'WebAppData':var $3=this.$A($1);if($3!=null){$0[$2]=$3;}break;case'Scene':case'UserTileLocation':case'DDP':if(this.$5){$0[$2]=$1.text;}break;default:if($p1==='CM'){$0[$2]=$1.xml;}else{$0[$2]=$1.text;}break;}}if(Object.keyExists($0,'WebAppData')){if(Type.canCast($0['WebAppData'],String)){delete $0.WebAppData;}else{var $4=$0['WebAppData'];if(!Object.keyExists($0,'DMN')){$0['DMN']=$4.domain;}if($0['DMN']!==MSCo.Configuration.get_domainName()||$4.domain!==MSCo.Configuration.get_domainName()){delete $0.WebAppData;}}}return $0;},$A:function($p0){var $0=MSH.XmlHelper.getAttribute($p0,'domain');if($0==null||$0!==MSCo.Configuration.get_domainName()){return null;}var $1=[];var $2=[];var $3=MSH.XmlHelper.selectNodes($p0,'MsgIds/Id');if($3!=null){var $5=$3.length;for(var $6=0;$6<$5;$6++){var $7=$3[$6].text;if(!String.isNullOrEmpty($7)){$1.add($7);}}}var $4=MSH.XmlHelper.selectSingleNode($p0,'Properties');if($4!=null){var $8=$4.childNodes.length;for(var $9=0;$9<$8;$9++){var $A=$4.childNodes[$9];var $B=$A.nodeName;if(!String.isNullOrEmpty($B)){$2.add(MC.$create_KeyValuePair($B,$A.text));}}}return MC.$create_ApplicationDataInfo($0,MSH.CollectionHelper.toArray($2),MSH.CollectionHelper.toArray($1));},$B:function($p0){MSH.Logger.logError(MC.LogContext.get_global(),'ServiceDataReader',$p0);this.$1=true;this.$2=false;},$C:function(){this.$1=true;this.$2=true;},get_$D:function(){return(this.$1&&this.$2);}}
MSP.ServiceDataWriter=function(serviceData,endpoint,services,docType){this.$5=new ss.StringBuilder();this.$0=serviceData;this.$1=endpoint;this.$2=services;this.$3=docType;}
MSP.ServiceDataWriter.prototype={$0:null,$1:null,$2:0,$3:0,$4:false,getPayload:function(){if(this.$4){return this.$5.toString();}this.$5.append('<user>');var $0=false;var $enum1=ss.IEnumerator.getEnumerator(this.$0);while($enum1.moveNext()){var $1=$enum1.get_current();if(this.$6($1.service)){switch(this.$3){case 0:this.$7($1);this.$8($1);break;case 1:this.$9($1);break;}$0=true;}}if(!$0){return null;}this.$5.append('</user>');this.$4=true;return this.$5.toString();},$6:function($p0){return($p0&this.$2)===$p0;},$7:function($p0){var $0=this.$A($p0.properties,true,$p0.service);if($0.length>0){this.$5.append(String.format('<s n=\"{0}\">',MC.ServiceDataHelper.formatServiceType($p0.service)));this.$5.append($0);this.$5.append(String.format('</s>'));}},$8:function($p0){var $0=this.$1;var $1=$p0.service;if(!Object.keyExists($p0.endpointData,$0)){$p0.endpointData[$0]=MC.$create_ServiceEndpointDataInfo($0,$1,MC.ServiceDataHelper.getDefaultOfflineEndpointData($1));}this.$5.append(String.format('<sep n=\"{0}\">',MC.ServiceDataHelper.formatServiceType($1)));this.$5.append(this.$A(($p0.endpointData[$0]).properties,false,$1));this.$5.append(String.format('</sep>'));},$9:function($p0){var $dict1=$p0.endpointData;for(var $key2 in $dict1){var $0={key:$key2,value:$dict1[$key2]};this.$5.append(String.format('<sep n=\"{0}\" epid=\"{1}\"/>',MC.ServiceDataHelper.formatServiceType($p0.service),$0.key));}},$A:function($p0,$p1,$p2){var $0=new ss.StringBuilder();var $dict1=$p0;for(var $key2 in $dict1){var $1={key:$key2,value:$dict1[$key2]};var $2=$1.key;if(($1.value!=null)&&MC.ServiceDataHelper.shouldPublishProperty($2,$p1,$p2)){switch($2){case'WebAppData':$0.append(this.$B($1.value));break;default:$0.append(String.format('<{0}>{1}</{0}>',MSH.XmlHelper.xmlEscape($2),MSH.XmlHelper.xmlEscape($1.value)));break;}}}if($p2===2&&!$p1&&!Object.keyExists($p0,'WebAppData')){$0.append(this.$B(MC.$create_ApplicationDataInfo($p0['DMN'],new Array(0),new Array(0))));}return $0.toString();},$B:function($p0){var $0=new ss.StringBuilder();$0.append(String.format('<WebAppData domain=\"{0}\">',$p0.domain));$0.append('<MsgIds>');for(var $1=0;$1<$p0.messageIds.length;$1++){$0.append('<Id>');$0.append(MSH.XmlHelper.xmlEscape($p0.messageIds[$1]));$0.append('</Id>');}$0.append('</MsgIds>');$0.append('<Properties>');for(var $2=0;$2<$p0.properties.length;$2++){$0.append(String.format('<{0}>{1}</{0}>',MSH.XmlHelper.xmlEscape($p0.properties[$2].key),MSH.XmlHelper.xmlEscape($p0.properties[$2].value)));}$0.append('</Properties>');$0.append('</WebAppData>');return $0.toString();}}
MSP.ConnectionService.registerClass('MSP.ConnectionService',null,MC.IConnectionService,MC.IConnectionServiceEvents);MSP.P$E.registerClass('MSP.P$E');MSP.P$16.registerClass('MSP.P$16',MSP.P$E);MSP.P$15.registerClass('MSP.P$15',MSP.P$E);MSP.P$1A.registerClass('MSP.P$1A',MSP.P$E);MSP.P$19.registerClass('MSP.P$19',MSP.P$E);MSP.P$18.registerClass('MSP.P$18',MSP.P$E);MSP.P$11.registerClass('MSP.P$11',MSP.P$E);MSP.P$10.registerClass('MSP.P$10',MSP.P$E);MSP.P$F.registerClass('MSP.P$F',MSP.P$E);MSP.P$14.registerClass('MSP.P$14',MSP.P$E);MSP.P$13.registerClass('MSP.P$13',MSP.P$E);MSP.P$22.registerClass('MSP.P$22',MSP.P$E);MSP.P$27.registerClass('MSP.P$27',MSP.P$E);MSP.P$26.registerClass('MSP.P$26',MSP.P$E);MSP.P$1E.registerClass('MSP.P$1E',MSP.P$E);MSP.P$21.registerClass('MSP.P$21',MSP.P$E);MSP.P$17.registerClass('MSP.P$17',MSP.P$E);MSP.P$1F.registerClass('MSP.P$1F',MSP.P$E);MSP.P$20.registerClass('MSP.P$20',MSP.P$E);MSP.P$1C.registerClass('MSP.P$1C',MSP.P$E);MSP.P$1D.registerClass('MSP.P$1D',MSP.P$E);MSP.P$4.registerClass('MSP.P$4');MSP.P$25.registerClass('MSP.P$25',MSM.MsnpConnection);MSP.P$6.registerClass('MSP.P$6');MSP.P$5.registerClass('MSP.P$5');MSP.P$23.registerClass('MSP.P$23',MSP.P$5);MSP.P$24.registerClass('MSP.P$24',MSP.P$5);MSP.P$1B.registerClass('MSP.P$1B',MSP.P$5);MSP.P$12.registerClass('MSP.P$12',MSP.P$5);MSP.P$3.registerClass('MSP.P$3');MSP.P$7.registerClass('MSP.P$7');MSP.P$B.registerClass('MSP.P$B');MSP.P$C.registerClass('MSP.P$C');MSP.P$D.registerClass('MSP.P$D');MSP.P$A.registerClass('MSP.P$A');MSP.P$8.registerClass('MSP.P$8');MSP.P$9.registerClass('MSP.P$9');MSP.ServiceDataWriter.registerClass('MSP.ServiceDataWriter');MSP.P$4.$8=new RegExp('&amp;|&lt;|&gt;|&apos;|&quot;|&#[0-9]{1,5};|&#x[0-9a-f]{1,5};|&','ig');MSP.P$25.$1_0=['MSNP21'];MSP.P$7.$D=8000-200;MSP.P$C.$10=[128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];Type.registerNamespace('MSCr');MSCr.O$0=function(){};MSCr.O$0.prototype={$0:0,$1:1,$2:2,$3:3,$4:4,$5:5}
MSCr.O$0.registerEnum('MSCr.O$0',false);MSCr.O$4=function(){};MSCr.O$4.prototype={$0:0,$1:1,$2:2,$3:3,$4:4,$5:8,$6:16}
MSCr.O$4.registerEnum('MSCr.O$4',true);MSCr.O$2=function(){};MSCr.O$2.prototype={$0:0,$1:1}
MSCr.O$2.registerEnum('MSCr.O$2',false);MSCr.O$3=function(){};MSCr.O$3.prototype={$0:0,$1:1,$2:2}
MSCr.O$3.registerEnum('MSCr.O$3',false);MSCr.O$1=function(){};MSCr.O$1.prototype={$0:0,$1:1,$2:2,$3:4,$4:8,$5:16,$6:32,$7:64,$8:128,$9:256,$A:512}
MSCr.O$1.registerEnum('MSCr.O$1',true);MSCr.ApplicationService=function(events,localStorageService){this.$1=events;this.$3=localStorageService;this.$4=MSCr.MessengerStatusSnapshot.getCurrent(localStorageService);}
MSCr.ApplicationService.prototype={$0:null,$1:null,$2:false,$3:null,$4:null,authenticate:function(appId,appVerifier){var $0=new MSCr.O$1A(appId,appVerifier,this,this.$3);$0.$5();},getApplicationContactsInfo:function(cids,contactTicket){var $0=new MSCr.O$21(cids,contactTicket,this.$0,null,this.$1,this.$4);$0.$5();},$5:function($p0,$p1){var $0=null;if($p0===0){this.$0=MC.$create_AuthenticationInfo(3,$p1.appSecurityToken);this.$2=true;$0=MC.$create_AppSettingsInfo(($p1.isContactsSignatureRequired)?1:2);}else{this.$2=false;$0=MC.$create_AppSettingsInfo(0);}this.$1.onAuthenticationCompleted($p0,$0);},get_$6:function(){return this.$2;}}
MSCr.UserService=function(identity,factory,events,localStorageService,identityService){this.$0=identity;this.$B=localStorageService;this.$8=new MSCr.O$13(this);this.$7=factory.createConfigurationService();this.$1=factory.createConnectionService(identity,this);this.$3=factory.createExpressionProfile(identity);this.$2=factory.createAddressBook(identity);this.$4=identityService;this.$A=MSCr.MessengerStatusSnapshot.getCurrent(localStorageService);this.$6=factory.createConversationService(identity,this,events,localStorageService);this.$5=events;this.$2.add_changed(ss.Delegate.create(this,this.$11));this.$2.add_authenticationFailed(ss.Delegate.create(this,this.$13));this.$3.add_authenticationFailed(ss.Delegate.create(this,this.$13));this.$7.add_changed(ss.Delegate.create(this,this.$12));localStorageService.add_instancesChanged(ss.Delegate.create(this,this.$14));}
MSCr.UserService.prototype={$0:null,$1:null,$2:null,$3:null,$4:null,$5:null,$6:null,$7:null,$8:null,$9:null,$A:null,$B:null,$C:null,updateNetwork:function(networkId,operation){this.$8.$2(new MSCr.O$A(networkId,operation,this.$2,this.$1,this.$5,this.$A));},getConsentStatus:function(appVerifierToken){},initializeSignInStatus:function(identity,prefetchedStatus,initializationOptions){this.$8.$4(new MSCr.O$1F(identity,this,this.$A,prefetchedStatus,this.$5));},updateApplicationContacts:function(operation,contactTicket){this.$8.$5(new MSCr.O$2B(operation,contactTicket,this.$0,this.$1,this.$5,this.$A));},updateIMAvailability:function(contacts,operationCode,networkSourceId,userState){this.$8.$D(new MSCr.O$8(contacts,operationCode,networkSourceId,this.$1,this.$2,this.$5,this.$A,this.$A.get_services(),userState));},getApplicationContactsInfo:function(cids,contactTicket){this.$8.$6(new MSCr.O$21(cids,contactTicket,this.$0.authenticationInfo,this.$5,null,this.$A));},addAddress:function(address,inviteMessage,userState){this.$8.$8(new MSCr.O$1B(address,inviteMessage,this.$1,this.$2,this.$5,this.$A,this.$A.get_services(),userState));},updateAppContactsRoleLists:function(addedAppContactIds,roles,userState){this.$8.$7(new MSCr.O$2A(addedAppContactIds,roles,this.$1,this.$5,this.$A,this.$A.get_services(),userState));},updateContactNickname:function(contact,userState){this.$8.$C(new MSCr.O$E(contact,this.$2,this.$5,this.$A,userState));},updateContact:function(contact,addedLists,removedLists,userState){this.$8.$B(new MSCr.O$10(contact,addedLists,removedLists,this.$1,this.$2,this.$5,this.$A,this.$A.get_services(),userState));},addAddressToContact:function(address,contact,userState){this.$8.$9(new MSCr.O$18(contact,address,this.$1,this.$2,this.$5,this.$A,userState));},removeAddressFromContact:function(address,contact,userState){this.$8.$A(new MSCr.O$1E(contact,address,this.$1,this.$2,this.$5,this.$A,userState));},addGroup:function(group,userState){this.$8.$15(new MSCr.O$11(0,group,this.$2,this.$5,this.$A,userState));},renameGroup:function(group,userState){this.$8.$15(new MSCr.O$11(2,group,this.$2,this.$5,this.$A,userState));},removeGroup:function(group,userState){this.$8.$15(new MSCr.O$11(1,group,this.$2,this.$5,this.$A,userState));},addContactToGroup:function(contact,group,userState){this.$8.$16(new MSCr.O$D(0,group,contact,this.$2,this.$5,this.$A,userState));},removeContactFromGroup:function(contact,group,userState){this.$8.$16(new MSCr.O$D(1,group,contact,this.$2,this.$5,this.$A,userState));},conversationCreate:function(id,address){this.$6.conversationCreate(id,address);},conversationSendMessage:function(id,message,userState){this.$6.conversationSendMessage(id,message,userState);},conversationInviteAddress:function(id,address,userState){this.$6.conversationInviteAddress(id,address,userState);},conversationExpose:function(id,roster){this.$5.onConversationCreated(id,roster);},conversationUpdateId:function(oldId,newId){this.$5.onConversationUpdatedId(oldId,newId);},conversationUpdateHasUnreadMessages:function(id,hasUnreadMessages){this.$6.conversationUpdateHasUnreadMessages(id,hasUnreadMessages);},conversationClose:function(id){this.$6.conversationClose(id,true);},signIn:function(serviceData,services,userState){var $0=this.$F(serviceData);this.$8.$13(new MSCr.O$30($0,services,false,this.$A,this.$1,this.$2,this.$7,this.$4,this.$5,userState));this.$8.$11(new MSCr.O$23(this.$7));},reconnect:function(serviceData,services,userState){var $0=this.$F(serviceData);this.$8.$13(new MSCr.O$30($0,services,true,this.$A,this.$1,this.$2,this.$7,this.$4,this.$5,userState));},signOut:function(locations,endpointIds,userInitiated,userState){var $0=null;if(userInitiated){$0=new MC.ServiceDataSet(this.$A.getServiceDataInfo(MC.$create_IMAddressInfo(this.$0.liveId,1,0)));}var $1=new MSCr.O$28($0,locations,endpointIds,!userInitiated,this.$1,this.$6,this.$A,this.$5,userState);this.$8.$14($1);},updateServices:function(services,userInitiated){this.$8.$17(new MSCr.O$B(services,this.$0,this.$A,this.$1,this.$6,this,this.$5,userInitiated));},updateSettings:function(settings,userState){this.$8.$18(new MSCr.O$17(settings,this.$2,this.$5,userState));},updateUXSettings:function(settings){this.$8.$19(new MSCr.O$19(this.$0,settings,this.$5,this.$A));},updateServiceData:function(serviceData,userState){this.$8.$1A(new MSCr.O$C(true,serviceData,this.$0,this.$A,this.$3,this.$1,this.$5,userState));},sendDatagram:function(page,callback,userState){this.$8.$12(new MSCr.O$20(page,this.$1,callback,userState));},$D:function($p0){$p0.$5();},$E:function($p0){this.$8=$p0;if(Type.canCast(this.$8,MSCr.O$12)){this.$10();}},$F:function($p0){var $0=this.$0.endpointId;var $1=new MC.ServiceDataSet($p0);var $2=$1.imServiceData.getEndpoint($0);$2.set_domain(MSCo.Configuration.get_domainName());var $3=this.$A.get_signInStatusResponseInfo();if((this.$0.authenticationInfo.authType!==1)||(($3!=null)&&!$3.signInStatus.isTrustedSignIn)){var $5=$2.get_capabilities();$5[1]|=4194304;$2.set_capabilities($5);}var $4=$1.peServiceData.getEndpoint($0);$4.set_clientName(MSCo.Configuration.get_clientId());$4.set_clientVersion(MSCo.Configuration.get_clientVersion());return $1;},$10:function(){this.$8.$1C(new MSCr.O$22(this.$5,this.$A.get_instances()));},$11:function($p0,$p1){this.$8.$F(new MSCr.O$1D(this.$1));},$12:function($p0,$p1){this.$9=this.$7.get_current();this.$8.$23(new MSCr.O$F(this.$7.get_current(),this.$3,this.$2,this.$1,this.$4,this.$A,this.$5));},$13:function($p0,$p1){this.$8.$10(new MSCr.O$1C($p1.get_authenticatedCommand(),this.get_$16()));},$14:function($p0,$p1){this.$8.$1C(new MSCr.O$22(this.$5,$p1.get_instances()));},get_$15:function(){return this.$0.authenticationInfo.authType;},get_$16:function(){return this.$4;},get_$17:function(){return this.$9;},$18:function(){this.$5.onTicketExpired();},resumeSignedInSession:function(result,response,requestedServices,userState){this.$7.updateConfiguration(response.clientConfiguration);this.$5.onConfigurationChanged(response.clientConfiguration);this.$5.onNetworksChanged(response.networks);var $0=null;var $1=null;if(response.services===3||response.services===0){$0=this.$19();$1=this.$1A($0);}this.$C=ss.Delegate.create(this,function(){this.$9=response.clientConfiguration;this.$4.updateConfiguration(this.$9.identity);this.$2.updateConfiguration(this.$9.addressBook);this.$3.updateConfiguration(this.$9.expressionProfile);this.$1.updateConfiguration(this.$9.presence);this.$E(new MSCr.O$12(this));this.$1.resumeSession(response.messengerSession);this.$A.normalizeSignInEvents();this.$5.onPersistedConversationsLoaded($0,$1,false);this.$1D();if(response.messengerSession.pendingEvents!=null){this.$1C(response.messengerSession.pendingEvents);}this.$5.onNotifyWebSignInPendingEventsCompleted();if(requestedServices!==response.services){this.updateServices(requestedServices,true);}});this.$5.onSignedIn(result,response.groups,response.contacts,response.settings,response.duration,response.serverName,userState);},$19:function(){return(this.$B==null)?null:this.$B.get_conversations();},$1A:function($p0){if($p0==null){return null;}var $0=new Array($p0.conversations.length);this.onPersistedConversationsLoaded($p0);this.$1B($p0,$0);return $0;},$1B:function($p0,$p1){if(this.$B==null){return;}var $0=0;var $enum1=ss.IEnumerator.getEnumerator($p0.conversations);while($enum1.moveNext()){var $1=$enum1.get_current();var $2=$1.id;var $3=this.$B.getConversationPersistedMessages($2);$p1[$0++]=MC.$create_ConversationMessages($2,$3);}},$1C:function($p0){var $enum1=ss.IEnumerator.getEnumerator($p0);while($enum1.moveNext()){var $0=$enum1.get_current();var $1=$0[1];switch($0[0]){case'OnAlertNotification':this.$5.onAlertNotificationReceived($1[0]);break;case'OnMailNotification':this.$5.onMailNotification($1[0]);break;case'OnServiceDataChanged':this.$5.onServiceDataChanged($1[0],$1[1]);break;case'OnServiceDataDeleted':this.$5.onServiceDataDeleted($1[0],$1[1]);break;case'OnSettingsChanged':this.$5.onSettingsChanged($1[0]);break;}}},$1D:function(){if(this.$B==null){return;}var $0=this.$B.get_alerts();if($0==null){return;}var $enum1=ss.IEnumerator.getEnumerator($0.alerts);while($enum1.moveNext()){var $1=$enum1.get_current();var $2=MC.$create_AlertInfo(null,null,null,null,$1.subscrUrl,$1.actionUrl,$1.iconUrl,null,$1.text,$1.timestamp,$1.type,true);this.$5.onAlertNotificationReceived($2);}},updateTicket:function(identity){this.$0.liveId=identity.liveId;this.$0.authenticationInfo=identity.authenticationInfo;this.$0.cid=identity.cid;this.$0.endpointId=identity.endpointId;this.$0.appId=identity.appId;this.onTicketUpdated();},onTicketUpdated:function(){this.$8.$1D();},onSignInPopulateCompleted:function(){if(this.$C!=null){this.$C.invoke(null,ss.EventArgs.Empty);this.$C=null;}},onPersistedConversationsLoaded:function(persistedConversations){(this.$6).onPersistedConversationsLoaded(persistedConversations);},onAlertNotificationReceived:function($p0){this.$8.$1B(new MSCr.O$9($p0,this.$5));this.$A.alertNotificationReceived($p0);},onNetworkStatusChanged:function($p0,$p1){this.$8.$3(new MSCr.O$24($p0,$p1,this.$5,this.$A));},onServiceDataChanged:function($p0,$p1){this.$8.$1E(new MSCr.O$2D($p0,$p1,this.$0,this.$A,this.$5));},onServiceDataDeleted:function($p0,$p1){this.$8.$1F(new MSCr.O$26($p0,$p1,this,this.$0,this.$A,this.$1,this.$6,this.$5));},onSettingsChanged:function($p0){this.$8.$20(new MSCr.O$2C($p0,this.$5));},onMailNotificationReceived:function($p0){this.$8.$25(new MSCr.O$25($p0,this.$5));this.$A.mailNotificationReceived($p0);},onSubscribeNotificationReceived:function(){this.$8.$E(new MSCr.O$27(this.$2,this.$5,this.$A));},onDatagramReceived:function($p0){this.$8.$22(new MSCr.O$2F(this.$6,$p0));},onDisconnected:function($p0,$p1,$p2){this.$8.$21(new MSCr.O$2E(this.$6,this.$5,$p0,$p1,$p2));this.$A.onSignedOut($p1);},onTransferred:function($p0,$p1,$p2,$p3){this.$8.$24(new MSCr.O$29($p0,$p1,$p2,$p3,this.$A,this));},onSignInEventsEmpty:function(){},onSessionIdChanged:function(newSessionId){this.$A.updateSessionId(newSessionId);},onTridChanged:function(newTrid){this.$A.updateTrid(newTrid);}}
MSCr.O$1A=function(appId,appVerifier,service,localStorageService){MSCr.O$1A.initializeBase(this);this.$E=appId;this.$F=appVerifier;this.$10=service;this.$13=localStorageService;}
MSCr.O$1A.prototype={$E:null,$F:null,$10:null,$11:null,$12:0,$13:null,$6:function(){if(!this.$14()){var $0=MC.$create_AppAuthRequest(MSCo.Configuration.get_authenticateAppVersion(),MSCo.Configuration.get_clientVersion(),this.$F);var $1=MSCo.JsonResponseParser.buildRequest($0);var $2={};$2['Content-Type']=MSCo.Configuration.get_webActionMethodContentType();var $3=new MSCo.HttpRequest(1,MSCo.Configuration.get_authenticateApplicationUrl(),$1,$2,ss.Delegate.create(this,this.$15));$3.execute();}},$14:function(){if(this.$13==null){return false;}var $0=this.$13.get_applicationInfo();if($0==null){return false;}if($0.id!==this.$E){return false;}if(MSH.DateTimeHelper.exceeded($0.creationTime,Date.get_now(),MSCr.O$1A.$D)){this.$13.set_applicationInfo(null);return false;}this.$12=0;this.$11=$0.authResponse;this.$9();return true;},$15:function($p0){switch($p0.get_status()){case 200:this.$12=0;this.$11=MSCo.JsonResponseParser.parseAppAuthResponse($p0.get_responseText());if(this.$13!=null){this.$13.set_applicationInfo(MC.$create_PersistedApplicationInfo(this.$E,this.$11));}break;case 401:this.$12=4;break;default:this.$12=1;break;}this.$9();},$A:function(){this.$10.$5(this.$12,this.$11);}}
MSCr.O$1B=function(address,inviteMessage,connService,addressBook,events,snapshot,services,userState){MSCr.O$1B.initializeBase(this);var $0;if(address.startsWith('+')){$0=4;}else if(address.indexOf('@')<0){$0=11;}else{$0=0;}this.$D=MC.$create_IMAddressInfo(address,$0,2);this.$D.inviteMessage=inviteMessage;this.$E=connService;this.$F=addressBook;this.$10=events;this.$11=userState;this.$16=snapshot;this.$17=services;}
MSCr.O$1B.prototype={$D:null,$E:null,$F:null,$10:null,$11:null,$12:0,$13:0,$14:null,$15:null,$16:null,$17:0,$6:function(){this.$18();},$A:function(){this.$10.onAddressAdded(this.$12,this.$15,this.$11);},$18:function(){switch(this.$13){case 0:var $0=MC.$create_ContactInfo(this.$D.address,null,[this.$D]);this.$F.createContact($0,ss.Delegate.create(this,this.$19));break;case 1:if(this.$D.type===11){var $1=MC.$create_ContactInfo(this.$14,String.Empty,[this.$D]);this.$1A(0,$1);}else{this.$F.retrieveContact(this.$14,ss.Delegate.create(this,this.$1A));}break;case 2:if(this.$D.type===11){this.$1B(0);}else{this.$E.updateAddresses(this.$15.addresses,2|1,0,this.$17,ss.Delegate.create(this,this.$1B));}break;case 3:this.$9();break;case 5:this.$8();break;}},$19:function($p0,$p1){switch($p0){case 0:this.$13=1;break;case 2:this.$13=5;this.$12=2;break;case 1:default:this.$13=5;this.$12=1;break;}this.$14=$p1;this.$18();},$1A:function($p0,$p1){switch($p0){case 0:this.$13=2;this.$16.contactCreatedOrUpdated(this.$14,$p1);break;case 1:default:this.$13=5;this.$12=1;break;}this.$15=$p1;this.$18();},$1B:function($p0){if($p0===0){this.$13=3;this.$12=0;}else{this.$13=5;this.$12=1;}this.$18();}}
MSCr.O$18=function(contact,address,connService,addressBook,events,snapshot,userState){MSCr.O$18.initializeBase(this);this.$D=contact;this.$E=address;this.$F=connService;this.$10=addressBook;this.$11=events;this.$12=userState;this.$13=snapshot;}
MSCr.O$18.prototype={$D:null,$E:null,$F:null,$10:null,$11:null,$12:null,$13:null,$14:0,$15:null,$6:function(){this.$16();},$A:function(){this.$11.onContactUpdated((this.get_$4())?0:1,this.$15,this.$12);},$16:function(){switch(this.$14){case 0:this.$10.createIMAddress(this.$D,this.$E,ss.Delegate.create(this,this.$17));break;case 1:this.$10.retrieveContact(this.$D.id,ss.Delegate.create(this,this.$18));break;case 2:this.$9();break;case 3:this.$8();break;case 5:this.$8();break;}},$17:function($p0,$p1){this.$14=($p0===0)?1:5;this.$16();},$18:function($p0,$p1){this.$14=($p0===0)?2:5;this.$15=$p1;if($p0===0){this.$13.contactCreatedOrUpdated($p1.id,$p1);}this.$16();}}
MSCr.O$9=function(alert,events){MSCr.O$9.initializeBase(this);this.$D=alert;this.$E=events;}
MSCr.O$9.prototype={$D:null,$E:null,$6:function(){this.$9();},$A:function(){this.$E.onAlertNotificationReceived(this.$D);}}
MSCr.O$F=function(configuration,expProfile,addressBook,connService,idService,snapshot,events){MSCr.O$F.initializeBase(this);this.$D=configuration;this.$E=expProfile;this.$F=addressBook;this.$10=connService;this.$11=idService;this.$13=snapshot;this.$12=events;}
MSCr.O$F.prototype={$D:null,$E:null,$F:null,$10:null,$11:null,$12:null,$13:null,$6:function(){this.$9();},$A:function(){this.$E.updateConfiguration(this.$D.expressionProfile);this.$F.updateConfiguration(this.$D.addressBook);this.$10.updateConfiguration(this.$D.presence);this.$11.updateConfiguration(this.$D.identity);this.$13.updateConfiguration(this.$D);this.$12.onConfigurationChanged(this.$D);}}
MSCr.O$2F=function(convService,message){MSCr.O$2F.initializeBase(this);this.$D=convService;this.$E=message;}
MSCr.O$2F.prototype={$D:null,$E:null,$6:function(){this.$D.onDatagramReceived(this.$E);},$A:function(){}}
MSCr.O$1F=function(identity,service,snapshot,prefetchedStatus,events){MSCr.O$1F.initializeBase(this);this.$D=identity;this.$E=service;this.$F=events;this.$12=snapshot;this.$11=prefetchedStatus;}
MSCr.O$1F.prototype={$D:null,$E:null,$F:null,$10:0,$11:null,$12:null,$6:function(){if(this.$11!=null){this.$14();this.$9();return;}var $0=MC.$create_SignInStatusRequest(MSCo.Configuration.get_signInStatusVersion(),this.$D.authenticationInfo,MSCo.Configuration.get_domainName(),MSCo.Configuration.get_clientVersion(),MSCo.Configuration.get_market());var $1=MSCo.JsonResponseParser.buildSignInStatusRequest($0);var $2={};$2['Content-Type']=MSCo.Configuration.get_webActionMethodContentType();var $3=new MSCo.HttpRequest(1,MSCo.Configuration.get_signInStatusUrl(),$1,$2,ss.Delegate.create(this,this.$13));$3.execute();},$13:function($p0){var $0=$p0.getResponseHeader('X-MSNSERVER');if($p0.get_status()===200){this.$11=MSCo.JsonResponseParser.parseSignInStatusResponse($p0.get_responseText());this.$11.serverName=$0;this.$14();}else{this.$10=1;this.$11=MC.$create_SignInStatusResponse(null,null);this.$11.serverName=$0;MSH.Logger.logWarning(MC.LogContext.get_global(),'InitializeSignInStatusCommand.OnResponse',String.format('HttpResponse Failed {0}',$p0.get_status()));this.$9();}},$14:function(){this.$11.reloaded=false;this.$10=0;this.$11.identity.authenticationInfo=this.$D.authenticationInfo;this.$11.signInStatus.isServicesKnown=true;this.$11.signInStatus.services=this.$12.get_services();this.$E.updateTicket(this.$11.identity);this.$12.get_localStorage().initializeUserStorage(null,this.$11.identity.liveId,ss.Delegate.create(this,this.$15));},$15:function($p0){this.$9();},$A:function(){this.$F.onInitializeSignInStatusCompleted(this.$10,this.$11);}}
MSCr.O$22=function(events,newInstances){MSCr.O$22.initializeBase(this);this.$D=events;this.$E=newInstances;}
MSCr.O$22.prototype={$D:null,$E:null,$6:function(){this.$9();},$A:function(){this.$D.onInstancesChanged(this.$E);}}
MSCr.O$21=function(cids,contactTicket,authInfo,userEvents,appEvents,snapshot){MSCr.O$21.initializeBase(this);this.$D=cids;this.$E=contactTicket;this.$F=authInfo;this.$10=userEvents;this.$11=appEvents;this.$12=snapshot;this.$14=[];}
MSCr.O$21.prototype={$D:null,$E:null,$F:null,$10:null,$11:null,$12:null,$13:0,$14:null,$6:function(){var $0=this.$15();if($0.length===0){this.$13=0;this.$9();return;}var $1=MC.$create_AppContactsPresenceInfoRequest(MSCo.Configuration.get_getAppContactsInfoVersion(),MSCo.Configuration.get_clientVersion(),this.$F,this.$E,$0);var $2=MSCo.JsonResponseParser.buildRequest($1);var $3={};$3['Content-Type']=MSCo.Configuration.get_webActionMethodContentType();var $4=new MSCo.HttpRequest(1,MSCo.Configuration.get_getApplicationContactsInfoUrl(),$2,$3,ss.Delegate.create(this,this.$16));$4.execute();},$15:function(){var $0=[];var $enum1=ss.IEnumerator.getEnumerator(this.$D);while($enum1.moveNext()){var $1=$enum1.get_current();var $2=this.$12.getAppContactsPresenceInfo($1);if($2!=null){this.$14.add($2);}else{$0.add($1);}}return MSH.CollectionHelper.toArray($0);},$16:function($p0){switch($p0.get_status()){case 200:var $0=MSCo.JsonResponseParser.parseAppContactsInfoResponse($p0.get_responseText());this.$13=($0!=null)?0:1;this.$12.applicationContactsPresenceInfoChanged($0);this.$14.addRange($0.presenceInfo);break;case 401:this.$13=2;break;case 400:this.$13=3;break;default:this.$13=1;break;}this.$9();},$A:function(){if(this.$10!=null){this.$10.onGetApplicationContactsInfoCompleted(this.$13,MSH.CollectionHelper.toArray(this.$14));}if(this.$11!=null){this.$11.onGetApplicationContactsInfoCompleted(this.$13,MSH.CollectionHelper.toArray(this.$14));}}}
MSCr.O$23=function(service){MSCr.O$23.initializeBase(this);this.$D=service;}
MSCr.O$23.prototype={$D:null,$6:function(){this.$9();},$A:function(){this.$D.loadConfiguration();}}
MSCr.O$25=function(notification,events){MSCr.O$25.initializeBase(this);this.$E=events;this.$D=notification;}
MSCr.O$25.prototype={$D:null,$E:null,$6:function(){this.$E.onMailNotification(this.$D);},$A:function(){}}
MSCr.O$24=function(networkId,status,events,snapshot){MSCr.O$24.initializeBase(this);this.$D=networkId;this.$E=status;this.$F=events;this.$10=snapshot;}
MSCr.O$24.prototype={$D:null,$E:0,$F:null,$10:null,$6:function(){this.$9();},$A:function(){this.$F.onNetworkStatusChanged(this.$D,this.$E);this.$10.onNetworkStatusChanged(this.$D,this.$E);}}
MSCr.O$1D=function(connService){MSCr.O$1D.initializeBase(this);this.$D=connService;}
MSCr.O$1D.prototype={$D:null,$6:function(){this.$D.notifyAddressBookChanged();},$A:function(){}}
MSCr.O$1C=function(pendingCommand,idService){MSCr.O$1C.initializeBase(this);this.$D=pendingCommand;this.$E=idService;}
MSCr.O$1C.prototype={$D:null,$E:null,$F:0,get_$10:function(){return this.$D;},get_$11:function(){return this.$F;},$6:function(){this.$E.reauthenticate(ss.Delegate.create(this,this.$12));},$A:function(){if(this.$F!==0){this.$D.fail();}else{this.$D.retry();}},$12:function($p0){this.$F=$p0;if(this.$F!==0){this.$8();}else{this.$9();}}}
MSCr.O$1E=function(contact,address,connService,addressBook,events,snapshot,userState){MSCr.O$1E.initializeBase(this);this.$D=contact;this.$E=address;this.$F=connService;this.$10=addressBook;this.$11=events;this.$12=userState;this.$13=snapshot;}
MSCr.O$1E.prototype={$D:null,$E:null,$F:null,$10:null,$11:null,$12:null,$13:null,$14:0,$15:null,$6:function(){this.$16();},$A:function(){this.$11.onContactUpdated((this.get_$4())?0:1,this.$15,this.$12);},$16:function(){switch(this.$14){case 0:this.$10.deleteIMAddress(this.$D,this.$E,ss.Delegate.create(this,this.$17));break;case 1:this.$10.retrieveContact(this.$D.id,ss.Delegate.create(this,this.$18));break;case 2:this.$9();break;case 3:this.$8();break;case 5:this.$8();break;}},$17:function($p0){this.$14=($p0===0)?1:5;this.$16();},$18:function($p0,$p1){this.$14=($p0===0)?2:5;this.$15=$p1;if($p0===0){this.$13.contactCreatedOrUpdated($p1.id,$p1);}this.$16();}}
MSCr.O$20=function(message,connService,callback,userState){MSCr.O$20.initializeBase(this);this.$D=message;this.$E=connService;this.$F=callback;this.$10=userState;}
MSCr.O$20.prototype={$D:null,$E:null,$F:null,$10:null,$6:function(){this.$E.sendDatagram(this.$D,ss.Delegate.create(this,this.$11));},$A:function(){},$11:function($p0,$p1){this.$F.invoke($p0,$p1);}}
MSCr.O$5=function(){}
MSCr.O$5.prototype={$0:null,$1:false,$2:false,$3:false,get_$4:function(){return this.$2;},$5:function(){this.$0=Date.get_now();this.$1=true;this.$6();},$7:function(){if(!this.$3){this.$3=true;this.$A();}},$8:function(){if(!this.$3){this.$3=true;this.$A();}},$9:function(){if(!this.$3){this.$3=true;this.$2=true;this.$A();if(this.$C!=null){this.$C.invoke(this,ss.EventArgs.Empty);}}},add_$B:function($p0){this.$C=ss.Delegate.combine(this.$C,$p0);},remove_$B:function($p0){this.$C=ss.Delegate.remove(this.$C,$p0);},$C:null}
MSCr.O$26=function(address,serviceData,service,userIdentity,snapshot,connectionService,conversationService,events){MSCr.O$26.initializeBase(this);this.$D=address;this.$E=serviceData;this.$14=service;this.$F=userIdentity;this.$10=snapshot;this.$11=connectionService;this.$12=conversationService;this.$13=events;}
MSCr.O$26.prototype={$D:null,$E:null,$F:null,$10:null,$11:null,$12:null,$13:null,$14:null,$15:0,$16:false,$17:false,$6:function(){this.$18();this.$9();},$A:function(){if(this.$17){this.$1B();}},$18:function(){if((this.$D.type!==1)||(this.$D.address!==this.$F.liveId)){this.$17=true;return;}this.$1A();if(this.$15===0||this.$10.get_switchingServices()){if(this.$16){this.$1B();}if(this.$15!==0){this.$10.set_switchingServices(false);}this.$19();return;}switch(this.$10.get_services()){case 3:if(this.$16){this.$1B();}this.$14.updateServices(1,false);break;default:this.$14.signOut(1,null,false,null);break;}},$19:function(){if(this.$15===0&&(this.$10.get_services()===0||this.$10.get_services()===3)){return;}var $0=new MC.ServiceDataSet(this.$10.getServiceDataInfo(this.$D));if($0.imServiceData.getAllEndpoints().length>1){return;}var $1=MC.ServiceData.createEmpty(2);$1.set_status(1);this.$13.onServiceDataChanged(this.$D,[$1.get_info()]);},$1A:function(){this.$15=0;var $enum1=ss.IEnumerator.getEnumerator(this.$E.toServiceDataArray());while($enum1.moveNext()){var $0=$enum1.get_current();if($0.getEndpoint(this.$F.endpointId)!=null){this.$15|=$0.get_service();$0.deleteEndpoint(this.$F.endpointId);}if($0.getAllEndpoints().length!==0){this.$16=true;}}},$1B:function(){this.$10.serviceDataChanged(this.$D,this.$E,true);this.$13.onServiceDataDeleted(this.$D,this.$E.toArray());}}
MSCr.O$2D=function(address,serviceData,userIdentity,snapshot,events){MSCr.O$2D.initializeBase(this);this.$D=address;this.$E=serviceData;this.$F=userIdentity;this.$10=snapshot;this.$11=events;}
MSCr.O$2D.prototype={$D:null,$E:null,$F:null,$10:null,$11:null,get_$12:function(){return this.$D;},$6:function(){this.$9();},$A:function(){var $0=this.$10.serviceDataChanged(this.$D,this.$E,false);if((this.$D.type===1)&&(this.$D.address===this.$F.liveId)){$0=this.$E.toArray();}this.$11.onServiceDataChanged(this.$D,$0);}}
MSCr.O$2C=function(settings,events){MSCr.O$2C.initializeBase(this);this.$D=settings;this.$E=events;}
MSCr.O$2C.prototype={$D:null,$E:null,$6:function(){this.$9();},$A:function(){this.$E.onSettingsChanged(this.$D);}}
MSCr.O$2E=function(convService,events,resultCode,reason,reconnectWaitTime){MSCr.O$2E.initializeBase(this);this.$D=convService;this.$E=events;this.$F=resultCode;this.$10=reason;this.$11=reconnectWaitTime;}
MSCr.O$2E.prototype={$D:null,$E:null,$F:0,$10:0,$11:0,$6:function(){var $0=(this.$F===2);this.$D.close($0);this.$9();},$A:function(){this.$E.onSignedOutRemotely(this.$10,this.$11);}}
MSCr.O$30=function(serviceData,services,reconnect,snapshot,connService,addressBook,configService,identityService,callback,userState){MSCr.O$30.initializeBase(this);this.$17=serviceData.clone();this.$18=services;this.$13=reconnect;this.$19=snapshot;this.$D=connService;this.$E=addressBook;this.$10=configService;this.$11=identityService;this.$F=callback;this.$14=userState;this.$15=MSCo.Configuration.get_clientDomain();this.$12=MC.Compatibility.get_networkOperationType();this.$1C=Date.get_now();}
MSCr.O$30.prototype={$D:null,$E:null,$F:null,$10:null,$11:null,$12:0,$13:false,$14:null,$15:null,$16:0,$17:null,$18:0,$19:null,$1A:null,$1B:null,$1C:null,$1D:null,$1E:null,$1F:null,$20:0,get_$21:function(){return(this.$2D(4)&&!this.$2D(8));},$22:function($p0,$p1,$p2){if($p1){var $0=this.$10.get_current();if($0!=null){$0.presence.hostName=$p0;}else{this.$1F.presence.hostName=$p0;}}this.$D.authenticate(this.$15,$p0,this.$18,$p2,ss.Delegate.create(this,this.$25));},$23:function(){if(this.get_$21()){return;}MSH.Logger.logWarning(this.$D.get_logContext(),'SignInCommand.OnDisconnected','Error Disconnected');this.$2A(1);},$6:function(){this.$2A(0);},$A:function(){if(this.$F!=null){if(this.$20===0){this.$2B();}else if(this.$20===3){this.$19.expire();}if(this.$13){this.$F.onSignedIn(this.$20,null,null,null,MSH.DateTimeHelper.subtract(Date.get_now(),this.$1C).toString(),this.$D.get_serverName(),this.$14);}else{this.$F.onNetworksChanged(this.$1E);this.$F.onSignedIn(this.$20,this.$1B,this.$1D,this.$1A,MSH.DateTimeHelper.subtract(Date.get_now(),this.$1C).toString(),this.$D.get_serverName(),this.$14);}}},$24:function(){this.$D.authenticate(this.$15,null,this.$18,null,ss.Delegate.create(this,this.$25));},$25:function($p0){if($p0!==0){switch($p0){case 4:if(!this.$13||this.$2D(4)){this.$2A(3);return;}this.$16|=4;this.$2A(0);break;default:this.$2A(1);break;}}else{this.$16|=1;this.$2A(0);}},$26:function(){this.$1B=this.$19.get_groups();this.$1A=this.$19.get_userSettingsInfo();this.$1E=this.$19.get_networks();this.$1D=this.$19.get_contacts();this.$1F=this.$19.get_configurationInfo();this.$16|=2;this.$2A(0);},$27:function($p0,$p1){if($p0!==0){this.$2A(1);return;}this.$1B=$p1.groups;this.$1A=$p1.settings;this.$1E=$p1.networks;this.$1D=$p1.contacts;this.$16|=2;this.$2A(0);},$28:function($p0){if($p0!==0){this.$2A(3);return;}this.$16|=8;this.$24();},$29:function($p0){this.$16|=16;if($p0!==0){this.$2A(1);}else{this.$2A(0);}},$2A:function($p0){if($p0!==0){this.$20=$p0;this.$8();return;}if(this.$16===0){if(this.$13){this.$26();}else{this.$E.getAddressBook(ss.Delegate.create(this,this.$27));}this.$24();return;}if(this.$2D(16)){this.$20=0;this.$9();return;}if(this.$2D(3)){this.$D.signIn(this.$12,this.$1E,this.$1D,this.$17,this.$1A,this.$18,ss.Delegate.create(this,this.$29));return;}if(this.$2D(4)){this.$11.reauthenticate(ss.Delegate.create(this,this.$28));return;}},$2B:function(){if(!this.$13){this.$19.set_groups(this.$1B);this.$19.set_networks(this.$1E);this.$19.set_contacts(this.$1D);this.$19.set_userSettingsInfo(this.$1A);}if(this.$10.get_current()!=null){this.$19.set_configurationInfo(this.$10.get_current());}this.$19.set_messengerSessionState(this.$2C());this.$19.set_messengerSessionEvents(MC.$create_MessengerSessionEvents([]));},$2C:function(){var $0=this.$D.getSession();var $1=MC.$create_MessengerSessionState($0.server,$0.sessionToken,$0.transactionID,this.$18,false);return $1;},$2D:function($p0){return(this.$16&$p0)===$p0;}}
MSCr.O$28=function(userServiceData,locations,endpointIds,initiatedRemotely,connService,convService,snapshot,callback,userState){MSCr.O$28.initializeBase(this);this.$D=userServiceData;this.$E=locations;this.$F=endpointIds;this.$10=initiatedRemotely;this.$11=connService;this.$12=convService;this.$13=callback;this.$14=userState;this.$16=snapshot;}
MSCr.O$28.prototype={$D:null,$E:0,$F:null,$10:false,$11:null,$12:null,$13:null,$14:null,$15:0,$16:null,get_$17:function(){return((this.$E&1)===1);},$6:function(){if(this.get_$17()){this.$12.close(true);}this.$11.signOut(this.$D,this.$E,this.$F,this.$10,ss.Delegate.create(this,this.$18));},$A:function(){if(this.get_$17()){this.$16.onSignedOut((this.$10)?1:0);}if(!this.$10){this.$13.onSignedOut(this.$15,this.$E,this.$14);}else{this.$13.onSignedOutRemotely(1,-1);}},$18:function($p0){if($p0===0){this.$15=0;this.$9();}else{this.$15=1;this.$8();}}}
MSCr.O$27=function(addressBook,events,snapshot){MSCr.O$27.initializeBase(this);this.$D=addressBook;this.$E=events;this.$F=snapshot;}
MSCr.O$27.prototype={$D:null,$E:null,$F:null,$10:null,$6:function(){this.$D.getAddressBook(ss.Delegate.create(this,this.$11));},$A:function(){},$11:function($p0,$p1){if($p0!==0){this.$8();return;}this.$10=$p1;this.$12();this.$14();this.$F.onAddressBookLoaded(this.$10);this.$9();},$12:function(){var $0=this.$13();if($0==null){return;}var $1=[];for(var $2=0;$2<$0.addresses.length;$2++){var $3=$0.addresses[$2];if(($3.roleLists&16)!==0){var $4=MC.$create_ContactInfo($0.id,null,[$3]);$1.add($4);}}this.$E.onPendingContacts(MSH.CollectionHelper.toArray($1));},$13:function(){var $0=this.$10.contacts;if($0!=null){for(var $1=0;$1<$0.length;$1++){for(var $2=0;$2<$0[$1].length;$2++){var $3=$0[$1][$2];if(MSH.ContactHelper.isUnknownContact($3)){return $3;}}}}return null;},$14:function(){var $0=this.$F.get_networks();if($0!=null){var $1={};for(var $3=0;$3<$0.length;$3++){var $4=$0[$3];$1[$4.id]=$4;}var $2=[];for(var $5=0;$5<this.$10.networks.length;$5++){var $6=this.$10.networks[$5];if(Object.keyExists($1,$6.id)){$2.add($6);}}this.$E.onNetworksChanged(MSH.CollectionHelper.toArray($2));}}}
MSCr.O$29=function(hostName,transferState,otherEndpointRequest,cacheHostName,snapshot,connServiceEvents){MSCr.O$29.initializeBase(this);this.$D=hostName;this.$E=transferState;this.$F=cacheHostName;this.$10=snapshot;this.$11=connServiceEvents;}
MSCr.O$29.prototype={$D:null,$E:null,$F:false,$10:null,$11:null,get_$12:function(){return this.$D;},get_$13:function(){return this.$E;},get_$14:function(){return this.$F;},$6:function(){if(this.$F){var $0=this.$10.get_configurationInfo();$0.presence.hostName=this.$D;this.$10.updateConfiguration($0);}this.$9();},$A:function(){this.$11.onDisconnected(0,6,0);}}
MSCr.O$2B=function(operation,ticket,identity,connService,events,snapshot){MSCr.O$2B.initializeBase(this);this.$F=operation;this.$10=ticket;this.$18=identity;this.$11=connService;this.$13=events;this.$12=snapshot;}
MSCr.O$2B.$1A=function($p0,$p1){var $enum1=ss.IEnumerator.getEnumerator($p1);while($enum1.moveNext()){var $0=$enum1.get_current();if(!MSH.ArrayHelper.contains($p0,$0)){return false;}}return true;}
MSCr.O$2B.$1B=function($p0,$p1){var $enum1=ss.IEnumerator.getEnumerator($p1);while($enum1.moveNext()){var $0=$enum1.get_current();if(MSH.ArrayHelper.contains($p0,$0)){return true;}}return false;}
MSCr.O$2B.prototype={$F:null,$10:null,$11:null,$12:null,$13:null,$14:0,$15:0,$16:null,$17:null,$18:null,$6:function(){if(!this.$19()){this.$15=1;this.$1C();}},$19:function(){var $0=false;var $1=this.$12.get_appContactsTicketInfo();if($1!=null&&$1.cids!=null){switch(this.$F.operationCode){case 2:if(MSCr.O$2B.$1A($1.cids,this.$F.cids)&&MSCr.O$2B.$1A(this.$F.cids,$1.cids)){$0=true;}break;case 0:if(MSCr.O$2B.$1A($1.cids,this.$F.cids)){$0=true;}break;case 1:if(!MSCr.O$2B.$1B($1.cids,this.$F.cids)){$0=true;}break;}}if($0){this.$17=$1.ticketInfo;this.$14=0;this.$9();}return $0;},$1C:function(){switch(this.$15){case 1:this.$1D();break;case 2:this.$22();break;default:break;}},$1D:function(){if(this.$1E()){this.$9();return;}var $0=MC.$create_AppContactsUpdateInfo((this.$F.operationCode===3)?2:this.$F.operationCode,(this.$F.ticket==null)?null:this.$F.ticket.ticket,(this.$F.ticket==null)?null:this.$F.ticket.signature,this.$F.userState);var $1=MC.$create_AppContactsUpdateRequest(MSCo.Configuration.get_updateAppTicketVersion(),MSCo.Configuration.get_clientVersion(),this.$18.authenticationInfo,this.$10,(this.$F.ticket==null)?null:[MC.$create_AppContactsUpdateInfo(this.$F.operationCode,this.$F.ticket.ticket,this.$F.ticket.signature,null)],this.$F.allCids);var $2=MSCo.JsonResponseParser.buildRequest($1);var $3={};$3['Content-Type']=MSCo.Configuration.get_webActionMethodContentType();var $4=new MSCo.HttpRequest(1,MSCo.Configuration.get_updateApplicationTicketUrl(),$2,$3,ss.Delegate.create(this,this.$21));$4.execute();},$1E:function(){switch(this.$F.operationCode){case 0:case 1:return false;}var $0=(this.$12==null)?null:this.$12.get_appContactsTicketInfo();var $1=$0!=null&&$0.cids!=null&&$0.cids.length>0;if(this.$F.operationCode===3){if(!$1){this.$14=0;return true;}this.$F.ticket=$0.ticketInfo;}if($1){var $2=this.$1F($0.cids);this.$F.allCids=this.$20(this.$F.allCids,$2);}return false;},$1F:function($p0){var $0=this.$12.getConversationContactCids();var $1=[];var $enum1=ss.IEnumerator.getEnumerator($0);while($enum1.moveNext()){var $2=$enum1.get_current();var $3=false;var $enum2=ss.IEnumerator.getEnumerator($p0);while($enum2.moveNext()){var $4=$enum2.get_current();if($2===$4){$3=true;break;}}if($3&&!$1.contains($2)){$1.add($2);}}return MSH.CollectionHelper.toArray($1);},$20:function($p0,$p1){var $0=[];$0.addRange($p0);var $enum1=ss.IEnumerator.getEnumerator($p1);while($enum1.moveNext()){var $1=$enum1.get_current();if(!$0.contains($1)){$0.add($1);}}return MSH.CollectionHelper.toArray($0);},$21:function($p0){switch($p0.get_status()){case 200:this.$16=MSCo.JsonResponseParser.parseTicketResponse($p0.get_responseText());this.$14=0;break;case 401:this.$14=2;break;case 400:this.$14=3;break;default:this.$14=1;break;}if(this.$16==null){this.$8();return;}this.$15=2;this.$1C();},$22:function(){this.$11.setApplicationContacts(this.$16.ticket,this.$16.messengerSignature,ss.Delegate.create(this,this.$23));},$23:function($p0){this.$14=$p0;if($p0===0){this.$17=(this.$F.ticket==null)?null:MC.$create_TicketInfo(this.$16.ticket,this.$16.applicationSignature);this.$9();this.$12.applicationContactsChanged(this.$F.allCids,this.$17);}else{this.$8();}},$A:function(){this.$13.onUpdateApplicationContactsCompleted(this.$14,this.$F.allCids,this.$17);}}
MSCr.O$2A=function(addedAppContactIds,roles,connService,events,snapshot,services,userState){MSCr.O$2A.initializeBase(this);this.$D=addedAppContactIds;this.$10=roles;this.$E=connService;this.$F=events;this.$12=userState;this.$13=snapshot;this.$14=services;}
MSCr.O$2A.prototype={$D:null,$E:null,$F:null,$10:0,$11:0,$12:null,$13:null,$14:0,$6:function(){this.$E.updateAppContactsRoleLists(this.$D,this.$10,this.$14,ss.Delegate.create(this,this.$15));},$15:function($p0){this.$11=($p0===0)?0:1;if($p0===0){var $enum1=ss.IEnumerator.getEnumerator(this.$D);while($enum1.moveNext()){var $0=$enum1.get_current();this.$13.updateRoleListsForCid($0,this.$10);}}},$A:function(){this.$F.onAppContactsRoleListsUpdated(this.$11,this.$12);}}
MSCr.O$10=function(contact,addedLists,removedLists,connService,addressBook,events,snapshot,services,userState){MSCr.O$10.initializeBase(this);this.$F=contact;this.$E=contact.id;this.$10=addedLists;this.$11=removedLists;this.$12=connService;this.$13=addressBook;this.$14=events;this.$15=userState;this.$16=snapshot;this.$17=services;this.$1A=null;}
MSCr.O$10.prototype={$E:null,$F:null,$10:0,$11:0,$12:null,$13:null,$14:null,$15:null,$16:null,$17:0,$18:null,$19:0,$1A:null,$6:function(){this.$1B();},$A:function(){this.$14.onContactUpdated((this.get_$4())?0:1,this.$1A,this.$15);},$1B:function(){switch(this.$19){case 0:if((this.$10&1)!==0){this.$18='CreateContact';this.$13.createContact(this.$F,ss.Delegate.create(this,this.$1D));}else if((this.$11&1)!==0){this.$18='DeleteContact';this.$13.deleteContact(this.$F,ss.Delegate.create(this,this.$1F));}else if(String.isNullOrEmpty(this.$F.id)){this.$18='CreateIMAddress';this.$F.id='00000000-0000-0000-0000-000000000000';var $0=MC.$create_IMAddressInfo(this.$F.addresses[0].address,this.$F.addresses[0].type,this.$10);this.$13.createIMAddress(this.$F,$0,ss.Delegate.create(this,this.$1E));}else{this.$18='UpdateContact';this.$13.updateContact(this.$F,this.$10,ss.Delegate.create(this,this.$1C));}break;case 1:this.$13.retrieveContact(this.$F.id,ss.Delegate.create(this,this.$20));break;case 2:this.$12.updateAddresses(this.$F.addresses,this.$10,this.$11,this.$17,ss.Delegate.create(this,this.$21));break;case 3:this.$22();this.$9();break;case 5:this.$8();break;}},$1C:function($p0){if($p0===0){if(this.$F.id==='00000000-0000-0000-0000-000000000000'){this.$1A=this.$F;for(var $0=0;$0<this.$1A.addresses.length;$0++){this.$1A.addresses[$0].roleLists&=~this.$11;}this.$19=2;}else{this.$19=1;}}else{this.$19=5;}this.$1B();},$1D:function($p0,$p1){if($p0===0){this.$19=1;this.$F.id=$p1;}else{this.$19=5;}this.$1B();},$1E:function($p0,$p1){if($p0===0){this.$19=2;this.$F.addresses[0].id=$p1;this.$1A=this.$F;}else{this.$19=5;}this.$1B();},$1F:function($p0){this.$19=($p0===0)?2:5;this.$1B();},$20:function($p0,$p1){this.$19=($p0===0)?2:5;this.$1A=$p1;this.$1B();},$21:function($p0){this.$19=($p0===0)?3:5;this.$1B();},$22:function(){var $0=this.$1A||this.$F;switch(this.$18){case'CreateContact':if((this.$11&16)!==0){var $enum1=ss.IEnumerator.getEnumerator($0.addresses);while($enum1.moveNext()){var $1=$enum1.get_current();this.$16.removeAddressFromContact(this.$E,$1);}}this.$16.contactCreatedOrUpdated($0.id,$0);break;case'DeleteContact':this.$16.contactDeleted($0);break;case'CreateIMAddress':this.$16.addIMAddress(this.$F.addresses[0]);break;case'UpdateContact':this.$16.contactCreatedOrUpdated($0.id,$0);break;}}}
MSCr.O$E=function(contact,addressBook,events,snapshot,userState){MSCr.O$E.initializeBase(this);this.$D=contact;this.$E=addressBook;this.$F=events;this.$10=userState;this.$11=snapshot;}
MSCr.O$E.prototype={$D:null,$E:null,$F:null,$10:null,$11:null,$12:0,$6:function(){this.$13();},$13:function(){switch(this.$12){case 0:this.$E.updateContactNickname(this.$D,ss.Delegate.create(this,this.$14));break;case 1:this.$9();break;case 5:this.$8();break;}},$14:function($p0){this.$12=($p0===0)?1:5;if($p0===0){this.$11.contactCreatedOrUpdated(this.$D.id,this.$D);}this.$13();},$A:function(){this.$F.onContactUpdated((this.get_$4())?0:1,this.$D,this.$10);}}
MSCr.O$D=function(type,group,contact,addressBook,events,snapshot,userState){MSCr.O$D.initializeBase(this);this.$D=type;this.$F=group;this.$E=contact;this.$10=addressBook;this.$11=events;this.$12=userState;this.$13=snapshot;}
MSCr.O$D.prototype={$D:0,$E:null,$F:null,$10:null,$11:null,$12:null,$13:null,$6:function(){this.$14();},$A:function(){},$14:function(){switch(this.$D){case 0:this.$10.createContactID(this.$F,this.$E,ss.Delegate.create(this,this.$15));break;case 1:this.$10.deleteContactID(this.$F,this.$E,ss.Delegate.create(this,this.$16));break;default:break;}},$15:function($p0,$p1){if($p0===0&&this.$D===0){this.$13.addContactToGroup(this.$E,this.$F);}this.$9();},$16:function($p0){if($p0===0&&this.$D===1){this.$13.removeContactFromGroup(this.$E,this.$F);}this.$9();}}
MSCr.O$11=function(type,group,addressBook,events,snapshot,userState){MSCr.O$11.initializeBase(this);this.$D=type;this.$E=group;this.$F=addressBook;this.$10=events;this.$11=userState;this.$12=snapshot;}
MSCr.O$11.prototype={$D:0,$E:null,$F:null,$10:null,$11:null,$12:null,$13:null,$6:function(){switch(this.$D){case 0:this.$F.createTag(this.$E,ss.Delegate.create(this,this.$14));break;case 1:this.$F.deleteTag(this.$E,ss.Delegate.create(this,this.$15));break;case 2:this.$F.updateTag(this.$E,ss.Delegate.create(this,this.$15));break;default:break;}},$A:function(){switch(this.$D){case 0:this.$10.onGroupAdded((this.get_$4())?0:1,this.$13,this.$11);if(this.get_$4()){this.$12.groupAdded(this.$13);}break;case 1:this.$10.onGroupRemoved((this.get_$4())?0:1,this.$13,this.$11);if(this.get_$4()){this.$12.groupRemoved(this.$13);}break;case 2:this.$10.onGroupRenamed((this.get_$4())?0:1,this.$13,this.$11);if(this.get_$4()){this.$12.groupModified(this.$13);}break;default:break;}},$14:function($p0,$p1){if($p0===0){this.$13=MC.$create_GroupInfo($p1,this.$E.name,this.$E.contactIds);this.$9();}else{this.$8();}},$15:function($p0){if($p0===0){this.$13=this.$E;this.$9();}else{this.$8();}}}
MSCr.O$8=function(contacts,code,networkSourceId,connService,addressBook,events,snapshot,services,userState){MSCr.O$8.initializeBase(this);this.$D=contacts;this.$E=code;this.$F=networkSourceId;this.$10=connService;this.$11=addressBook;this.$12=events;this.$13=userState;this.$14=snapshot;this.$15=services;this.$16=0;}
MSCr.O$8.prototype={$D:null,$E:0,$F:null,$10:null,$11:null,$12:null,$13:null,$14:null,$15:0,$16:0,$6:function(){this.$17();},$A:function(){this.$12.onIMAvailabilityUpdated((this.get_$4())?0:1,this.$13);},$17:function(){switch(this.$16){case 0:this.$11.updateIMAvailability(this.$D,this.$E,this.$F,ss.Delegate.create(this,this.$18));break;case 1:var $0=(this.$E===1)?64:0;var $1=(this.$E===2)?64:0;var $2=[];var $enum1=ss.IEnumerator.getEnumerator(this.$D);while($enum1.moveNext()){var $3=$enum1.get_current();var $enum2=ss.IEnumerator.getEnumerator($3.addresses);while($enum2.moveNext()){var $4=$enum2.get_current();$2.add($4);}}this.$10.updateAddresses(MSH.CollectionHelper.toArray($2),$0,$1,this.$15,ss.Delegate.create(this,this.$19));break;case 3:this.$1A();this.$9();break;case 5:this.$8();break;}},$18:function($p0){this.$16=($p0===0)?1:5;this.$17();},$19:function($p0){this.$16=($p0===0)?3:5;this.$17();},$1A:function(){var $enum1=ss.IEnumerator.getEnumerator(this.$D);while($enum1.moveNext()){var $0=$enum1.get_current();var $enum2=ss.IEnumerator.getEnumerator($0.addresses);while($enum2.moveNext()){var $1=$enum2.get_current();if($1.type===13){continue;}if(this.$E===1){$1.roleLists|=64;}else if(this.$E===2){$1.roleLists&=~64;}}this.$14.contactCreatedOrUpdated($0.id,$0);}}}
MSCr.O$A=function(networkId,operation,addressbook,connService,events,snapshot){MSCr.O$A.initializeBase(this);this.$D=networkId;this.$E=operation;this.$14=this.$E&(4|8);this.$15=this.$E&(1|2);this.$F=addressbook;this.$10=connService;this.$11=events;this.$13=snapshot;}
MSCr.O$A.prototype={$D:null,$E:0,$F:null,$10:null,$11:null,$12:0,$13:null,$14:0,$15:0,$6:function(){if(this.$14!==0){var $0=(this.$14===8)?3:4;this.$F.updateIMAvailability(null,$0,this.$D,ss.Delegate.create(this,this.$17));}else{this.$10.updateNetworks([this.$D],this.$15,ss.Delegate.create(this,this.$16));}},$A:function(){this.$11.onUpdateNetworkCompleted(this.$12,this.$D,this.$E);},$16:function($p0){if($p0===0){this.$12=0;}else{this.$12=9;}this.$9();},$17:function($p0){if($p0===0){if(this.$15!==0){this.$10.updateNetworks([this.$D],this.$15,ss.Delegate.create(this,this.$16));}else{this.$12=0;this.$9();}}else{this.$12=8;this.$9();}}}
MSCr.O$C=function(persist,change,identity,snapshot,expProfile,connService,events,userState){MSCr.O$C.initializeBase(this);this.$D=persist;this.$E=change;this.$F=identity;this.$10=snapshot;this.$11=expProfile;this.$12=connService;this.$13=events;this.$14=userState;}
MSCr.O$C.prototype={$D:false,$E:null,$F:null,$10:null,$11:null,$12:null,$13:null,$14:null,$15:false,$16:0,$6:function(){var $0=MC.$create_IMAddressInfo(this.$F.liveId,1,0);var $1=new MC.ServiceDataSet(this.$10.getServiceDataInfo($0));var $2=MC.ServiceDataSet.createMessengerUpdate($1,this.$E);this.$17($2);this.$10.serviceDataChanged($0,$2,false);this.$12.publishServiceData($2,this.$10.get_services(),ss.Delegate.create(this,this.$18));if(this.$D&&$2.peServiceData!=null){var $3=new MC.ServiceDataSet(this.$E);this.$11.update($3,ss.Delegate.create(this,this.$19));}},$A:function(){this.$13.onUserServiceDataUpdated(this.$16,this.$14);},$17:function($p0){if($p0.imServiceData!=null){var $0=$p0.imServiceData.getEndpoint(this.$F.endpointId);$0.set_domain(MSCo.Configuration.get_domainName());}},$18:function($p0){if(!this.$15){this.$15=true;if($p0!==0){this.$16=1;this.$8();}else{this.$16=0;this.$9();}}},$19:function($p0){if(!this.$15){this.$15=true;if($p0!==0){this.$16=1;this.$8();}else{this.$16=0;this.$9();}}}}
MSCr.O$B=function(services,identity,snapshot,connService,convService,connServiceEvents,events,userInitiated){MSCr.O$B.initializeBase(this);this.$13=MC.$create_IMAddressInfo(identity.liveId,1,0);this.$E=connService;this.$F=convService;this.$10=connServiceEvents;this.$11=events;this.$16=identity;this.$D=services;this.$12=snapshot;this.$17=userInitiated;}
MSCr.O$B.prototype={$D:0,$E:null,$F:null,$10:null,$11:null,$12:null,$13:null,$14:0,$15:0,$16:null,$17:false,get_$18:function(){return this.$D;},$19:function($p0){if((this.$15&16)===16&&$p0.type===1&&$p0.address===this.$13.address){this.$2E(0,16);}},$6:function(){this.$15=this.$27(this.$12.get_services(),this.$D);this.$12.set_switchingServices((this.$15&8)===8);this.$1A();},$A:function(){this.$12.set_services(this.$D);if(this.$17){this.$11.onUserServicesUpdated(this.$14);}else{this.$11.onServicesChanged(this.$D);}},$1A:function(){if(this.$14===1){this.$8();return;}if((this.$15&16)===16){this.$1B();}else if((this.$15&4)===4){this.$1D();}else if((this.$15&2)===2){this.$1F();}else if((this.$15&256)===256){this.$23();}else if((this.$15&128)===128){this.$22();}else if((this.$15&8)===8){this.$20();}else if((this.$15&32)===32){this.$1E();}else if((this.$15&1)===1){this.$1C();}else if((this.$15&512)===512){this.$24();}else if((this.$15&64)===64){this.$21();}else{this.$9();}},$1B:function(){this.$E.updateUserAddress(this.$13,1,0,this.$D,ss.Delegate.create(this,this.$2A));},$1C:function(){var $0=this.$12.getContactAddressesOnLocalNetworks(true);if($0.length>0){this.$E.publishRoleLists($0,this.$D,ss.Delegate.create(this,this.$2B));}else{this.$2B(0);}},$1D:function(){var $0=this.$12.getServiceDataInfo(this.$13);if(($0!=null)&&($0.length>0)){var $1=new MC.ServiceDataSet($0);if($1.imServiceData.get_status()===1){$1.imServiceData.set_status(2);}this.$E.publishServiceData($1,this.$D,ss.Delegate.create(this,this.$28));}else{this.$28(0);}},$1E:function(){this.$E.updateUserAddress(this.$13,0,1,this.$12.get_services(),ss.Delegate.create(this,this.$2C));},$1F:function(){var $0=this.$12.getContactAddressesOnLocalNetworks(true);if($0.length>0){this.$E.updateAddresses($0,0,1,this.$12.get_services(),ss.Delegate.create(this,this.$2D));}else{this.$2D(0);}},$20:function(){var $0=this.$16.endpointId;var $1=MC.ServiceDataSet.create();$1.addEndpoint(MC.ServiceEndpointData.createEmpty(2,$0));$1.addEndpoint(MC.ServiceEndpointData.createEmpty(4,$0));$1.addEndpoint(MC.ServiceEndpointData.createEmpty(1,$0));this.$E.deleteServiceData($1,ss.Delegate.create(this,this.$29));},$21:function(){var $0=this.$12.getServiceDataInfo(this.$13);if(($0!=null)&&($0.length>0)){this.$11.onServiceDataChanged(this.$13,$0);}this.$2E(0,64);},$22:function(){var $0=this.$12.getContactAddressesOnLocalNetworks(true);for(var $3=0;$3<$0.length;$3++){var $4=this.$12.getServiceDataInfo($0[$3]);if(($4!=null)&&($4.length>0)){this.$10.onServiceDataDeleted($0[$3],new MC.ServiceDataSet($4));}}var $1=this.$12.getServiceDataInfo(this.$13);var $2=false;for(var $5=0;$5<$1.length;$5++){if(Object.keyExists($1[$5].endpointData,this.$16.endpointId)){delete $1[$5].endpointData[this.$16.endpointId];}if(Object.getKeyCount($1[$5].endpointData)>0){$2=true;}}if($2){this.$10.onServiceDataDeleted(this.$13,new MC.ServiceDataSet($1));}this.$2E(0,128);},$23:function(){this.$F.close(true);this.$2E(0,256);},$24:function(){this.$12.get_localStorage().refreshConversationData(ss.Delegate.create(this,this.$25));},$25:function(){var $0=this.$12.get_localStorage().get_conversations();if($0!=null){(this.$F).onPersistedConversationsLoaded($0);var $1=this.$26($0);this.$11.onPersistedConversationsLoaded($0,$1,true);}this.$2E(0,512);},$26:function($p0){var $0=new Array($p0.conversations.length);var $1=0;var $enum1=ss.IEnumerator.getEnumerator($p0.conversations);while($enum1.moveNext()){var $2=$enum1.get_current();var $3=$2.id;var $4=this.$12.get_localStorage().getConversationPersistedMessages($3);$0[$1++]=MC.$create_ConversationMessages($3,$4);}return $0;},$27:function($p0,$p1){if($p0===3){$p0=0;}if($p1===3){$p1=0;}if($p0===2){if($p1===0){return 4|512|64;}else if($p1===1){return 32|2|128;}}else if($p0===0){if($p1===2){return 8|256;}else if($p1===1){return 32|8|2|128|256;}}else if($p0===1){if($p1===2){return 16|1;}else if($p1===0){return 16|4|1|64|512;}}return 0;},$28:function($p0){this.$2E($p0,4);},$29:function($p0){this.$2E($p0,8);},$2A:function($p0){if($p0!==0){this.$2E($p0,16);}},$2B:function($p0){this.$2E($p0,1);},$2C:function($p0){this.$2E($p0,32);},$2D:function($p0){this.$2E($p0,2);},$2E:function($p0,$p1){if($p0!==0){this.$14=1;}this.$15&=~$p1;this.$1A();}}
MSCr.O$17=function(settings,addressBook,events,userState){MSCr.O$17.initializeBase(this);this.$D=settings;this.$E=addressBook;this.$F=events;this.$10=userState;}
MSCr.O$17.prototype={$D:null,$E:null,$F:null,$10:null,$11:0,$6:function(){this.$E.updateSettings(this.$D,ss.Delegate.create(this,this.$12));},$A:function(){this.$F.onUserSettingsUpdated(this.$11,this.$10);},$12:function($p0){if($p0!==0){this.$11=1;this.$8();}else{this.$11=0;this.$9();}}}
MSCr.O$19=function(identity,settings,events,snapshot){MSCr.O$19.initializeBase(this);this.$D=identity;this.$F=settings;this.$E=events;this.$11=snapshot;}
MSCr.O$19.prototype={$D:null,$E:null,$F:null,$10:0,$11:null,$6:function(){var $0=MC.$create_UpdateUserSettingsRequest(MSCo.Configuration.get_updateUserSettingsVersion(),MSCo.Configuration.get_clientVersion(),this.$D.authenticationInfo,this.$F.autoSignInEnabled,this.$F.audioEnabled,this.$F.firstRunExperienceViewed,this.$F.lastStatus);var $1=MSCo.JsonResponseParser.buildRequest($0);var $2={};$2['Content-Type']=MSCo.Configuration.get_webActionMethodContentType();var $3=new MSCo.HttpRequest(1,MSCo.Configuration.get_updateUserSettingsUrl(),$1,$2,ss.Delegate.create(this,this.$12));$3.execute();},$12:function($p0){switch($p0.get_status()){case 200:var $0=this.$11.get_signInStatusResponseInfo();if($0!=null){$0.signInStatus.isUserSettingsKnown=true;$0.signInStatus.isAutoSignInEnabled=this.$F.autoSignInEnabled;$0.signInStatus.isAudioEnabled=this.$F.audioEnabled;$0.signInStatus.isFirstRunExperienceViewed=this.$F.firstRunExperienceViewed;$0.signInStatus.lastStatus=this.$F.lastStatus;this.$11.set_signInStatusResponseInfo($0);}this.$10=0;break;case 401:this.$10=4;break;default:this.$10=1;break;}this.$9();},$A:function(){this.$E.onUserUXSettingsUpdated(this.$10);}}
MSCr.O$6=function(){}
MSCr.O$6.$0=function($p0,$p1){var $0=$p0.events;var $1={};for(var $4=$0.length-1;$4>=0;$4--){var $5=$0[$4];if($5[0].toString()==='OnServiceDataChanged'){var $6=($5[1])[0];if($6==null){continue;}if($6.type===13&&$p1===$6.network){var $7=MSH.ContactHelper.getIMAddressInfoKey($6);if(!Object.keyExists($1,$7)){$1[$7]=$5;}}}}var $2={};$2['Status']='FLN';var $3=new MC.ServiceDataSet([MC.$create_ServiceDataInfo(2,$2,{})]);var $dict1=$1;for(var $key2 in $dict1){var $8={key:$key2,value:$dict1[$key2]};MSCr.O$6.$6($8.value,$3,false);}}
MSCr.O$6.$1=function($p0,$p1,$p2,$p3){var $0=$p0.events;var $1=MSCr.O$6.$3($0,$p1);if($1!=null){return MSCr.O$6.$6($1,$p2,$p3);}else if(!$p3){MSCr.O$6.$4($p0,$p1,$p2);return $p2.toArray();}else{return null;}}
MSCr.O$6.$2=function($p0,$p1){var $0=$p0.events;var $1=MSCr.O$6.$3($0,$p1);if($1!=null){var $2=$1[1];var $3=new MC.ServiceDataSet($2[1]);return $3.clone().toArray();}else{return new Array(0);}}
MSCr.O$6.$3=function($p0,$p1){var $0=null;if($p0==null){return null;}for(var $1=$p0.length-1;$1>=0;$1--){var $2=$p0[$1];if($2[0].toString()==='OnServiceDataChanged'){var $3=($2[1])[0];if($3==null){continue;}if($p1.type===11&&$3.type===11&&!String.isNullOrEmpty($p1.cid)&&$p1.cid===$3.cid){$0=$2;break;}if(!String.isNullOrEmpty($p1.address)&&MSH.ContactHelper.areIMAddressesEqual($p1,$3)){$0=$2;break;}}}return $0;}
MSCr.O$6.$4=function($p0,$p1,$p2){var $0=new Array(2);$0[0]='OnServiceDataChanged';$0[1]=[$p1,$p2.clone().toArray()];MSCr.O$6.$5($p0,$0);}
MSCr.O$6.$5=function($p0,$p1){var $0=($p0.events==null)?1:$p0.events.length+1;var $1=new Array($0);if($0===1){$1[0]=$p1;}else{for(var $2=0,$3=$p0.events.length;$2<$3;$2++){$1[$2]=$p0.events[$2];}$1[$p0.events.length]=$p1;}$p0.events=$1;}
MSCr.O$6.$6=function($p0,$p1,$p2){var $0=$p0[1];var $1=new MC.ServiceDataSet($0[1]);var $2;if($p2){$1.deleteAll($p1.toArray());$0[1]=$1.toArray();$2=null;}else{$2=$1.createDiff($p1);var $3=MSCr.O$6.$7($1,$p1);$3.updateAll($2);$0[1]=$3.toArray();}return $2;}
MSCr.O$6.$7=function($p0,$p1){var $0=[];var $enum1=ss.IEnumerator.getEnumerator($p0.toArray());while($enum1.moveNext()){var $1=$enum1.get_current();$0.add($1);}var $enum2=ss.IEnumerator.getEnumerator($p1.toServiceDataArray());while($enum2.moveNext()){var $2=$enum2.get_current();if($p0.getServiceData($2.get_service())==null){$0.add($2.clone());}}return new MC.ServiceDataSet(MSH.CollectionHelper.toArray($0));}
MSCr.O$6.$8=function($p0,$p1){if($p1.type!==0){return;}var $0=['OnMailNotification',[$p1]];MSCr.O$6.$5($p0,$0);}
MSCr.O$6.$9=function($p0,$p1){var $0=$p0.notification;if($0.source===0){$p1.inboxUnread-=$0.delta;if($0.destination!==0&&$0.destination!==6){$p1.foldersUnread+=$0.delta;}}else if($0.source!==6){$p1.foldersUnread-=$0.delta;if($0.destination===0){$p1.inboxUnread+=$0.delta;}}else{if($0.destination===0){$p1.inboxUnread+=$0.delta;}else if($0.destination!==6){$p1.foldersUnread+=$0.delta;}}if($p1.foldersUnread<0){$p1.foldersUnread=0;}}
MSCr.O$6.$A=function($p0,$p1){var $0=$p0.events;var $1=MSCr.O$6.$C($0);if($1!=null){MSCr.O$6.$B($1,$p1);}else{MSCr.O$6.$8($p0,$p1);}}
MSCr.O$6.$B=function($p0,$p1){var $0=$p0[1];var $1=$0[0];var $2=$1.notification;switch($p1.type){case 0:$1.notification=$p1.notification;break;case 1:break;case 2:MSCr.O$6.$9($p1,$2);break;}}
MSCr.O$6.$C=function($p0){var $0=null;if($p0==null){return null;}for(var $1=$p0.length-1;$1>=0;$1--){var $2=$p0[$1];if($2[0].toString()==='OnMailNotification'){var $3=$2[1];var $4=$3[0];if($4.type===0){$0=$2;break;}}}return $0;}
MSCr.O$6.$D=function($p0,$p1){var $0=[];$0.add($p0.id);if($p1.contactIds!=null){$0.addRange($p1.contactIds);}$p1.contactIds=MSH.CollectionHelper.toArray($0);}
MSCr.O$6.$E=function($p0,$p1){var $0=[];$0.add([$p0]);$0.addRange($p1);return MSH.CollectionHelper.toArray($0);}
MSCr.O$6.$F=function($p0,$p1){var $0=false;var $1=[];var $enum1=ss.IEnumerator.getEnumerator($p1);while($enum1.moveNext()){var $2=$enum1.get_current();var $3=MSCr.O$6.$10($2,$p0);if($3!=null){$1.add($3);}if($2!==$3){$0=true;}}if(!$0){return $p1;}return MSH.CollectionHelper.toArray($1);}
MSCr.O$6.$10=function($p0,$p1){var $0=false;var $enum1=ss.IEnumerator.getEnumerator($p0);while($enum1.moveNext()){var $3=$enum1.get_current();if($3.id===$p1.id){$0=true;break;}}if(!$0){return $p0;}if($p0.length===1){return null;}var $1=new Array($p0.length-1);var $2=0;var $enum2=ss.IEnumerator.getEnumerator($p0);while($enum2.moveNext()){var $4=$enum2.get_current();if($4.id!==$p1.id){$1[$2++]=$4;}}return $1;}
MSCr.O$6.$11=function($p0,$p1){if($p0==null){return null;}var $enum1=ss.IEnumerator.getEnumerator($p0);while($enum1.moveNext()){var $0=$enum1.get_current();var $enum2=ss.IEnumerator.getEnumerator($0);while($enum2.moveNext()){var $1=$enum2.get_current();var $2=MSCr.O$6.$12($1,$p1);if($2!=null){return $2;}}}return null;}
MSCr.O$6.$12=function($p0,$p1){if(($p0==null)||($p0.addresses==null)){return null;}var $enum1=ss.IEnumerator.getEnumerator($p0.addresses);while($enum1.moveNext()){var $0=$enum1.get_current();if($0.type===11&&$0.address===$p1){return $0;}}return null;}
MSCr.O$6.$13=function($p0,$p1){if($p0.contactIds==null){return false;}var $enum1=ss.IEnumerator.getEnumerator($p0.contactIds);while($enum1.moveNext()){var $0=$enum1.get_current();if($0===$p1){return true;}}return false;}
MSCr.O$6.$14=function($p0,$p1){if($p0.contactIds==null||$p0.contactIds.length===0){return false;}var $0=$p0.contactIds.length;var $1=[];for(var $2=0;$2<$p0.contactIds.length;$2++){if($p0.contactIds[$2]!==$p1.id){$1.add($p0.contactIds[$2]);}}$p0.contactIds=MSH.CollectionHelper.toArray($1);return $0!==$p0.contactIds.length;}
MSCr.O$6.$15=function($p0,$p1){if(($p0==null)||($p1==null)){return;}var $0=new Array($p0.addresses.length+1);var $1=0;$0[$1++]=$p1;var $enum1=ss.IEnumerator.getEnumerator($p0.addresses);while($enum1.moveNext()){var $2=$enum1.get_current();if(MSH.ContactHelper.getIMAddressInfoKey($2)===MSH.ContactHelper.getIMAddressInfoKey($p1)){return;}$0[$1++]=$2;}$p0.addresses=$0;}
MSCr.O$6.$16=function($p0,$p1){if($p0.addresses==null||$p0.addresses.length===0){return;}var $0=0;var $1=false;var $2=new Array($p0.addresses.length-1);var $enum1=ss.IEnumerator.getEnumerator($p0.addresses);while($enum1.moveNext()){var $3=$enum1.get_current();if(MSH.ContactHelper.areIMAddressesEqual($3,$p1)){$1=true;continue;}$2[$0++]=$3;}if($1){$p0.addresses=$2;}}
MSCr.O$6.$17=function($p0,$p1,$p2){$p1.addresses=$p2.addresses;$p1.id=$p0;$p1.nickname=$p2.nickname;}
MSCr.O$6.$18=function($p0,$p1){var $enum1=ss.IEnumerator.getEnumerator($p1);while($enum1.moveNext()){var $0=$enum1.get_current();var $enum2=ss.IEnumerator.getEnumerator($0);while($enum2.moveNext()){var $1=$enum2.get_current();if($p0===$1.id){return $1;}}}return null;}
MSCr.O$6.$19=function($p0,$p1){if($p1==null){return null;}var $enum1=ss.IEnumerator.getEnumerator($p1);while($enum1.moveNext()){var $0=$enum1.get_current();if($0.id===$p0.id){return $0;}}return null;}
MSCr.O$6.$1A=function($p0){return MSCr.O$6.$18('00000000-0000-0000-0000-000000000000',$p0);}
MSCr.O$6.$1B=function($p0,$p1){var $0=[];$0.add($p1);$0.addRange($p0);return MSH.CollectionHelper.toArray($0);}
MSCr.O$6.$1C=function($p0,$p1){$p0.contactIds=$p1.contactIds;$p0.id=$p1.id;$p0.name=$p1.name;}
MSCr.O$6.$1D=function($p0,$p1){var $0=new Array($p0.length-1);var $1=0;var $enum1=ss.IEnumerator.getEnumerator($p0);while($enum1.moveNext()){var $2=$enum1.get_current();if($2.id!==$p1.id){$0[$1++]=$2;}}return $0;}
MSCr.O$6.$1E=function($p0){var $0=[];var $1={};var $2=null;if($p0.events!=null){var $enum1=ss.IEnumerator.getEnumerator($p0.events);while($enum1.moveNext()){var $3=$enum1.get_current();switch($3[0]){case'OnDatagramReceived':break;case'OnServiceDataChanged':var $4=MSCr.O$6.$1F($3);if(Object.keyExists($1,$4)){var $5=$3[1];var $6=$5[1];MSCr.O$6.$6($1[$4],new MC.ServiceDataSet($6),false);}else{$1[$4]=$3;$0.add($3);}break;case'OnServiceDataDeleted':var $7=MSCr.O$6.$1F($3);if(Object.keyExists($1,$7)){var $8=$3[1];var $9=$8[1];MSCr.O$6.$6($1[$7],new MC.ServiceDataSet($9),true);}break;case'OnMailNotification':var $A=($3[1])[0];switch($A.type){case 0:if($2!=null){$0.remove($2);}$0.add($3);$2=$3;break;case 2:if($2!=null){MSCr.O$6.$B($2,$A);}break;}break;default:$0.add($3);break;}}}$p0.events=MSH.CollectionHelper.toArray($0);}
MSCr.O$6.$1F=function($p0){var $0=($p0[1])[0];return String.format('{0}:{1}',$0.type,($0.type===11)?$0.cid:$0.address);}
MSCr.O$6.$20=function($p0){return $p0.isAuthenticated&&!$p0.isApplicationBlocked&&!$p0.isTicketExpired&&!$p0.isUnsupportedBrowser;}
MSCr.O$6.$21=function(){var $0=ss.isNullOrUndefined(window.signInControl);return $0;}
MSCr.MessengerStatusSnapshot=function(localStorage){this.$8=null;this.$10=false;this.$17=null;this.$13=false;this.$14=null;this.$11=false;this.$15=null;this.$12=false;this.$19=localStorage.get_revision();this.$18=localStorage;this.$18.add_dataWritten(ss.Delegate.create(this,this.$33));this.$18.add_dataRead(ss.Delegate.create(this,this.$34));MSH.PerfCollector.get_instance().registerStatusCollector(this);}
MSCr.MessengerStatusSnapshot.getCurrent=function(localStorage){var $enum1=ss.IEnumerator.getEnumerator(MSCr.MessengerStatusSnapshot.$1C);while($enum1.moveNext()){var $1=$enum1.get_current();if($1.$18===localStorage){return $1;}}var $0=new MSCr.MessengerStatusSnapshot(localStorage);MSCr.MessengerStatusSnapshot.$1C.add($0);return $0;}
MSCr.MessengerStatusSnapshot.prototype={$1:null,$2:null,$3:null,$4:null,$5:null,$6:null,$7:null,$8:null,$9:false,$A:false,$B:false,$C:false,$D:false,$E:false,$F:false,$10:false,$11:false,$12:false,$13:false,$14:null,$15:null,$16:null,$17:null,$18:null,$19:0,$1B:false,get_localStorage:function(){return this.$18;},get_lastModified:function(){return this.$18.get_lastWriteTime();},get_ageInMilliSeconds:function(){return MSH.DateTimeHelper.subtract(Date.get_now(),this.get_lastModified());},get_instances:function(){return this.$18.get_currentInstances();},get_signInStatusResponseInfo:function(){return this.$23();},set_signInStatusResponseInfo:function(value){this.$24(value);return value;},get_networks:function(){if(this.$1==null){this.$1=this.$18.get_networks();}return this.$1;},set_networks:function(value){if(this.$1!==value){this.$1=value;this.$9=true;this.$2A();}return value;},get_groups:function(){if(this.$2==null){this.$2=this.$18.get_groups();}return this.$2;},set_groups:function(value){if(this.$2!==value){this.$2=value;this.$A=true;this.$2A();}return value;},get_contacts:function(){if(this.$3==null){this.$3=this.$18.get_contacts();}return this.$3;},set_contacts:function(value){if(this.$3!==value){this.$3=value;this.$B=true;this.$2A();}return value;},get_userSettingsInfo:function(){if(this.$4==null){this.$4=this.$18.get_userSettingsInfo();}return this.$4;},set_userSettingsInfo:function(value){if(this.$4!==value){this.$4=value;this.$C=true;this.$2A();}return value;},get_configurationInfo:function(){if(this.$5==null){this.$5=this.$18.get_configurationInfo();}return this.$5;},set_configurationInfo:function(value){if(this.$5!==value){this.$5=value;this.$D=true;this.$2A();}return value;},get_messengerSessionState:function(){if(this.$6==null){this.$6=this.$18.get_messengerSessionState();}return this.$6;},set_messengerSessionState:function(value){if(this.$6!==value){this.$6=value;this.$E=true;}return value;},get_messengerSessionEvents:function(){if(this.$7==null){this.$7=this.$18.get_messengerSessionEvents();}return this.$7;},set_messengerSessionEvents:function(value){if(this.$7!==value){this.$7=value;this.$F=true;}return value;},get_services:function(){var $0=this.get_messengerSessionState();if($0!=null){return $0.services;}return 0;},set_services:function(value){var $0=this.get_messengerSessionState();if(($0!=null)&&($0.services!==value)){$0.services=value;this.$E=true;this.$2A();}return value;},get_switchingServices:function(){return this.$1B;},set_switchingServices:function(value){this.$1B=value;return value;},updateConfiguration:function(configuration){this.set_configurationInfo(this.$5);this.$D=true;this.$2A();},updateSessionId:function(newSessionId){if(this.$8==null){this.$8=this.$18.get_signInStatusResponseInfo();}var $0=this.get_messengerSessionState();if($0!=null){$0.sessionToken=newSessionId;this.$E=true;this.$10=true;this.$2A();}},updateTrid:function(newTrid){if(this.$8==null){this.$8=this.$18.get_signInStatusResponseInfo();}var $0=this.get_messengerSessionState();if($0!=null){$0.transactionID=newTrid;this.$E=true;this.$2A();}},expire:function(){this.$31();this.$2A();},onSignedOut:function(reason){if(reason===0||reason===1){this.$32();if(MSCr.O$6.$21()){this.$24(null);}this.$18.onSignedOut(false);}else{this.$18.onSignedOut(true);var $0=this.get_messengerSessionState();if($0!=null){$0.disconnected=true;$0.sessionToken=null;this.$E=true;this.$2A();}}},normalizeSignInEvents:function(){var $0=this.get_messengerSessionEvents();if($0==null){return;}MSCr.O$6.$1E($0);this.$F=true;this.$2A();},onAddressBookLoaded:function(addressBookResponse){var $0=this.get_networks();var $1=addressBookResponse.networks;if($0!=null&&$1!=null){for(var $2=0;$2<$0.length;$2++){for(var $3=0;$3<$1.length;$3++){if($0[$2].id===$1[$3].id){$1[$3].status=$0[$2].status;}}}}this.set_networks($1);this.set_groups(addressBookResponse.groups);this.set_contacts(addressBookResponse.contacts);this.set_userSettingsInfo(addressBookResponse.settings);this.$9=true;this.$A=true;this.$B=true;this.$C=true;this.$2A();},onNetworkStatusChanged:function(networkId,status){var $0=this.get_networks();if($0!=null){var $enum1=ss.IEnumerator.getEnumerator($0);while($enum1.moveNext()){var $1=$enum1.get_current();if(String.compare($1.id,networkId,true)===0){if($1.status!==status){$1.status=status;if($1.status===0){MSCr.O$6.$0(this.get_messengerSessionEvents(),networkId);this.$F=true;}this.$9=true;}break;}}if(this.$9){this.$2A();}}},onNetworkIMEnabledChanged:function(networkId,imEnabled){var $0=this.get_networks();if($0!=null){for(var $1=0;$1<$0.length;$1++){var $2=$0[$1];if($2.id===networkId){if($2.imEnabled!==imEnabled){$2.imEnabled=imEnabled;this.$9=true;}break;}}if(this.$9){this.$2A();}}},getConversationContactCids:function(){var $0=[];var $1=this.$18.get_conversations();if($1!=null&&$1.conversations!=null){var $enum1=ss.IEnumerator.getEnumerator($1.conversations);while($enum1.moveNext()){var $2=$enum1.get_current();var $enum2=ss.IEnumerator.getEnumerator($2.roster);while($enum2.moveNext()){var $3=$enum2.get_current();if(!String.isNullOrEmpty($3.cid)){$0.add($3.cid);}}}}return MSH.CollectionHelper.toArray($0);},serviceDataChanged:function(address,serviceData,updateDelete){var $0=this.get_messengerSessionEvents();if($0==null){return serviceData.toArray();}var $1=MSCr.O$6.$1($0,address,serviceData,updateDelete);this.$F=true;this.$2A();return $1;},getServiceDataInfo:function(address){var $0=this.get_messengerSessionEvents();if($0==null){return new Array(0);}return MSCr.O$6.$2($0,address);},mailNotificationReceived:function(mailNotification){var $0=this.get_messengerSessionEvents();if($0==null){return;}MSCr.O$6.$A($0,mailNotification);this.$F=true;this.$2A();},alertNotificationReceived:function(alertInfo){var $0=MC.$create_PersistedAlert(alertInfo.actionUrl,alertInfo.subscrUrl,alertInfo.iconUrl,alertInfo.timestamp,alertInfo.message,alertInfo.type);var $1=[];if(this.$18.get_alerts()!=null){var $enum1=ss.IEnumerator.getEnumerator(this.$18.get_alerts().alerts);while($enum1.moveNext()){var $2=$enum1.get_current();$1.add($2);}}if($1.length>=50){$1.removeAt(0);}$1.add($0);if(this.$17==null){this.$17=MC.$create_PersistedAlerts();}this.$17.alerts=MSH.CollectionHelper.toArray($1);this.$13=true;this.$2A();},get_alerts:function(){if(this.$17==null){this.$17=this.$18.get_alerts();}return this.$17;},contactCreatedOrUpdated:function(contactId,contact){if((this.$3==null)||(contact==null)){return;}this.$1F(contact);var $0=this.$21(contactId);if($0==null){this.$22(contactId,contact);}else{MSCr.O$6.$17(contactId,$0,contact);}this.$B=true;this.$2A();},contactDeleted:function(contact){if((this.$3==null)||(contact==null)||String.isNullOrEmpty(contact.id)){return;}var $0=MSCr.O$6.$F(contact,this.$3);if($0!==this.$3){this.$3=$0;this.$B=true;}if(this.$2.length>0){var $enum1=ss.IEnumerator.getEnumerator(this.$2);while($enum1.moveNext()){var $3=$enum1.get_current();if(MSCr.O$6.$14($3,contact)){this.$A=true;}}}var $1={};var $enum2=ss.IEnumerator.getEnumerator(contact.addresses);while($enum2.moveNext()){var $4=$enum2.get_current();$1[MSH.ContactHelper.getIMAddressInfoKey($4)]=$4;}var $2=this.$20();if($2!=null){var $5=[];var $enum3=ss.IEnumerator.getEnumerator($2.addresses);while($enum3.moveNext()){var $6=$enum3.get_current();if(!Object.keyExists($1,MSH.ContactHelper.getIMAddressInfoKey($6))){$5.add($6);}}$2.addresses=MSH.CollectionHelper.toArray($5);this.$B=true;}if(this.$B||this.$A){this.$2A();}},addIMAddress:function(address){var $0=this.$20();if($0==null){return;}MSCr.O$6.$15($0,address);this.$B=true;this.$2A();},removeAddressFromContact:function(contactId,addressInfo){var $0=this.$21(contactId);if(($0==null)||(addressInfo==null)){return;}MSCr.O$6.$16($0,addressInfo);this.$B=true;this.$2A();},updateRoleListsForCid:function(cid,roleLists){if((this.$3==null)||String.isNullOrEmpty(cid)){return;}var $0=this.$1D(cid);if($0!=null){$0.roleLists=roleLists;this.$B=true;this.$2A();}},addContactToGroup:function(contactInfo,groupInfo){if((contactInfo==null)||(groupInfo==null)||(this.$2==null)||String.isNullOrEmpty(contactInfo.id)||String.isNullOrEmpty(groupInfo.id)){return;}var $0=this.$1E(groupInfo);if($0==null){return;}if(MSCr.O$6.$13($0,contactInfo.id)){return;}MSCr.O$6.$D(contactInfo,$0);this.$A=true;this.$2A();},removeContactFromGroup:function(contactInfo,groupInfo){if((contactInfo==null)||(groupInfo==null)||(this.$2==null)||String.isNullOrEmpty(contactInfo.id)||String.isNullOrEmpty(groupInfo.id)){return;}var $0=this.$1E(groupInfo);if($0==null){return;}if(!MSCr.O$6.$13($0,contactInfo.id)){return;}MSCr.O$6.$14($0,contactInfo);this.$A=true;this.$2A();},groupAdded:function(groupInfo){if(groupInfo==null){return;}if(this.$2==null){this.$2=new Array(0);}var $0=this.$1E(groupInfo);if($0==null){this.$2=MSCr.O$6.$1B(this.$2,groupInfo);}else{MSCr.O$6.$1C($0,groupInfo);}this.$A=true;this.$2A();},groupRemoved:function(groupInfo){if((groupInfo==null)||(this.$2==null)){return;}var $0=this.$1E(groupInfo);if($0==null){return;}this.$2=MSCr.O$6.$1D(this.$2,$0);this.$A=true;this.$2A();},groupModified:function(groupInfo){this.groupAdded(groupInfo);},$1D:function($p0){if(this.$3==null){return null;}return MSCr.O$6.$11(this.$3,$p0);},$1E:function($p0){if(this.$2==null){return null;}return MSCr.O$6.$19($p0,this.$2);},$1F:function($p0){var $0=this.$20();if($0!=null){for(var $1=0,$2=$0.addresses.length;$1<$2;$1++){var $enum1=ss.IEnumerator.getEnumerator($p0.addresses);while($enum1.moveNext()){var $3=$enum1.get_current();if(MSH.ContactHelper.getIMAddressInfoKey($0.addresses[$1])===MSH.ContactHelper.getIMAddressInfoKey($3)){$0.addresses[$1]=$3;break;}}}}},$20:function(){return MSCr.O$6.$1A(this.$3);},$21:function($p0){return MSCr.O$6.$18($p0,this.$3);},$22:function($p0,$p1){this.$3=MSCr.O$6.$E(MC.$create_ContactInfo($p0,$p1.nickname,$p1.addresses),this.$3);},$23:function(){if(this.$8==null){return this.$18.get_signInStatusResponseInfo();}return this.$8;},$24:function($p0){if(($p0!=null)&&!$p0.signInStatus.isAuthenticated){if(this.$8!=null){this.$31();this.$2A();}return;}if((this.$8!=null)&&($p0!=null)){if(this.$25($p0.identity)||!MSCr.O$6.$20($p0.signInStatus)){this.$31();}}this.$8=$p0;this.$10=true;this.$2A();},$25:function($p0){if(this.$8==null){return true;}return this.$8.identity.liveId!==$p0.liveId||this.$8.identity.endpointId!==$p0.endpointId||this.$8.identity.authenticationInfo.ticket!==$p0.authenticationInfo.ticket;},$26:function($p0,$p1){return MSH.DateTimeHelper.exceeded($p0,Date.get_now(),$p1);},get_appContactsTicketInfo:function(){if(this.$14==null){this.$27();}else if(this.$26(this.$14.creationTime,MSCr.MessengerStatusSnapshot.$0)){this.$14=null;this.$11=true;this.$2A();}return this.$14;},$27:function(){this.$14=this.$18.get_appContactsTicketInfo();},applicationContactsChanged:function(cids,ticketInfo){this.$14=MC.$create_PersistedAppContactsTicketInfo(cids,ticketInfo);this.$11=true;this.$2A();},get_appContactsPresenceInfo:function(){this.$28();return this.$15.presenceInfoList;},$28:function(){if(this.$15==null){this.$15=this.$18.get_appContactsPresenceInfo();if(this.$15!=null){if(this.$26(this.$15.creationTime,MSCr.MessengerStatusSnapshot.$0)){this.$15=null;this.$16=null;this.$12=true;this.$2A();}else{this.$29();}}}else if(this.$26(this.$15.creationTime,MSCr.MessengerStatusSnapshot.$0)){this.$15=null;this.$16=null;this.$12=true;this.$2A();}},$29:function(){this.$16={};var $enum1=ss.IEnumerator.getEnumerator(this.$15.presenceInfoList);while($enum1.moveNext()){var $0=$enum1.get_current();this.$16[$0.addressInfo.cid]=$0;}},getAppContactsPresenceInfo:function(cid){this.$28();if(this.$16==null){return null;}else{return this.$16[cid];}},getContactAddressesOnLocalNetworks:function(skipSelf){var $0=[];var $1={};var $2=this.get_contacts();var $3=this.get_signInStatusResponseInfo();if(($2!=null)&&($3!=null)){var $enum1=ss.IEnumerator.getEnumerator($2);while($enum1.moveNext()){var $4=$enum1.get_current();var $enum2=ss.IEnumerator.getEnumerator($4);while($enum2.moveNext()){var $5=$enum2.get_current();if($5.addresses!=null){var $enum3=ss.IEnumerator.getEnumerator($5.addresses);while($enum3.moveNext()){var $6=$enum3.get_current();if(skipSelf&&($6.type===1)&&($6.address===$3.identity.liveId)){continue;}if($6.type===13){continue;}if((($6.roleLists&1)===1)&&!Object.keyExists($1,MSH.ContactHelper.getIMAddressInfoKey($6))){$0.add($6);$1[MSH.ContactHelper.getIMAddressInfoKey($6)]=$6;}}}}}}return MSH.CollectionHelper.toArray($0);},applicationContactsPresenceInfoChanged:function(presenceInfoResponse){if(presenceInfoResponse.presenceInfo==null||presenceInfoResponse.presenceInfo.length===0){return;}if(this.$15==null){this.$15=MC.$create_PersistedAppContactsPresenceInfo(presenceInfoResponse.presenceInfo);}else{var $0=[];var $enum1=ss.IEnumerator.getEnumerator(this.$15.presenceInfoList);while($enum1.moveNext()){var $2=$enum1.get_current();$0.add($2);}var $enum2=ss.IEnumerator.getEnumerator(presenceInfoResponse.presenceInfo);while($enum2.moveNext()){var $3=$enum2.get_current();$0.add($3);}var $1=this.$15.creationTime;this.$15=MC.$create_PersistedAppContactsPresenceInfo(MSH.CollectionHelper.toArray($0));this.$15.creationTime=$1;}this.$29();this.$12=true;this.$2A();},$2A:function(){if(this.$18.get_usesLocalStorageProxy()){MSH.Scheduler.defer(ss.Delegate.create(this,this.$2B));}else{this.$2B();}},$2B:function(){this.$2C();this.$2D();this.$30();this.$2F();this.$2E();},$2C:function(){if(this.$10){this.$19++;this.$18.set_signInStatusResponseInfo(this.$8);this.$10=false;}},$2D:function(){if(this.$9){this.$19++;this.$18.set_networks(this.$1);this.$9=false;}if(this.$A){this.$19++;this.$18.set_groups(this.$2);this.$A=false;}if(this.$B){this.$19++;this.$18.set_contacts(this.$3);this.$B=false;}if(this.$C){this.$19++;this.$18.set_userSettingsInfo(this.$4);this.$C=false;}if(this.$D){this.$19++;this.$18.set_configurationInfo(this.$5);this.$D=false;}if(this.$E){this.$19++;this.$18.set_messengerSessionState(this.$6);this.$E=false;}if(this.$F){this.$19++;this.$18.set_messengerSessionEvents(this.$7);this.$F=false;}},$2E:function(){if(this.$13){this.$19++;this.$18.set_alerts(this.$17);this.$13=false;}},$2F:function(){if(this.$12){this.$19++;this.$18.set_appContactsPresenceInfo(this.$15);this.$12=false;}},$30:function(){if(this.$11){this.$19++;this.$18.set_appContactsTicketInfo(this.$14);this.$11=false;}},$31:function(){this.$8=null;this.$10=true;this.$32();},$32:function(){this.$17=null;this.$13=true;this.$14=null;this.$11=true;this.$1=null;this.$9=true;this.$2=null;this.$A=true;this.$3=null;this.$B=true;this.$4=null;this.$C=true;this.$6=null;this.$E=true;this.$7=null;this.$F=true;this.$5=null;this.$D=true;},$33:function($p0,$p1){if(($p1.get_revision()>this.$19)&&($p1.get_data()!=null)){switch($p1.get_element()){case 3:this.$2=$p1.get_data();break;case 2:this.$3=$p1.get_data();break;case 5:this.$4=$p1.get_data();break;case 4:this.$1=$p1.get_data();break;case 6:this.$5=$p1.get_data();break;case 7:this.$6=$p1.get_data();break;case 8:this.$7=$p1.get_data();break;}}this.$19=$p1.get_revision();},$34:function($p0,$p1){if($p1.get_data()==null){return;}if(($p1.get_element()===7)&&(this.$6==null)){this.$6=$p1.get_data();}if(($p1.get_element()===8)&&(this.$7==null)){this.$7=$p1.get_data();}if(($p1.get_element()===3)&&(this.$2==null)){this.$2=$p1.get_data();}if(($p1.get_element()===2)&&(this.$3==null)){this.$3=$p1.get_data();}if(($p1.get_element()===4)&&(this.$1==null)){this.$1=$p1.get_data();}if(($p1.get_element()===5)&&(this.$4==null)){this.$4=$p1.get_data();}if(($p1.get_element()===6)&&(this.$5==null)){this.$5=$p1.get_data();}if($p1.get_element()===14){this.$14=$p1.get_data();}if($p1.get_element()===12){this.$17=$p1.get_data();}},get_name:function(){return'MessengerStatusSnapshot';},getStatusText:function(){var $0=new ss.StringBuilder();$0.append('[MessengerStatusSnapshot] ');if(this.$3!=null){$0.append('Contacts count: ');$0.append(this.$3.length);}if(this.$7!=null){$0.append('| Messenger session events count: ');$0.append(this.$7.events.length);}if(this.$2!=null){$0.append('| Groups count: ');$0.append(this.$2.length);}return $0.toString();}}
MSCr.O$7=function(service){this.$0=service;}
MSCr.O$7.prototype={$0:null,get_$1:function(){return this.$0;},$2:function($p0){this.$26($p0);},$3:function($p0){this.$26($p0);},$4:function($p0){this.$26($p0);},$5:function($p0){this.get_$1().$D($p0);},$6:function($p0){this.get_$1().$D($p0);},$7:function($p0){this.$26($p0);},$8:function($p0){this.$26($p0);},$9:function($p0){this.$26($p0);},$A:function($p0){this.$26($p0);},$B:function($p0){this.$26($p0);},$C:function($p0){this.$26($p0);},$D:function($p0){this.$26($p0);},$E:function($p0){this.$26($p0);},$F:function($p0){this.$26($p0);},$10:function($p0){this.$26($p0);},$11:function($p0){this.$26($p0);},$12:function($p0){this.$26($p0);},$13:function($p0){this.$26($p0);},$14:function($p0){this.$26($p0);},$15:function($p0){this.$26($p0);},$16:function($p0){this.$26($p0);},$17:function($p0){this.$26($p0);},$18:function($p0){this.$26($p0);},$19:function($p0){this.get_$1().$D($p0);},$1A:function($p0){this.$26($p0);},$1B:function($p0){this.$26($p0);},$1C:function($p0){this.$26($p0);},$1D:function(){this.$26(null);},$1E:function($p0){this.$26($p0);},$1F:function($p0){this.$26($p0);},$20:function($p0){this.$26($p0);},$21:function($p0){this.$26($p0);},$22:function($p0){this.$26($p0);},$23:function($p0){this.$26($p0);},$24:function($p0){this.$26($p0);},$25:function($p0){this.$26($p0);},$26:function($p0){}}
MSCr.O$13=function(service){MSCr.O$13.initializeBase(this,[service]);}
MSCr.O$13.prototype={$27:null,$4:function($p0){this.get_$1().$D($p0);},$13:function($p0){this.$27=$p0;},$11:function($p0){this.get_$1().$D($p0);},$23:function($p0){var $0=new MSCr.O$14(this.get_$1());this.get_$1().$D($p0);this.get_$1().$E($0);if(this.$27!=null){$0.$13(this.$27);}}}
MSCr.O$12=function(service){this.$27=[];this.$28=[];MSCr.O$12.initializeBase(this,[service]);this.$2C=MSH.DateTimeHelper.addMilliseconds(Date.get_now(),this.get_$2F());}
MSCr.O$12.prototype={$29:null,$2A:null,$2B:null,$2C:null,$2:function($p0){this.get_$1().$D($p0);},$3:function($p0){this.get_$1().$D($p0);},$7:function($p0){this.get_$1().$D($p0);},$4:function($p0){this.get_$1().$D($p0);},$8:function($p0){this.get_$1().$D($p0);},$F:function($p0){this.get_$1().$D($p0);},$24:function($p0){this.get_$1().$D($p0);},$14:function($p0){if($p0.get_$17()){this.$33();this.get_$1().$E(new MSCr.O$15(this.get_$1(),$p0));}this.get_$1().$D($p0);},$10:function($p0){switch(this.get_$1().get_$15()){case 1:this.get_$1().$D($p0);break;case 2:this.$27.add($p0.get_$10());this.get_$1().$18();break;}},$1D:function(){while(this.$27.length>0){(this.$27[0]).retry();this.$27.removeAt(0);}},$15:function($p0){this.get_$1().$D($p0);},$16:function($p0){this.get_$1().$D($p0);},$17:function($p0){this.$28.enqueue($p0);this.$32();},$18:function($p0){this.get_$1().$D($p0);},$1A:function($p0){this.$28.enqueue($p0);this.$32();},$1B:function($p0){this.get_$1().$D($p0);},$1C:function($p0){this.get_$1().$D($p0);},$22:function($p0){this.get_$1().$D($p0);},$25:function($p0){this.get_$1().$D($p0);},$1E:function($p0){this.get_$1().$D($p0);if(this.$29!=null){this.$29.$19($p0.get_$12());}},$1F:function($p0){this.get_$1().$D($p0);},$20:function($p0){this.get_$1().$D($p0);},$21:function($p0){this.$33();this.get_$1().$E(new MSCr.O$14(this.get_$1()));this.get_$1().$D($p0);},$12:function($p0){this.get_$1().$D($p0);},$B:function($p0){this.get_$1().$D($p0);},$D:function($p0){this.get_$1().$D($p0);},$C:function($p0){this.get_$1().$D($p0);},$9:function($p0){this.get_$1().$D($p0);},$A:function($p0){this.get_$1().$D($p0);},$E:function($p0){if(this.$2A!=null){return;}this.$2A=$p0;var $0=0;var $1=Date.get_now();if(MSH.DateTimeHelper.isGreaterThanOrEqual(this.$2C,$1)){$0=Math.round(MSH.DateTimeHelper.subtract(this.$2C,Date.get_now())/1000);}this.$2B=new MSH.Timer(ss.Delegate.create(this,this.$2D),$p0,$0,MSH.Timeout.infinite);},$2D:function($p0){this.$2A.add_$B(ss.Delegate.create(this,this.$2E));this.get_$1().$D(this.$2A);},$2E:function($p0,$p1){this.$30();this.$2C=MSH.DateTimeHelper.addMilliseconds(Date.get_now(),this.get_$2F());},get_$2F:function(){var $0=this.get_$1().get_$17().addressBook.syncAddressBookInterval;if($0!=null){return $0;}return 1000*30;},$30:function(){if(this.$2A!=null){this.$2A.remove_$B(ss.Delegate.create(this,this.$2E));this.$2A=null;}if(this.$2B!=null){this.$2B.dispose();this.$2B=null;}},$31:function($p0,$p1){this.$29.remove_$B(ss.Delegate.create(this,this.$31));this.$29=null;this.$32();},$32:function(){while(this.$29==null&&this.$28.length!==0){var $0=this.$28.dequeue();this.$29=Type.safeCast($0,MSCr.O$B);if(this.$29!=null){this.$29.add_$B(ss.Delegate.create(this,this.$31));}this.get_$1().$D($0);}},$33:function(){if(this.$29!=null){this.$29.remove_$B(ss.Delegate.create(this,this.$31));this.$29=null;}this.$28.clear();this.$30();}}
MSCr.O$14=function(service){MSCr.O$14.initializeBase(this,[service]);}
MSCr.O$14.prototype={$4:function($p0){this.get_$1().$D($p0);},$13:function($p0){this.get_$1().$E(new MSCr.O$16(this.get_$1(),$p0));this.get_$1().$D($p0);}}
MSCr.O$16=function(service,command){this.$28=[];MSCr.O$16.initializeBase(this,[service]);this.$27=command;this.$27.add_$B(ss.Delegate.create(this,this.$29));}
MSCr.O$16.prototype={$27:null,$14:function($p0){if($p0.get_$17()){this.get_$1().$E(new MSCr.O$15(this.get_$1(),$p0));}this.get_$1().$D($p0);},$17:function($p0){this.$28.add($p0);},$24:function($p0){this.$27.$22($p0.get_$12(),$p0.get_$14(),$p0.get_$13());},$21:function($p0){this.get_$1().$E(new MSCr.O$14(this.get_$1()));this.$27.$23();},$10:function($p0){$p0.get_$10().fail();},$29:function($p0,$p1){this.$27.remove_$B(ss.Delegate.create(this,this.$29));if(this.$27.get_$4()){var $0=new MSCr.O$12(this.get_$1());this.get_$1().$E($0);var $enum1=ss.IEnumerator.getEnumerator(this.$28);while($enum1.moveNext()){var $1=$enum1.get_current();$0.$17($1);}}else{this.get_$1().$E(new MSCr.O$14(this.get_$1()));}}}
MSCr.O$15=function(service,command){MSCr.O$15.initializeBase(this,[service]);command.add_$B(ss.Delegate.create(this,this.$27));}
MSCr.O$15.prototype={$27:function($p0,$p1){this.get_$1().$E(new MSCr.O$14(this.get_$1()));},$12:function($p0){this.get_$1().$D($p0);}}
MSCr.ApplicationService.registerClass('MSCr.ApplicationService',null,MC.IApplicationService);MSCr.UserService.registerClass('MSCr.UserService',null,MC.IUserService,MC.IConnectionServiceEvents);MSCr.O$5.registerClass('MSCr.O$5');MSCr.O$1A.registerClass('MSCr.O$1A',MSCr.O$5);MSCr.O$1B.registerClass('MSCr.O$1B',MSCr.O$5);MSCr.O$18.registerClass('MSCr.O$18',MSCr.O$5);MSCr.O$9.registerClass('MSCr.O$9',MSCr.O$5);MSCr.O$F.registerClass('MSCr.O$F',MSCr.O$5);MSCr.O$2F.registerClass('MSCr.O$2F',MSCr.O$5);MSCr.O$1F.registerClass('MSCr.O$1F',MSCr.O$5);MSCr.O$22.registerClass('MSCr.O$22',MSCr.O$5);MSCr.O$21.registerClass('MSCr.O$21',MSCr.O$5);MSCr.O$23.registerClass('MSCr.O$23',MSCr.O$5);MSCr.O$25.registerClass('MSCr.O$25',MSCr.O$5);MSCr.O$24.registerClass('MSCr.O$24',MSCr.O$5);MSCr.O$1D.registerClass('MSCr.O$1D',MSCr.O$5);MSCr.O$1C.registerClass('MSCr.O$1C',MSCr.O$5);MSCr.O$1E.registerClass('MSCr.O$1E',MSCr.O$5);MSCr.O$20.registerClass('MSCr.O$20',MSCr.O$5);MSCr.O$26.registerClass('MSCr.O$26',MSCr.O$5);MSCr.O$2D.registerClass('MSCr.O$2D',MSCr.O$5);MSCr.O$2C.registerClass('MSCr.O$2C',MSCr.O$5);MSCr.O$2E.registerClass('MSCr.O$2E',MSCr.O$5);MSCr.O$30.registerClass('MSCr.O$30',MSCr.O$5);MSCr.O$28.registerClass('MSCr.O$28',MSCr.O$5);MSCr.O$27.registerClass('MSCr.O$27',MSCr.O$5);MSCr.O$29.registerClass('MSCr.O$29',MSCr.O$5);MSCr.O$2B.registerClass('MSCr.O$2B',MSCr.O$5);MSCr.O$2A.registerClass('MSCr.O$2A',MSCr.O$5);MSCr.O$10.registerClass('MSCr.O$10',MSCr.O$5);MSCr.O$E.registerClass('MSCr.O$E',MSCr.O$5);MSCr.O$D.registerClass('MSCr.O$D',MSCr.O$5);MSCr.O$11.registerClass('MSCr.O$11',MSCr.O$5);MSCr.O$8.registerClass('MSCr.O$8',MSCr.O$5);MSCr.O$A.registerClass('MSCr.O$A',MSCr.O$5);MSCr.O$C.registerClass('MSCr.O$C',MSCr.O$5);MSCr.O$B.registerClass('MSCr.O$B',MSCr.O$5);MSCr.O$17.registerClass('MSCr.O$17',MSCr.O$5);MSCr.O$19.registerClass('MSCr.O$19',MSCr.O$5);MSCr.O$6.registerClass('MSCr.O$6');MSCr.MessengerStatusSnapshot.registerClass('MSCr.MessengerStatusSnapshot',null,MC.IMessengerStatusSnapshot,MSH.IStatusCollector);MSCr.O$7.registerClass('MSCr.O$7');MSCr.O$13.registerClass('MSCr.O$13',MSCr.O$7);MSCr.O$12.registerClass('MSCr.O$12',MSCr.O$7);MSCr.O$14.registerClass('MSCr.O$14',MSCr.O$7);MSCr.O$16.registerClass('MSCr.O$16',MSCr.O$7);MSCr.O$15.registerClass('MSCr.O$15',MSCr.O$7);MSCr.O$1A.$D=8*60*60*1000;MSCr.MessengerStatusSnapshot.$0=59*60*1000;MSCr.MessengerStatusSnapshot.$1C=[];});