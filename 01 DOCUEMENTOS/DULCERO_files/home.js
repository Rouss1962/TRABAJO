registerNamespace("$SB");new function(){if(typeof $SB.SearchBox!=="function")return;$SB.renderModes=new $Enum("HOME","HOTMAIL","OTHER","CONTACTLIST","DOCUMENTS");var d=false;$SB.logEvent=function(b,a){$BSI.reportEvent("search.general",{SearchType:b+(a?"_"+a:""),SearchMethod:d?"enter":"click"});d=false};var c=$SB.SearchBox.prototype,a=$SB.renderModes,l=/%20/g,h="c_search_i",e="c_ms";c.getContentHeader=function(){var b=this;if(typeof b.contentHeader==="undefined")b.contentHeader=b[(!$SBC.auth?"bing":b.renderMode===a.HOME?"secondary":"primary")+"MenuItem"];return b.contentHeader};c.getEmailHeader=function(){var a=this;if(typeof a.emailHeader==="undefined")a.emailHeader=a.isEmailMode()?a.primaryMenuItem:null;return a.emailHeader};c.getHeaders=function(){var a=this;if(typeof a.headers==="undefined"){var d=["primary","secondary","bing"],c;a.headers=[];for(var b=0;b<d.length;b++)if(c=a[d[b]+"MenuItem"])a.headers.push(c)}return a.headers};c.isEmailMode=function(){return $SBC.auth&&(this.renderMode===a.HOME||this.renderMode===a.HOTMAIL)};function f(a){return a.encodeUrl().replace(l,"+")}function m(d,c){var b=d.renderMode;if(b==a.DOCUMENTS)return g(c);if(b==a.OTHER)return i(c);return null}function k(c,b){switch(c.renderMode){case a.HOME:case a.DOCUMENTS:return i(b);case a.OTHER:return g(b);case a.HOTMAIL:case a.CONTACTLIST:default:return null}}var o=$SB.getBingUrl=function(b){var a=$SB.formCode;return $SBC.bingUrl+"?q="+f(b)+(a?"&form="+a.encodeUrl():"")};function b(a){return a.getElementsByTagName("A")[0]}function i(a){return j(a,"people")}function g(a){return j(a,"documents")}function j(b,a){return $SBC.homeSerp+"?query="+f(b)+"&consumerid="+$SB.consumer.encodeUrl()+"&mkt="+$Config.mkt.encodeUrl()+(a?"&scope="+a.encodeUrl():"")}var n=function(j,cb){var eb=this,c=j,A=$(j.searchBoxId),i=V(),H=j.hasInitialQuery,F=false,n=null,s=cb,C=false,z=null,q=null,g=null,Z=j.getEmailHeader(),K=j.getContentHeader(),db=false,G=false,f=j.isEmailMode()?$SB.MailSearchHelper:null,u="H_search_contacts",D="H_search_documents",I="H_search_email",U="H_search_contact_list",l="H_search_bing",y={HOME:[I,u,l],HOTMAIL:[I,l],OTHER:[u,D,l],CONTACTLIST:[U,l],DOCUMENTS:[D,u,l]};function ab(){var e=c.getHeaders(),d=c.renderMode;$f.addEvent(b(e[0]),"onclick",function(b){$SB.logEvent(y[d][0]);if(typeof c.searchEmailFunc!="function"){v(c.getValue());if(d==a.OTHER||d==a.DOCUMENTS)return true;if($B.IE_M6){$(c.formId).submit();return $f.cancelEvent(b)}else{c.submitForm();return true}}else{c.searchEmailFunc(c.getValue());r();return $f.cancelEvent(b)}});$f.addEvent(b(e[1]),"onclick",function(){v(c.getValue());$SB.logEvent(y[d][1]);r();return true});e[2]&&$f.addEvent(b(e[2]),"onclick",function(){v(c.getValue());$SB.logEvent(y[d][2]);r();return true});!c.usesForm&&$f.addEvent($(c.submitId),"onclick",function(a){c.searchEmailFunc(c.getValue());r();return $f.cancelEvent(a)});$f.addEvent(A,"onfocus",bb);$f.addEvent(A,"onfocus",t);$f.addEvent(A,"onkeyup",t)}function r(){var a=i.binding;a&&a.isOpen()&&a.hide()}function bb(a){J(a);E();if(H){t(a);H=false}}function E(){if(!C)s.initialize(P);C=true}function J(e){if(F)return;F=true;var b=6;$B.rtl&&(b=7);($B.IE||$B.Chrome||$B.Safari)&&(b=5);var c={x:-3,y:b};$menu.bind(e,0,c,1,1,0,undefined,0,0,0,0,0,"click");var a=i.binding;a&&a.EnterEvent.attach(function(){d=true});a&&s.onTab&&a.TabEvent.attach(function(b){s.onTab(b,a)})}function V(){var f=$(c.formId),g=c.renderMode,d=$SBC.firstHead,b=$SBC.secondHead,e=$SBC.bingHead,a=_ce("ul");a.className="c_m t_hovl c_search_menu";a.setAttribute("id",c.idPrefix+"menu");a.setAttribute("sutra","searchboxdropdown");c.primaryMenuItem=w(a,"t_hov",d,1,0,"SearchEmail");b&&(c.secondaryMenuItem=w(a,0,b,1,0,0));c.bingMenuItem=w(a,0,e,0,1,0);f.appendChild(a);return a}function w(f,b,e,c,d,g){var a=_ce("li");g&&a.setAttribute("aId","SearchEmail");a.setAttribute("sutra","searchboxitem");a.innerHTML='<a href="javascript:;" target="'+(d?"_blank":"_top")+'" '+'class="'+(b?b+" ":"")+'c_search_heading">'+e.encodeHtml()+"</a>"+(c?'<span class="c_ms"></span>':"");f.appendChild(a);return a}function t(a){J(a);E();X()}function X(){if(z===null){z=setTimeout(function(){if(q!==null){B(q);q=null}z=null},$SBC.queryInterval);B(c.getValue())}else q=c.getValue()}function B(a){if(a===n)return;n=a;if(!Y(a)&&Q(a)){if(!s.getMatches(p(a))){L(a,true);!G&&x(true);G=true}}else P([],p(a))}function v(e){var a=c.getHeaders(),g=b(a[0]),f=a.length>2&&b(a[1]),h=b(a[a.length-1]),d;(d=m(c,e))&&g.setAttribute("href",d);f&&(d=k(c,e))&&f.setAttribute("href",d);h.setAttribute("href",o(e))}function P(b,g){if(p(n)!==g)return;var e=K;x(false);O();var f=L(n,false);c.renderMode===a.HOTMAIL&&(b.length=Math.min(b.length,$SBC.max-f));for(var d=0;d<b.length;d++)e=M(b[d],e);T(b.length,n);N()}function p(a){return f?f.removeKeywords(a):a}function Y(a){return p(a).trim().length===0}function L(g,d){if(f){var a=f.getMailItems(g,c),e=Z;d&&O();for(var b=0;b<a.length;b++)e=M(a[b],e);d&&N();return a.length}return 0}function T(d,e){if(f&&c.renderMode===a.HOTMAIL)b(c.getEmailHeader()).innerHTML=f.getHeaderText(d,e).encodeHtml()}function Q(b){if(f&&c.renderMode===a.HOTMAIL)return f.queryStartsWithKeyword(b)!=="subject:";return true}function N(){W();i.binding.update()}function O(){var a=0,b=i.childNodes,d=null,e=c.getHeaders();while(b.length>a){d=b[a].className;if(d===h){i.removeChild(b[a]);b=i.childNodes}else a++}for(var a=0;a<e.length-1;a++)S(e[a])}function S(c){var a=null,b=c.childNodes;for(a=0;a<b.length;a++)if(b[a].className===e){c.removeChild(b[a]);break}}function W(){var f=c.getHeaders(),a=null,b=null;for(var d=1;d<f.length;d++){a=f[d].previousSibling;while(a.nodeType!==1)a=a.previousSibling;b=_ce("SPAN");b.className=e;a.appendChild(b)}}function M(c,b){var a=_ce("LI");a.setAttribute("sutra","searchboxitem");a.className=h;a.appendChild(c);i.insertBefore(a,b.nextSibling);return a}function x(a){R();g.style.display=a?"inline":"none";a&&setTimeout(function(){x(false)},$SBC.lt)}function R(){if(g===null){g=new Image;g.setAttribute("src",$SBC.ldImg);g.style.display="none";g.className="c_search_ld";b(K).appendChild(g)}}ab()};$SB.bindAllSearchBoxes=function(c){for(var b in $SB.sbs)if(!FunctionHelper.isSpecialMember($SB.sbs,b)){var a=$SB.sbs[b];new n(a,new c(a));$Config.isINT&&$(a.statusId).setAttribute("status","Ready")}}};new function(){var L="<strong>",M="</strong>",n=new $Enum("documents","picw"),c="setAttribute",E={canary:$SBC.canary,bicild:""},o="javascript:;",b;function F(a){return function(e,f){var c=a(e),d=a(f),b=0;if(c>d)b=1;else if(c<d)b=-1;return b}}function x(f,e,g){var a={},c=[e,E];switch(f){case n.documents:a.scope="documentsearch"}a.callback="$SB."+g;for(var b=0;b<c.length;b++)for(var d in c[b])a[d]=c[b][d];return $SBC.ufs+"?"+$Utility.serialize(a)}function m(a){if(!a)return false;return $Network.extractHost(a).endsWith("live"+($Config.isINT?"-int":"")+".com")}var p=" !\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~",I=new RegExp("["+p.escapeRegex()+"]","ig");function k(d){var b=[],a=null,c=null;if(d){b.push(a=d.lTrim());while((c=a.search(I))!=-1)b.push(a=a.substring(c+1).lTrim())}return b}function g(k,l,g,d,i,b,f,h,j,e){var a=_ce("A");if(b)a.className=b;a[c]("title",k);a[c]("target",f?"_blank":"_top");a[c]("href",l);$f.addEvent(a,"onclick",function(c){var b=g(c);$menu.closeCurrent();$SB.logEvent(h,a.sbindex||"");return b});d&&a.appendChild(d);a.appendChild(i);a.sbbinding=j;e&&(a.sbindex=e);return a}function t(f,h,g,e,b){var a=new Image,d=B(f,a,e);$f.addEvent(a,"onload",C(a));a.className="c_search_imgpad c_search_img"+(b?" "+b:"");a[c]("alt",h);a[c]("src",$ssl.ensureSSLImageUrl(G(f,g,e)));d&&$f.addEvent(a,"onerror",d);return a}function G(c,b,a){if(c.defaultImage)return a;return b}function C(a){return function b(){a.style.visibility="inherit";$f.removeEvent(a,"onload",b)}}function B(a,b,e){if(a.defaultImage)return null;return function d(){a.defaultImage=true;b[c]("src",$ssl.ensureSSLImageUrl(e));$f.removeEvent(b,"onerror",d)}}function l(b){var a=_ce("SPAN");a.className="c_search_txt";a.innerHTML=b;return a}var w={a:/[\xE0-\xE4]/ig,e:/[\xE8-\xEB]/ig,i:/[\xED-\xEF]/ig,o:/[\xF3-\xF5]/ig,u:/[\xF9-\xFC]/ig,n:/\xF1/ig,y:/\xFF/ig,c:/\xE7/ig};function i(a){a=a.toLowerCase();for(var b in w)if(!FunctionHelper.isSpecialMember(b))a=a.replace(w[b],b);return a}var e="\ue000",f="\ue001";function j(a,b,d){var c=h.match(a)?h.highlight(a,b):r(a,b,d);return c.encodeHtml().replace(new RegExp(e.encodeHtml(),"g"),L).replace(new RegExp(f.encodeHtml(),"g"),M)}function r(c,q,o){var m=[q].concat(q.split(" ")),b=new Array(c.length+2),r="(^|\\s"+(o?"|@":"")+(!o?"|["+p.escapeRegex()+"]":"")+")";for(var a=0;a<b.length;a++)b[a]=0;for(var a=0;a<m.length;a++){var s=m[a],l=i(c).replace(new RegExp(r+"("+i(s).escapeRegex()+")","ig"),"$1"+e+"$2"+f),n=0,d=0,h=0;while((n=l.indexOf(e,d))!=-1){d=l.indexOf(f,d+1);h+=2;for(var k=n-h+2;k<d-h+1;k++)b[k+1]=1}}var g=[];for(var a=1;a<b.length;a++)if(b[a]!=b[a-1])g.push(a-1);var j=0;for(var a=0;a<g.length;a++){j=g[a]+a;c=c.substr(0,j)+(a%2?f:e)+c.substr(j)}return c}var q=$SB.MailSearchHelper=new function(){var c=this,b={FROM:$SBC.from,SUBJECT:$SBC.subject,TO:$SBC.to},h={NORMAL:$SBC.emailHead,FROM:$SBC.emailFrom,TO:$SBC.emailTo},e=[b.FROM,b.SUBJECT,b.TO],a=["from:","subject:","to:"],f=null;c.keywords=b;c.getMailItems=function(f,q){var r=d(f),n=[];if(!c.queryStartsWithKeyword(r)){var p=null,b=null,k;for(var h=0;h<e.length;h++){b=e[h];p=['<span class="c_search_k">',b,"</span> <strong>",f.encodeHtml(),"</strong>"].join("");k=g(i(b,f),o,j(a[h],f,q),null,l(p),null,false,m(b),null,null);k.sbmail={k:b.trim(),q:f.trim()};n.push(k)}}return n};c.removeKeywords=function(a){return a.replace(k(),"")};c.getHeaderText=function(e,f){var b=null;if(e&&(b=c.queryStartsWithKeyword(d(f)))&&b!==a[1])switch(b){case a[0]:return h.FROM;case a[2]:return h.TO}return h.NORMAL};c.queryStartsWithKeyword=function(c){c=d(c);for(var b=0;b<a.length;b++)if(c.startsWith(d(a[b]))||c.startsWith(d(e[b])))return a[b];return null};function k(){if(!f){var b=a.clone();b.addRange(e);f=new RegExp("^\\s*("+b.join("|")+")","ig")}return f}function m(a){switch(a){case b.FROM:return "HM_from";case b.TO:return "HM_to";case b.SUBJECT:return "HM_subject";default:return ""}}function j(b,c,a){return function(d){a.searchEmailFunc(i(b,c));return $f.cancelEvent(d)}}function i(a,b){return a+" "+b}function d(a){return a.toLowerCase()}},h=new function(){var b=this,g=new RegExp("([\\uAC00-\\uD7AF])","g"),n=44032,h=4352,i=4449,j=4519,p=e,a=f,d={"\u3131":"\u1100","\u3132":"\u1101","\u3134":"\u1102","\u3137":"\u1103","\u3138":"\u1104","\u3139":"\u1105","\u3141":"\u1106","\u3142":"\u1107","\u3143":"\u1108","\u3145":"\u1109","\u3146":"\u110a","\u3147":"\u110b","\u3148":"\u110c","\u3149":"\u110d","\u314a":"\u110e","\u314b":"\u110f","\u314c":"\u1110","\u314d":"\u1111","\u314e":"\u1112"},l=k(d),o=new RegExp("([\\u1100-\\u1112][\\u1161-\\u1175][\\u11A8-\\u11C2]{0,1})","g"),m=new RegExp("([\\u1100-\\u1112]"+a+"{0,1}[\\u1161-\\u1175]"+a+"{0,1}[\\u11A8-\\u11C2]{0,1})","g");b.expand=function(a){a=a.replace(l,function(a){return d[a]});return a.replace(g,function(f){var a=f.charCodeAt(0)-n,b=Math.floor(a/588),e=Math.floor((a-b*588)/28),d=a%28;return c(b+h)+c(e+i)+(d?c(d+j):"")})};b.highlight=function(e,f){var d=r(b.expand(e),b.expand(f),0);return d.replace(m,function(b){return b.replace(a,"")+(b.match(a)?a:"")}).replace(o,function(a){var b=a.charCodeAt(0)-h,d=a.charCodeAt(1)-i,e=a.length>2?a.charCodeAt(2)-j:0;return c(b*588+d*28+e+44032)})};b.match=function(a){return a.match(g)};function c(a){return String.fromCharCode(a)}function k(){var a=["(["];for(var b in d)a.push(b);a.push("])");return new RegExp(a.join(""),"g")}},a=function(d,b,c){var a=this;a.key=d;a.weight=b;a.order=c},d=new function(){var b=this,a=new $Enum("VIEWPHOTOS","SEARCHEMAIL","SENDEMAIL","SENDMESSAGE","DOCSEDIT","DOCSPROPERTY"),c=new function(){var b=this;b[a.VIEWPHOTOS]=$SBC.viewPhotos;b[a.SEARCHEMAIL]=$SBC.searchEmail;b[a.SENDEMAIL]=$SBC.sendEmail;b[a.SENDMESSAGE]=$SBC.sendMsg;b[a.DOCSEDIT]=$SBC.docsEdit;b[a.DOCSPROPERTY]=$SBC.docsProperty};b.actionTypes=a;b.isActionPosition=function(a){return a===0};b.getActionNode=function(b,h,a,i,d){var f=function(b){if(a)return a(b);return true},e=c[b];return g(e,h,f,null,document.createTextNode(e),"c_search_ai"+(d?" "+d:""),i,"QA_"+b,null,null)}},K=function(){var b=this,m=$SBC.docsBase+"/default.png",i={query:"*","ds.OwnedByMe":"1","ds.Acled":"1",maxitems:"4000","ds.o.WordWheelView":"1"},f=d.actionTypes,e=d.getActionNode,h="c_search_d";b.localStorageKey="documents";b.getResults=function(c){var b=c.SearchResponse.DocumentSearch||[];for(var a=0;a<b.length;a++)b[a].sbid=a;return b};b.getSource=function(a){return x(n.documents,i,a)};b.comparer=function(a,b){return a.sbid-b.sbid};b.matchField=function(a){return a.t};b.getHtml=function(c,e){var b=[];for(var a=0;a<c.length;a++){b.push(p(c[a],e,a+1));d.isActionPosition(a)&&r(b,c[a])}return b};b.getKeysAndWeights=function(f){var d=k(f.t.toLowerCase()),c=[],b=d.length;b&&c.push(new a(d[0],1.5,1));for(var e=1;e<b-1;e++)c.push(new a(d[e],1,e+1));b&&c.push(new a(d[b-1],.5,b));return c};b.autoComplete=function(a){return a.t};b.compareParents=null;b.isValid=function(){return true};function r(b,c){var d=e(f.DOCSEDIT,$SBC.docsAction.format("edit",c.id),null,false,h),a=e(f.DOCSPROPERTY,$SBC.docsAction.format("self",c.id),null,false,h);$css.add(a,"c_search_last");b.push(d);b.push(a)}function p(a,d,b){return g(c(a),v(a),function(){return true},u(a),o(a,d),null,false,"WW_documents",a,b)}function c(a){return a.t}function v(a){return $SBC.docsAction.format("view",a.id)}function u(a){var e=s(a),d=$SBC.imgsBase,b=_ce("span"),f=0;b.className="c_search_imgpad";b.appendChild(!$B.rtl&&e!=null?$IS.Create(e,8,16,16,d,d+"h/s6.png",c(a)):t(a,c(a),q(a),m,0));return b}function q(a){return $SBC.imgsBase+"ftype/"+a.ty+".png"}function s(b){var a=46;switch(b.ty){case "ppt":return a+16*2;case "doc":return a+16*3;case "xls":return a+16;case "one":return a}return null}function o(a,b){return l(j(a.t,b))}},v=function(z,Q){var e=this,y=$SBC.utfb,v=z.contactOverride,E={"cs.DisableNickNames":1,"cs.shellcontacts":1},u=d.actionTypes,b=Q,f=z,i=$SB.renderModes,s=d.getActionNode;if($SBC.https)E["cs.httpsusertileonly"]=1;e.getResults=function(c){var b=c.SearchResponse.People;for(var a=0;a<b.length;a++)b[a].id=a;return b};e.getSource=function(a){return x(n.picw,{},a)};e.comparer=F(N);e.matchField=function(a){return h(p(a))};e.getHtml=function(c,e){var b=[];for(var a=0;a<c.length;a++){b.push(L(p(c[a]),e,a+1));d.isActionPosition(a)&&O(b,p(c[a]))}return b};e.getKeysAndWeights=function(b){b=p(b);var l=h(b),e=k(l||c(b)),d=[];e[0]&&d.push(new a(e[0],1.5,1));for(var f=1;f<e.length;f++)d.push(new a(e[f],1,f+1));if(r(b)){var i=k(b.get_network().get_name());for(var g=0;g<i.length;g++)d.push(new a(i[g],.75,g+1))}else if(l&&c(b)){var j=c(b).toLowerCase();d.push(new a(j,.75,1));d.push(new a(j.split("@")[1],.5,1))}return d};e.autoComplete=function(a){var d=c(a),g=h(a),e=f.renderMode==i.HOME;return b||e&&d?d:g};e.isValid=b?function(){return true}:function(a,b){return a.pId!=b.pId};e.compareParents=b?null:function(a,b){var c=a.pId-b.pId;if(c)return c;return a.lcOrder-b.lcOrder};function L(a,d,c){return g(B(a),A(a),function(b){return H(a,b)},b||f.renderMode===i.CONTACTLIST?null:P(a),K(a,d),null,!m(A(a)),"WW_contacts",a,c)}function H(a,c){if(v)return v(a,c);if(b){var d=q.queryStartsWithKeyword(f.getValue())||"";f.searchEmailFunc(d+" "+w(a));return $f.cancelEvent(c)}return true}function O(h,d){if(G()){var a=null,e=null,b=null;switch(f.renderMode){case i.HOME:e=s(u.SEARCHEMAIL,o,function(a){f.searchEmailFunc(w(d));return $f.cancelEvent(a)},false,0);break;case i.OTHER:if(a=D(d))e=s(u.VIEWPHOTOS,a,null,!m(a),0);break;default:return}if((r(d)||!c(d))&&(a=I(d)))b=s(u.SENDMESSAGE,a,null,!m(a),0);else if(!r(d)&&(a=J(d)))b=s(u.SENDEMAIL,a,null,false,0);var g=null;if(e&&!b)g=e;else if(b)g=b;g&&$css.add(g,"c_search_last");e&&h.push(e);b&&h.push(b)}}function G(){return !b&&(f.renderMode===i.HOME||f.renderMode===i.OTHER)}function w(a){return c(a)||h(a)||""}function D(a){if(a.get_photosUrl){var b=a.get_photosUrl()||"";return b.toString()}return 0}function J(b){var a=c(b);if(a)return $SBC.sendEmailLink.replace("{address}",a.encodeUrl().encodeUrl()).replace("{ru}",window.location.href.encodeUrl().encodeUrl());return null}function I(a){if(a.get_sendMessageUrl){var b=a.get_sendMessageUrl()||"";return b.toString()}return 0}function r(a){return a.get_network&&a.get_network().get_id()!="WL"}function B(b){var d=h(b),a=c(b);return (d||a||"")+(d&&a?C(a):"")}function C(a){return $B.rtl?" - "+a:" ("+a+")"}function A(a){var d=null;if(!(v||b)){var c=a.get_profileUrl()||"";return c.toString()||$SBC.profDet.format(a.get_id())}return o}function P(a){return t(a,B(a),M(a),y,"c_search_lg")}function K(a,d){var e=h(a)||"",g=c(a)||"",b="",f="";if(r(a))b=a.get_network().get_name();else if(e)b=g;f=(e?j(e,d):j(g,d,true))+(b&&!$B.rtl?' <span class="c_search_e">('+j(b,d,!r(a))+")</span>":"");return l(f)}function M(a){var b=a.get_displayPictureUrl()||"";return b.toString()||y}function h(a){return b?a.n:a.get_fullName()}function c(a){return b?a.e:a.get_emailAddress()}function N(a){return b?a.id:p(a).get_id()}function p(a){return b?a:a.c}},s=1,H=function(r){var l=this,k=null,e=r,g=null,p=false,J=false,j=null,R=/\s+/g,I="searchCallback"+s++,G="wlxSB",a=null,O="wlximlocalstoreready",X="searchboxlocalstore",t=false,F=false,c=function(){var a=$SB.renderModes;switch(e.renderMode){case a.HOTMAIL:return new v(r,true);case a.HOME:case a.OTHER:case a.CONTACTLIST:return new v(r,false);case a.DOCUMENTS:return new K;default:return null}}(),A="cid",B="xid",f="data",d=[],fb=c.comparer;function gb(){bb()&&C();$SB[I]=Q}l.getMatches=function(l){V();if(!p){g=l;return false}W(l);var i=S(l),w=c.matchField,f=[],h=null,b=null;if(i==""){k([],l);return true}h=H(i);for(var a=0;a<h.length;a++){b=h[a];f.push({obj:b.obj,weight:w(b.obj).toLowerCase()==i?b.weight+1.5:b.weight,bucket:0})}var j=i.split(" ");if(j.length>1)for(var a=0;a<j.length;a++){h=H(j[a]);for(var q=0;q<h.length;q++){b=h[q];f.push({obj:b.obj,weight:b.weight-.1*Math.abs(a+1-b.order),bucket:a+1})}}var e=[];if(f.length){var t=c.compareParents?[Z]:[];t.addRange([z,Y]);f.sort(y(t));var d=null,m=null,o=null,n=null,v=j.length>1?j.length:0,s=function(a){d=a;m=d.bucket;o=m==0?0:1},u=function(){(!n||c.isValid(n.obj,d.obj))&&o==v&&e.push(n=d)};s(f[0]);for(var a=1;a<f.length;a++){var b=f[a];if(z(d,b)){u();s(b)}else{d.weight=d.weight+b.weight;if(m!=b.bucket){m=b.bucket;o++}}}u()}e.sort(y([ab,N]));e.length=Math.min(e.length,$SBC.max);var r=new Array(e.length);for(var a=0;a<e.length;a++)r[a]=e[a].obj;var x=c.getHtml(r,i);k(x,l);return true};l.onTab=function(m,l){var j=l.getSelectedEl(),b=j.sbbinding,f=j.sbmail;if(b||f){if(b){var a=e.getValue(),k=c.autoComplete(b),i=[],h=a.length-q.removeKeywords(a).length;d.push(k);for(var g=0;g<d.length;g++)i.push(o(d[g]));e.setValue([a.substring(0,h),h?" ":"",i.join(" ")," "].join(""))}else{d=[];e.setValue(f.k+" "+f.q+" ")}$f.cancelEvent(m)}};function y(a){return function(d,e){var c=0,b=0;while(c<a.length&&!(b=a[c++](d,e)));return b}}function Z(a,b){return c.compareParents(a.obj,b.obj)}function Y(a,b){return a.bucket-b.bucket}function z(a,b){return fb(a.obj,b.obj)}function N(b,d){var a=c.matchField;return a(b.obj).length-a(d.obj).length}function ab(a,b){return b.weight-a.weight}function W(c){var a=0,b;while(a<d.length){b=o(d[a]);if(c.indexOf(b)==-1)d.splice(a,1);else{c=c.replace(b,"");a++}}}function o(a){return a}l.initialize=function(a){!k&&(k=a);C()};function C(){if(!p&&!J){J=true;if(e.renderMode==$SB.renderModes.HOTMAIL)n();else $Do.when(O,0,P)}}function P(){b=$WLXIM;if(e.renderMode==$SB.renderModes.DOCUMENTS){a=new b.ML.Core.LocalStorageProxy(X);a.add_initialized(w)}else b.hasContacts()?u():b.addStateListener(x)}function x(){if(b.hasContacts()){b.removeStateListener(x);setTimeout(u,1)}}function cb(d,b,c){var a=this;a.pId=d;a.lcOrder=b;a.c=c}function u(){var h=[],i=b.user,d=[i.get_contacts(),i.get_emailOnlyContacts()],f=0;for(var a=0;a<d.length;a++){var k=d[a].get_count();for(var e=0;e<k;e++){var g=d[a].get_item(e).get_linkedContacts(),j=g.get_count();for(var c=0;c<j;c++)h.push(new cb(f,c,g.get_item(c)));f++}}m(h)}function w(e,d){if(t)return;t=true;if(d.get_status()!=b.ML.Core.LocalStorageStatus.initialized){a.remove_initialized(w);a=null;n()}else{$Logout.add(E);var c=L();if(!c)n();else m(c)}}function S(a){a=db(a);return a.toLowerCase().trim().replace(R," ")}function db(a){for(var b=0;b<d.length;b++)a=a.replace(o(d[b]),"");return a}function H(a){return j.matchPrefix(i(h.expand(a)))}function Q(d){var b=c.getResults(d);if(a)if(c.localStorageKey&&b)M(b);m(b)}function m(a){eb(a);p=true;if(g){l.getMatches(g);g=null}}function eb(d){j=new $Trie;for(var a=0;a<d.length;a++){var f=c.getKeysAndWeights(d[a]);for(var e=0;e<f.length;e++){var b=f[e];j.insert(i(h.expand(b.key.toLowerCase().trim())),{obj:d[a],weight:b.weight,order:b.order})}}j.sort()}function n(){$Network.fetchScript(c.getSource(I),function(){},null)}function L(){return T(c.localStorageKey)}function M(a){U(c.localStorageKey,a)}function T(b){D();return a.get_item(f)[b]}function U(d,c){D();var b=a.get_item(f);b[d]=c;a.set_item(f,b)}function D(){var b=$Config.cid,c=$Config.BSI.xid;if(b!=a.get_item(A)||c!=a.get_item(B)||typeof(a.get_item(f)!=="object")){E();a.set_item(A,b);a.set_item(B,c);a.set_item(f,{})}}function E(){a.clear()}function bb(){return $Cookie.getCookie(G,0)==="1"}function V(){if(!F){var a=new Date;a.setDate((new Date).getDate()+$SBC.dateOffset);$Cookie.setCookie(G,"1",$Config.sd,0,a,0);F=true}}gb()},u="<strong>",y="</strong>",z=/&#57344;/g,A=/&#57345;/g,D=/[\uE000\uE001]/g,J="c_search_bi",N=function(i){var b=this,d="bingCompleted"+s++,k=$SBC.bingAuto+"?JsonCallback=$SB."+d.encodeUrl()+"&Market="+$Config.mkt.encodeUrl()+"&Options=EnableHighlighting"+"&JsonType=callback"+($SB.formCode?"&form="+$SB.formCode.encodeUrl():"")+"&Query=",a=null,e=null,j=i;b.getMatches=function(b){if(!$SBC.https&&$SBC.bingSupport){a=b;$Network.fetchScript(k+b.encodeUrl(),function(){},null)}return true};b.initialize=function(a){e=a};b.onTab=null;function h(f){if(c(a)===c(f.SearchSuggestion.Query)){var g=f.SearchSuggestion.Section||[],h=Math.min($SBC.max,g.length),d=new Array(h);for(var b=0;b<h;b++)d[b]=l(g[b].Text);e(d,a)}}function l(c){var a=_ce("A"),b=f(c);a.className=J;a.setAttribute("target","_blank");a.setAttribute("href",$SB.getBingUrl(b));a.setAttribute("title",b);$f.addEvent(a,"onclick",function(){j.setValue(b);$menu.closeCurrent();$SB.logEvent("WW_bing");return true});a.innerHTML="<span>"+g(c.encodeHtml())+"</span>";return a}function g(a){return u+a.replace(z,y).replace(A,u)+y}function f(a){return a.replace(D,"")}function c(a){return a.toLowerCase().trim()}$SB[d]=h};try{$SB.bindAllSearchBoxes($SBC.auth?H:N)}catch(O){}};registerNamespace("$Comments");$Comments.Initialize=function(){};$Comments.Dispose=function(){if(window.$Cmt)$ic.ic.removeICsFromNamespace("cmtc");$Comments.DirtyEvent.dispose();$Comments.CommentAddSuccessfull.dispose();$Comments.DirtyEvent=null;$Comments.CommentAddSuccessfull=null;$Cmt=null;$Comments.DirtyCount=0;if(window.$HipV3)var a=$HipV3.Get("CommentHip");if(a)try{a.dispose()}catch(b){}};$Comments.DisposeSelfPageControl=function(b){$ic.ic.removeICsFromNamespace("cmtc");if($Cmt!=null){$Cmt["c_"+b]=null;$Cmt["hipCCid"]=null}$Comments.DirtyCount=0;if(window.$HipV3)var a=$HipV3.Get("CommentHip");if(a)try{a.dispose()}catch(c){}};$Comments.OnViewMoreClick=function(a){$Comments.DirtyEvent.fire();var b=$Comments.PreProcessRequest("v",a);$Comments.SendRequest(b);return false};$Comments.OnDeleteClick=function(a,e,f,c){$Comments.DirtyEvent.fire();function d(){try{var d=new $UI.Popover;d.header=$Cmt["dlpohd"];d.body=document.createElement("div");var e=false;if($Cmt["currusercid"]!=c&&$Cmt["c_"+a].isgrp=="false"&&$Cmt["c_"+a].isExt!=true)e=true;d.body.innerHTML=$Cmt["dlpocnf"]+(e?"<br /><br /><input type='CHECKBOX' id='cc_rptUser' style='vertical-align:middle'>"+$Cmt["dlporpt"]:"");var g={showHeader:true,width:400,modal:true,shadow:true,bodyPadding:true};$Utility.updateObject(d,g);d.addButton("bOK",$Cmt["btok"],true,false);d.addButton("bCancel",$Cmt["btcancel"],false,true);d.show(b,f,"bOK")}catch(h){b()}}function b(f,d){var b=true,g=false;if(f!=null&&d!=null){var h=_ge("cc_rptUser");if(h!=null)g=h.checked;f.hide();if(d=="bCancel")b=false}if(b){var i={abuse:g,creator:c},j=$Comments.PreProcessRequest("d",a,e,i);$Comments.SendRequest(j)}}if(window.$UI!=null&&window.$UI.Popover!=null)d();else $Network.fetchScript($Cmt["pourl"],d);return false};$Comments.OnPostClick=function(a){$Comments.DirtyEvent.fire();var c="c_"+a;function b(){var e=_ge("cc2_ta_"+a);if(e.Dirty==null)return true;var b=e.value;b=b.replace(/^\s+|\s+$/g,"");if(b==""){_ge("cc2_adderr_"+a).style.display="block";_ge("cc2_adderr_errimg_"+a).innerHTML="<img src='"+$Cmt["errorimgurl"]+"' />";_ge("cc2_adderrtext_"+a).innerHTML=$Cmt["emptyerrtext"]}else if(b.length>$Cmt["maxcommentlength"]){_ge("cc2_adderr_"+a).style.display="block";_ge("cc2_adderr_errimg_"+a).innerHTML="<img src='"+$Cmt["errorimgurl"]+"' />";_ge("cc2_adderrtext_"+a).innerHTML=$Cmt["longerrtext"]}else{_ge("cc2_adderr_"+a).style.display="none";var g=$Comments.PreProcessRequest("a",a,b),f=$Cmt[c],d={};if(f.ans)d["Target"]=f.ans;$Do.when("$wn.RecordComment",this,d);$Comments.SendRequest(g)}}if($Cmt["hipCCid"]!=null&&$Cmt["hipCCid"]==c)if(window.$HipV3){var d=$HipV3.Get("CommentHip");d.validate(b)}else{_ge("cc2_adderr_"+a).style.display="block";_ge("cc2_adderr_errimg_"+a).innerHTML="<img src='"+$Cmt["errorimgurl"]+"' />";_ge("cc2_adderrtext_"+a).innerHTML=$Cmt["adderrtext"]}else b();return false};$Comments.PreProcessRequest=function(j,d,h,l){var n="c_"+d,a=$Cmt[n],b={};b["id"]=d;b["isExt"]=a.isExt;if(a.cctype=="f")b["type"]="f";else if(a.cctype=="i")b["type"]="i";if(j=="v"){b["url"]=$Cmt["churl"]+$Cmt["hdlrvm"];b["method"]="GET";b["action"]="v";if(b["isExt"]!=true)b["loadBox"]=_ge("cc2_ldfl_"+d);if(b["type"]=="f"&&a.moreComments==true){if(a.deletionHappened)if(_ge("cc2_cmt_"+a.anchor)==null){a.anchor=a.fbanchor;a.fbanchor=null}b["viewAnchor"]=_ge("cc2_vmlnkfl_"+d);b["viewContainer"]=_ge("cc2_vmmainfl_"+d);b["vars"]="sparent="+a.sparentid+"&order=a&psp="+a.isPhoto+"&dir=p&cnt="+$Cmt["maxflcomments"]+"&lanchor="+a.anchor+"&ict="+$ic.ic.getICNamespaceCount("cmtc")+"&cmtid="+d+"&cid="+b["id"]+"&na="+a.notfApp+"&nct="+a.notfCt+"&bat="+a.biciAcType+"&attic="+a.attic+"&r="+Math.floor(Math.random()*1e4)}else if(b["type"]=="i")if(b["isExt"]==true){var g="";if(a.isExt)g="&ans="+a.ans+"&exccid="+a.exccid;_ge("cc2_rflnk_"+b["id"]).style.display="none";var f=_ge("cc2_noup_"+b["id"]);f.innerHTML='<img src="'+$Cmt["spinnerImgUrl"]+'" />'+"&nbsp;<span style='color:#000'>"+$Cmt["loading"]+"</span>";f.style.display="inline";b["vars"]="sparent="+a.sparentid+"&rev=true&ctype=i&ict="+$ic.ic.getICNamespaceCount("cmtc")+"&cmtid="+d+"&cid="+b["id"]+"&na="+a.notfApp+"&appname="+a.appname+g+"&nct="+a.notfCt+"&bat="+a.biciAcType+"&isExt=true&aid="+a.aparentid+"&r="+Math.floor(Math.random()*1e4)}else{b["viewAnchor"]=_ge("cc2_vmlnkinl_"+d);b["viewContainer"]=_ge("cc2_vmmaininl_"+d);b["vars"]="sparent="+a.sparentid+"&order=d&psp=false&dir=n&cnt="+a.maxfetchcnt+"&rev=true&lanchor=&ctype=i&ict="+$ic.ic.getICNamespaceCount("cmtc")+"&cmtid="+d+"&cid="+b["id"]+"&na="+a.notfApp+"&nct="+a.notfCt+"&bat="+a.biciAcType+"&isExt=false"+"&attic="+a.attic+"&fcmtid="+a.firstid+"&lcmtid="+a.lastid+ +"&r="+Math.floor(Math.random()*1e4)}if(b["isExt"]!=true){b["viewAnchor"].style.display="none";b["viewContainer"].style.display="none";b["loadBox"].style.display="block"}}else if(j=="a"){if(!window.$HipV3)$Network.fetchScript($Cmt["aurl"],function(){});b["url"]=$Cmt["churl"]+$Cmt["hdlrad"];b["addBox"]=_ge("cc2_ta_"+d);b["postButton"]=_ge("cc2_pbtn_"+d);b["addBox"].disabled=true;b["postButton"].disabled=true;var e=null;if(window.$HipV3){var m=$HipV3.Get("CommentHip");if($Cmt["hipCCid"]!=null&&$Cmt["hipCCid"]==n)e=$HipV3.Get("CommentHip").getSolutionDetails();$Cmt["hipCCid"]=null;if(m)try{m.dispose()}catch(f){}}var i=_ge("cmtDisposeDiv");if(i)i.parentNode.parentNode.removeChild(i.parentNode);try{_ge($Cmt["amcp"]+d).innerHTML='<span class="cc2_addngext"><img src="'+$Cmt["spinnerImgUrl"]+'" />'+"&nbsp;"+$Cmt["addMsg"]+"</span>"}catch(f){}if(a.isExt==null)a.isExt=false;var k=null;if(e!=null)k="&hip="+c(e.userSol)+"&hipch="+c(e.challenge)+"&hipfid="+c(e.flowId)+"&hipfh="+c(e.flowIdHash);var g="";if(a.isExt)g="&ans="+c(a.ans)+"&exccid="+c(a.exccid)+"&appname="+c(a.appname);b["vars"]="sparentid="+c(a.sparentid)+"&aparentid="+c(a.aparentid)+"&content="+c(h)+"&fname="+c($Cmt["fname"])+"&lname="+c($Cmt["lname"])+"&purl="+c($Cmt["ppic"])+"&aocid="+c(a.aocid)+"&isGrp="+c(a.isgrp)+"&type="+c(a.ptype)+"&ctype="+a.ctype+"&ccid="+c(a.sparentid)+"&ctrlid="+c(b["id"])+"&na="+c(a.notfApp)+"&nct="+c(a.notfCt)+"&bat="+c(a.biciAcType)+(a.notRecipients!=null?"&nrs="+c(a.notRecipients):"")+(a.cmtPageUrl!=null?"&cmtPageUrl="+c(a.cmtPageUrl):"")+"&hash="+c(a.hash)+"&ict="+c($ic.ic.getICNamespaceCount("cmtc").toString())+"&canary="+c($Cmt["canary"])+"&audiourl="+c($Cmt["audiourl"])+"&attic="+c(a.attic)+(e!=null?k:"")+(b["type"]=="f"?"&selfpage=true":"&selfpage=false")+"&isExt="+c(a.isExt.toString())+g;b["method"]="POST";b["action"]="a"}else if(j=="d"){b["url"]=$Cmt["churl"]+$Cmt["hdlrdl"];b["vars"]="commentid="+c(h)+"&activityid="+c(a.aparentid)+"&canary="+c($Cmt["canary"])+"&na="+c(a.notfApp)+"&nct="+c(a.notfCt)+"&bat="+c(a.biciAcType)+"&abuse="+c(l.abuse?"true":"false")+"&creatorCid="+c(l.creator);b["method"]="POST";b["commentid"]=h;b["deleteContainer"]=_ge("cc2_dlmain_"+h);b["deleteContainerHtml"]=b["deleteContainer"].innerHTML;b["deleteContainer"].innerHTML=$Cmt["dltmsg"];try{_ge("cc2_dlterr_"+b["commentid"]).style.display="none"}catch(f){}b["action"]="d"}function c(a){if(a)return a.encodeURIComponent();else return ""}return b};$Comments.SendRequest=function(a){if(a["method"]=="GET")$Network.fetchXML(a["url"]+"?"+a["vars"],b,"GET");else{var c={};c["Content-Type"]="application/x-www-form-urlencoded";$Network.fetchXML(a["url"],b,"POST",a["vars"],c)}function b(f){if($Cmt==null||$Cmt["c_"+a["id"]]==null)return;var r=!f||f.status!=200?true:false;if(r){if(a["action"]=="v")if(a["isExt"]==true){$Cmt["c_"+a["id"]].extViewError=true;if(f.responseText!=null&&f.responseText.indexOf("thirdpartyerror")>=0){var b=document.createElement("div"),q=_ge("cc2_noup_"+a["id"]);q.innerHTML="";q.appendChild(b);$Utility.ajaxInnerHtml(b,f.responseText);var m=_ge("c_"+a["id"]+"_exAdd");if(m)m.parentNode.removeChild(m)}else{_ge("cc2_noup_"+a["id"]).innerHTML="<img src='"+$Cmt["errorimgurl"]+"' />"+"&nbsp;<span class='errorText'>"+$Cmt["lderr"]+"</span>";var j=_ge("cc2_adderr_"+a["id"]);if(j)j.style.display="none"}}else{_ge("cc2_lderr_"+a["id"]).style.display="block";_ge("cc2_lderr_errimg_"+a["id"]).innerHTML="<img src='"+$Cmt["errorimgurl"]+"' />";a["loadBox"].style.display="none"}else if(a["action"]=="d"){var p=_ge("cc2_dlterr_"+a["commentid"]);p.innerHTML=$Cmt.dltnotif;p.style.display="block";a["deleteContainer"].innerHTML=a["deleteContainerHtml"]}else if(a["action"]=="a"){try{_ge($Cmt["amcp"]+a["id"]).innerHTML="";if(a["isExt"]==true&&$Cmt["c_"+a["id"]].extViewError==true){var i=_ge("cc2_noup_"+a["id"]);i.parentNode.style.display="none"}}catch(i){}var j=_ge("cc2_adderr_"+a["id"]);j.style.display="block";_ge("cc2_adderr_errimg_"+a["id"]).innerHTML="<img src='"+$Cmt["errorimgurl"]+"' />";_ge("cc2_adderrtext_"+a["id"]).innerHTML=$Cmt["adderrtext"];a["addBox"].disabled=false;a["postButton"].disabled=false}}else{if(a["action"]=="v"){var c=_ge(a["id"]+"_viewajax");if(c){if(a["isExt"]==true)c.innerHTML="";c.style.display="block";var b=document.createElement("div"),n=false;if(a["type"]=="f"){var o=$Cmt["c_"+a["id"]].lastajaxchild;if(o==null){$Cmt["c_"+a["id"]].lastajaxchild=b;c.appendChild(b)}else{c.insertBefore(b,o);$Cmt["c_"+a["id"]].lastajaxchild=b}}else{c.appendChild(b);if(a["isExt"]!=true){var h=$Cmt["c_"+a["id"]],k=_ge("cc2_cmt_"+h.lastid);if(k)k.parentNode.removeChild(k);var l=_ge(a["id"]+"_addajax");if(l){l.innerHTML="";l.style.display="none"}$Utility.ajaxInnerHtml(b,f.responseText);n=true}}if(!n)$Utility.ajaxInnerHtml(b,f.responseText)}}else if(a["action"]=="a"){try{_ge($Cmt["amcp"]+a["id"]).innerHTML="";if(a["type"]=="f"){var e=_ge("cc2_ccc_"+a["id"]);if(e!=null){var d=e.innerHTML,g=null;if(d!=null&&d!=""){g=parseInt(d.substring(1,d.length-1))+1;e.innerHTML="("+g+")"}else e.innerHTML="(1)"}}}catch(i){}var c;if(a["isExt"]==true){c=_ge(a["id"]+"_viewajax");if($Cmt["c_"+a["id"]].extViewError==true){var i=_ge("cc2_noup_"+a["id"]);i.parentNode.style.display="none"}}else c=_ge(a["id"]+"_addajax");if(c){c.style.display="block";var b=document.createElement("div");b.ajaxAddParent=true;c.appendChild(b);$Utility.ajaxInnerHtml(b,f.responseText)}}else if(a["action"]=="d"){try{if(a["type"]=="f"){var e=_ge("cc2_ccc_"+a["id"]);if(e!=null){var d=e.innerHTML,g=null;if(d!=null&&d!=""){g=parseInt(d.substring(1,d.length-1))-1;if(g<=0){e.innerHTML="";if(_ge("cc2_ta_"+a["id"])==null)_ge("cc2_main_full_"+a["id"]).style.display="none"}else e.innerHTML="("+g+")"}}}}catch(i){}$Cmt["c_"+a["id"]].deletionHappened=true;if(a["type"]=="i"){var h=$Cmt["c_"+a["id"]];if(h.lastid==a["commentid"])h.lastid="";else if(h.firstid==a["commentid"])h.firstid=""}}$Comments.PostProcess(a)}}};$Comments.PostProcess=function(a){var c=$Cmt["c_"+a["id"]];if(a["action"]=="v")if(a["isExt"]!=true){a["viewContainer"].style.display="block";if(c.moreComments==false&&a["type"]=="f"||a["type"]=="i"&&!c.showViewAll)a["viewAnchor"].parentNode.style.display="none";else if(a["type"]=="i"&&c.showViewAll)_ge("cc2_valnkinl_"+a["id"]).style.display="inline";else if(c.moreComments==true&&a["type"]=="f")a["viewAnchor"].style.display="inline";a["loadBox"].style.display="none"}else{var d=_ge("cc2_noup_"+a["id"]);if(d)if(c.moreComments==true){_ge("cc2_vae_"+a["id"]).style.display="inline";d.style.display="none"}else if($Cmt["c_"+a["id"]].showNoMoreComments){d.innerHTML='<span class="cc2_nmco">'+$Cmt.nomorecmt+"</span>";var f=_ge(a["id"]+"_viewajax");f.innerHTML="";f.style.display="none"}else{d.parentNode.style.display="none";_ge(a["id"]+"_viewajax").style.marginTop="4px"}}else if(a["action"]=="a"){a["addBox"].disabled=false;a["postButton"].disabled=false;if($Cmt["disposeTextbox"]==true){a["addBox"].value="";$Comments.OnTextBoxBlur(a["addBox"])}}else if(a["action"]=="d"){c.deletionHappened=true;var b=_ge("cc2_cmt_"+a["commentid"]),e="c_"+a["id"]+"_"+a["commentid"];if($Cmt[e]&&$Cmt[e].ajaxAdd)if(b.parentNode.ajaxAddParent)b.parentNode.parentNode.removeChild(b.parentNode);else b.parentNode.removeChild(b);else b.parentNode.removeChild(b)}};$Comments.DirtyEvent=new $Event;$Comments.CommentAddSuccessfull=new $Event;registerNamespace("$SA");SA_stat={p:false,tid:null,rc:false,b:false,skyID:null,skyPoll:0,d:true};SA_Code={Success:0,GeneralError:1,Banned:2};new function(){var a=$SA,b=true,n=false,u,g,h,C=true,o=false,q,z=false,y=false,Y="",r=false,c=null,k=0,f=[],m=false,p="";a._strTableCell=$B.IE?"block":"table-cell";var D=true,d,X=true,E=/(^|\s)(http:\/\/|https:\/\/|www\.)\S+(\s|$)/,v="SAInput",s="";a.dispose=function(){if(b)return;g.dispose();u.dispose();g=null;u=null;n=false;b=true;SA_stat.d=true};a.initialize=function(){h=false;b=false;SA_stat.d=false;u=new $Memory.Events;g=new $Memory.Events;q="";k=0;c=null;f=[];m=false;o=false;_lastPsmValue="";u.register(window,{onunload:a.dispose});if(window.$SAConfig){d=$SAConfig.pt;if($SAConfig._BadgeModel){SA_stat.tid="SAUrl";o=true;h=true;g.dispose();var l=document.activeElement,i=$("SAUrlSummary");if(l!=$("SAInput"))H();if(l!=i)a.UrlTADeactivate(i);if(!$SAConfig._BadgePreview)setTimeout($SA.LoadUrlPreview,0);if($SAConfig._IsVideo)d="VideoEmbed";if($SAConfig._BadgePsm!="")setTimeout("$SA.initTextBox('SAInput')",0);if($SAConfig._BadgePreview){setTimeout("$SA.initTextBox('SAUrlTitle')",0);setTimeout("$SA.initTextBox('SAUrlSummary')",0);if($SAConfig._BadgeThumbnail){c={images:[]};c.images.push($SAConfig._BadgeThumbnail);c.images.push("");var e=0;while(e<c.images.length){f[e]=true;e++}j(c.images.length,true)}else{t();a.DisablePaging()}}}}};a.initTextBox=function(a){if(b)return;$SA._focusedTextAreaId=a;$SA.recalc()};a.active=function(e){if(b||$SAConfig._BadgeHasShared)return false;var c=!h&&a.activeRO(e);if(c){if(D){var d=_ge("SAContext");if(d)_ge("SACtrl").appendChild(d.removeChild(_ge("SAActive")));D=false}a.focusInput(e);g.register(document,{onclick:G});W();h=true}return c};function G(){if(b)return;if(!SA_stat.p&&!SA_stat.tid){var f=_ge("SAInput");if(w(f)){var e=20,c=event.srcElement,d=0;while(c&&c.id!="SAActive"&&c.id!="SAInactive"&&d<e){c=c.parentElement;d++}if(!c||d>=e)a.inactive()}}}a.inactive=function(){if(SA_stat.p||!h||b)return;r=false;_lastPsmValue="";p="";a.remove();a.showErr(SA_Code.Success);_ge("SAActive").style.display="none";_ge("SAInactive").style.display="block";v="SAInput";g.dispose();setTimeout(SA_Inactive2,0);h=false};a.rich=function(f,e){if(SA_stat.p||b)return false;c=null;SA_stat.rc=true;var h=_ge("SAInput");if(w(h))h.value=$SAConfig.strRichHint;SA_stat.rc=false;g.dispose();a.showErr(SA_Code.Success);_ge(f).style.display="block";_ge("SASimple").style.display="none";d=e;SA_stat.tid=f;_ge("SAMenu").style.display="none";_ge("SARC").style.display=$SA._strTableCell;if(e=="Url")a.ShowUrl();else if(e=="Photo")SAShowPhoto();else if(e=="Document")SAShowDoc();if(event)event.returnValue=false;return false};a.remove=function(){o=false;k=0;f=[];m=false;p="";if(SA_stat.p||!SA_stat.tid||b)return false;a.showErr(SA_Code.Success);SA_stat.rc=true;var h=_ge("SAInput");if(w(h))h.value="";SA_stat.rc=false;g.register(document,{onclick:G});var c=d;_ge(SA_stat.tid).style.display="none";_ge("SASimple").style.display="block";d="Simple";SA_stat.tid=null;var e=_ge("SARC");if(e)e.style.display="none";var i=_ge("SAMenu");if(i)_ge("SAMenu").style.display=$SA._strTableCell;if(c=="Photo")SAClearPhoto();else if(c=="Document")SAClearDoc();else if(c=="Url"){t();F();_ge("SALoading2").style.display="none"}v="SAInput";a.focusInput(true);return false};a.recalc=function(){if(!h||b)return;SA_stat.rc=true;var a=_ge($SA._focusedTextAreaId);if($SA._focusedTextAreaId=="SAInput")A(a);var d=a.getAttribute("maxlength"),c=false;if(a.value.length>d){a.value=a.value.substring(0,d);if($B.IE){setTimeout($SA.recalc,0);c=true}}if(!c){a.rows=1;var e=2,f=550;if(a.clientHeight<a.scrollHeight-e)while(a.clientHeight<a.scrollHeight-e&&a.rows<f)a.rows+=1}SA_stat.rc=false};a.blur=function(a){if(b)return;q="";if(a.id=="SAInput")setTimeout(H,200)};function B(){if(!SA_stat.tid)return $SAConfig.strTextHint;else return $SAConfig.strRichHint}function w(a){return a.value.length==0||a.value==B(a.id)}function H(){if(q=="SAInput"||b)return;SA_stat.b=true;var a=_ge("SAInput"),c=a.getAttribute("helper")!="help",d=!w(a);if(!c&&d)A(a);else if(c&&!d){a.className="SAInput SAHelp";a.value=B(a.id);a.setAttribute("helper","help")}SA_stat.b=false}function A(a){if(a.getAttribute("helper")=="help"){var b=a.value,c=B(a.id);a.className="SAInput SANormal";if(b.startsWith(c))a.value=b=b.substr(c.length);a.setAttribute("helper","normal")}}a.focus=function(c){if(b)return;q=c.id;a.trackFocus(c);if(q=="SAInput")A(c)};a.trackFocus=function(a){if(b)return;v=a.id};a.focusInput=function(g){if(SA_stat.p||b)return false;var e=false,f=true;if(!g&&event){var c=event.srcElement;while(c&&c.id!="SACtrl"){if(c.nodeName=="A"||c.nodeName=="INPUT"||c.nodeName=="TEXTAREA"){if(c.className=="SAPsaExtra"||c.className=="SAPsaIcon")e=!(SA_stat.p||n);if(c.id!="SAInactiveLink")f=false;while(c&&c.id!="SACtrl"){if(c.id=="SAErr"){e=!(SA_stat.p||n);break}c=c.parentElement}break}c=c.parentElement}}if(f)try{var d=_ge(v);if(d.id=="SAUrlTitle"||d.id=="SAUrlSummary")d=_ge("SAInput");d.focus();a.moveCursorToEnd(d)}catch(h){}return e};a.moveCursorToEnd=function(a){if(a.createTextRange){var c=a.createTextRange();c.move("character",a.value.length);c.select()}else if(a.setSelectionRange){var b=a.value.length;a.setSelectionRange(b,b)}};a.ShowUrl=function(){if(b)return;o=true;var c=$SAConfig.strRemLink.encodeHtml();_ge("SARem").innerHTML=c;_ge("SAUrlBox").style.display="block";a.blur(_ge("SAInput"));a.InitUrlForm(false);N();a.SetLoading(false);setTimeout("$SA.focus(_ge('SAUrlInput'))",0);setTimeout("_ge('SAUrlInput').select()",0)};function N(){if(b)return;var a=_ge("SABtn");a.disabled=false;a.innerHTML=$SAConfig.strPreview.encodeHtml();a.onclick=$SA.LoadUrlPreview}function R(){if(b)return;var a=_ge("SABtn");a.disabled=false;a.innerHTML=$SAConfig.strCancel.encodeHtml();a.onclick=$SA.UrlCancel}function F(){if(b)return;var a=_ge("SABtn");a.disabled=false;a.innerHTML=$SAConfig.strSave.encodeHtml();a.onclick=$SA.startPost}a.UrlCancel=function(){if(b)return;$SA.soxeCallback();a.SetLoading(false);a.ShowUrlPreview()};a.LoadUrlPreview=function(){if(b)return false;var d=_ge("SAUrlInput").value.trim();if(d=="")return false;R();a.SetLoading(true);var c=$SAConfig.SoxeURL;if(c.indexOf("?")==-1)c+="?url="+d.encodeURIComponent();c+="&canary="+$SAConfig.urlCan.encodeURIComponent();$Network.fetchScript(c,$SA.soxeCallback);n=true};a.soxeCallback=function(){n=false;if(!m&&!b&&o){m=true;var e=_ge("SAUrlInput").value.trim();c={title:e,description:$SAConfig.strSummaryHint,videoUrl:"",videoHeight:"",videoWidth:"",url:e};c.images=[];c.images.push("");var d=0;while(d<c.images.length){f[d]=true;d++}a.ShowUrlPreview()}};a.previewResult=function(e){n=false;if(!m&&!b&&o){m=true;if(!e.images)e.images=[];e.images.push("");if(!e.url)e.url=_ge("SAUrlInput").value.trim();if(!e.title)e.title=e.url;if(!e.description)e.description=$SAConfig.strSummaryHint;if(!e.videoUrl)e.videoUrl="";if(!e.videoHeight)e.videoHeight="";if(!e.videoWidth)e.videoWidth="";if(!e.embedParams)e.embedParams="";c=e;if(c.videoUrl)d="VideoEmbed";var g=0;while(g<c.images.length){f[g]=true;g++}a.ShowUrlPreview()}};a.ShowUrlPreview=function(){if(b)return;F();a.SetLoading(false);a.InitUrlForm(true);a.blur(_ge("SAInput"));_ge("SAUrlBox").style.display="none";if(c!=null){x();j(c.images.length,true);_ge("SAUrlTitle").value=c.title;_ge("SAUrlSummary").value=c.description;_ge("SAVideoSource").value=c.videoUrl;_ge("SAVideoHeight").value=c.videoHeight;_ge("SAVideoWidth").value=c.videoWidth;_ge("SAUrlInput").value=c.url;_ge("SAVideoParams").value=c.embedParams}else t();var f=_ge("SAUrlTitle"),e=_ge("SAUrlSummary"),d=_ge("SAPreviewColB").clientWidth;f.style.width=d-10+"px";e.style.width=d-10+"px";setTimeout(U,5);setTimeout("$SA.initTextBox('SAUrlTitle')",0);setTimeout("$SA.initTextBox('SAUrlSummary')",0);setTimeout(function(){try{_ge("SAInput").focus();$SA.focus(_ge("SAInput"));$SA.moveCursorToEnd(_ge("SAInput"))}catch(a){}},10)};function U(){if(p!==""){var c=p,b=_ge("SAInput").value;if(b.startsWith(c))_ge("SAInput").value=b.substr(c.length);a.initTextBox("SAInput");p=""}}a.SetLoading=function(a){if(b)return;_ge("SAUrlInput").disabled=a;_ge("SALoading2").style.display=a?$SA._strTableCell:"none";var c=_ge("SARC");if(c)c.style.display=a?"none":$SA._strTableCell;else _ge("SANoMenu").style.display=a?"none":$SA._strTableCell};a.InitUrlForm=function(a){if(b)return;if(!a){_ge("SAUrlInput").value="http://";_ge("SAUrlSummary").rows=1;_ge("SAUrlTitle").rows=1}else{var c=_ge("SAUrlInput").value.trim();_ge("SAUrlTitle").value=c;_ge("SAUrlSummary").value=$SAConfig.strSummaryHint}_ge("SAUrlInput").style.display=a?"none":"";_ge("SAPreview").style.display=a?"":"none"};a.UrlTAOver=function(a){if(b)return;a.className="SAUrlPreviewActive"};a.UrlTAOut=function(a){if(b)return;if(a.id=="SAUrlSummary"&&!y||a.id=="SAUrlTitle"&&!z)a.className="SAUrlPreviewInactive"};a.UrlTAActivate=function(a){if(b)return;$SA.focus(a);if(a.id=="SAUrlSummary"){y=true;var c=a.value,d=$SAConfig.strSummaryHint;if(c.startsWith(d))a.value=c=c.substr(d.length)}if(a.id=="SAUrlTitle")z=true;a.className="SAUrlPreviewActive"};a.UrlTADeactivate=function(a){if(b)return;$SA.blur(a);if(a.id=="SAUrlSummary"){y=false;if(a.value.trim()=="")a.value=$SAConfig.strSummaryHint}if(a.id=="SAUrlTitle")z=false;a.className="SAUrlPreviewInactive"};a.AutoDetectUrlOnPaste=function(){if(!r){$SA.AutoDetectUrl();if(r){var b=_ge("SAInput").value,a=_ge("SAUrlInput").value.trim();if(b.trim()==a)p=a}}};a.AutoDetectUrl=function(){if(SA_stat.p||d!="Simple"||b||!$SAConfig.urlEnabled)return;var a=_ge("SAInput").value,c=a.match(E);if(!r&&a.match(E)){$SA.rich("SAUrl","Url");_ge("SAUrlInput").value=c[0].trim();$SA.LoadUrlPreview();r=true}};a.DisablePaging=function(){_ge("SAThumbPagingOn").style.display="none";_ge("SAThumbPagingOff").style.display="block"};a.EnablePaging=function(){_ge("SAThumbPagingOn").style.display="block";_ge("SAThumbPagingOff").style.display="none"};function x(){_ge("SALoadingThumbDir").style.display="block";_ge("SANoThumbDir").style.display="none";_ge("SAThumbDir").style.display="none";a.EnablePaging()}function t(){_ge("SAUrlThumbnail").value="";_ge("SAThumbDir").style.display="none";_ge("SALoadingThumbDir").style.display="none";_ge("SANoThumbDir").style.display="block";if(L())a.EnablePaging();else a.DisablePaging()}function L(){for(i=0;i<f.length-1;i++)if(f[i]==true)return true;return false}function T(e){_ge("SAUrlThumbnail").value=e.originalSrc;var d=_ge("SAThumbImg");d.src=e.src;var b=e.width,c=e.height;if(b>=c){c=96*c/b;b=96}else{b=96*b/c;c=96}d.width=b;d.height=c;d.style.paddingLeft=(96-b)/2+"px";d.style.paddingRight=(96-b)/2+"px";_ge("SANoThumbDir").style.display="none";_ge("SALoadingThumbDir").style.display="none";_ge("SAThumbDir").style.display="block";a.EnablePaging()}function j(a,e){if(SA_stat.p||b||!h)return;if(e)a=P(a);else a=O(a);k=a;if(!f[a]){j(a,e);return}if(c.images[a]==""){t();return}else{var d=new Image,i=function(){$SA.ImageLoaded(a,e,d)},g=function(){$SA.ImageFailed(a,e)},l=function(){d.attachEvent("onload",i);d.attachEvent("onerror",g);d.originalSrc=c.images[a];d.src=$ssl.ensureSSLImageUrl(c.images[a])};setTimeout(l,0)}}a.ImageLoaded=function(a,d,c){if(b)return;if(a!=k)return;if(M(c))T(c);else{f[a]=false;j(a,d)}};a.ImageFailed=function(a,c){if(b)return;f[a]=false;if(a!=k)return;j(a,c)};a.prevThumb=function(){if(b)return;x();j(k,false)};a.nextThumb=function(){if(b)return;x();j(k,true)};function P(a){a++;if(a>=c.images.length)a=0;return a}function O(a){a--;if(a<0)a=c.images.length-1;return a}function M(a){if(a==null)return false;if(typeof a.naturalWidth!="undefined"&&a.naturalWidth==0)return false;if(a.width<64||a.height<64)return false;if(a.width>640||a.height>640)return false;return true}function W(){if(C&&!b){if($SAConfig._BadgeModel){C=false;return}var n=_ge("SA_3Table"),c=n.clientWidth;if(c<314)c=314;var d=_ge("SAPSA");if(d)d.style.width=d.clientWidth+"px";var i,g,a=0,f,h=0,m,k,p=_ge("SABtnActive"),o=_ge("SAShare");if(d)h=d.clientWidth;a=e(_ge("SAMenu"),a,false);a=e(_ge("SANoMenu"),a,false);a=e(o,a,true);var j=K();if(j>a)a=j;f=j;f=e(_ge("SALoading2"),f,true);m=_ge("SABtnActive").clientWidth;k=J();i=a+h+m;g=f+h+k;if(c<i)c=i;if(c<g)c=g;_ge("SAActiveWidth").style.width=c+16+"px";n.style.width="100%";if($B.IE_M6){l("SAInput",c-10-8+"px");l("SAUrlInput",c+"px")}else{l("SAInput","100%");l("SAUrlInput","100%")}if($B.IE){l("SAPhotoInput","100%");l("SADocInput","100%")}C=false}}function K(){var b=_ge("SARC"),a=0;if(!b)return a;b.style.display=$SA._strTableCell;var c=_ge("SARem");c.innerHTML=$SAConfig.strRemLink.encodeHtml();a=e(b,a,false);c.innerHTML=$SAConfig.strRemPhoto.encodeHtml();a=e(b,a,false);c.innerHTML=$SAConfig.strRemDoc.encodeHtml();a=e(b,a,false);b.style.display="none";return a}function J(){var c=_ge("SABtnActive"),a=0,b=_ge("SABtn"),d=b.innerHTML;a=e(c,a,false);b.innerHTML=$SAConfig.strSave.encodeHtml();a=e(c,a,false);b.innerHTML=$SAConfig.strCancel.encodeHtml();a=e(c,a,false);b.innerHTML=$SAConfig.strPreview.encodeHtml();a=e(c,a,false);b.innerHTML=d;return a}function e(a,b,c){var d=b;if(a){if(c)a.style.display=$SA._strTableCell;if(a.clientWidth>b)d=a.clientWidth;if(c)a.style.display="none"}return d}function l(c,b){var a=_ge(c);if(a)a.style.width=b}a.setPostState=function(a){if(SA_stat.d)return;_ge("SABtn").disabled=a;_ge("SAInput").disabled=a;if(d=="Photo")SAPhotoDisable(a);else if(d=="Document")SADocDisable(a);else if(d=="Url")SA_UrlDisable(a);var c,b;if(!SA_stat.tid){c=_ge("SAShare");b=_ge("SAMenu")}else{c=_ge("SAShare");b=_ge("SARC")}if(!b)b=_ge("SANoMenu");c.style.display=a?$SA._strTableCell:"none";b.style.display=a?"none":$SA._strTableCell};a.startPost=function(){if(SA_stat.p||SA_stat.d)return;S(d);if(_ge("SABtn").disabled)return;a.showErr(SA_Code.Success);if(d=="Photo")SAUploadImage("SAPhotoForm");else if(d=="Url")V();else if(d=="VideoEmbed")Q();else if(d==="Document")SAUploadImage("SADocForm");else $SA.post()};function S(a){if(SA_stat.d)return;if(a=="Photo")SAPhotoCheck();else if(a=="Document")SADocCheck();else if(!(a=="Url"||a=="VideoEmbed"))_ge("SABtn").disabled=false}function Q(){var a=_ge("SAUrlSummary").value.trim();if(a.startsWith($SAConfig.strSummaryHint))a=a.substr($SAConfig.strSummaryHint.length);var g=_ge("SAUrlTitle").value.trim(),b=_ge("SAUrlThumbnail").value.trim(),i=_ge("SAUrlInput").value.trim(),d=_ge("SAVideoHeight").value.trim(),h=_ge("SAVideoWidth").value.trim(),e=_ge("SAVideoParams").value.trim(),f=_ge("SAVideoSource").value.trim(),c="&up="+a.encodeURIComponent()+"&ut="+g.encodeURIComponent()+"&uth="+b.encodeURIComponent()+"&vh="+d.encodeURIComponent()+"&vw="+h.encodeURIComponent()+"&vp="+e.encodeURIComponent()+"&vs="+f.encodeURIComponent()+"&u="+i.encodeURIComponent();$SA.post(c)}function V(){var a=_ge("SAUrlSummary").value.trim();if(a.startsWith($SAConfig.strSummaryHint))a=a.substr($SAConfig.strSummaryHint.length);var d=_ge("SAUrlTitle").value.trim(),b=_ge("SAUrlThumbnail").value.trim(),e=_ge("SAUrlInput").value.trim(),c="&up="+a.encodeURIComponent()+"&ut="+d.encodeURIComponent()+"&uth="+b.encodeURIComponent()+"&u="+e.encodeURIComponent();$SA.post(c)}function I(c){var a;if(c.indexOf("?")==-1)a="?";else a="&";var b={};$BSI.addHandlerDPs(b);for(var d in b)a+=d+"="+b[d].encodeURIComponent()+"&";return c+a}a.post=function(b){if(SA_stat.d)return;var e=$SAConfig.SAHURL,c={};c["Content-Type"]="application/x-www-form-urlencoded";var f=SA_getPsm(),a="";if(b)a=b+"&";a=a+"s="+f.encodeURIComponent()+"&canary="+$SAConfig.can.encodeURIComponent()+"&saii="+$ic.ic.getICNamespaceCount("wnit")+"&pt="+d.encodeURIComponent()+"&wnint="+$SAConfig.wn.encodeURIComponent();$Network.fetchXML(I(e),SA_postReturn,"POST",a,c);SA_stat.p=true;$SA.setPostState(true)};a.IsFirefoxPaste=function(b){if(b.srcElement.id!="SAInput"||!$B.Firefox)return false;var a=false;if(b.srcElement.value.length-_lastPsmValue.length>5)a=true;return a};a.showErr=function(b,a){if(SA_stat.d)return;_ge("SAErr").style.display="none";if(s){_ge("SAErrMsg").innerHTML=s;s=""}if(b){if(a){s=_ge("SAErrMsg").innerHTML;_ge("SAErrMsg").innerHTML=a}_ge("SAErr").style.display="block"}}};function SA_UrlDisable(a){if(SA_stat.d)return;_ge("SAUrlInput").disabled=a;_ge("SAUrlTitle").disabled=a;_ge("SAUrlSummary").disabled=a;if(a)$SA.DisablePaging();else $SA.EnablePaging()}function SA_Inactive2(){if(SA_stat.d)return;var a=_ge("SAInput");a.value="";a.rows=1}SA_Text=function(a){if(SA_stat.p||SA_stat.rc||SA_stat.d)return;if(!SA_KeyCheck(a))SA_InText(a)};SA_KeyCheck=function(a){if(SA_stat.p||SA_stat.rc||SA_stat.d)return false;var b=a.keyCode;if(b==27&&!$SAConfig._BadgeModel){$SA.inactive();return true}else if(b==13){if(!SA_stat.tid)$SA.startPost();else if(a.srcElement.id=="SAUrlInput"&&!_ge("SABtn").disabled){$SA.LoadUrlPreview();a.returnValue=true}else a.returnValue=false;return true}else if(b==32&&a.srcElement.id=="SAInput")setTimeout($SA.AutoDetectUrl,0);return false};SA_InText=function(a){if(SA_stat.d)return;$SA._focusedTextAreaId=a.srcElement.id;if(SA_stat.p||SA_stat.rc||SA_stat.b)return;if(a.type=="propertychange"&&a.propertyName!="value")return;if(a.type=="paste"||$SA.IsFirefoxPaste(a))setTimeout($SA.AutoDetectUrlOnPaste,0);if(a.srcElement.id=="SAInput")_lastPsmValue=a.srcElement.value;setTimeout($SA.recalc,0)};SA_CheckUrlInput=function(a){if(SA_stat.p||SA_stat.d)return;if($B.IE&&a.propertyName!="value")return;var b=a.srcElement.value.trim();SA_KeyCheck(a)};function SA_getPsm(){if(SA_stat.d)return;var b=_ge("SAInput"),a;if(b.getAttribute("helper")=="help")a="";else{a=b.value.trim();a=a.replace(/[\r\n]/g," ")}return a}SA_postReturn=function(d){if(SA_stat.d)return;SA_stat.p=false;$SA.setPostState(false);var a=SA_Code.GeneralError,f="",h="",i="",e=false;try{e=d&&(d.status==200||d.status==500)}catch(k){e=false}if(e){var c=d.responseText,g=c.length;if(c&&g>0){var b=c.split("^",3);a=parseInt(b[0]);if(isNaN(a))a=SA_Code.GeneralError;else if(b.length==3){f=b[1].replace(/\*2/g,"^").replace(/\*1/g,"*");h=b[2].replace(/\*2/g,"^").replace(/\*1/g,"*");var j=b[0].length+b[1].length+b[2].length+3;if(j<=g)i=c.substring(j)}else if(a==SA_Code.Success)a=SA_Code.GeneralError}}$SA.showErr(a,f);if(a==SA_Code.Success){SA_changePSM(f,h,SA_getPsm());$SA.inactive();SA_WNIns(i);if($SAConfig._BadgeModel){$SAConfig._BadgeHasShared=true;_ge("SAInactive").style.cursor="default"}}};SA_changePSM=function(g,d,h){var c=_ge("SANoPsm"),e=_ge("SAPsm"),b=_ge("SAPsmLC");if(!g){c.style.display="block";e.style.display="none"}else{if(d){b.innerHTML=d;b.style.display=$SA._strTableCell}else b.style.display="none";var a=_ge("SA_PSMin"),f=a.parentElement;if($B.Firefox)f.removeChild(a);a.innerHTML=g;if($B.Firefox)f.appendChild(a);a.title=h;c.style.display="none";e.style.display=$B.IE?"block":"table"}};SA_WNIns=function(a){if($SAConfig.wn=="true"&&window.$wn&&$wn.insertTop&&a)$wn.insertTop(a)};$Do.register("$SA.initialize",$SA.initialize);registerNamespace("$SA");new function(){var d=$SA,b=true;d.activeRO=function(){var k="SAInactive",j=_ge(k),i,p="SA_PSMURLin";if(j.style.display=="none")return false;if(event){var d=event.srcElement;while(d&&d.id!=k){if(d.nodeName=="A"&&(d.id==p||d.parentElement.id=="SA_PSMin")){i=true;break}d=d.parentElement}}if(i)return false;SA_liteupArea(false);if(b){var n={SACloseImg:$SAConfig.themeBase+"hig/img/glyph/close_rest_dark.gif"},g="prev",h="next";if($B.rtl){g="next";h="prev"}var o={SAthumbLoad:$SAConfig.imgBase+"wn/progress_loading_2.gif",SAThumbLeftImgOff:$SAConfig.imgBase+"sa/"+g+"-ina.png",SAThumbRightImgOff:$SAConfig.imgBase+"sa/"+h+"-ina.png",SAThumbLeftImg:$SAConfig.imgBase+"sa/"+g+"-act.png",SAThumbRightImg:$SAConfig.imgBase+"sa/"+h+"-act.png",SAErrImg:$SAConfig.imgBase+"sa/err16.gif",SAShareImg:$SAConfig.imgBase+"wn/progress_loading_2.gif",SALoadingImg:$SAConfig.imgBase+"wn/progress_loading_2.gif"};a(n);var f=Object.fromJSON($SAConfig.imgStrips);if(f)for(var l in f){var e=f[l],m=$IS.Create(e.x,e.y,e.w,e.h,$SAConfig.imgBase,e.img,e.alt);_ge(l).appendChild(m)}if($B.IE_M6)setTimeout(c,0);a(o)}b=false;j.style.display="none";_ge("SAActive").style.display="";return true};function a(a){for(var b in a){var c=_ge(b);if(c)c.src=a[b]}}function c(){var a=_ge("SACtrl");a.className=a.className}};SA_liteupArea=function(c){if(SA_stat.d)return;var a=_ge("SAInactive"),b="SAHover";if(a.style.display!="none")if(c)$css.add(a,b);else $css.remove(a,b)};function SAShowPhoto(){_ge("SARem").innerHTML=$SAConfig.strRemPhoto.encodeHtml();try{_ge("SAPhotoInput").focus()}catch(a){}$SA.blur(_ge("SAInput"));SAPhotoCheck()}function SAClearPhoto(){var a=_ge("SAPhotoInput").parentElement;a.innerHTML=a.innerHTML;_ge("SABtn").disabled=false}function SAPhotoCheck(a){if(a&&a.type=="propertychange"&&a.propertyName!="value")return;if(_ge("SAPhotoInput").value.length>0)_ge("SABtn").disabled=false;else _ge("SABtn").disabled=true}function SAPhotoDisable(a){_ge("SAPhotoInput").disabled=a}function SAShowDoc(){_ge("SARem").innerHTML=$SAConfig.strRemDoc.encodeHtml();try{_ge("SADocInput").focus()}catch(a){}$SA.blur(_ge("SAInput"));SADocCheck()}function SAClearDoc(){var a=_ge("SADocInput").parentElement;a.innerHTML=a.innerHTML;_ge("SABtn").disabled=false}function SADocCheck(a){if(a&&a.type=="propertychange"&&a.propertyName!="value")return;if(_ge("SADocInput").value.length>0)_ge("SABtn").disabled=false;else _ge("SABtn").disabled=true}function SADocDisable(a){_ge("SADocInput").disabled=a}function SAUploadImage(g){if(SA_stat.d)return;var e=false,d=_ge(g),f=_ge("SAHide"),a,c=document.createElement("div");SA_stat.skyID=Math.floor(Math.random()*1e4);c.id="SAiframeC";c.innerHTML='<iframe id="SAiframe" name="SAimageUploadFrame" class="SAiframe"></iframe>';var b=SA_getPsm();if(b.length>255){b=b.substring(0,254);b+="\u2026"}d.elements["caption"].value=b;d.elements["id"].value=SA_stat.skyID;d.target="SAimageUploadFrame";a=c.firstChild;a.src="about:blank";if($B.IE)a.onreadystatechange=SAIframeEvent;else a.onload=SAIframeEvent;f.appendChild(c);try{d.submit()}catch(h){$SA.showErr(SA_Code.GeneralError);e=true;a.onload=null;a.onreadystatechange=null}if(!e){SA_stat.p=true;$SA.setPostState(true)}}function SAIframeEvent(){if(SA_stat.d)return;var a=_ge("SAiframe");if(!SA_stat.p)return;SA_stat.skyPoll=0;if($B.IE){if(a.readyState=="complete"){setTimeout(SAFrameResponse,100);a.onreadystatechange=null}}else{setTimeout(SAFrameResponse,100);a.onload=null}}function SAFrameResponse(){if(SA_stat.d)return;var b=$Cookie.getCookie("SDXPostUpload"),a=SAParseFile(b);if(SA_stat.skyPoll>9||a.match){$Cookie.deleteCookie("SDXPostUpload",$SAConfig.domain);SAUploadComplete(a)}else{SA_stat.skyPoll++;setTimeout(SAFrameResponse,100)}}function SAUploadComplete(a){if(SA_stat.d)return;var c=_ge("SAHide"),b=_ge("SAiframeC");c.removeChild(b);if(a.error){$SA.setPostState(false);SA_stat.p=false;$SA.showErr(SA_Code.GeneralError)}else{var d="&cns="+a.cns;$SA.post(d)}}function SAParseFile(c){var b={error:true,match:false};if(!c||SA_stat.d)return b;var a=c.split("|",4);if(a.length>=2){var e=a[0],f=a[1],d;if(a.length>=3)d=a[2];if(f==SA_stat.skyID){b.match=true;var g=/^OK$/i;if(g.test(e)){b.error=false;b.cns=d}}}return b};var $wn={};new function(){var b=$wn,k=false;_wnOptions=null,_options=null,_optionsText="",_optionsLink="",_wnOptionsLink="",_permissionsText="",_permissionsLink="",_wnPermissionsLink="",_optionsHandler="",_insertTopOptionClass="c_wn_opti",_itemFocusClassName="c_wn_i_of",_itemHoverClassName="c_wn_i_oh",_itemMenuOnClassName="c_wn_i_mo",_itemBottomClassName="c_wn_ibp",_itemClassName="c_wn_i",_imageNormal="",_imageAlt="",_itemWithMenuClassName="c_wn_wm",_moreClassName="c_wn_more",_disposed=false,_instanceId=1;_dynamicCanary="",_queryRandomizer=0,_menuEvents='onfocus="return $wn.menuItemOn(this);" onblur="return $wn.menuItemOut(this);"';function e(a){a=a||event;return a.target||a.srcElement}function F(a){n(a,true)}function E(a){n(a,false)}function n(b,d){var a=c(e(b));if(d)$css.add(a,_itemHoverClassName);else $css.remove(a,_itemHoverClassName);if(D(a))$css.add(a,_itemMenuOnClassName);else $css.remove(a,_itemMenuOnClassName)}function c(a,d,b){var c=b?b:d?"c_wn":_itemClassName;while(a&&!$css.has(a,c))a=a.parentNode;return a}function d(d){var c=[],b=d.getElementsByTagName("DIV");for(var a=0;a<b.length;a++)if($css.has(b[a],_itemClassName))c.push(b[a]);return c}function z(c){var b=c.getElementsByTagName("DIV");for(var a=0;a<b.length;a++)if($css.has(b[a],_itemClassName))return b[a];return null}function B(w){var l=e(w),q=l.tagName=="IMG"?l.parentNode.parentNode:l.parentNode,v=l.tagName=="IMG"?l.parentNode:l,d=c(q);if(!q.menu){var k=a(d,"n"),u=a(d,"an"),r=document.createElement("div"),m=q;menuOptions="",i=0;var s=a(d,"cid"),A=a(d,"e"),p=a(d,"ctid"),y=a(d,"ex"),z=a(d,"a");if($css.has(m,_itemWithMenuClassName)==false){r.className="c_m c_om t_hovl";$css.add(m,_itemWithMenuClassName);var h=$css.has(m,_insertTopOptionClass)?g(m):_options;for(var b in h){var j=null,o=null,n=null;if(b=="af"){if((p||s)&&k){n=" class='wn_af'";j=h[b].format(k.encodeHtml(),f(true));if(a(d,"if"))o=" style='display:none'"}}else if(b=="rf"){if((p||s)&&k){n=" class='wn_rf'";j=h[b].format(k.encodeHtml(),f(true));if(!a(d,"if"))o=" style='display:none'"}}else if(b=="n"){if(h[b]&&(s||A||p||y)&&k)j=h[b].format(k.encodeHtml())}else if(b=="a"){if(h[b]&&z&&u)j=h[b].format(u.encodeHtml())}else j=h[b];if(j)menuOptions+=["<li",n,o,'><a href="#" onclick="return $wn.doAction(\'',b,"',this)\">",j,"</a></li>"].join("");i++}m.appendChild(r);var x=_permissionsText&&_permissionsLink?'<li><a target="_top" href="'+_permissionsLink+'">'+_permissionsText+"</a></li>":"",t=_optionsText&&_optionsLink?'<li><a target="_top" href="'+_optionsLink+'">'+_optionsText+"</a></li>":"";r.innerHTML="<ul>"+menuOptions+"</ul>"+(t==""?"":'<div class="lp"><div class="line"></div></div><ul>'+x+t+"</ul>")}try{$menu.bind(w,1)}catch(B){}}if(d.refreshMenu&&v.menu){d.refreshMenu=null;v.menu.update()}return false}function D(a){var b=false;if(a)try{b=a.children[1].children[0].style.visibility=="visible"}catch(c){}return b}function a(a,b){return a.attributes?a.getAttribute(b):null}function g(f,d){var e=d?"o"+d:"o",c={},b=a(f,e).split("|");for(i=0;i<b.length;i++)c[b[i]]=window["$wn_"+b[i]];return c}b.bindOptions=function(j){var d=c(j,1);if(!d.bound){var i=$f.addEvent;_optionsText=_optionsText?_optionsText:$wn_ot;_optionsLink=_optionsLink?_optionsLink:a(d,"ov");_permissionsText=_permissionsText?_permissionsText:$wn_pt;_permissionsLink=_permissionsLink?_permissionsLink:a(d,"pv");_dynamicCanary=_dynamicCanary?_dynamicCanary:a(d,"dc");_optionsHandler=_optionsHandler?_optionsHandler:a(d,"hdlr");var f=d.getElementsByTagName("DIV"),b;_options=_options?_options:g(d);if(!k){_wnOptions=_options;_wnOptionsLink=_optionsLink;_wnPermissionsLink=_permissionsLink;k=true}for(b=0;b<f.length;b++)if($css.has(f[b],_itemClassName)&&!f[b].bound){i(f[b],"onmouseover",F);i(f[b],"onmouseout",E);f[b].bound=true}var e=d.getElementsByTagName("A");for(b=0;b<e.length;b++)if($css.has(e[b],"c_wn_ito")&&!e[b].bound){i(e[b],"onfocus",$wn.menuOn);i(e[b],"onblur",$wn.menuOut);i(e[b],"onclick",B);var h=new Image;h.src=_imageNormal=$wn_oi;h.alt=_imageAlt=$wn_oa;h.title=h.alt;h.className="c_wn_i_opt";e[b].appendChild(h);e[b].bound=true}d.bound=true}return false};b.doAction=function(d,p){var e="",o="none",r=new Image,b=c(p),f;if(d=="d"){b.style.display=o;var m=c(p,0,"wn_ins");if(m){var g=b.parentElement;while(g&&g!=m){g.style.display=o;g=g.parentElement}}var q=a(b,"a");e=a(b,d)+"&a="+q;f="d"}else if(d=="n"){var k=["ctid","cid","e","ex"];for(var j=0;j<k.length;j++){var i=a(b,k[j]);if(i){h(b,k[j],i);e=k[j]+"="+i.encodeURIComponent();break}}f="bu"}else if(d=="a"){var i=a(b,"a");s(b);h(b,"a",i);e="a="+i;f="ba"}else if(d=="af"||d=="rf"){var l=a(b,"cid"),n=a(b,"ctid");if(!l)e="ctid="+n;else e="cid="+l;$wn.updateFavoriteUI(b,n,l,d=="af");f=d}r.src=_optionsHandler+"?dc="+_dynamicCanary+"&"+e+"&act="+f+"&r="+_queryRandomizer++;$menu.closeCurrent();return false};function h(g,f,h){var e=d(c(g,true));for(var b=0;b<e.length;b++)if(e[b]&&a(e[b],f)==h)e[b].style.display="none"}function s(d){if(window.$wn_afmf){var b=$("wn_afm");if(b)b.parentNode.removeChild(b);var c=a(d,"an"),i=c?c.encodeURIComponent().encodeHtml():"";c=c?c.encodeHtml():"";var h=a(d,"a"),f=a(d,"cid");f=f?f:"";var e="",g=$css.getCN("c_wn_itc","div",d);if(g&&g.length>0){e=g[0].innerText;e=e?e.encodeURIComponent().encodeHtml():""}if(c&&h){var j=$wn_afmf.replace(/{appname}/g,c.encodeHtml()).replace(/{ai}/g,h).replace(/{cid}/g,f).replace(/{at}/g,e).replace(/{anp}/g,i);b=document.createElement("div");d.parentNode.insertBefore(b,d);b.id="wn_afm";b.className="c_wn_afm";b.innerHTML=j}}}b.menuOn=function(d){var a=e(d),b=c(a);$css.add(b,_itemFocusClassName)};b.menuOut=function(d){var b=e(d),a=c(b);$css.remove(a,_itemMenuOnClassName);$css.remove(a,_itemFocusClassName)};b.menuItemOn=function(a){b.menuOn(a);var d=c(a);$css.add(d,_itemMenuOnClassName)};b.menuItemOut=function(a){b.menuOut(a);var d=c(a);$css.remove(d,_itemMenuOnClassName)};b.viewMore=function(b){if(window.$wn_ld||_disposed)return;$wn_ld=true;var a=$("wn");if(b)t(a,b);else b=$("wn_viewmore");if(b){var e=p(a,"vmh"),f=b.parentElement,c=x(a),h=!c?"GET":"POST",g=o(a,f);function d(b){l(a,g,b,true)}try{$Network.fetchXML(e,d,h,c)}catch(i){d(null)}}};function t(g,f){var c=g.getElementsByTagName("A"),d=false;for(var b=c.length-1;b>=0;b--)if(c[b]==f)d=true;else if(d){var a=c[b],e=false;while(a&&a.nodeType!=9){if(a.currentStyle.display=="none"||a.currentStyle.visibility=="hidden"){e=true;break}a=a.parentNode}if(!e){try{c[b].focus()}catch(h){}break}}}function x(g){var c=[],h=0,f=d(g);for(var b=0;b<f.length;b++){var e=a(f[b],"aid");if(e)c[h++]=e}return c.join(",")}b.insertTop=function(h){if(!window.$wn_ld){var b=$("wn_nodata"),a=$("wn_insc"),f=c(a,1),e=document.createElement("div"),g=d(f);$css.remove(g[0],"c_wn_fitm");if(b!=null&&b.style!=null)b.style.display="none";if(a.hasChildNodes())a.insertBefore(e,a.firstChild);else a.appendChild(e);$Utility.ajaxInnerHtml(e,h);a.style.display="block";f.bound=false}};b.Load=function(g,c){if(_disposed||window.$wn_ld)return;$wn_ld=true;var b=$("wn"),e=$("wn_insc");if(e){e.innerHTML="";e.style.display="none"}if(g)A(g,b);else c=a(b,"f");w(b,c=="me");q();b.setAttribute("f",c?c:"");var d=$("wn_itms");if(d==null)d=$("wn_err");var j=d.offsetHeight,f=o(b,d);f.style.height=j-13+"px";var i=p(b,"alh",c);function h(a){l(b,f,a,false)}try{$Network.fetchXML(i,h,"GET")}catch(k){h(null)}};function q(){if(window.$ic&&$ic.ic){$ic.ic.removeICsFromNamespace("wn");$ic.ic.removeICsFromNamespace("wnit")}}function r(b,c){$wn_ld=false;var a=document.createElement("div");a.innerText=c;a.id="wn_err";$css.add(a,"c_wn_err");$css.add(a,"ErrorMed");b.parentNode.replaceChild(a,b)}function A(f){if(_disposed)return;var a=f.parentNode,g=c(a,0,"c_wn_fl"),d=g.getElementsByTagName("li");for(var b=0;b<d.length;b++)$css.remove(d[b],"c_wn_fls");if(!$css.has(a.parentNode,"c_wn_fl")){var e=$("wn_other");$css.add(e.parentNode,"c_wn_fls")}$css.add(a,"c_wn_fls");$menu.closeCurrent()}function p(f,e,c){var b=a(f,e);b+="&ii="+$ic.ic.getICNamespaceCount("wn");b+="&wii="+_instanceId++;var d=$ic.ic.getICNamespaceCount("cmtc");b+="&cindx="+d;if(c=="me"){b=b.replace("w=1","w=0");b=b.replace("im=bap","im=da")}else if(c=="recent")b=b+"&re=1";else if(c)b=b+"&tf="+c;return b}function o(d,b){var c=$wn_le,a=document.createElement("div");if(b)b.parentNode.replaceChild(a,b);else d.appendChild(a);a.innerHTML=c;a.id="wn_loading";$css.add(a,"c_wn_loading");return a}function l(f,i,c,k){var n=!c||c.status!=200||!c.responseText||c.responseText.indexOf("c_wn_")<0?true:false;if(_disposed)return;if(n)r(i,$wn_em);else{var b=document.createElement("div");$css.add(b,"c_wn_vm");i.parentNode.replaceChild(b,i);$Utility.ajaxInnerHtml(b,c.responseText);if(!k)b.id="wn_itms";if(b.firstChild){wnEl=$("wn_aa");if(wnEl){if(k){var j=d(f),l=z(wnEl);if(l!=null){var g=-1;for(var e=0;e<j.length;e++)if(j[e]==l){g=e-1;break}if(g>=0)$css.add(j[g],_itemBottomClassName)}}wnEl.id="";var o=f.setAttribute("vmh",a(wnEl,"vmh")),h=$("wn_vmc_aa");if(h){h.id="";if(k){var m=$("wn_itms");m.appendChild(h)}}f.bound=false}}else r(b,$wn_em);$wn_ld=false}}function w(b,c){if(c){_options=g(b,"ra");_permissionsLink=a(b,"pvra");_optionsLink=a(b,"ovra")}else{_options=_wnOptions;_permissionsLink=_wnPermissionsLink;_optionsLink=_wnOptionsLink}}function v(i){if(_disposed)return;var a=i.srcElement,d=document.getElementById("wn");while(a&&a.tagName!="A"&&a!=d)a=a.parentNode;if(a&&a!=d){var f=$wn_expUrl.replace("{0}","SUP_Click"),e=d.getElementsByTagName("A");if(window.$Beacon){var g=-1;for(var c=0;c<e.length;c++)if(e[c]==a){g=c;break}var h=a.href?a.href:"#",b={};b["LinkId"]=g;b["LinkUrl"]=h;if(a.href&&a.href!="#")$Beacon.fireAndHold(f,b);else $Beacon.fire(f,b)}}}function j(){$Beacon.fire($wn_expUrl.replace("{0}","SUP_PV"))}b.RecordComment=function(a){if(window.$wn_inExp)$Beacon.fire($wn_expUrl.replace("{0}","SUP_Comment"),a)};b.InitExp=function(){if(_disposed)return;if($BSI.isLoading())$BSI.addLoadedCallback(j);else j();var a=document.getElementById("wn");$f.addEvent(a,"onclick",v)};b.Dispose=function(){if(_disposed)return;_disposed=true;q();if(window.$Comments&&$Comments.Dispose)$Comments.Dispose();var b=$("wn");if(b){if(window.$IS&&window.$IS.disposeAll)$IS.disposeAll(b);var e=b.getElementsByTagName("IMG");for(var a=e.length-1;a>=0;a--)e[a].parentNode.removeChild(e[a]);var c=b.getElementsByTagName("OBJECT");for(var a=c.length-1;a>=0;a--)c[a].parentNode.removeChild(c[a]);var d=b.getElementsByTagName("EMBED");for(var a=d.length-1;a>=0;a--)d[a].parentNode.removeChild(d[a])}$wn=null};b.SLImages=function(){if(window.$wn_id&&$wn_id>0)setTimeout(C,$wn_id)};function C(){var d=$("wn");if(d){var a=d.getElementsByTagName("IMG");for(var b=a.length;b--;){var c=a[b].getAttribute("SRCTO");if(c){a[b].setAttribute("SRCTO","");a[b].src=c;a[b].setAttribute("SRC",c)}}}}b.updateFavoriteUI=function(n,i,j,h,g){if(!g){var f=$("wn_afs");if(f)f.parentNode.removeChild(f)}var b=c(n);if(b){if(h){m(b);y(b,g)}else m(b);if(!g){var l=d(c(b,true));for(var k=0;k<l.length;k++){var e=l[k];if(e!=b&&(i&&a(e,"ctid")==i||j&&a(e,"cid")==j))$wn.updateFavoriteUI(e,i,j,h,true)}}u(b,h)}};function y(b,h){var e=b.getElementsByTagName("A");for(var c=0;c<e.length;c++)if($css.has(e[c],"c_wn_pn")&&window.$wn_fav){var g=new Image;g.src=$wn_fav;g.onerror="this.style.display='none'";g.className="c_wn_fav";e[c].parentNode.insertBefore(g,e[c].nextSibling)}b.setAttribute("if","1");if(!h&&window.$wn_favs){var i=a(b,"fn"),d=document.createElement("div");b.parentNode.insertBefore(d,b);d.id="wn_afs";d.className="c_wn_afs";d.innerHTML=$wn_favs.format(i,f())}}function m(d){var c=d.getElementsByTagName("IMG"),b=[];for(var a=0;a<c.length;a++)if($css.has(c[a],"c_wn_fav"))b.push(c[a]);for(var a=0;a<b.length;a++)b[a].parentNode.removeChild(b[a]);d.removeAttribute("if")}function u(d,c){var b=d.getElementsByTagName("LI");for(var a=0;a<b.length;a++){if($css.has(b[a],"wn_af"))b[a].style.display=c?"none":"block";if($css.has(b[a],"wn_rf"))b[a].style.display=c?"block":"none"}d.refreshMenu=1}function f(c){var a="",b=c?"c_wn_sfav":"c_wn_fav";if(window.$wn_fav)a='<img class="'+b+'" onerror="this.style.display=\'none\'" src="'+$wn_fav+'"/>';return a}b.Dismiss=function(g,e,f,d){if($wnup_dm=="c"&&d){var c="wnup",a=$Cookie.getCookie(c);a=!a?{}:$Utility.deserialize(a);var h=window.location.hostname;a[d]="1";$Cookie.setCookie(c,$Utility.serialize(a),h,0,new Date(2020,0,1),1)}else if(window.$wnup_du){var b={};if(f)b["type"]=f;if(g)b["apps"]=g;if(e)b["up"]=e;$Beacon.fire($wnup_du,b)}}};window.sn_favHandler=function(b,a,d){var c=$(b);$wn.updateFavoriteUI(c,a,d,true);return true};$wn.SLImages();$Do.register("$wn.Load",$wn.Load);$Do.register("$wn.InitExp",$wn.InitExp);$Do.register("$wn.RecordComment",$wn.RecordComment);$Do.register("$wn.Dismiss",$wn.Dismiss);$Do.register("$wn.viewMore",$wn.viewMore);registerNamespace("$wnWav");new function(){var k=1600,m=1200,p=640,n=480,h=75,g="WhatsNewDialogContents",a=null,e=false,d=null,c=null;$wnWav.show=function(c){if(!e){e=true;var b=_ce("div");b.className="UI_Dialog_Contents";b.id=g;b.innerHTML=c;b.style.color="#fff";b.style.backgroundColor="#000";a=new $UI.Dialog(true,null,true,"wnWav");a.setContents(b);i();f();a.show();window.attachEvent("onunload",l)}};$wnWav.close=function(){b();a.minimize();a.hide();a.dispose();a=null;e=false;if(d)d.focus()};function i(){window.attachEvent("onresize",f);document.attachEvent($B.RE_WebKit?"onkeydown":"onkeypress",j)}function b(){window.detachEvent("onresize",f);document.detachEvent($B.RE_WebKit?"onkeydown":"onkeypress",j)}function l(){window.detachEvent("onunload",l);b()}function j(a){switch(($B.RE_WebKit?a:event).keyCode){case 27:$wnWav.close()}}function f(){b();var d=document.documentElement.clientWidth,j=document.documentElement.clientHeight,l=k/m,c=Math.min(d-h*2,k),e=Math.max(Math.min(Math.floor(c/l),j-h*2),n);c=Math.floor(e*l);var f=Math.max(Math.floor((d-c)/2),0);if(document.body.className.indexOf("rtl")>-1)f=Math.min(f,d-c);var o=($B.RE_WebKit?document.body:document.documentElement).scrollTop,q=Math.max(Math.floor((j-e)/2)+o,o);a.dock.y=q;a.dock.x=f;var p=_ge(g).style;p.pixelWidth=c;p.pixelHeight=e;i();a.recalc()}function o(a){while(a&&!$css.has(a,"c_wn_i"))a=a.parentNode;return a}$wnWav.getBaseUrl=function(a){if(a)return "/Handlers/WavEmbed.mvc";else return $wn_we};$wnWav.popoverSlideshow=function(a,j,e){if(!IsRequiredSilverlightVersionInstalled())return true;else $wnWav.show("<div id='WhatsNewDialogInnerContents' style='height:100%'><table style='height:100%;width:100%;text-align:center;vertical-align:middle'><tr><td>"+$wn_le+"</td></tr></table></div>");d=a;c=a.href;var b=o(a),k=b.getAttribute("a"),i=b.getAttribute("alid"),h=$wnWav.getBaseUrl(e),f="app="+k.encodeURIComponent()+"&album="+i.encodeURIComponent()+"&photo="+j.encodeURIComponent(),g={"Content-Type":"application/x-www-form-urlencoded"};$Network.fetchXML(h,$wnWav.popoverSlideshowCallback,"POST",f,g);return false};$wnWav.ps1=function(b,a){return $wnWav.popoverSlideshow(b,a,false)};$wnWav.ps3=function(b,a){return $wnWav.popoverSlideshow(b,a,true)};$wnWav.popoverSlideshowCallback=function(a){if($("WhatsNewDialogInnerContents"))if(a.status==200&&a.responseText.startsWith("<!--WAVPopover-->"))$Utility.ajaxInnerHtml($("WhatsNewDialogInnerContents"),a.responseText);else if(window.self!=window.top)window.top.location=c;else window.location=c}};IsRequiredSilverlightVersionInstalled=function(){var b="4.0.50401",a=null;return function(){if(a!=null)return a;else return a=Silverlight.isInstalled(b)}}();if(!window.Silverlight)window.Silverlight={};Silverlight.isInstalled=function(b){if(b==undefined)b=null;var a=false,m=null;try{var i=null,j=false;if(window.ActiveXObject)try{i=new ActiveXObject("AgControl.AgControl");if(b===null)a=true;else if(i.IsVersionSupported(b))a=true;i=null}catch(l){j=true}else j=true;if(j){var k=navigator.plugins["Silverlight Plug-In"];if(k)if(b===null)a=true;else{var h=k.description;if(h==="1.0.30226.2")h="2.0.30226.2";var g=h.split(".");while(g.length>4)g.pop();var d=b.split(".");while(d.length>4)d.pop();var c,f,e=0;do{c=parseInt(d[e]);f=parseInt(g[e]);e++}while(e<d.length&&c===f);if(c<=f&&!isNaN(c))a=true}}}catch(l){a=false}return a};var $WebSecurity={};$WebSecurity.FlashDetection=new function(){var h=window["$Config"]||{},a=h.Flash,c=false,b=false;this.HasFlash=function(){if(!c){try{b=1==$Cookie.getSessionCookie(a.Cookie)||g(a.Major,a.Min,a.Rev)}catch(d){b=false}if(b)$Cookie.setSessionCookie(a.Cookie,1);c=true}return b};this.HandleEmbedCode=function(f,e){var b=$(f);if(!b||!b.parentNode)return;var c;if(this.HasFlash())try{var d=_d.createElement("span");d.innerHTML=e;c=d.firstChild;c.setAttribute("wmode","opaque",0)}catch(g){}else{c=_d.createElement("span");c.innerHTML=a.NoFlashHtml}b.parentNode.insertBefore(c,b);b.parentNode.removeChild(b)};this.DetectNow=function(){if(a&&window.flObj)for(var b in window.flObj)this.HandleEmbedCode(b,window.flObj[b])};function d(){var a=null;try{var c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7"),b=c.GetVariable("$version"),d=b.split(" ");a=d[1].split(",")}catch(e){}return a}function e(){var d=null;if(null!=navigator.plugins&&0<navigator.plugins.length&&(!!navigator.plugins["Shockwave Flash 2.0"]||!!navigator.plugins["Shockwave Flash"])){var g=navigator.plugins["Shockwave Flash 2.0"]?"Shockwave Flash 2.0":"Shockwave Flash",e=navigator.plugins[g].description,a=e.split(" "),b=a[2].split("."),f=""!=a[3]?a[3]:a[4],c=f.split("r");d=[b[0],b[1],c[1]>0?c[1]:0]}return d}function f(){if(null!=navigator.plugins&&0<navigator.plugins.length)return e();else if($B.IE_Win)return d();return null}function g(b,c,d){var a=f();if(!a)return false;if(a[0]>b)return true;else if(a[0]==b)if(a[1]>c)return true;else if(a[1]==c)return a[2]>=d;return false}};$WebSecurity.FlashDetection.DetectNow();HomeActions={};HomeActions.newMsg=function HomeActions$newMsg(){PersistenceMerge.navigateTo("/mail/EditMessageLight.aspx?n="+HomePage.nonce)};HomeActions.searchMail=function HomeActions$searchMail(){var a=$("c_search_SearchBoxControl_box");if(a)try{a.focus()}catch(b){}};HomeActions.goToInbox=function HomeActions$goToInbox(){HomeActions._goToFldr(HomePage.sysFldrs.inboxFid)};HomeActions.goToDrafts=function HomeActions$goToDrafts(){HomeActions._goToFldr(HomePage.sysFldrs.draftsFid)};HomeActions.goToSent=function HomeActions$goToSent(){HomeActions._goToFldr(HomePage.sysFldrs.sentFid)};HomeActions._goToFldr=function HomeActions$_goToFldr(a){var b="/mail/InboxLight.aspx?FolderID="+a+"&n="+HomePage.nonce;PersistenceMerge.navigateTo(b)};var KeyboardHandler={};KeyboardHandler._textElements=",BUTTON,SELECT,TEXTAREA,";KeyboardHandler._validInputTypes=",CHECKBOX,RADIO,";KeyboardHandler.Shortcuts={NOMATCH:0,MATCH:1,POTENTIALMATCH:2};KeyboardHandler.initialize=function KeyboardHandler$initialize(b,c,d,e,a){if(c&&b){KeyboardHandler._shortcutsTree=b;KeyboardHandler._handler=c;KeyboardHandler._needsModifierOrFunctionKey=true==e?true:false;KeyboardHandler._timeout=d>0?d:1e3;KeyboardHandler._matchFunction=null;KeyboardHandler._timeoutId=0;KeyboardHandler._resetSequence();KeyboardHandler._keyDownDelegate=$CD(this,KeyboardHandler.onKeyDownWrapper);document.attachEvent("onkeydown",KeyboardHandler._keyDownDelegate)}if(a)KeyboardHandler._validateShortcutsEnabled=a};KeyboardHandler.attachToIframe=function KeyboardHandler$attachToIframe(c){if(c&&KeyboardHandler._shortcutsTree){var d=c.contentWindow;if(d){var a=d.document;if(a){if(!KeyboardHandler._iframeEltsAndHandlers)KeyboardHandler._iframeEltsAndHandlers=[];var b=function(a){return KeyboardHandler._keyDownDelegate(a)};a.attachEvent("onkeydown",b);KeyboardHandler._iframeEltsAndHandlers.push({iframeDoc:a,handler:b})}}}};KeyboardHandler.dispose=function KeyboardHandler$dispose(){if(KeyboardHandler._iframeEltsAndHandlers){for(var b=KeyboardHandler._iframeEltsAndHandlers.length;b--;){var a=KeyboardHandler._iframeEltsAndHandlers[b];if(a){var d=a["iframeDoc"],c=a["handler'"];if(d&&c)d.detachEvent("onkeydown",c);KeyboardHandler._iframeEltsAndHandlers[b]=null}}KeyboardHandler._iframeEltsAndHandlers=null}if(KeyboardHandler._keyDownDelegate){document.detachEvent("onkeydown",KeyboardHandler._keyDownDelegate);KeyboardHandler._keyDownDelegate=null}KeyboardHandler._shortcutsTree=KeyboardHandler._handler=KeyboardHandler._needsModifierOrFunctionKey=KeyboardHandler._timeout=KeyboardHandler._timeoutId=KeyboardHandler._matchFunction=KeyboardHandler._sequence=KeyboardHandler._validateShortcutsEnabled=null};KeyboardHandler.onKeyDownWrapper=function KeyboardHandler$onKeyDownWrapper(a){if(KeyboardHandler._validateShortcutsEnabled&&!KeyboardHandler._validateShortcutsEnabled())return true;a=a||event;if(a.ctrlKey&&a.altKey){KeyboardHandler._resetSequence();return true}var c="",d=false;if(a.ctrlKey){c="CTRL";d=true}else if(a.altKey){c="ALT";d=true}if(a.shiftKey)c=c+"SHIFT";var e=a.keyCode;if(e>=112&&e<=123)d=true;var g=c+e;if(!KeyboardHandler._validatePreConditions(d,a)){KeyboardHandler._resetSequence();return true}var b=KeyboardHandler._addTermAndLookup(g);if(b==KeyboardHandler.Shortcuts.NOMATCH){var h=KeyboardHandler._sequence.length>1;KeyboardHandler._resetSequence();if(h){b=KeyboardHandler._addTermAndLookup(g);if(b==KeyboardHandler.Shortcuts.NOMATCH)KeyboardHandler._resetSequence()}}if(b==KeyboardHandler.Shortcuts.MATCH){if(KeyboardHandler._handler){var f=false;try{f=KeyboardHandler._handler(a,KeyboardHandler._matchFunction)}catch(i){}if(f)b=KeyboardHandler.Shortcuts.NOMATCH;KeyboardHandler._resetSequence();KeyboardHandler._matchFunction=null}}else if(b==KeyboardHandler.Shortcuts.POTENTIALMATCH)KeyboardHandler._setSequenceTimeout();if(b!=KeyboardHandler.Shortcuts.NOMATCH){a.returnValue=false;a.cancelBubble=true;return false}return true};KeyboardHandler._addTermAndLookup=function KeyboardHandler$_addTermAndLookup(a){KeyboardHandler._sequence.push(a);return KeyboardHandler._lookupHelper(KeyboardHandler._shortcutsTree,0)};KeyboardHandler._lookupHelper=function KeyboardHandler$_lookupHelper(a,b){if(null==a)return KeyboardHandler.Shortcuts.NOMATCH;if("string"==typeof a){KeyboardHandler._matchFunction=a;return KeyboardHandler.Shortcuts.MATCH}if(b>=KeyboardHandler._sequence.length)return KeyboardHandler.Shortcuts.POTENTIALMATCH;else return KeyboardHandler._lookupHelper(a[KeyboardHandler._sequence[b]],b+1)};KeyboardHandler._setSequenceTimeout=function KeyboardHandler$_setSequenceTimeout(){if(KeyboardHandler._timeoutId){clearTimeout(KeyboardHandler._timeoutId);KeyboardHandler._timeoutId=0}KeyboardHandler._timeoutId=setTimeout(KeyboardHandler._sequenceTimeout,KeyboardHandler._timeout)};KeyboardHandler._sequenceTimeout=function KeyboardHandler$_sequenceTimeout(){KeyboardHandler._resetSequence()};KeyboardHandler._resetSequence=function KeyboardHandler$_resetSequence(){KeyboardHandler._sequence=[];if(KeyboardHandler._timeoutId){clearTimeout(KeyboardHandler._timeoutId);KeyboardHandler._timeoutId=0}};KeyboardHandler._validatePreConditions=function KeyboardHandler$_validatePreConditions(a,b){return a||!KeyboardHandler._needsModifierOrFunctionKey&&!KeyboardHandler._isTextElt(b.srcElement)};KeyboardHandler._isTextElt=function KeyboardHandler$_isTextElt(a){var b=a.tagName?a.tagName.toUpperCase():"";return KeyboardHandler._textElements.indexOf(["",b,""].join(","))>=0||"INPUT"==b&&KeyboardHandler._isTextInputType(a)||a.isContentEditable||"on"==a.designMode||"HTML"==b&&a.document&&"on"==a.document.designMode};KeyboardHandler._isTextInputType=function KeyboardHandler$_isTextInputType(a){var b=a.type?a.type.toUpperCase():"";return KeyboardHandler._validInputTypes.indexOf(["",b,""].join(","))<0};new function(){var R=$("HomeContent"),V=$("h_leftcol"),E=$("h_rightcol"),k=$("h_upsell"),N=$("h_messages"),h=$("h_tempmsgs"),o=E.currentStyle,q=parseInt(o.marginLeft),p=parseInt(o.marginRight),P=(isNaN(q)?0:q)+(isNaN(p)?0:p),M=E.offsetWidth+P,n=0,d,m=HomePage.wnAutoScroll,w=2e3,t=2,b=1,f=-2,K=-1,H="LI",v="DIV",g="type",a="style",I="h_panel",G="Tahoma",B=HomePage.inboxCount,l;function T(){window.attachEvent("onunload",i);if(HomePage.kbdShortcuts)KeyboardHandler.initialize(HomePage.kbdShortcuts,function(b,a){HomeActions[a]()},HomePage.kbdShortcutsTimeout,false);if(k){var a=k.getAttribute("shownurl");if(a)y(a,k.getAttribute("canary"))}window.attachEvent("onresize",j);j();$Do.when("wlximuiinner",0,J);if(m)window.attachEvent("onscroll",u)}function y(d,c,b){var a={},e="canary="+c;a["Content-Type"]="application/x-www-form-urlencoded";$Network.fetchXML(d,function f(){},"POST",e,a);A(b)}$Do.register("h_NotifyAction",y);function Q(d,c,b){if($Cookie){var a=new Date;a.setTime(a.getTime()+1*24*60*60*1e3);$Cookie.setCookie(HomePage.bdayCookie,"!",window.location.host,0,a,1)}A(b)}$Do.register("h_DismissBday",Q);function O(d,c,a,b){if(a)$BSI.reportEvent(a,b);$BSI.navigateTo(d,c)}$Do.register("h_NavigateToLink",O);function S(a){var b="/mail/inboxlight.aspx?FolderID=66666666-6666-6666-6666-666666666666&n="+HomePage.nonce+"&SearchEmailKeyword="+a.encodeUrl();PersistenceMerge.navigateTo(b)}$Do.register("h_SearchEmail",S);function A(b){if(b){var c=$(b);if(c)c[a].display="none"}}function J(){if(!d&&$WLXIM){d=1;$WLXIM.addUnreadMailCountListener(e)}}function u(){if(!n){n=1;if($("wn_viewmore")){window["wn_viewmore"]="wn_viewmore";$Do.when("$wn.viewMore")}}}function i(){window.detachEvent("onresize",j);window.detachEvent("onunload",i);if(m)window.detachEvent("onscroll",u);if(HomePage.kbdShortcuts)KeyboardHandler.dispose();if($wn)$wn.Dispose();if($Ads)$Ads.Dispose();if(d)$WLXIM.removeUnreadMailCountListener(e)}$Do.register("h_Dispose",i);function e(){var a=parseInt($WLXIM.unreadMailCount);if(a>=0){if(a>0)l=1;else if(!l)return;if(B!=a&&HomePage.msgsAutoRefresh){try{$Network.fetchXML("/mail/messageshelper.mvc",function(a){F(a)},"GET")}catch(c){}B=a}if(a>9999)a="999+";$("h_inboxCount").innerHTML=HomePage.goToInboxStr.format(a);var b=$("h_newMsgs");if(b)if(a==0||a==1)b.innerHTML=a==0?HomePage.noMsgsStr:HomePage.oneNewMsgStr;else b.innerHTML=HomePage.xNewMsgsStr.format(a)}}$Do.register("h_UpdateUnreadCount",e);function U(){var b=R.offsetWidth-M-2;if(b>0)V[a].width=b+"px"}function j(){setTimeout(U,0)}function F(a){var b=!a||a.status!=200;if(!b&&a.responseText&&a.responseText.indexOf(I)!=-1){$Utility.ajaxInnerHtml(h,a.responseText);D(h,N,v);h.innerHTML=""}}function z(g,a){a.animating=1;var e=(new Date).getTime(),d=e-g;if(a.FadeTimeLeft<=d){C(a,a.FadeState==b?100:0);a.FadeState=a.FadeState==b?t:f;if(a.parentNode&&a.FadeState==f){a.parentNode.removeChild(a);a.animating=0}r(a);return}a.FadeTimeLeft-=d;var c=a.FadeTimeLeft/w;if(a.FadeState==b)c=1-c;C(a,c*100);r(a);a.animatedTimer=setTimeout(function(){z(e,a),33})}function r(b){if(b.FadeState==t&&b[a].filter&&b[a].removeAttribute){b[a].removeAttribute("filter");b[a].fontFamily=null}}function C(c,b){var d="undefined"==typeof c[a].filter?"opacity":"filter";c[a][d]=d=="filter"?"alpha(opacity="+b+")":.01*b}function c(c,d){if(c.animating)if(d&&c.FadeState<0||!d&&c.FadeState>0)return;else clearTimeout(c.animatedTimer);c[a].fontFamily=G;c[a].zoom="1";c.FadeState=d?K:b;c.FadeTimeLeft=w;z((new Date).getTime(),c)}function s(b){b[a].opacity=0;b[a].filter="alpha(opacity=0)";b[a].zoom="1";b.FadeState=f}function L(d,b){var c=d.getElementsByTagName("ul")[0],a=b.getElementsByTagName("ul")[0];D(c,a,H)}function D(j,f,e){var b=j.children[0],a=f.children[0],k=0;while(b&&!b.tagName)b=b.nextSibling;while(a&&!a.tagName)a=a.nextSibling;do{if(a&&b&&b.tagName==e){var i=b.getAttribute(g),h=a.getAttribute(g);if(i==h){if(e==v)L(b,a);a=a.nextSibling;b=b.nextSibling}else{if(!x(f.children,i,e)){var d=b.cloneNode(true);s(d);f.insertBefore(d,a);c(d,0);b=b.nextSibling}if(!x(j.children,h,e)){var l=a.nextSibling;c(a,1);a=l}}}while(b&&!b.tagName)b=b.nextSibling;while(a&&!a.tagName)a=a.nextSibling;k++}while(b&&a&&k<=10);if(b)do{if(b.tagName==e){var d=b.cloneNode(true);s(d);f.appendChild(d);c(d,0)}b=b.nextSibling}while(b);if(a)do if(a.tagName==e){var l=a.nextSibling;c(a,1);a=l}else a=a.nextSibling;while(a)}function x(b,d,c){for(var a=0;a<b.length;a++)if(b[a].tagName==c&&b[a].getAttribute(g)==d)return 1;return 0}T()}