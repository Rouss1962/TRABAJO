/* Copyright (C) 2011 Microsoft Corporation */if(!window["$theme"]){$theme=new Function;$theme.maxLinks=5;$theme.thumbnail=function(a){var i=this,b=a.getAttribute("info").split("|");this.themeinfo=b;function h(){$f.addEvent(a,"onfocus",d);$f.addEvent(a,"onblur",c);$f.addEvent(a,"onmouseover",d);$f.addEvent(a,"onmouseout",c);$f.addEvent(a,"onclick",g);if(!$menu.disableThumbs){var b=new Image;b.className="thumb";b.alt=a.title;b.src=f();b.setAttribute("thov","2");a.appendChild(b)}else e()}function e(){a.style.backgroundColor=b[3]}function g(){$theme.previewTheme(b,true,a)}function c(){$theme.previewTheme();$css.remove(a,"t_hov")}function d(){$theme.previewTheme(b);$css.add(a,"t_hov")}function f(){return b[1]}h()};$theme.keys=[];if("undefined"==typeof $theme.previewTheme)$theme.previewTheme=function(g,c,e){var r=$theme.keys.length==0,t=navigator.appVersion.indexOf("MSIE 6")>-1;if(!g)g=[$theme.current,,$theme.version];var i=g[2],b=g[0];if($theme.preview==b&&(!c||$theme.current==b)){if(c&&$f.pn(e,"c_m"))$menu.closeCurrent();return}if(!$theme.previewLinks)$theme.previewLinks=[];var s=false,f=$theme.previewLinks,p=[$theme.baseUrl,$theme.preview,"/",$theme.version].join(""),n=$theme.genService.replace("{themeid}",b).replace("{version}",i)+($theme.uniqueServiceParams?"&"+$theme.uniqueServiceParams:""),j=$theme.baseGenLinkId+b+"_"+i.replace(".","_"),a=document.getElementById(j),d=document.getElementById("themecss");if(!a){a=document.createElement("link");a.id=j;a.href=n;a.disabled=true;a.type="text/css";a.rel="stylesheet";m(d,a);if(!c)$theme.previewLinks.push(a)}if(c){var k=d.parentNode;if(d.nodeName=="STYLE")d.id="themecssold";else k.removeChild(d);a.id="themecss";for(var h=0;h<f.length;h++)if(f[h].id!="themecss")k.removeChild(f[h]);$theme.previewLinks=f=[]}if($theme.disableAllExceptTimeout){clearTimeout($theme.disableAllExceptTimeout);$theme.disableAllExceptTimeout=0}$theme.disableAllExceptTimeout=window.setTimeout(function(){l(j)},0);function m(c,d){var a=c.parentElement||c.parentNode;for(var b=0;b<a.childNodes.length-1;b++)if(a.childNodes[b]==c){a.insertBefore(d,a.childNodes[b+1]);return}a.appendChild(d)}function l(e){var a=$theme.previewLinks,c=$theme.maxLinks;for(var b=0;b<a.length-c;b++)a[b].removeNode();if($theme.previewLinks.length>c)$theme.previewLinks=a=$theme.previewLinks.splice(a.length-c,c);for(var b=0;b<a.length;b++)a[b].disabled=true;var d=document.getElementById(e);if(d)d.disabled=false}$theme.preview=b;if(c&&e){$css.remove($theme.currentEl,"sel");$css.add(e,"sel");$theme.currentEl=e;$theme.current=b;$theme.version=i;if("undefined"!=typeof $themewritecallback)$themewritecallback(b);if($f.pn(e,"c_m"))$menu.closeCurrent();if(!$theme.saveTheme||$theme.saveTheme(b)){var o=new Image;o.src=[$theme.serviceUrl,"&themeid=",b,"&",Math.random()].join("")}}};$theme.bind=function(d,e){if(d&&e&&d.themebound!=true){var c=$(e);if(c&&"undefined"!=typeof $Config.Themes){$theme.baseUrl=$Config.Themes.baseUrl;$theme.genService=$Config.Themes.genService;$theme.preview=$theme.current=$Config.Themes.current;$theme.version=$Config.Themes.version;$theme.serviceUrl=c.getAttribute("serviceurl");$theme.baseGenLinkId="theme_gen_link_";$theme.uniqueServiceParams=$Config.Themes.uniqueServiceParams;var a=c.getElementsByTagName("A");if(a.length>0){for(var b=0;b<a.length;b++)if(a[b].getAttribute("info")){if("undefined"==typeof a[b].binding)a[b].binding=new $theme.thumbnail(a[b]);if(a[b].binding.themeinfo[0].toLowerCase()==$theme.current.toLowerCase()){$css.add(a[b],"sel");$theme.currentEl=a[b]}}d.themebound=true}}}}}if(window["$menu"]&&$menu.themeCallback)$menu.themeCallback()