// Copyright (c) Microsoft Corporation. All rights reserved.
Microsoft.Live.Core.Loader.onResourceAvailable('messenger_services_loader',null,function(){Type.registerNamespace('MSCo');MSCo.LocalStorageServiceWrapper=function(service){this.swapServices(service);}
MSCo.LocalStorageServiceWrapper.prototype={$0:null,swapServices:function(newService){if(this.$0!=null){this.$0.remove_dataRead(ss.Delegate.create(this,this.$4));this.$0.remove_dataWritten(ss.Delegate.create(this,this.$5));this.$0.remove_instancesChanged(ss.Delegate.create(this,this.$6));}this.$0=newService;this.$0.add_dataRead(ss.Delegate.create(this,this.$4));this.$0.add_dataWritten(ss.Delegate.create(this,this.$5));this.$0.add_instancesChanged(ss.Delegate.create(this,this.$6));},add_dataWritten:function(value){this.$1=ss.Delegate.combine(this.$1,value);},remove_dataWritten:function(value){this.$1=ss.Delegate.remove(this.$1,value);},$1:null,add_dataRead:function(value){this.$2=ss.Delegate.combine(this.$2,value);},remove_dataRead:function(value){this.$2=ss.Delegate.remove(this.$2,value);},$2:null,add_instancesChanged:function(value){this.$3=ss.Delegate.combine(this.$3,value);},remove_instancesChanged:function(value){this.$3=ss.Delegate.remove(this.$3,value);},$3:null,get_usesLocalStorageProxy:function(){return this.$0.get_usesLocalStorageProxy();},get_lastWriteTime:function(){return this.$0.get_lastWriteTime();},get_lastReadTime:function(){return this.$0.get_lastReadTime();},get_revision:function(){return this.$0.get_revision();},get_currentInstances:function(){return this.$0.get_currentInstances();},get_signInStatusResponseInfo:function(){return this.$0.get_signInStatusResponseInfo();},set_signInStatusResponseInfo:function(value){this.$0.set_signInStatusResponseInfo(value);return value;},get_groups:function(){return this.$0.get_groups();},set_groups:function(value){this.$0.set_groups(value);return value;},get_contacts:function(){return this.$0.get_contacts();},set_contacts:function(value){this.$0.set_contacts(value);return value;},get_networks:function(){return this.$0.get_networks();},set_networks:function(value){this.$0.set_networks(value);return value;},get_userSettingsInfo:function(){return this.$0.get_userSettingsInfo();},set_userSettingsInfo:function(value){this.$0.set_userSettingsInfo(value);return value;},get_configurationInfo:function(){return this.$0.get_configurationInfo();},set_configurationInfo:function(value){this.$0.set_configurationInfo(value);return value;},get_messengerSessionState:function(){return this.$0.get_messengerSessionState();},set_messengerSessionState:function(value){this.$0.set_messengerSessionState(value);return value;},get_messengerSessionEvents:function(){return this.$0.get_messengerSessionEvents();},set_messengerSessionEvents:function(value){this.$0.set_messengerSessionEvents(value);return value;},get_signInResponseInfo:function(){return this.$0.get_signInResponseInfo();},set_signInResponseInfo:function(value){this.$0.set_signInResponseInfo(value);return value;},get_alerts:function(){return this.$0.get_alerts();},set_alerts:function(value){this.$0.set_alerts(value);return value;},get_conversations:function(){return this.$0.get_conversations();},set_conversations:function(value){this.$0.set_conversations(value);return value;},get_applicationInfo:function(){return this.$0.get_applicationInfo();},set_applicationInfo:function(value){this.$0.set_applicationInfo(value);return value;},get_appContactsTicketInfo:function(){return this.$0.get_appContactsTicketInfo();},set_appContactsTicketInfo:function(value){this.$0.set_appContactsTicketInfo(value);return value;},get_appContactsPresenceInfo:function(){return this.$0.get_appContactsPresenceInfo();},set_appContactsPresenceInfo:function(value){this.$0.set_appContactsPresenceInfo(value);return value;},saveConversationMessage:function(conversationId,message){this.$0.saveConversationMessage(conversationId,message);},deletePersistedConversationMessages:function(conversationId){this.$0.deletePersistedConversationMessages(conversationId);},updatePersistedConversationMessageIds:function(oldId,newId){this.$0.updatePersistedConversationMessageIds(oldId,newId);},getConversationPersistedMessages:function(conversationId){return this.$0.getConversationPersistedMessages(conversationId);},clearUserSession:function(){this.$0.clearUserSession();},clearAllPersistedData:function(){this.$0.clearAllPersistedData();},onSignedOut:function(preserveInstance){this.$0.onSignedOut(preserveInstance);},initializeUserStorage:function(userTicket,userId,callback){this.$0.initializeUserStorage(userTicket,userId,callback);},refreshConversationData:function(refreshCallback){this.$0.refreshConversationData(refreshCallback);},$4:function($p0,$p1){if(this.$2!=null){this.$2.invoke($p0,$p1);}},$5:function($p0,$p1){if(this.$1!=null){this.$1.invoke($p0,$p1);}},$6:function($p0,$p1){if(this.$3!=null){this.$3.invoke($p0,$p1);}}}
MSCo.HashHelper=function(){}
MSCo.HashHelper.computeFastHash=function(str,prefix){var $0=5381;for(var $2=0,$3=str.length;$2<$3;$2++){$0=(($0<<5)+$0)+str.charCodeAt($2);}var $1=prefix;if($0<0){$1+='_';$0*=-1;}$1+=$0;return $1;}
MSCo.Configuration=function(){}
MSCo.Configuration.get_webActionMethodContentType=function(){return MSCo.Configuration.$B;}
MSCo.Configuration.get_clientId=function(){return MSCo.Configuration.$1;}
MSCo.Configuration.get_domainName=function(){if(String.isNullOrEmpty(MSCo.Configuration.$2)){MSCo.Configuration.$C();}return MSCo.Configuration.$2;}
MSCo.Configuration.set_domainName=function(value){if(String.isNullOrEmpty(value)){throw new Error('Invalid domain name.');}MSCo.Configuration.$2=MSH.DomainHelper.getReportingDomain(value);return value;}
MSCo.Configuration.get_market=function(){return Microsoft.Live.Core.Loader.get_settings().market;}
MSCo.Configuration.get_authenticateAppVersion=function(){return MSCo.Configuration.$7;}
MSCo.Configuration.get_signInVersion=function(){return MSCo.Configuration.$4;}
MSCo.Configuration.get_signInStatusVersion=function(){return MSCo.Configuration.$5;}
MSCo.Configuration.get_consentStatusVersion=function(){return MSCo.Configuration.$6;}
MSCo.Configuration.get_updateUserSettingsVersion=function(){return MSCo.Configuration.$8;}
MSCo.Configuration.get_getAppContactsInfoVersion=function(){return MSCo.Configuration.$9;}
MSCo.Configuration.get_updateAppTicketVersion=function(){return MSCo.Configuration.$A;}
MSCo.Configuration.get_clientDomain=function(){if(String.isNullOrEmpty(MSCo.Configuration.$2)){return'msmsgs';}return MSCo.Configuration.$2;}
MSCo.Configuration.get_clientVersion=function(){return MSCo.Configuration.$3;}
MSCo.Configuration.set_clientVersion=function(value){MSCo.Configuration.$3=value;return value;}
MSCo.Configuration.get_endpointName=function(){return MSCo.Configuration.$2;}
MSCo.Configuration.get_configurationUrl=function(){return MSCo.Configuration.get_signInServerPath()+'/actions/getmessengerconfiguration';}
MSCo.Configuration.get_silentReauthDetectionUrl=function(){return Microsoft.Live.Core.Loader.get_settings().messenger.silentReauthDetectionUrl;}
MSCo.Configuration.get_silentReauthUrlFormat=function(){return Microsoft.Live.Core.Loader.get_settings().messenger.silentReauthUrlFormat;}
MSCo.Configuration.get_reauthCompletedPageUrl=function(){return Microsoft.Live.Core.Loader.get_settings().messenger.getResourceUrl('ReauthCompleted.html');}
MSCo.Configuration.get_signInHost=function(){return Microsoft.Live.Core.Loader.get_settings().messenger.serviceHostName;}
MSCo.Configuration.get_signInServerPath=function(){return MSCo.HttpRequest.get_defaultScheme()+MSCo.Configuration.get_signInHost();}
MSCo.Configuration.get_webSignInUrl=function(){return MSCo.Configuration.getWebSignInUrl(MSCo.Configuration.get_signInHost());}
MSCo.Configuration.get_signInStatusUrl=function(){return MSCo.Configuration.get_signInServerPath()+'/actions/signinstatus/';}
MSCo.Configuration.get_updateApplicationTicketUrl=function(){return MSCo.Configuration.get_signInServerPath()+'/actions/updateapplicationticket/';}
MSCo.Configuration.get_getApplicationContactsInfoUrl=function(){return MSCo.Configuration.get_signInServerPath()+'/actions/getapplicationcontactsinfo/';}
MSCo.Configuration.get_updateUserSettingsUrl=function(){return MSCo.Configuration.get_signInServerPath()+'/actions/updateusersettings/';}
MSCo.Configuration.get_updateUserProfileUrl=function(){return MSCo.Configuration.get_signInServerPath()+'/actions/updateuserprofile/';}
MSCo.Configuration.get_updateIMAvailabilityService=function(){return MSCo.Configuration.get_signInServerPath()+'/actions/updateimavailabilityservice/';}
MSCo.Configuration.get_getAddressBookUrl=function(){return MSCo.Configuration.get_signInServerPath()+'/actions/getaddressbook/';}
MSCo.Configuration.get_authenticateApplicationUrl=function(){return MSCo.Configuration.get_signInServerPath()+'/actions/authenticateapplication/';}
MSCo.Configuration.getWebSignInUrl=function(hostName){return MSCo.Configuration.getSignInServerPath(hostName)+'/actions/signin/';}
MSCo.Configuration.getSignInServerPath=function(hostName){return MSCo.HttpRequest.get_defaultScheme()+hostName;}
MSCo.Configuration.$C=function(){var $0=window.location.hostname;if(!String.isNullOrEmpty($0)){MSCo.Configuration.set_domainName($0);}}
MSCo.HttpHelper=function(){}
MSCo.HttpHelper.extractScheme=function(url){var $0=url.indexOf('://');if($0!==-1){return MSH.StringHelper.substring(url,0,$0)+'://';}return null;}
MSCo.HttpHelper.extractHost=function(url){var $0=MSCo.HttpHelper.extractScheme(url);if($0!=null){var $1=$0.length;var $2=url.indexOf('/',$1);if($2>=0){return MSH.StringHelper.substringSection(url,$1,$2);}else{return MSH.StringHelper.substringToEnd(url,$1);}}return null;}
MSCo.JsonResponseParser=function(){}
MSCo.JsonResponseParser.parseConfigurationResponse=function(text){try{return MLC.JSON.deserialize(text);}catch($0){return null;}}
MSCo.JsonResponseParser.parseSignInResponse=function(text){try{return MLC.JSON.deserialize(text);}catch($0){return null;}}
MSCo.JsonResponseParser.buildSignInStatusRequest=function(request){return MLC.JSON.serialize(request);}
MSCo.JsonResponseParser.parseSignInStatusResponse=function(text){try{return MLC.JSON.deserialize(text);}catch($0){return null;}}
MSCo.JsonResponseParser.parseGetAddressBookResponse=function(text){try{return MLC.JSON.deserialize(text);}catch($0){return null;}}
MSCo.JsonResponseParser.buildRequest=function(instance){return MLC.JSON.serialize(instance);}
MSCo.JsonResponseParser.parseTicketResponse=function(text){try{return MLC.JSON.deserialize(text);}catch($0){return null;}}
MSCo.JsonResponseParser.parseAppContactsInfoResponse=function(text){try{return MLC.JSON.deserialize(text);}catch($0){return null;}}
MSCo.JsonResponseParser.parseAppAuthResponse=function(text){try{return MLC.JSON.deserialize(text);}catch($0){return null;}}
MSCo.LocalStorageMemoryService=function(){this.$0=MSH.DateTimeHelper.minValue;this.$1=MSH.DateTimeHelper.minValue;this.$4={};}
MSCo.LocalStorageMemoryService.createMessengerSessionInfoFromStorage=function(msState,msEvents){if(msState==null||msEvents==null){return null;}var $0=MC.$create_MessengerSessionInfo(msState.server,msState.sessionToken,msState.transactionID,msEvents.events);$0.services=msState.services;$0.disconnected=msState.disconnected;return $0;}
MSCo.LocalStorageMemoryService.prototype={$2:0,$3:false,$4:null,$5:null,$6:null,$7:null,$8:null,$9:null,$A:null,$B:null,$C:null,$D:null,$E:null,$F:null,$10:null,$11:null,add_dataWritten:function(value){this.$12=ss.Delegate.combine(this.$12,value);},remove_dataWritten:function(value){this.$12=ss.Delegate.remove(this.$12,value);},$12:null,add_dataRead:function(value){this.$13=ss.Delegate.combine(this.$13,value);},remove_dataRead:function(value){this.$13=ss.Delegate.remove(this.$13,value);},$13:null,add_instancesChanged:function(value){this.$14=ss.Delegate.combine(this.$14,value);},remove_instancesChanged:function(value){this.$14=ss.Delegate.remove(this.$14,value);},$14:null,get_usesLocalStorageProxy:function(){return false;},get_lastWriteTime:function(){return this.$1;},get_lastReadTime:function(){return this.$0;},get_revision:function(){return this.$2;},get_currentInstances:function(){return this.$15();},get_signInStatusResponseInfo:function(){this.$17(1,this.$5);return this.$5;},set_signInStatusResponseInfo:function(value){if(value!==this.$5){this.$5=value;this.$16(1,value);}return value;},get_networks:function(){this.$17(4,this.$6);return this.$6;},set_networks:function(value){if(this.$6!==value){this.$6=value;this.$16(4,this.$6);}return value;},get_groups:function(){this.$17(3,this.$7);return this.$7;},set_groups:function(value){if(this.$7!==value){this.$7=value;this.$16(3,this.$7);}return value;},get_contacts:function(){this.$17(2,this.$8);return this.$8;},set_contacts:function(value){if(this.$8!==value){this.$8=value;this.$16(2,this.$8);}return value;},get_userSettingsInfo:function(){this.$17(5,this.$9);return this.$9;},set_userSettingsInfo:function(value){if(this.$9!==value){this.$9=value;this.$16(5,this.$9);}return value;},get_configurationInfo:function(){this.$17(6,this.$A);return this.$A;},set_configurationInfo:function(value){if(this.$A!==value){this.$A=value;this.$16(6,this.$A);}return value;},get_messengerSessionEvents:function(){this.$17(8,this.$C);return this.$C;},set_messengerSessionEvents:function(value){if(value!==this.$C){this.$C=value;this.$16(8,value);}return value;},get_messengerSessionState:function(){this.$17(7,this.$B);return this.$B;},set_messengerSessionState:function(value){if(value!==this.$B){this.$B=value;this.$16(7,value);if(value!=null){this.$3=true;if(this.$14!=null){this.$14.invoke(this,new MC.InstancesChangedEventArgs(this.$15()));}}}return value;},get_signInResponseInfo:function(){var $0=null;var $1=MSCo.LocalStorageMemoryService.createMessengerSessionInfoFromStorage(this.get_messengerSessionState(),this.get_messengerSessionEvents());var $2=this.get_configurationInfo();if($1!=null&&$2!=null){$0=MC.$create_SignInResponse($2,$1,this.get_networks(),this.get_groups(),this.get_contacts(),this.get_userSettingsInfo());}return $0;},set_signInResponseInfo:function(value){if(value!=null){this.set_groups(value.groups);this.set_contacts(value.contacts);this.set_networks(value.networks);this.set_configurationInfo(value.clientConfiguration);this.set_userSettingsInfo(value.settings);var $0=value.messengerSession;$0.services=value.services;this.set_messengerSessionEvents(MC.$create_MessengerSessionEvents($0.pendingEvents));this.set_messengerSessionState(MC.$create_MessengerSessionState($0.server,$0.sessionToken,$0.transactionID,$0.services,$0.disconnected));}else{this.set_groups(null);this.set_contacts(null);this.set_networks(null);this.set_configurationInfo(null);this.set_userSettingsInfo(null);this.set_messengerSessionEvents(null);this.set_messengerSessionState(null);}return value;},get_alerts:function(){this.$17(12,this.$D);return this.$D;},set_alerts:function(value){if(value!==this.$D){this.$D=value;this.$16(12,value);}return value;},get_conversations:function(){this.$17(9,this.$E);return this.$E;},set_conversations:function(value){if(value!==this.$E){this.$E=value;this.$16(9,value);}return value;},get_applicationInfo:function(){this.$17(13,this.$F);return this.$F;},set_applicationInfo:function(value){if(value!==this.$F){this.$F=value;this.$16(13,value);}return value;},get_appContactsTicketInfo:function(){this.$17(14,this.$10);return this.$10;},set_appContactsTicketInfo:function(value){if(value!==this.$10){this.$10=value;this.$16(14,value);}return value;},get_appContactsPresenceInfo:function(){this.$17(15,this.$11);return this.$11;},set_appContactsPresenceInfo:function(value){if(value!==this.$11){this.$11=value;this.$16(15,value);}return value;},saveConversationMessage:function(conversationId,message){if(!Object.keyExists(this.$4,conversationId)){this.$4[conversationId]=[];}var $0=this.$4[conversationId];$0.add(message);this.$16(10,MSH.CollectionHelper.toArray($0));},deletePersistedConversationMessages:function(conversationId){if(Object.keyExists(this.$4,conversationId)){delete this.$4[conversationId];}this.$16(10,null);},updatePersistedConversationMessageIds:function(oldId,newId){var $0=this.$4[oldId];if($0==null){return;}if(!Object.keyExists(this.$4,newId)){this.$4[newId]=[];}var $1=this.$4[newId];var $enum1=ss.IEnumerator.getEnumerator($0);while($enum1.moveNext()){var $2=$enum1.get_current();$1.add($2);}delete this.$4[oldId];this.$16(10,MSH.CollectionHelper.toArray($1));},getConversationPersistedMessages:function(conversationId){var $0;if(!Object.keyExists(this.$4,conversationId)){$0=new Array(0);}else{$0=MSH.CollectionHelper.toArray(this.$4[conversationId]);}this.$17(10,$0);return $0;},clearUserSession:function(){this.set_appContactsTicketInfo(null);this.set_conversations(null);this.set_networks(null);this.set_groups(null);this.set_contacts(null);this.set_userSettingsInfo(null);this.set_configurationInfo(null);this.set_messengerSessionState(null);this.set_messengerSessionEvents(null);this.set_signInStatusResponseInfo(null);Object.clearKeys(this.$4);this.$16(10,new Array(0));},clearAllPersistedData:function(){this.$4={};this.$0=MSH.DateTimeHelper.minValue;this.$1=MSH.DateTimeHelper.minValue;this.$2=0;this.$3=false;this.$5=null;this.$6=null;this.$7=null;this.$8=null;this.$9=null;this.$A=null;this.$B=null;this.$C=null;this.$D=null;this.$E=null;this.$F=null;this.$10=null;this.$11=null;},onSignedOut:function(preserveInstance){this.$3=false;if(this.$14!=null){this.$14.invoke(this,new MC.InstancesChangedEventArgs(this.$15()));}},initializeUserStorage:function(userTicket,userId,callback){if(String.isNullOrEmpty(userId)&&(String.isNullOrEmpty(userTicket)||userTicket==='none')){callback.invoke(false);return;}callback.invoke(true);},refreshConversationData:function(refreshCallback){refreshCallback.invoke();},$15:function(){if(this.$3&&this.$B!=null){switch(this.$B.services){case 3:case 0:return[MC.$create_InstanceInfo('0',true,true)];}}return new Array(0);},$16:function($p0,$p1){if(this.$12!=null){this.$1=Date.get_now();this.$2++;this.$12.invoke(this,new MC.LocalStorageDataReadWriteEventArgs(this.$2,$p0,$p1));}},$17:function($p0,$p1){if(this.$13!=null){this.$0=Date.get_now();this.$13.invoke(this,new MC.LocalStorageDataReadWriteEventArgs(this.$2,$p0,$p1));}}}
MSCo.HttpMethod=function(){};MSCo.HttpMethod.prototype={Get:0,Post:1,Put:2,Delete:3}
MSCo.HttpMethod.registerEnum('MSCo.HttpMethod',false);MSCo.HttpStatusCode=function(){};MSCo.HttpStatusCode.prototype={none:0,aborted:1,OK:200,created:201,accepted:202,noContent:204,movedPermanently:301,found:302,notModified:304,badRequest:400,unauthorized:401,forbidden:403,notFound:404,requestTimeout:408,conflict:409,serverError:500}
MSCo.HttpStatusCode.registerEnum('MSCo.HttpStatusCode',false);MSCo.HttpRequest=function(method,url,postData,headers,onResponse){this.$1=method;this.$2=url;this.$4=this.$15(headers);this.$3=postData||String.Empty;this.$5=onResponse;this.$9=30000;this.$6=MSCo.HttpHelper.extractHost(this.$2);if(String.isNullOrEmpty(this.$6)){this.$6=MSCo.N$4.get_$F();}if(this.$6!==MSCo.N$4.get_$F()){this.$7=true;}this.$C=MSCo.N$4.$10(this.$6);}
MSCo.HttpRequest.get_defaultScheme=function(){return(MSH.TestingHelper.get_isUnitTest())?'http://':MSH.UriHelper.get_windowLocationProtocol()+'//';}
MSCo.HttpRequest.$13=function($p0){if($p0!=null&&typeof($p0.abort)!=='undefined'){try{$p0.abort();}catch($0){}}}
MSCo.HttpRequest.$14=function($p0,$p1){if($p0!=null){try{$p0.onabort=$p1;}catch($0){}}}
MSCo.HttpRequest.$1E=function($p0){switch($p0){case 0:return'GET';case 1:return'POST';case 2:return'PUT';case 3:return'DELETE';default:return null;}}
MSCo.HttpRequest.prototype={$1:0,$2:null,$3:null,$4:null,$5:null,$6:null,$7:false,$8:null,$9:0,$A:null,$B:null,$C:null,$D:null,$E:false,$F:false,$10:false,get_state:function(){return this.$8;},set_state:function(value){this.$8=value;return value;},get_$11:function(){return this.$1;},setTimeout:function(timeout){this.$9=timeout;},execute:function(){if(!this.$E){this.$E=true;this.$C.$15(this);}},abort:function(){this.$F=true;this.$10=true;if(this.$E){MSCo.HttpRequest.$13(this.$A);}},$12:function(){this.$1C();if(this.$7){var $0={};$0['type']=((this.$1===1)?'XMLPost':'XMLGet');$0['verb']=MSCo.HttpRequest.$1E(this.$1);$0['timeout']=null;$0['url']=this.$2;$0['headers']=this.$4;$0['postString']=this.$3;this.$A=this.$C.$17($0,ss.Delegate.create(this,this.$18));MSCo.HttpRequest.$14(this.$A,ss.Delegate.create(this,this.$17));}else{this.$A=new XMLHttpRequest();this.$A.open(MSCo.HttpRequest.$1E(this.$1),this.$2,true);this.$A.onreadystatechange=ss.Delegate.create(this,this.$16);MSCo.HttpRequest.$14(this.$A,ss.Delegate.create(this,this.$17));if(this.$4!=null&&Object.getKeyCount(this.$4)>0){var $dict1=this.$4;for(var $key2 in $dict1){var $1={key:$key2,value:$dict1[$key2]};this.$A.setRequestHeader($1.key,$1.value);}}try{this.$A.send(this.$3);}catch($2){this.$18(this.$A);}}},$15:function($p0){if(MSH.BrowserHelper.get_isWebKit()){delete $p0['Proxy-Connection'];}return $p0;},$16:function(){if(4===this.$A.readyState){this.$18(this.$A);}},$17:function(){this.$10=true;},$18:function($p0){MSH.Scheduler.defer(ss.Delegate.create(this,function(){MSH.PerfCollector.get_instance().increaseEventCounter('HttpRequest-OnComplete',1);var $1_0=Date.get_now();this.$19($p0);var $1_1=MSH.DateTimeHelper.subtract(Date.get_now(),$1_0);MSH.PerfCollector.get_instance().addPerfCounterValue('HttpRequest-ResponseHandlingTime',$1_1);}));},$19:function($p0){this.$1D();var $0=new MSCo.N$5($p0,this.$8,(this.$10)?1:0);MSH.Logger.logHttpRequest(2,MC.LogContext.get_global(),'HttpRequest','Http response received',MC.$create_HttpRequestLogEntryInfo(this.$2,$0.get_statusText(),$0.get_responseText()));if(this.$B!=null){if($0.get_status()===304){$0=new MSCo.N$5(this.$B,this.$8,(this.$10)?1:0);$p0=this.$B;}this.$B=null;}else{if((this.$1===0)&&String.isNullOrEmpty($0.getResponseHeader('Date'))){this.$B=$p0;this.$4['If-Modified-Since']=$0.getResponseHeader('Last-Modified')||MSH.DateTimeHelper.minValue.toUTCString();this.$12();return;}}this.$E=false;this.$A=null;if(this.$10&&!this.$F){this.$C.$16(this,null,$0);}else{this.$C.$16(this,this.$5,$0);}},$1A:function($p0){this.$F=true;MSCo.HttpRequest.$13(this.$A);},$1B:function($p0){if($p0===0&&this.$10){$p0=1;}var $0=new XMLHttpRequest();var $1=new MSCo.N$5($0,this.$8,$p0);this.$5.invoke($1);},$1C:function(){this.$1D();this.$D=new MSH.Timer(ss.Delegate.create(this,this.$1A),null,this.$9,MSH.Timeout.infinite);},$1D:function(){if(this.$D!=null){this.$D.dispose();this.$D=null;}}}
MSCo.N$4=function(domain){this.$5=domain;this.$6=[];this.$7=[];if(this.$5!==MSCo.N$4.get_$F()){MSCo.N$4.$E();var $0=domain.endsWith(document.domain);var $1=domain.indexOf(':');if($1>0){if(domain.substring(0,$1).endsWith(document.domain)){$0=true;}}if($0){this.$8=true;this.$12();}}}
MSCo.N$4.$E=function(){if(MSCo.N$4.$3){return;}var $0=MSCo.N$4.$4;var $1=$0.indexOf(':');if($1>0){$0=$0.substring(0,$1);}if(!$0.endsWith('.com')){throw Error.createError(String.format('Invalid domain: {0}',$0),null);}var $2=$0.indexOf('.');if($2>0){try{document.domain=$0;while($2>=0){$0=$0.substr($2+1);if($0!=='com'){document.domain=$0;$2=$0.indexOf('.');}else{$2=-1;}}}catch($3){}}MSCo.N$4.$3=true;}
MSCo.N$4.get_$F=function(){return MSCo.N$4.$4;}
MSCo.N$4.$10=function($p0){$p0=$p0.toLowerCase();var $0=MSCo.N$4.$2[$p0];if($0==null){$0=new MSCo.N$4($p0);MSCo.N$4.$2[$p0]=$0;window.attachEvent('onbeforeunload',ss.Delegate.create($0,$0.dispose));window.attachEvent('onunload',ss.Delegate.create($0,$0.dispose));}else{$0.$13();}return $0;}
MSCo.N$4.prototype={$5:null,$6:null,$7:null,$8:false,$9:null,$A:false,$B:null,$C:null,$D:false,$11:function($p0){this.$B=$p0;this.$A=false;this.$1A();this.$18();},$12:function(){this.$A=false;this.$9=document.createElement('iframe');this.$9.style.display='none';this.$9.src=String.format('{0}//{1}/xmlProxy.htm?vn={2}&domain={3}',MSH.UriHelper.get_windowLocationProtocol(),this.$5,'9.090515.0',document.domain);this.$C=new MSH.Timer(ss.Delegate.create(this,this.$14),null,30000,MSH.Timeout.infinite);document.body.appendChild(this.$9);},$13:function(){if(this.$8&&this.$A){this.$12();}},$14:function($p0){if(this.$B==null){this.$A=true;document.body.removeChild(this.$9);this.$9=null;this.$19();}this.$1A();},$15:function($p0){this.$6.enqueue($p0);this.$18();},$16:function($p0,$p1,$p2){this.$7.remove($p0);this.$18();if(this.$D){return;}if($p1!=null){$p1.invoke($p2);}},$17:function($p0,$p1){return this.$B.fetchXML($p0,MSCo.N$3,this,$p1);},$18:function(){if(!this.$D){if(!this.$8||this.$B!=null){while(this.$6.length>0&&this.$7.length<4){var $0=this.$6.dequeue();this.$7.add($0);$0.$12();}}else if(this.$A){this.$19();}}},$19:function(){while(this.$6.length>0){var $0=this.$6.dequeue();$0.$1B(404);}},$1A:function(){if(this.$C!=null){this.$C.dispose();this.$C=null;}},dispose:function(){if(!this.$D){this.$D=true;var $enum1=ss.IEnumerator.getEnumerator(this.$7);while($enum1.moveNext()){var $0=$enum1.get_current();$0.abort();}}}}
MSCo.HttpResponse=function(){}
MSCo.HttpResponse.prototype={$0:null,get_responseData:function(){return null;},get_responseXml:function(){if(this.$0==null){this.$0=MSH.XmlHelper.parseXmlDocument(this.get_responseText());}return this.$0;},toString:function(){return this.get_responseText();}}
MSCo.N$3=function(){}
MSCo.N$3.$0=function($p0){var $0=$p0.location.hostname;var $1=MSCo.N$4.$10($0);$1.$11($p0);}
MSCo.N$5=function(request,state,status){MSCo.N$5.initializeBase(this);this.$1=request;this.$2=state;this.$3=status;}
MSCo.N$5.prototype={$1:null,$2:null,$3:0,$4:null,get_state:function(){return this.$2;},get_responseText:function(){try{if(this.$4==null){this.$4=this.$1.responseText;}return this.$4;}catch($0){return String.Empty;}},get_hasContent:function(){return!String.isNullOrEmpty(this.get_responseText());},get_status:function(){try{if(this.$3!==0){return this.$3;}else if(this.$1.readyState===0){return 408;}else if(ss.isUndefined(this.$1.status)){return 0;}else{switch(this.$1.status){case 1223:return 204;case 12002:return 408;case 12007:case 12029:case 12030:case 12031:return 1;case 12152:return 500;default:return this.$1.status;}}}catch($0){return 0;}},get_statusText:function(){try{if(this.$1.readyState===0){return'Request Timeout';}else{switch(this.$1.status){case 1223:return'No Content';default:return this.$1.statusText;}}}catch($0){return String.Empty;}},getResponseHeader:function($p0){try{return this.$1.getResponseHeader($p0);}catch($0){return null;}}}
Type.registerNamespace('Web');Web.N$2=function(){}
MSCo.LocalStorageServiceWrapper.registerClass('MSCo.LocalStorageServiceWrapper',null,MC.ILocalStorageService);MSCo.HashHelper.registerClass('MSCo.HashHelper');MSCo.Configuration.registerClass('MSCo.Configuration');MSCo.HttpHelper.registerClass('MSCo.HttpHelper');MSCo.JsonResponseParser.registerClass('MSCo.JsonResponseParser');MSCo.LocalStorageMemoryService.registerClass('MSCo.LocalStorageMemoryService',null,MC.ILocalStorageService);MSCo.HttpRequest.registerClass('MSCo.HttpRequest',null,MC.IAbortable);MSCo.N$4.registerClass('MSCo.N$4',null,ss.IDisposable);MSCo.HttpResponse.registerClass('MSCo.HttpResponse');MSCo.N$3.registerClass('MSCo.N$3');MSCo.N$5.registerClass('MSCo.N$5',MSCo.HttpResponse);Web.N$2.registerClass('Web.N$2');MSCo.Configuration.$1='msgrlib';MSCo.Configuration.$2=String.Empty;MSCo.Configuration.$3='4.2.0.0';MSCo.Configuration.$4='4.2';MSCo.Configuration.$5='1';MSCo.Configuration.$6='1';MSCo.Configuration.$7='1';MSCo.Configuration.$8='1';MSCo.Configuration.$9='2';MSCo.Configuration.$A='2';MSCo.Configuration.$B='application/json; charset=utf-8';MSCo.N$4.$2={};MSCo.N$4.$3=false;MSCo.N$4.$4=(window.location.host).toLowerCase();(function(){MSCo.N$3.Type={};var $0=MSCo.N$3.Type;$0.XMLPost='XMLPost';Function.emptyFunction=ss.Delegate.Null;MSCo.N$3.oninvoke={};var $1=MSCo.N$3.oninvoke;$1.fire=ss.Delegate.Null;MSCo.N$3.onhttperror={};var $2=MSCo.N$3.onhttperror;$2.fire=ss.Delegate.Null;var $3=window.Web;$3.Network=MSCo.N$3;MSCo.N$3.registerProxy=MSCo.N$3.$0;$3.Browser={};var $4=$3.Browser;$4.isIE=ss.Delegate.Null;})();Type.registerNamespace('MSII');MSII.ISignInControlWindow=function(){};MSII.ISignInControlWindow.registerInterface('MSII.ISignInControlWindow');MSII.ISignInControlWindowEvents=function(){};MSII.ISignInControlWindowEvents.registerInterface('MSII.ISignInControlWindowEvents');MSII.SignInState=function(){};MSII.SignInState.prototype={init:0,missingPrivacyPolicy:1,serviceUnavailable:2,applicationBlocked:3,userBlocked:4,unauthenticated:5,authenticated:6,signingIn:7,signedIn:8}
MSII.SignInState.registerEnum('MSII.SignInState',false);Type.registerNamespace('MSL');MSL.IConsentHandler=function(){};MSL.IConsentHandler.registerInterface('MSL.IConsentHandler');MSL.L$1=function(){};MSL.L$1.prototype={$0:1,$1:2,$2:3,$3:4}
MSL.L$1.registerEnum('MSL.L$1',false);MSL.L$A=function(channel,serviceFactory){this.$0=channel;this.$0.add_messageReceived(ss.Delegate.create(this,this.$2));this.$1=new MSL.L$11(serviceFactory.createApplicationService(this));}
MSL.L$A.prototype={$0:null,$1:null,$2:function($p0,$p1){var $0=$p1.get_command();var $1=$p1.get_parameters();switch($0){case'Authenticate':this.$1.authenticate($1[0],$1[1]);break;case'GetApplicationContactsInfo':this.$1.getApplicationContactsInfo($1[0],$1[1]);break;}},onAuthenticationCompleted:function($p0,$p1){this.$0.sendMessage('OnAuthenticationCompleted',[$p0,$p1]);},onGetApplicationContactsInfoCompleted:function($p0,$p1){this.$0.sendMessage('OnGetApplicationContactsInfoCompleted',[$p0,$p1]);}}
MSL.L$11=function(impl){MSL.L$11.initializeBase(this);this.$12=impl;}
MSL.L$11.prototype={$12:null,authenticate:function($p0,$p1){this.$D($p0);this.$D($p1);this.$12.authenticate($p0,$p1);},getApplicationContactsInfo:function($p0,$p1){this.$A($p0);this.$F($p1);this.$12.getApplicationContactsInfo($p0,$p1);}}
MSL.L$B=function(callback){this.$1=[0,8,7,5];this.$0=callback;}
MSL.L$B.prototype={$0:null,$2:function($p0){var $0=this.$5($p0);Microsoft.Live.Core.Loader.load($0,ss.Delegate.create(this,function(){this.$3($p0);}));},$3:function($p0){if(this.$4($p0)){var $enum1=ss.IEnumerator.getEnumerator(this.$1);while($enum1.moveNext()){var $0=$enum1.get_current();this.$0.invoke($0);}}else{this.$0.invoke($p0);}},$4:function($p0){return this.$1.contains($p0);},$5:function($p0){var $0='';if(this.$4($p0)){$p0=0;}switch($p0){case 9:return'Messenger.PubSub.Service';case 1:$0='AddressBook';break;case 4:$0='Chat';break;case 6:$0='Configuration';break;case 0:$0='Core';break;case 2:$0='ExpressionProfile';break;case 3:$0='Identity';break;default:throw new Error('Unexpected service');}return'Messenger.Services.'+$0;}}
MSL.L$9=function(localStorageService){this.$3=localStorageService;this.$0=new MSL.L$B(ss.Delegate.create(this,this.$8));this.$1=new Array(10);this.$2=MC.$create_IdentityInfo(null,null);}
MSL.L$9.prototype={$0:null,$1:null,$2:null,$3:null,$4:null,$5:null,$6:function(){window.consentHandler=this;},$7:function($p0){this.$0.$2($p0);},$8:function($p0){var $0=this.$1[$p0];if($0!=null){$0.$C();}},$9:function($p0){var $0=$p0[0];var $1=$p0[1];var $2=$p0[2];new MSL.L$C(this.$3,this.$2,$0,$1,$2,this.$1[3],ss.Delegate.create(this,this.$A)).$A();},$A:function($p0,$p1,$p2,$p3){if($p0===0){var $0=this.$1[0];var $1=$0;$1.resumeSignedInSession($p0,$p1,$p2,$p3);}else{this.$4.onSignedIn($p0,null,null,null,'failure',$p1.serverName,$p3);}},$B:function($p0){var $0=$p0[0];var $1=$p0[1];var $2=$p0[2];new MSL.L$E(this.$3,$0.authenticationInfo,$1,$2,this.$1[3],ss.Delegate.create(this,this.$C)).$8();},$C:function($p0,$p1){if($p1!=null&&$p1.identity!=null){this.$D($p1.identity);}this.$4.onInitializeSignInStatusCompleted($p0,$p1);},$D:function($p0){this.$2.liveId=$p0.liveId;this.$2.authenticationInfo=$p0.authenticationInfo;this.$2.cid=$p0.cid;if(String.isNullOrEmpty(this.$2.endpointId)){this.$2.endpointId=$p0.endpointId;}this.$2.appId=$p0.appId;},$E:function($p0){},onGetConsentStatusCompleted:function($p0,$p1){var $0=MC.$create_ConsentStatusResponse(false,String.Empty);$0.isConsented=$p1.isConsented;$0.consentToken=$p1.consentToken;MSH.Scheduler.defer(ss.Delegate.create(this,function(){this.$4.onGetConsentStatusCompleted($p0,$0);}));},createUserService:function($p0){this.$4=$p0;var $0=new MSL.L$D(0,[this.$2,this,this.$4,this.$3,this.$10()],this);$0.$8('signIn',ss.Delegate.create(this,this.$9));$0.$8('initializeSignInStatus',ss.Delegate.create(this,this.$B));$0.$8('updateTicket',ss.Delegate.create(this,this.$F));$0.$8('getConsentStatus',ss.Delegate.create(this,this.$E));this.$1[0]=$0;this.$5=$0;return this.$5;},createApplicationService:function($p0){var $0=new MSL.L$D(8,[$p0,this.$3],this);this.$1[8]=$0;return $0;},createConnectionService:function($p0,$p1){var $0=new MSL.L$D(5,[$p0,$p1],this);$0.$7(['set_logger']);this.$1[5]=$0;return $0;},createAddressBook:function($p0){var $0=new MSL.L$D(1,[$p0],this);$0.$7(['updateConfiguration','add_changed','add_authenticationFailed','set_logger']);this.$1[1]=$0;return $0;},createExpressionProfile:function($p0){var $0=new MSL.L$D(2,[$p0,null],this);$0.$7(['updateConfiguration','add_authenticationFailed','set_logger']);this.$1[2]=$0;return $0;},createConversationService:function($p0,$p1,$p2,$p3){var $0=new MSL.L$D(4,[$p0,$p1,$p2,$p3],this);$0.$7(['close','set_logger']);this.$1[4]=$0;return $0;},createConfigurationService:function(){var $0=new MSL.L$D(6,[this.$2,MSCo.Configuration.get_configurationUrl()],this);$0.$7(['add_changed']);this.$1[6]=$0;return $0;},$F:function($p0){var $0=$p0[0];this.$2.liveId=$0.liveId;this.$2.authenticationInfo=$0.authenticationInfo;this.$2.cid=$0.cid;this.$2.endpointId=$0.endpointId;this.$2.appId=$0.appId;this.$5.onTicketUpdated();},$10:function(){var $0=new MSL.L$D(3,[],this);$0.$7(['updateConfiguration']);this.$1[3]=$0;return $0;}}
MSL.L$7=function(channel){this.$0=channel;this.$0.add_messageReceived(ss.Delegate.create(this,this.$1));}
MSL.L$7.prototype={$0:null,$1:function($p0,$p1){var $0=$p1.get_command();var $1=$p1.get_parameters();switch($0){case'CollectLogs':var $2=MSH.LogCollector.get_instance().getLocalLogEntries();this.$0.sendMessage('CollectLogsResponse',[$2]);break;case'PerfCollectorOutputToConsole':MSH.PerfCollector.get_instance().reportToConsole();return;case'PerfCollectorEnable':MSH.PerfCollector.get_instance().set_enabled(true);return;case'PerfCollectorDisable':MSH.PerfCollector.get_instance().set_enabled(false);return;}}}
MSL.L$8=function(){this.$0=new RegExp('^\\{[a-f\\d]{8}\\-([a-f\\d]{4}\\-){3}[a-f\\d]{12}\\}$','i');}
MSL.L$8.prototype={$0:null,$1:function(){throw new Error('Invalid parameter');},$2:function($p0){if(ss.isNullOrUndefined($p0)){this.$1();}},$3:function($p0){if(!ss.isNullOrUndefined($p0)){this.$9($p0);for(var $0=0;$0<$p0.length;$0++){this.$D($p0[$0].key);this.$E($p0[$0].value);}}},$4:function($p0){this.$2($p0);this.$C($p0.privacyOptions);this.$7($p0.isMpopDisabledChanged);this.$7($p0.isMpopDisabled);this.$7($p0.isIdentityUnverifiedChanged);this.$7($p0.isIdentityUnverified);this.$7($p0.hasInboxChanged);this.$7($p0.hasInbox);},$5:function($p0){this.$2($p0);this.$6($p0.autoSignInEnabled);this.$7($p0.audioEnabled);this.$7($p0.firstRunExperienceViewed);},$6:function($p0){switch($p0){case 0:case 1:case 2:return;default:this.$1();return;}},$7:function($p0){this.$2($p0);if(($p0!==true)&&($p0!==false)){this.$1();}},$8:function($p0){this.$D($p0);if($p0.match(this.$0)==null){this.$1();}},$9:function($p0){this.$2($p0);if(!Array.isInstanceOfType($p0)){this.$1();}},$A:function($p0){this.$9($p0);for(var $0=0;$0<$p0.length;$0++){this.$D($p0[$0]);}},$B:function($p0){this.$9($p0);for(var $0=0;$0<$p0.length;$0++){this.$C($p0[$0]);}},$C:function($p0){this.$2($p0);if(isNaN($p0)||!isFinite($p0)){this.$1();}},$D:function($p0){this.$2($p0);if(Type.getInstanceType($p0)!==String){this.$1();}if(String.isNullOrEmpty($p0)){this.$1();}},$E:function($p0){if(!ss.isNullOrUndefined($p0)){if(Type.getInstanceType($p0)!==String){this.$1();}}},$F:function($p0){if(!ss.isNullOrUndefined($p0)){if(Type.getInstanceType($p0.ticket)!==String){this.$1();}if(Type.getInstanceType($p0.signature)!==String){this.$1();}}},$10:function($p0){this.$2($p0);if($p0.ticket!=null){this.$F($p0.ticket);}if($p0.userState!=null){this.$1();}var $enum1=ss.IEnumerator.getEnumerator($p0.cids);while($enum1.moveNext()){var $0=$enum1.get_current();this.$D($0);}},$11:function($p0){this.$2($p0);if(Type.getInstanceType($p0)!==String){this.$1();}}}
MSL.L$D=function(serviceType,args,serviceFactory){this.$0=serviceType;this.$4=[];this.$1=args;this.$6=serviceFactory;this.$3={};this.$2=[];var $0=MSL.L$D.$D(this.$0);var $1=Type.getType($0);var $2=this;var $dict1=$1.prototype;for(var $key2 in $dict1){var $3={key:$key2,value:$dict1[$key2]};if(String.equals($3.key,'constructor',false)){continue;}if(Object.keyExists($2,$3.key)){throw new Error(String.format('The service method \'{0}\' in class \'{1}\' conflicts with a member in the ServiceProxy class',$3.key,$0));}$2[$3.key]=this.$B($3.key);}}
MSL.L$D.$D=function($p0){switch($p0){case 0:return'MSL.UserServiceProxyDef';case 5:return'MSL.ConnectionServiceProxyDef';case 7:return'MSL.LocalStorageProxyDef';case 1:return'MSL.AddressBookProxyDef';case 2:return'MSL.ExpressionProfileProxyDef';case 3:return'MSL.IdentityServiceProxyDef';case 4:return'MSL.ConversationServiceProxyDef';case 6:return'MSL.ConfigurationServiceProxyDef';case 8:return'MSL.ApplicationServiceProxyDef';default:throw new Error('Invalid service type!');}}
MSL.L$D.$E=function($p0){var $0=null;switch($p0){case 0:$0='MSCr.UserService';break;case 5:$0='MSP.ConnectionService';break;case 7:$0='MSLS.LocalStorageService';break;case 1:$0='MSA.AddressBookService';break;case 2:$0='MSE.ExpressionProfileService';break;case 3:$0='MSI.IdentityService';break;case 4:$0='MSCh.PersistencedConversationService';break;case 6:$0='MSCf.ConfigurationService';break;case 8:$0='MSCr.ApplicationService';break;default:throw new Error('Invalid service type!');}return Type.getType($0);}
MSL.L$D.$F=function($p0,$p1,$p2){var $0=$p0[$p1];return $0.apply($p0,$p2);}
MSL.L$D.$10=function($p0,$p1){switch($p1.length){case 0:return new $p0();case 1:return new $p0($p1[0]);case 2:return new $p0($p1[0],$p1[1]);case 3:return new $p0($p1[0],$p1[1],$p1[2]);case 4:return new $p0($p1[0],$p1[1],$p1[2],$p1[3]);case 5:return new $p0($p1[0],$p1[1],$p1[2],$p1[3],$p1[4]);case 6:return new $p0($p1[0],$p1[1],$p1[2],$p1[3],$p1[4],$p1[5]);case 7:return new $p0($p1[0],$p1[1],$p1[2],$p1[3],$p1[4],$p1[5],$p1[6]);case 8:return new $p0($p1[0],$p1[1],$p1[2],$p1[3],$p1[4],$p1[5],$p1[6],$p1[7]);case 9:return new $p0($p1[0],$p1[1],$p1[2],$p1[3],$p1[4],$p1[5],$p1[6],$p1[7],$p1[8]);case 10:return new $p0($p1[0],$p1[1],$p1[2],$p1[3],$p1[4],$p1[5],$p1[6],$p1[7],$p1[8],$p1[9]);default:throw new Error('Number of arguments exceeds maximum for CreateInstance.');}}
MSL.L$D.prototype={$0:0,$1:null,$2:null,$3:null,$4:null,$5:null,$6:null,$7:function($p0){this.$2=$p0;},$8:function($p0,$p1){this.$3[$p0]=$p1;},$9:function($p0){if(Object.keyExists(this.$3,$p0)){delete this.$3[$p0];}},$A:function($p0){if(Object.keyExists(this.$3,$p0)){return this.$3[$p0];}else{return null;}},$B:function($p0){return ss.Delegate.create(this,function(){var $1_0=null;var $1_1=new Array(arguments.length);for(var $1_3=0;$1_3<$1_1.length;$1_3++){$1_1[$1_3]=arguments[$1_3];}var $1_2=this.$A($p0);if($1_2!=null){$1_2.invoke($1_1);return $1_0;}if(this.$5==null){this.$4.enqueue([$p0,$1_1]);if(!this.$2.contains($p0)){this.$6.$7(this.$0);}}else{$1_0=MSL.L$D.$F(this.$5,$p0,$1_1);}return $1_0;});},$C:function(){if(this.$5==null){var $0=MSL.L$D.$E(this.$0);this.$5=MSL.L$D.$10($0,this.$1);}while(this.$4.length>0){var $1=this.$4.dequeue();MSL.L$D.$F(this.$5,$1[0],$1[1]);}}}
MSL.L$E=function(localStorageService,authInfo,prefetchedStatus,initializationOptions,identityService,callback){this.$4=MC.$create_SignInStatusRequest(MSCo.Configuration.get_signInStatusVersion(),authInfo,MSCo.Configuration.get_domainName(),MSCo.Configuration.get_clientVersion(),MSCo.Configuration.get_market());this.$1=initializationOptions;this.$6=localStorageService;this.$2=identityService;this.$3=callback;this.$5=prefetchedStatus;}
MSL.L$E.$14=function($p0){if(String.isNullOrEmpty($p0)){return String.Empty;}var $0=$p0.split(';');if(($0==null)||($0.length===0)){return String.Empty;}var $1=$0.length;for(var $2=0;$2<$1;$2++){if(String.isNullOrEmpty($0[$2])){continue;}var $3=$0[$2].trim();if($3.startsWith('ANON=')){var $4=$3.substr('ANON='.length).split('&');if(($4==null)||($4.length===0)){continue;}for(var $5=0;$5<$4.length;$5++){var $6=$4[$5].split('=');if(($6==null)||($6.length!==2)){continue;}if($6[0].trim()==='A'){return $6[1];}}}}return String.Empty;}
MSL.L$E.prototype={$1:null,$2:null,$3:null,$4:null,$5:null,$6:null,$7:false,$8:function(){var $0=true;if(this.$1!=null){if(this.$1.clearStorageBeforeUse){this.$6.clearAllPersistedData();}if(this.$1.disableLocalStorage){(this.$6).swapServices(new MSCo.LocalStorageMemoryService());}$0=this.$1.allowLocalSignIn;}if(!$0||!this.$A()){this.$D();}},$9:function(){if(this.$6!=null){this.$6.clearUserSession();}},$A:function(){if(this.$6==null){return false;}var $0=this.$4.authInfo.ticket;if(String.isNullOrEmpty($0)){$0=MSL.L$E.$14(document.cookie);if(String.isNullOrEmpty($0)){return false;}}this.$6.initializeUserStorage($0,null,ss.Delegate.create(this,this.$B));return true;},$B:function($p0){if(!$p0){this.$D();return;}var $0=Date.get_now().getTime()-this.$6.get_lastWriteTime().getTime();if($0>MSL.L$E.$0){this.$D();return;}if(this.$C(this.$4,this.$6.get_signInStatusResponseInfo())){this.$D();return;}this.$5=this.$6.get_signInStatusResponseInfo();var $1=this.$6.get_messengerSessionState();if($1!=null){this.$5.signInStatus.isServicesKnown=true;this.$5.signInStatus.services=$1.services;}this.$5.signInStatus.isManualSignIn=false;this.$5.signInStatus.isAutoSignIn=true;this.$5.reloaded=true;this.$13(0,this.$5);},$C:function($p0,$p1){if($p0==null||$p0.authInfo==null){return false;}if($p1==null||$p1.identity==null||$p1.identity.authenticationInfo==null||$p0.authInfo.ticket!==$p1.identity.authenticationInfo.ticket){return true;}return false;},$D:function(){this.$9();if(this.$5!=null){this.$11();return;}this.$E();},$E:function(){var $0=MLC.JSON.serialize(this.$4);var $1={};$1['Content-Type']=MSCo.Configuration.get_webActionMethodContentType();var $2=new MSCo.HttpRequest(1,MSCo.Configuration.get_signInStatusUrl(),$0,$1,ss.Delegate.create(this,this.$F));$2.execute();},$F:function($p0){var $0=$p0.getResponseHeader('X-MSNSERVER');if($p0.get_status()===200){this.$5=MSCo.JsonResponseParser.parseSignInStatusResponse($p0.get_responseText());this.$5.serverName=$0;if(!this.$5.signInStatus.isAuthenticated&&this.$4.authInfo.authType===1&&!this.$7){this.$7=true;this.$2.reauthenticate(ss.Delegate.create(this,this.$10));}else{this.$11();}}else{this.$9();this.$5=MC.$create_SignInStatusResponse(null,null);this.$5.serverName=$0;this.$13(1,this.$5);}},$10:function($p0){if($p0===0){this.$4.authInfo.ticket=null;this.$E();}else{this.$11();}},$11:function(){if(this.$6!=null){var $0=this.$4.authInfo.ticket;if(String.isNullOrEmpty($0)){$0=MSL.L$E.$14(document.cookie);}this.$6.initializeUserStorage($0,this.$5.identity.liveId,ss.Delegate.create(this,this.$12));}else{this.$12(true);}},$12:function($p0){if(this.$5!=null){if(this.$5.identity!=null){this.$5.identity.authenticationInfo=this.$4.authInfo;}if(this.$6!=null&&$p0){if(this.$5.signInStatus.isAuthenticated){this.$6.set_signInStatusResponseInfo(this.$5);var $0=this.$6.get_messengerSessionState();if($0!=null){this.$5.signInStatus.isServicesKnown=true;this.$5.signInStatus.services=$0.services;}}else{this.$6.set_signInStatusResponseInfo(null);this.$6.set_appContactsTicketInfo(null);}}}this.$13(0,this.$5);},$13:function($p0,$p1){if(this.$3!=null){this.$3.invoke($p0,$p1);}}}
MSL.L$C=function(localStorageService,identity,serviceData,services,userState,identityService,callback){var $0=new MC.ServiceDataSet(serviceData);var $1=$0.pdServiceData.getEndpointData(identity.endpointId);var $2=$0.imServiceData;this.$3=MC.$create_SignInRequest(MSCo.Configuration.get_signInVersion(),MC.Compatibility.get_version(),MSCo.Configuration.get_domainName(),identity.endpointId,$1.get_name(),identity.experienceId,$2.get_status(),services,$1.get_clientType(),MSCo.Configuration.get_clientVersion(),identity.authenticationInfo,Microsoft.Live.Core.Loader.get_settings().market);this.$6=localStorageService;this.$7=identity;this.$5=userState;this.$1=identityService;this.$2=callback;}
MSL.L$C.prototype={$1:null,$2:null,$3:null,$4:null,$5:null,$6:null,$7:null,$8:null,$9:false,$A:function(){this.$B();},$B:function(){if(!this.$C()){this.$D();}},$C:function(){var $0=Date.get_now().getTime()-this.$6.get_lastWriteTime().getTime();if($0<MSL.L$C.$0){this.$4=this.$6.get_signInResponseInfo();if(this.$4!=null&&!this.$4.messengerSession.disconnected){this.$11();return true;}}this.$6.set_signInResponseInfo(null);return false;},$D:function(){var $0=MLC.JSON.serialize(this.$3);var $1={};$1['Content-Type']=MSCo.Configuration.get_webActionMethodContentType();var $2=this.$6.get_signInStatusResponseInfo().hostName;var $3;if(!String.isNullOrEmpty($2)&&!MSH.UriHelper.get_isSecureContext()){$3=MSCo.Configuration.getWebSignInUrl($2);}else{$3=MSCo.Configuration.get_webSignInUrl();}var $4=new MSCo.HttpRequest(1,$3,$0,$1,ss.Delegate.create(this,this.$E));$4.execute();},$E:function($p0){var $0=$p0.getResponseHeader('X-MSNSERVER');if($p0.get_status()===200){this.$4=MSCo.JsonResponseParser.parseSignInResponse($p0.get_responseText());if(this.$4!=null){this.$4.serverName=$0;this.$6.set_signInResponseInfo(this.$4);this.$11();return;}}var $1;switch($p0.get_status()){case 401:if(this.$3.authInfo.authType===1&&!this.$9){this.$9=true;this.$8=$p0;this.$1.reauthenticate(ss.Delegate.create(this,this.$F));return;}$1=3;break;default:$1=1;break;}this.$10($p0);this.$4=MC.$create_SignInResponse(null,null,null,null,null,null);this.$4.serverName=$0;this.$2.invoke($1,this.$4,this.$3.services,this.$5);},$F:function($p0){if($p0===0){this.$3.authInfo.ticket=null;this.$D();}else{this.$E(this.$8);}},$10:function($p0){if(this.$6!=null){this.$6.set_signInResponseInfo(null);if($p0.get_status()===401){this.$6.set_signInStatusResponseInfo(null);this.$6.set_appContactsTicketInfo(null);}}},$11:function(){this.$2.invoke(0,this.$4,this.$3.services,this.$5);}}
MSL.AddressBookProxyDef=function(){}
MSL.AddressBookProxyDef.prototype={add_changed:function(value){},remove_changed:function(value){},add_authenticationFailed:function(value){},remove_authenticationFailed:function(value){},get_logContext:function(){return null;},set_logContext:function(value){return value;},getAddressBook:function(callback){},updateContactNickname:function(contact,callback){},retrieveUnknownContact:function(callback){},createContact:function(contact,callback){},retrieveContact:function(contactId,callback){},updateContact:function(contact,addedLists,callback){},deleteContact:function(contact,callback){},createIMAddress:function(contact,address,callback){},retrieveIMAddress:function(contactId,addressId,callback){},deleteIMAddress:function(contact,address,callback){},updateIMAvailability:function(contacts,code,networkSourceId,callback){},createTag:function(group,callback){},retrieveTag:function(groupId,callback){},updateTag:function(group,callback){},deleteTag:function(group,callback){},createContactID:function(group,contact,callback){},deleteContactID:function(group,contact,callback){},updateConfiguration:function(configuration){},updateSettings:function(settings,callback){}}
MSL.ApplicationServiceProxyDef=function(){}
MSL.ApplicationServiceProxyDef.prototype={authenticate:function(appId,appVerifier){},getApplicationContactsInfo:function(cids,contactTicket){}}
MSL.ConfigurationServiceProxyDef=function(){}
MSL.ConfigurationServiceProxyDef.prototype={get_current:function(){return null;},add_changed:function(value){},remove_changed:function(value){},loadConfiguration:function(){},updateConfiguration:function(configuration){}}
MSL.ConnectionServiceProxyDef=function(){}
MSL.ConnectionServiceProxyDef.prototype={authenticate:function(clientId,hostName,services,transferState,onCompleted){},resumeSession:function(sessionInfo){},publishNetworks:function(networks,operation,services,onCompleted){},updateNetworks:function(networkIds,operation,onCompleted){},getSession:function(){return null;},signIn:function(networkOperation,networks,contacts,serviceData,settings,services,onCompleted){},signOut:function(userServiceData,locations,endpointIds,initiatedRemotely,onCompleted){},deleteServiceData:function(userServiceData,onCompleted){},setApplicationContacts:function(contactData,signature,onCompleted){},updateAppContactsRoleLists:function(addedAppContactIds,roles,services,onCompleted){},publishServiceData:function(serviceData,services,onCompleted){},updateAddresses:function(addresses,addedLists,removedLists,services,onCompleted){},updateUserAddress:function(address,addedLists,removedLists,services,onCompleted){},publishRoleLists:function(addresses,services,onCompleted){},sendDatagram:function(message,onCompleted){},updateConfiguration:function(configuration){},notifyAddressBookChanged:function(){},setTransferServer:function(server,transferState,cache){},get_logContext:function(){return null;},set_logContext:function(value){return value;},get_isSignedIn:function(){return false;},get_serverName:function(){return null;}}
MSL.ConversationServiceProxyDef=function(){}
MSL.ConversationServiceProxyDef.prototype={conversationCreate:function(id,address){},conversationSendMessage:function(id,message,userState){},conversationInviteAddress:function(id,address,userState){},conversationClose:function(id,userInitiated){},conversationExpose:function(id,roster){},conversationUpdateId:function(oldId,newId){},conversationUpdateHasUnreadMessages:function(id,hasUnreadMessages){},sendDatagram:function(message,callback,userState){},onDatagramReceived:function(message){},close:function(closeConversations){},get_logContext:function(){return null;},set_logContext:function(value){return value;},onPersistedConversationsLoaded:function(persistedConversations){}}
MSL.ExpressionProfileProxyDef=function(){}
MSL.ExpressionProfileProxyDef.prototype={add_authenticationFailed:function(value){},remove_authenticationFailed:function(value){},synchronize:function(serviceData,onCompleted){},update:function(serviceData,onCompleted){},updateConfiguration:function(configuration){},get_logContext:function(){return null;},set_logContext:function(value){return value;}}
MSL.IdentityServiceProxyDef=function(){}
MSL.IdentityServiceProxyDef.prototype={reauthenticate:function(onCompleted){},updateConfiguration:function(configuration){}}
MSL.LocalStorageProxyDef=function(){}
MSL.LocalStorageProxyDef.prototype={get_usesLocalStorageProxy:function(){return false;},get_lastWriteTime:function(){return Date.get_now();},get_lastReadTime:function(){return Date.get_now();},get_revision:function(){return 0;},get_signInStatusResponseInfo:function(){return null;},set_signInStatusResponseInfo:function(value){return value;},get_applicationInfo:function(){return null;},set_applicationInfo:function(value){return value;},get_appContactsTicketInfo:function(){return null;},set_appContactsTicketInfo:function(value){return value;},get_currentInstances:function(){return null;},get_networks:function(){return null;},set_networks:function(value){return value;},get_groups:function(){return null;},set_groups:function(value){return value;},get_contacts:function(){return null;},set_contacts:function(value){return value;},get_userSettingsInfo:function(){return null;},set_userSettingsInfo:function(value){return value;},get_configurationInfo:function(){return null;},set_configurationInfo:function(value){return value;},get_messengerSessionState:function(){return null;},set_messengerSessionState:function(value){return value;},get_messengerSessionEvents:function(){return null;},set_messengerSessionEvents:function(value){return value;},get_signInResponseInfo:function(){if(this.$1!=null){this.$1.invoke(null,null);}return null;},set_signInResponseInfo:function(value){if(this.$0!=null){this.$0.invoke(null,null);}if(this.$2!=null){this.$2.invoke(null,null);}return value;},get_conversations:function(){return null;},set_conversations:function(value){return value;},get_alerts:function(){return null;},set_alerts:function(value){return value;},saveConversationMessage:function(conversationId,message){},deletePersistedConversationMessages:function(conversationId){},updatePersistedConversationMessageIds:function(oldId,newId){},clearUserSession:function(){},clearAllPersistedData:function(){},onSignedOut:function(preserveInstance){},initializeUserStorage:function(userTicket,userId,callback){},refreshConversationData:function(refreshCallback){},getConversationPersistedMessages:function(conversationId){return null;},add_dataWritten:function(value){this.$0=ss.Delegate.combine(this.$0,value);},remove_dataWritten:function(value){this.$0=ss.Delegate.remove(this.$0,value);},$0:null,add_dataRead:function(value){this.$1=ss.Delegate.combine(this.$1,value);},remove_dataRead:function(value){this.$1=ss.Delegate.remove(this.$1,value);},$1:null,add_instancesChanged:function(value){this.$2=ss.Delegate.combine(this.$2,value);},remove_instancesChanged:function(value){this.$2=ss.Delegate.remove(this.$2,value);},$2:null,get_appContactsPresenceInfo:function(){return null;},set_appContactsPresenceInfo:function(value){return value;}}
MSL.UserServiceProxyDef=function(){}
MSL.UserServiceProxyDef.prototype={getConsentStatus:function(appVerifierToken){},initializeSignInStatus:function(identity,prefetchedStatus,initializationOptions){},updateApplicationContacts:function(operation,contactsTicket){},getApplicationContactsInfo:function(cids,contactsTicket){},addAddress:function(address,inviteMessage,userState){},updateNetwork:function(networkId,operation){},updateAppContactsRoleLists:function(addedAppContactIds,roles,userState){},updateContact:function(contact,addedLists,removedLists,userState){},updateContactNickname:function(contact,userState){},updateIMAvailability:function(contacts,operationCode,networkSourceId,userState){},addAddressToContact:function(address,contact,userState){},removeAddressFromContact:function(address,contact,userState){},addGroup:function(group,userState){},renameGroup:function(group,userState){},removeGroup:function(group,userState){},addContactToGroup:function(contact,group,userState){},removeContactFromGroup:function(contact,group,userState){},signIn:function(serviceData,services,userState){},reconnect:function(serviceData,services,userState){},signOut:function(locations,endpointIds,userInitiated,userState){},updateSettings:function(settings,userState){},updateUXSettings:function(settings){},updateServiceData:function(serviceData,userState){},sendDatagram:function(message,callback,userState){},conversationCreate:function(id,address){},conversationSendMessage:function(id,message,userState){},conversationInviteAddress:function(id,address,userState){},conversationClose:function(id){},conversationUpdateHasUnreadMessages:function(id,hasUnreadMessages){},conversationExpose:function(id,roster){},conversationUpdateId:function(oldId,newId){},resumeSignedInSession:function(result,response,requestedServices,userState){},onSignInPopulateCompleted:function(){},updateTicket:function(identityInfo){},onTicketUpdated:function(){},onPersistedConversationsLoaded:function(persistedConversations){},updateServices:function(services,userInitiated){}}
MSL.L$5=function(channel,serviceFactory){this.$4=ss.Delegate.create(this,this.$11);this.$1=channel;this.$1.add_messageReceived(this.$4);this.$6=serviceFactory;this.$3=new MSL.L$10(this.$6.createUserService(this));}
MSL.L$5.prototype={$1:null,$2:null,$3:null,$4:null,$5:false,$6:null,add_$7:function($p0){this.$8=ss.Delegate.combine(this.$8,$p0);},remove_$7:function($p0){this.$8=ss.Delegate.remove(this.$8,$p0);},$8:null,add_$9:function($p0){this.$A=ss.Delegate.combine(this.$A,$p0);},remove_$9:function($p0){this.$A=ss.Delegate.remove(this.$A,$p0);},$A:null,get_$B:function(){return this.$2;},set_$B:function($p0){this.$2=$p0;return $p0;},$C:function($p0){if(this.$5){return;}this.onSignedOutRemotely($p0,-1);this.$3.signOut(1,null,true,'UserSignOut');},$D:function($p0,$p1,$p2){if(this.$5){return;}this.$3.initializeSignInStatus($p0,$p1,$p2);},$E:function($p0,$p1){if(this.$5){return;}if($p0===0){this.$3.updateTicket($p1.identity);}this.$1.sendMessage('OnInitializeSignInStatusCompleted',[$p0,$p1]);},$F:function(){if(this.$8!=null){this.$8.invoke(this,ss.EventArgs.Empty);}},$10:function(){if(this.$A!=null){this.$A.invoke(this,ss.EventArgs.Empty);}},onAlertNotificationReceived:function($p0){this.$1.sendMessage('OnAlertNotificationReceived',[$p0]);},onUpdateNetworkCompleted:function($p0,$p1,$p2){this.$1.sendMessage('OnUpdateNetworkCompleted',[$p0,$p1,$p2]);},onNetworksChanged:function($p0){this.$1.sendMessage('OnNetworksChanged',[$p0]);},onNetworkStatusChanged:function($p0,$p1){this.$1.sendMessage('OnNetworkStatusChanged',[$p0,$p1]);},onGetApplicationContactsInfoCompleted:function($p0,$p1){this.$1.sendMessage('OnGetApplicationContactsInfoCompleted',[$p0,$p1]);},onGetConsentStatusCompleted:function($p0,$p1){this.$1.sendMessage('OnGetConsentStatusCompleted',[$p0,$p1]);},onInitializeSignInStatusCompleted:function($p0,$p1){if(this.$2!=null){this.$2.$5($p0,$p1);}else{this.$E($p0,$p1);}},onSignedIn:function($p0,$p1,$p2,$p3,$p4,$p5,$p6){this.$1.sendMessage('OnSignedIn',[$p0,$p1,$p2,$p3,$p4,$p5,$p6]);if($p0===0){this.$F();}else{this.$10();}},onPersistedConversationsLoaded:function($p0,$p1,$p2){this.$1.sendMessage('OnPersistedConversationsLoaded',[$p0,$p1,$p2]);},onNotifyWebSignInPendingEventsCompleted:function(){this.$1.sendMessage('OnNotifyWebSignInPendingEventsCompleted',new Array(0));},onSignedOut:function($p0,$p1,$p2){if('UserSignOut'!==$p2){this.$1.sendMessage('OnSignedOut',[$p0,$p1,$p2]);}switch($p1){case 3:case 1:this.$10();break;}},onInstancesChanged:function($p0){this.$1.sendMessage('OnInstancesChanged',[$p0]);},onTicketExpired:function(){this.$1.sendMessage('OnTicketExpired',[]);},onUpdateApplicationContactsCompleted:function($p0,$p1,$p2){this.$1.sendMessage('OnUpdateApplicationContactsCompleted',[$p0,$p1,$p2]);},onAppContactsRoleListsUpdated:function($p0,$p1){this.$1.sendMessage('OnAppContactsRoleListsUpdated',[$p0,$p1]);},onAddressAdded:function($p0,$p1,$p2){this.$1.sendMessage('OnAddressAdded',[$p0,$p1,$p2]);},onGroupAdded:function($p0,$p1,$p2){this.$1.sendMessage('OnGroupAdded',[$p0,$p1,$p2]);},onGroupRenamed:function($p0,$p1,$p2){this.$1.sendMessage('OnGroupRenamed',[$p0,$p1,$p2]);},onGroupRemoved:function($p0,$p1,$p2){this.$1.sendMessage('OnGroupRemoved',[$p0,$p1,$p2]);},onContactAddedToGroup:function($p0,$p1,$p2,$p3){this.$1.sendMessage('OnContactAddedToGroup',[$p0,$p1,$p2,$p3]);},onContactRemovedFromGroup:function($p0,$p1,$p2,$p3){this.$1.sendMessage('OnContactRemovedFromGroup',[$p0,$p1,$p2,$p3]);},onContactUpdated:function($p0,$p1,$p2){this.$1.sendMessage('OnContactUpdated',[$p0,$p1,$p2]);},onIMAvailabilityUpdated:function($p0,$p1){this.$1.sendMessage('OnIMAvailabilityUpdated',[$p0,$p1]);},onUserSettingsUpdated:function($p0,$p1){this.$1.sendMessage('OnUserSettingsUpdated',[$p0,$p1]);},onUserUXSettingsUpdated:function($p0){this.$1.sendMessage('OnUserUXSettingsUpdated',[$p0]);},onUserServiceDataUpdated:function($p0,$p1){this.$1.sendMessage('OnUserServiceDataUpdated',[$p0,$p1]);},onSignedOutRemotely:function($p0,$p1){this.$1.sendMessage('OnSignedOutRemotely',[$p0,$p1]);this.$10();},onMailNotification:function($p0){this.$1.sendMessage('OnMailNotification',[$p0]);},onPendingContacts:function($p0){this.$1.sendMessage('OnPendingContacts',[$p0]);},onSettingsChanged:function($p0){this.$1.sendMessage('OnSettingsChanged',[$p0]);},onServiceDataChanged:function($p0,$p1){this.$1.sendMessage('OnServiceDataChanged',[$p0,$p1]);},onServiceDataDeleted:function($p0,$p1){this.$1.sendMessage('OnServiceDataDeleted',[$p0,$p1]);},onConversationCreated:function($p0,$p1){this.$1.sendMessage('OnConversationCreated',[$p0,$p1]);},onConversationInviteAddressCompleted:function($p0,$p1,$p2,$p3){this.$1.sendMessage('OnConversationInviteAddressCompleted',[$p0,$p1,$p2,$p3]);},onConversationAddressJoined:function($p0,$p1){this.$1.sendMessage('OnConversationAddressJoined',[$p0,$p1]);},onConversationAddressLeft:function($p0,$p1){this.$1.sendMessage('OnConversationAddressLeft',[$p0,$p1]);},onConversationMessageReceived:function($p0,$p1){this.$1.sendMessage('OnConversationMessageReceived',[$p0,$p1]);},onConversationHasUnreadMessagesUpdated:function($p0,$p1){this.$1.sendMessage('OnConversationHasUnreadMessagesUpdated',[$p0,$p1]);},onConversationClosed:function($p0){this.$1.sendMessage('OnConversationClosed',[$p0]);},onConversationSendMessageFailed:function($p0,$p1,$p2,$p3){this.$1.sendMessage('OnConversationSendMessageFailed',[$p0,$p1,$p2,$p3]);},onConversationUpdatedId:function($p0,$p1){this.$1.sendMessage('OnConversationUpdatedId',[$p0,$p1]);},onConfigurationChanged:function($p0){this.$1.sendMessage('OnConfigurationChanged',[$p0]);},onUserServicesUpdated:function($p0){this.$1.sendMessage('OnUserServicesUpdated',[$p0]);},onServicesChanged:function($p0){this.$1.sendMessage('OnServicesChanged',[$p0]);},$11:function($p0,$p1){if(this.$5){return;}MSH.PerfCollector.get_instance().increaseEventCounter('UserServiceEventsProxy-MessageReceivedCount',1);var $0=Date.get_now();var $1=$p1.get_command();var $2=$p1.get_parameters();switch($1){case'AddAddress':this.$3.addAddress($2[0],$2[1],$2[2]);break;case'AddAddressToContact':this.$3.addAddressToContact($2[0],$2[1],$2[2]);break;case'AddContactToGroup':this.$3.addContactToGroup($2[0],$2[1],$2[2]);break;case'AddGroup':this.$3.addGroup($2[0],$2[1]);break;case'UpdateNetwork':this.$3.updateNetwork($2[0],$2[1]);break;case'ConversationClose':this.$3.conversationClose($2[0]);break;case'ConversationUpdateHasUnreadMessages':this.$3.conversationUpdateHasUnreadMessages($2[0],$2[1]);break;case'ConversationCreate':this.$3.conversationCreate($2[0],$2[1]);break;case'ConversationExpose':this.$3.conversationExpose($2[0],$2[1]);break;case'ConversationInviteAddress':this.$3.conversationInviteAddress($2[0],$2[1],$2[2]);break;case'ConversationSendMessage':this.$3.conversationSendMessage($2[0],$2[1],$2[2]);break;case'ConversationUpdateId':this.$3.conversationUpdateId($2[0],$2[1]);break;case'GetApplicationContactsInfo':this.$3.getApplicationContactsInfo($2[0],$2[1]);break;case'GetConsentStatus':this.$3.getConsentStatus($2[0]);break;case'InitializeSignInStatus':this.$3.initializeSignInStatus($2[0],$2[1],$2[2]);break;case'OnSignInPopulateCompleted':this.$3.onSignInPopulateCompleted();break;case'Reconnect':this.$3.reconnect($2[0],$2[1],$2[2]);break;case'RemoveAddressFromContact':this.$3.removeAddressFromContact($2[0],$2[1],$2[2]);break;case'RemoveContactFromGroup':this.$3.removeContactFromGroup($2[0],$2[1],$2[2]);break;case'RemoveGroup':this.$3.removeGroup($2[0],$2[1]);break;case'RenameGroup':this.$3.renameGroup($2[0],$2[1]);break;case'SignIn':if(this.$2!=null&&!this.$2.$2()){}else{this.$3.signIn($2[0],$2[1],$2[2]);}break;case'SignOut':this.$3.signOut($2[0],$2[1],$2[2],$2[3]);break;case'UpdateAppContactsRoleLists':this.$3.updateAppContactsRoleLists($2[0],$2[1],$2[2]);break;case'UpdateApplicationContacts':this.$3.updateApplicationContacts($2[0],$2[1]);break;case'UpdateContact':this.$3.updateContact($2[0],$2[1],$2[2],$2[3]);break;case'UpdateIMAvailability':this.$3.updateIMAvailability($2[0],$2[1],$2[2],$2[3]);break;case'UpdateContactNickname':this.$3.updateContactNickname($2[0],$2[1]);break;case'UpdateServiceData':this.$3.updateServiceData($2[0],$2[1]);break;case'UpdateServices':this.$3.updateServices($2[0],$2[1]);break;case'UpdateSettings':this.$3.updateSettings($2[0],$2[1]);break;case'UpdateTicket':this.$3.updateTicket($2[0]);break;case'UpdateUXSettings':this.$3.updateUXSettings($2[0]);break;}var $3=MSH.DateTimeHelper.subtract(Date.get_now(),$0);MSH.PerfCollector.get_instance().addPerfCounterValue('UserServiceEventsProxy-MessageHandlingTime',$3);},dispose:function(){if(this.$5){return;}this.$5=true;this.$1.remove_messageReceived(this.$4);this.$2=null;this.$3=null;}}
MSL.L$10=function(impl){MSL.L$10.initializeBase(this);this.$12=impl;}
MSL.L$10.prototype={$12:null,updateNetwork:function($p0,$p1){this.$D($p0);this.$C($p1);this.$12.updateNetwork($p0,$p1);},getConsentStatus:function($p0){this.$D($p0);this.$12.getConsentStatus($p0);},initializeSignInStatus:function($p0,$p1,$p2){this.$13($p0);this.$14($p2);this.$12.initializeSignInStatus($p0,$p1,$p2);},updateApplicationContacts:function($p0,$p1){this.$10($p0);this.$F($p1);if($p0.userState!=null){this.$1();}this.$12.updateApplicationContacts($p0,$p1);},getApplicationContactsInfo:function($p0,$p1){this.$A($p0);this.$F($p1);this.$12.getApplicationContactsInfo($p0,$p1);},addAddress:function($p0,$p1,$p2){this.$D($p0);this.$E($p1);this.$11($p2);this.$12.addAddress($p0,$p1,$p2);},addAddressToContact:function($p0,$p1,$p2){this.$1E($p0);this.$15($p1);this.$11($p2);this.$12.addAddressToContact($p0,$p1,$p2);},addContactToGroup:function($p0,$p1,$p2){this.$15($p0);this.$1D($p1);this.$11($p2);this.$12.addContactToGroup($p0,$p1,$p2);},addGroup:function($p0,$p1){this.$1D($p0);this.$11($p1);this.$12.addGroup($p0,$p1);},removeAddressFromContact:function($p0,$p1,$p2){this.$1E($p0);this.$15($p1);this.$11($p2);this.$12.removeAddressFromContact($p0,$p1,$p2);},removeContactFromGroup:function($p0,$p1,$p2){this.$15($p0);this.$1D($p1);this.$11($p2);this.$12.removeContactFromGroup($p0,$p1,$p2);},removeGroup:function($p0,$p1){this.$1D($p0);this.$11($p1);this.$12.removeGroup($p0,$p1);},renameGroup:function($p0,$p1){this.$1D($p0);this.$11($p1);this.$12.renameGroup($p0,$p1);},signIn:function($p0,$p1,$p2){this.$16($p0);this.$C($p1);this.$11($p2);this.$12.signIn($p0,$p1,$p2);},reconnect:function($p0,$p1,$p2){this.$16($p0);this.$C($p1);this.$11($p2);this.$12.reconnect($p0,$p1,$p2);},signOut:function($p0,$p1,$p2,$p3){this.$1B($p0);this.$1C($p1);this.$11($p3);this.$7($p2);this.$12.signOut($p0,$p1,$p2,$p3);},updateAppContactsRoleLists:function($p0,$p1,$p2){this.$2($p0);this.$11($p2);this.$12.updateAppContactsRoleLists($p0,$p1,$p2);},updateContact:function($p0,$p1,$p2,$p3){this.$15($p0);this.$C($p1);this.$C($p2);this.$11($p3);this.$12.updateContact($p0,$p1,$p2,$p3);},updateContactNickname:function($p0,$p1){this.$15($p0);this.$11($p1);this.$12.updateContactNickname($p0,$p1);},updateIMAvailability:function($p0,$p1,$p2,$p3){var $enum1=ss.IEnumerator.getEnumerator($p0);while($enum1.moveNext()){var $0=$enum1.get_current();this.$15($0);}this.$11($p3);this.$C($p1);if($p1===3||$p1===4){this.$D($p2);}this.$12.updateIMAvailability($p0,$p1,$p2,$p3);},updateServices:function($p0,$p1){this.$C($p0);this.$7($p1);this.$12.updateServices($p0,$p1);},updateSettings:function($p0,$p1){this.$4($p0);this.$11($p1);this.$12.updateSettings($p0,$p1);},updateUXSettings:function($p0){this.$5($p0);this.$12.updateUXSettings($p0);},updateServiceData:function($p0,$p1){this.$16($p0);this.$11($p1);this.$12.updateServiceData($p0,$p1);},sendDatagram:function($p0,$p1,$p2){},conversationCreate:function($p0,$p1){this.$D($p0);this.$1E($p1);this.$12.conversationCreate($p0,$p1);},conversationSendMessage:function($p0,$p1,$p2){this.$D($p0);this.$19($p1);this.$11($p2);this.$12.conversationSendMessage($p0,$p1,$p2);},conversationInviteAddress:function($p0,$p1,$p2){this.$D($p0);this.$1E($p1);this.$11($p2);this.$12.conversationInviteAddress($p0,$p1,$p2);},conversationClose:function($p0){this.$D($p0);this.$12.conversationClose($p0);},conversationUpdateHasUnreadMessages:function($p0,$p1){this.$D($p0);this.$12.conversationUpdateHasUnreadMessages($p0,$p1);},conversationExpose:function($p0,$p1){},conversationUpdateId:function($p0,$p1){},resumeSignedInSession:function($p0,$p1,$p2,$p3){},onSignInPopulateCompleted:function(){this.$12.onSignInPopulateCompleted();},updateTicket:function($p0){this.$13($p0);this.$12.updateTicket($p0);},onTicketUpdated:function(){},onPersistedConversationsLoaded:function($p0){this.$12.onPersistedConversationsLoaded($p0);},$13:function($p0){this.$2($p0);this.$2($p0.authenticationInfo);this.$E($p0.authenticationInfo.ticket);this.$E($p0.appId);this.$E($p0.cid);this.$E($p0.endpointId);this.$E($p0.liveId);this.$E($p0.puid);switch($p0.authenticationInfo.authType){case 1:case 2:break;default:this.$1();break;}},$14:function($p0){if($p0==null){return;}this.$7($p0.clearStorageBeforeUse);this.$7($p0.disableLocalStorage);this.$7($p0.allowLocalSignIn);},$15:function($p0){this.$2($p0);this.$E($p0.id);if(!ss.isNullOrUndefined($p0.addresses)){this.$9($p0.addresses);for(var $0=0;$0<$p0.addresses.length;$0++){this.$1E($p0.addresses[$0]);}}},$16:function($p0){this.$9($p0);var $enum1=ss.IEnumerator.getEnumerator($p0);while($enum1.moveNext()){var $0=$enum1.get_current();this.$2($0);this.$C($0.service);this.$18($0.properties);this.$2($0.endpointData);var $dict2=$0.endpointData;for(var $key3 in $dict2){var $1={key:$key3,value:$dict2[$key3]};this.$17($1.value);}}},$17:function($p0){this.$2($p0);this.$C($p0.service);this.$D($p0.endpointId);this.$18($p0.properties);},$18:function($p0){this.$2($p0);var $dict1=$p0;for(var $key2 in $dict1){var $0={key:$key2,value:$dict1[$key2]};this.$D($0.key);}},$19:function($p0){this.$2($p0);this.$C($p0.type);this.$1E($p0.sender);switch($p0.type){case 3:this.$2($p0.info);var $0=$p0.info;this.$D($0.id);this.$D($0.content);break;case 2:case 255:if(!ss.isNullOrUndefined($p0.info)){this.$1();}break;case 1:this.$2($p0.info);var $1=$p0.info;this.$D($1.text);this.$1A($1.format);break;default:this.$1();break;}},$1A:function($p0){this.$2($p0);this.$C($p0.fontColor);this.$D($p0.fontFamily);this.$C($p0.fontStyle);this.$7($p0.rightToLeft);},$1B:function($p0){this.$C($p0);},$1C:function($p0){if(!ss.isNullOrUndefined($p0)){this.$A($p0);for(var $0=0;$0<$p0.length;$0++){this.$8($p0[$0]);}}},$1D:function($p0){this.$2($p0);if(!ss.isNullOrUndefined($p0.contactIds)){this.$A($p0.contactIds);}this.$D($p0.id);this.$D($p0.name);},$1E:function($p0){this.$2($p0);this.$D($p0.address);this.$C($p0.roleLists);this.$C($p0.type);}}
MSL.L$3=function(){}
MSL.L$3.$4=function($p0){if(MSL.L$3.$0==null){MSL.L$3.$0=new MSL.L$B(MSL.L$3.$6);MSL.L$3.$0.$2(9);}if(!MSL.L$3.$1){if(MSL.L$3.$2==null){MSL.L$3.$2={};}var $0=new MSL.L$4();$0.$0=$p0;$0.$1=[];MSL.L$3.$2[$p0.get_id().toString()]=$0;$p0.add_messageReceived(MSL.L$3.$7);}else{MSL.L$3.$5($p0);}}
MSL.L$3.$5=function($p0){var $0=PSCh.PubSubServiceEventsProxy;var $1=$0.create($p0);MSL.L$3.$3[$p0.get_id().toString()]=$1;return $1;}
MSL.L$3.$6=function($p0){MSL.L$3.$1=true;if(MSL.L$3.$2==null){return;}var $0=MSL.L$3.$2;var $dict1=$0;for(var $key2 in $dict1){var $1={key:$key2,value:$dict1[$key2]};var $2=$1.key;var $3=MSL.L$3.$2[$2];var $4=$3.$0;var $5=$3.$1;var $6=MSL.L$3.$5($4);while($5.length>0){var $7=$5.dequeue();$6.handleQueuedMessage($4,$7);}}}
MSL.L$3.$7=function($p0,$p1){var $0=$p0;var $1=MSL.L$3.$2[$0.get_id().toString()];$1.$1.enqueue($p1);}
MSL.L$4=function(){}
MSL.L$4.prototype={$0:null,$1:null}
MSL.MessengerServiceInitializer=function(){}
MSL.MessengerServiceInitializer.initialize=function(id,hostingDomain){MSL.MessengerServiceInitializer.$7=new MC.LogContext(id);MSH.Logger.logInfo(MSL.MessengerServiceInitializer.$7,'Initialize','Initialized');if(String.isNullOrEmpty(hostingDomain)){throw new Error('Invalid domain.');}MSCo.Configuration.set_domainName(hostingDomain);MSL.MessengerServiceInitializer.$1=hostingDomain;MSL.MessengerServiceInitializer.$6=id;MSL.MessengerServiceInitializer.$F();}
MSL.MessengerServiceInitializer.$9=function(){var $0=Microsoft.Live.Core.Loader.get_settings().messenger.getResourceUrl('Channel.html');var $1=MLC.Channel.fromChild(MSL.MessengerServiceInitializer.$6,MSL.MessengerServiceInitializer.$1,$0,'MessengerChannel');MSL.MessengerServiceInitializer.$0=new MC.ChannelEndpointMultiplexer($1);MSL.MessengerServiceInitializer.$0.add_channelEndpointCreated(MSL.MessengerServiceInitializer.$A);MSL.MessengerServiceInitializer.$0.add_channelEndpointDisposed(MSL.MessengerServiceInitializer.$D);}
MSL.MessengerServiceInitializer.$A=function($p0,$p1){var $0=$p1.get_channelEndpoint();switch($0.get_type()){case 0:break;case 1:if(MSL.MessengerServiceInitializer.$2==null){MSL.MessengerServiceInitializer.$2=new MSL.L$7($0);}break;case 6:if(MSL.MessengerServiceInitializer.$3==null){MSL.MessengerServiceInitializer.$3=new MSL.L$A($0,MSL.MessengerServiceInitializer.$B());}break;case 7:if(MSL.MessengerServiceInitializer.$E(MSL.MessengerServiceInitializer.$1)){MSL.L$3.$4($0);}break;default:var $1=MSL.MessengerServiceInitializer.$B();var $2=new MSL.L$5($0,$1);MSL.MessengerServiceInitializer.$8[$0.get_id().toString()]=$2;if($0.get_type()===3){MSL.MessengerServiceInitializer.$C($0,$2);}else{var $3=new MSL.L$6($2);}if($0.get_type()===2){$1.$6();}break;}}
MSL.MessengerServiceInitializer.$B=function(){var $0=MSL.MessengerServiceInitializer.$10();return new MSL.L$9($0);}
MSL.MessengerServiceInitializer.$C=function($p0,$p1){var $0=new MSL.L$F($p0,$p1);window.signInControl=$0;window.signInControlChannelEndpointId=$p0.get_id();if(!String.isNullOrEmpty(Microsoft.Live.Core.Loader.get_settings().messenger.signInControlState)){switch(Microsoft.Live.Core.Loader.get_settings().messenger.signInControlState.toLowerCase()){case'serviceunavailable':$0.set_$10(2);break;case'missingpolicy':$0.set_$10(1);break;case'applicationblocked':$0.set_$10(3);break;default:$0.set_$10(0);break;}}}
MSL.MessengerServiceInitializer.$D=function($p0,$p1){var $0=$p1.get_channelEndpoint();if($0.get_type()===2||$0.get_type()===5||$0.get_type()===4||$0.get_type()===3){var $2=$0.get_id().toString();var $3=MSL.MessengerServiceInitializer.$8[$2];$3.dispose();delete MSL.MessengerServiceInitializer.$8[$2];}var $1=window.signInControlChannelEndpointId;if(!ss.isNullOrUndefined($1)&&$1===$0.get_id()){window.signInControl=null;}}
MSL.MessengerServiceInitializer.$E=function($p0){$p0=$p0||String.Empty;$p0=$p0.toLowerCase();var $0='.'+window.document.domain.toLowerCase();return $p0.endsWith($0);}
MSL.MessengerServiceInitializer.$F=function(){if(!Microsoft.Live.Core.Loader.get_settings().messenger.localStorageDisabled){var $0=new MSLS.LocalStorageService(MSL.MessengerServiceInitializer.$1);$0.add_initialized(MSL.MessengerServiceInitializer.$11);}else{MSL.MessengerServiceInitializer.$5=1;Microsoft.Live.Core.Loader.onDocumentReady(MSL.MessengerServiceInitializer.$9);}}
MSL.MessengerServiceInitializer.$10=function(){var $0;if(Microsoft.Live.Core.Loader.get_settings().messenger.localStorageDisabled||MSL.MessengerServiceInitializer.$5!==1){$0=new MSCo.LocalStorageMemoryService();}else if(MSL.MessengerServiceInitializer.$4!=null){$0=MSL.MessengerServiceInitializer.$4;MSL.MessengerServiceInitializer.$4=null;}else{$0=new MSLS.LocalStorageService(MSL.MessengerServiceInitializer.$1);}return new MSCo.LocalStorageServiceWrapper($0);}
MSL.MessengerServiceInitializer.$11=function($p0,$p1){MSL.MessengerServiceInitializer.$5=$p1.get_status();var $0=$p0;if($0!=null){$0.remove_initialized(MSL.MessengerServiceInitializer.$11);}if($p1.get_status()===1){MSL.MessengerServiceInitializer.$4=$0;}else{MSH.Logger.logWarning(MSL.MessengerServiceInitializer.$7,'MessengerServiceInitializer.OnFirstLocalStorageServiceInitialized','LocalStorageService failed to initialize.');}Microsoft.Live.Core.Loader.onDocumentReady(MSL.MessengerServiceInitializer.$9);}
MSL.L$6=function(proxy){this.$0=proxy;this.$0.set_$B(this);}
MSL.L$6.prototype={$0:null,$1:false,$2:function(){return this.$1;},$3:function(){this.$1=false;},$4:function(){this.$1=true;},$5:function($p0,$p1){if($p0===0){switch($p1.identity.authenticationInfo.authType){case 1:if($p1.signInStatus.isTrustedSignIn){this.$1=true;}else{this.$1=false;$p1.signInStatus.isApplicationBlocked=true;}break;case 2:if(!$p1.signInStatus.isApplicationBlocked&&!$p1.signInStatus.isUserBlocked&&!$p1.signInStatus.isTicketExpired){this.$1=true;}else{this.$1=false;}break;default:this.$1=false;break;}}else{this.$1=false;}this.$0.$E($p0,$p1);}}
MSL.L$F=function(channel,proxy){this.$F=0;MSL.L$F.initializeBase(this,[proxy]);this.$6=channel;this.$0=proxy;this.$6.add_messageReceived(ss.Delegate.create(this,this.$11));this.$0.add_$7(ss.Delegate.create(this,this.$17));this.$0.add_$9(ss.Delegate.create(this,this.$16));var $0=MC.$create_IdentityInfo(null,null);$0.authenticationInfo=MC.$create_AuthenticationInfo(1,null);this.$0.$D($0,null,null);}
MSL.L$F.prototype={$6:null,$7:null,$8:null,$9:null,$A:null,$B:0,$C:false,$D:false,$E:false,get_$10:function(){return this.$F;},set_$10:function($p0){this.$F=$p0;return $p0;},$2:function(){var $0=MSL.L$F.callBaseMethod(this,'$2');this.$3();return $0;},$11:function($p0,$p1){switch($p1.get_command()){case'$ChangeStyle':if($p1.get_parameters().length!==1){this.$12();}var $0=$p1.get_parameters()[0];this.$13($0);break;}},$12:function(){throw new Error('Invalid parameter');},$13:function($p0){if(ss.isNullOrUndefined($p0)){this.$12();}this.$14($p0.backColor);this.$14($p0.borderColor);this.$14($p0.foreColor);this.$14($p0.linkColor);this.$14($p0.buttonBackColor);this.$14($p0.buttonBorderColor);this.$14($p0.buttonForeColor);this.$7=$p0;if(this.$8!=null){this.$8.setStyle(this.$7);}},$14:function($p0){if(ss.isNullOrUndefined($p0)||Type.getInstanceType($p0)!==String){this.$12();}var $0=new RegExp('^#[0-9a-f]{6,6}$','i');if(!$0.test($p0)){this.$12();}},get_$15:function(){if(this.$9==null||this.$9.liveId==null){return String.Empty;}else{return this.$9.liveId;}},$16:function($p0,$p1){if(this.$8!=null){this.$8.setSignInState(6,this.get_$15());}},$17:function($p0,$p1){if(this.$8!=null){this.$8.setSignInState(8,this.get_$15());}},$5:function($p0,$p1){this.$B=$p0;this.$A=$p1;if(this.$8!=null){this.$18();}else{this.$C=true;}},$18:function(){if(this.$8.get_signInState()===1){return;}if(this.$B===0){var $0=false;if(this.$9!=null){if(this.$9.liveId!==this.$A.identity.liveId){this.$9=this.$A.identity;$0=true;}}else{this.$9=this.$A.identity;$0=true;}if($0){this.$D=false;switch(this.$8.get_signInState()){case 7:case 8:this.$0.$C(1);break;}}if(this.$F!==0){this.$8.setSignInState(this.$F,this.get_$15());return;}if(this.$8.get_isSignInWizardPending()){this.$8.showSignInWizard(this.get_$1D(),this.get_$1B());return;}var $1=this.$A.signInStatus;if($1.isApplicationBlocked){this.$8.setSignInState(3,this.get_$15());}else if($1.isUserBlocked){this.$8.setSignInState(4,this.get_$15());}else if(!$1.isAuthenticated){this.$9=null;this.$A=null;this.$1A();}else{var $2=false;if($1.isTrustedSignIn){$2=true;}else if($1.isAutoSignIn||$1.isManualSignIn){if(this.$D){$2=true;}else{var $3=$1.isUserSignedInViaSpopClient||($1.isUserSignedInViaMpopEndpoints&&!$1.isMpopSettingEnabled);if($1.isAutoSignIn&&!$3&&!$1.isUnsupportedBrowser){$2=true;}}}if($2&&!this.$E){this.$1C();}else{this.$19();}}}else{this.$9=null;this.$A=null;if(this.$8.get_isSignInWizardPending()){this.$8.showSignInWizard('&error=true',this.get_$1B());return;}switch(this.$8.get_signInState()){case 8:case 7:break;default:this.$8.setSignInState(2,this.get_$15());break;}}},$19:function(){switch(this.$8.get_signInState()){case 8:case 7:break;default:this.$8.setSignInState(6,this.get_$15());break;}},$1A:function(){switch(this.$8.get_signInState()){case 8:case 7:this.$0.$C(1);break;default:this.$8.setSignInState(5,this.get_$15());break;}},get_$1B:function(){return this.$A!=null&&this.$A.signInStatus!=null&&this.$A.signInStatus.isAuthenticated;},$1C:function(){switch(this.$8.get_signInState()){case 8:case 7:break;default:this.$8.setSignInState(7,this.$9.liveId);this.$6.sendMessage('$SetSignInConfig',[this.$8.getSignInConfig()]);this.$4();this.$0.$E(0,this.$A);break;}},onClickSignIn:function(){this.$E=false;var $0;if(this.$A!=null){var $1=this.$A.signInStatus;if($1.isTrustedSignIn){$0=true;}else if($1.isManualSignIn||$1.isAutoSignIn){var $2=$1.isUserSignedInViaSpopClient||($1.isUserSignedInViaMpopEndpoints&&!$1.isMpopSettingEnabled);if($2||$1.isUnsupportedBrowser){if(this.$D){$0=true;}else{$0=false;}}else{$0=true;}}else{$0=false;}}else{$0=false;}if($0){this.$1C();}else{this.$8.showSignInWizard(this.get_$1D(),this.get_$1B());}},get_$1D:function(){if(this.$A==null||this.$A.signInStatus==null){return String.Empty;}var $0=new ss.StringBuilder();var $1=this.$A.signInStatus;$0.append('&UserBlocked=');$0.append($1.isUserBlocked.toString());$0.append('&UnsupportedBrowser=');$0.append($1.isUnsupportedBrowser.toString());$0.append('&AutoSignIn=');$0.append($1.isAutoSignIn.toString());$0.append('&ManualSignIn=');$0.append($1.isManualSignIn.toString());$0.append('&TrustedSignIn=');$0.append($1.isTrustedSignIn.toString());$0.append('&SignedInSpopClient=');$0.append($1.isUserSignedInViaSpopClient.toString());$0.append('&SignedInMpop=');$0.append($1.isUserSignedInViaMpopEndpoints.toString());$0.append('&MpopEnabled=');$0.append($1.isMpopSettingEnabled.toString());return $0.toString();},onClickSignOut:function(){this.$E=true;this.$0.$C(1);},onPotentialSignInStatusChanged:function(){var $0=MC.$create_IdentityInfo(null,null);$0.authenticationInfo=MC.$create_AuthenticationInfo(1,String.Empty);this.$0.$D($0,null,MC.$create_InitializationOptionsInfo(false,false,false));},onSignInControlWindowLoaded:function($p0){this.$8=$p0;this.$8.setStyle(this.$7);if(this.$C){this.$18();}},onConsentSignIn:function(){this.$D=true;},onChangeAccount:function(){this.$D=false;this.$E=false;},onShowSignInWizard:function(){this.$8.showSignInWizard(this.get_$1D(),this.get_$1B());}}
MSL.L$A.registerClass('MSL.L$A',null,MC.IApplicationServiceEvents);MSL.L$8.registerClass('MSL.L$8');MSL.L$11.registerClass('MSL.L$11',MSL.L$8,MC.IApplicationService);MSL.L$B.registerClass('MSL.L$B');MSL.L$9.registerClass('MSL.L$9',null,MC.IServiceFactory,MSL.IConsentHandler);MSL.L$7.registerClass('MSL.L$7');MSL.L$D.registerClass('MSL.L$D');MSL.L$E.registerClass('MSL.L$E');MSL.L$C.registerClass('MSL.L$C');MSL.AddressBookProxyDef.registerClass('MSL.AddressBookProxyDef',null,MC.IAddressBook);MSL.ApplicationServiceProxyDef.registerClass('MSL.ApplicationServiceProxyDef',null,MC.IApplicationService);MSL.ConfigurationServiceProxyDef.registerClass('MSL.ConfigurationServiceProxyDef',null,MC.IConfigurationService);MSL.ConnectionServiceProxyDef.registerClass('MSL.ConnectionServiceProxyDef',null,MC.IConnectionService);MSL.ConversationServiceProxyDef.registerClass('MSL.ConversationServiceProxyDef',null,MC.IConversationService);MSL.ExpressionProfileProxyDef.registerClass('MSL.ExpressionProfileProxyDef',null,MC.IExpressionProfile);MSL.IdentityServiceProxyDef.registerClass('MSL.IdentityServiceProxyDef',null,MC.IIdentityService);MSL.LocalStorageProxyDef.registerClass('MSL.LocalStorageProxyDef',null,MC.ILocalStorageService);MSL.UserServiceProxyDef.registerClass('MSL.UserServiceProxyDef',null,MC.IUserService);MSL.L$5.registerClass('MSL.L$5',null,MC.IUserServiceEvents,ss.IDisposable);MSL.L$10.registerClass('MSL.L$10',MSL.L$8,MC.IUserService);MSL.L$3.registerClass('MSL.L$3');MSL.L$4.registerClass('MSL.L$4');MSL.MessengerServiceInitializer.registerClass('MSL.MessengerServiceInitializer');MSL.L$6.registerClass('MSL.L$6');MSL.L$F.registerClass('MSL.L$F',MSL.L$6,MSII.ISignInControlWindowEvents);MSL.L$E.$0=3*60*1000;MSL.L$C.$0=2*60*1000;MSL.L$3.$0=null;MSL.L$3.$1=false;MSL.L$3.$2=null;MSL.L$3.$3={};MSL.MessengerServiceInitializer.$0=null;MSL.MessengerServiceInitializer.$1=null;MSL.MessengerServiceInitializer.$2=null;MSL.MessengerServiceInitializer.$3=null;MSL.MessengerServiceInitializer.$4=null;MSL.MessengerServiceInitializer.$5=0;MSL.MessengerServiceInitializer.$6=null;MSL.MessengerServiceInitializer.$7=null;MSL.MessengerServiceInitializer.$8={};Type.registerNamespace('MSLS');MSLS.$create_LS$5=function(domainKey,id,lastUpdated,status,userTicket,userId){var $o={};$o.$0=domainKey;$o.id=id;$o.$1=lastUpdated;$o.$2=status;$o.$3=userTicket;$o.$4=userId;return $o;}
MSLS.LS$1=function(){};MSLS.LS$1.prototype={$0:0,$1:1,$2:2}
MSLS.LS$1.registerEnum('MSLS.LS$1',false);MSLS.LS$0=function(){};MSLS.LS$0.prototype={$0:0,$1:1,$2:2}
MSLS.LS$0.registerEnum('MSLS.LS$0',true);MSLS.LS$7=function(domainKey){this.$2=domainKey;this.$A=ss.Delegate.create(this,this.$20);}
MSLS.LS$7.get_$10=function(){if(MSLS.LS$7.$1==null){MSLS.LS$7.$1=new MSLS.LS$3('Messenger2.INST',1,null);}return MSLS.LS$7.$1;}
MSLS.LS$7.prototype={$2:null,$3:null,$4:null,$5:null,$6:null,$7:false,$8:null,$9:null,$A:null,$B:null,add_$E:function($p0){this.$F=ss.Delegate.combine(this.$F,$p0);},remove_$E:function($p0){this.$F=ss.Delegate.remove(this.$F,$p0);},$F:null,get_$11:function(){return this.$7;},get_$12:function(){return this.$8;},get_$13:function(){return this.$6.id;},get_$14:function(){return this.$5;},get_$15:function(){return this.$4;},set_$15:function($p0){this.$4=$p0;this.$6.$3=$p0;this.$6.$1=Date.get_now();this.$27(this.$6,false,false);return $p0;},$16:function($p0,$p1,$p2){if(this.$7){if(!String.isNullOrEmpty($p0)&&$p0!==this.$4){this.$4=$p0;this.$6.$3=this.$4;this.$27(this.$6,false,false);}$p2.invoke(true);}else{this.$5=$p1;this.$4=$p0;this.$B=$p2;this.$3.refresh();}},$17:function(){var $0=[];var $1=[];var $2=[];var $3=this.$24(null);var $enum1=ss.IEnumerator.getEnumerator($3);while($enum1.moveNext()){var $4=$enum1.get_current();var $5=this.$29($4.$0,$4.$4,null);if(this.$2A($4)){$0.add(this.$29($4.$0,$4.$4,$4.id));if(!$2.contains($5)){$2.add($5);}}else if(!$1.contains($5)){$1.add($5);}}var $enum2=ss.IEnumerator.getEnumerator($2);while($enum2.moveNext()){var $6=$enum2.get_current();if(!$1.contains($6)){$0.add($6);}}return MSH.CollectionHelper.toArray($0);},$18:function($p0){if(($p0&&this.$6.$2===1)||(!$p0&&this.$6.$2===0)){return;}this.$6.$2=($p0)?1:0;this.$6.$1=Date.get_now();this.$27(this.$6,true,false);this.$3.refresh();},$19:function($p0){if($p0){this.$6.$1=Date.get_now();this.$6.$2=0;this.$27(this.$6,true,false);}else{this.$9.dispose();this.$9=null;window.detachEvent('onunload',this.$A);this.$3.removeOnUnloadWrite(this.$28(this.$6.id));this.$26([this.$6.id]);this.$6=null;this.$5=null;this.$4=null;this.$8=null;this.$7=false;}},$1A:function($p0){this.$3=$p0;this.$3.add_refreshed(ss.Delegate.create(this,this.$1D));},$1B:function(){if(this.$F!=null){this.$F.invoke(this,new MC.InstancesChangedEventArgs(this.$8));}},$1C:function($p0){this.$3.refresh();},$1D:function($p0,$p1){if(this.$7){if(this.$9==null){return;}this.$1F();}else{if(this.$B==null){return;}var $0=this.$B;this.$B=null;if(String.isNullOrEmpty(this.$5)){this.$1E();}if(String.isNullOrEmpty(this.$5)){$0.invoke(false);}else{this.$6=this.$21();window.attachEvent('onunload',this.$A);this.$7=true;$0.invoke(true);this.$9=new MSH.Timer(ss.Delegate.create(this,this.$1C),null,MSLS.LS$7.$C,MSLS.LS$7.$C);}}},$1E:function(){var $0=this.$23();var $enum1=ss.IEnumerator.getEnumerator($0);while($enum1.moveNext()){var $1=$enum1.get_current();if(!this.$2A($1)&&this.$4===$1.$3){this.$5=$1.$4;return;}}},$1F:function(){var $0=this.$23();var $1=this.$8;this.$8=this.$22($0);this.$6.$1=Date.get_now();this.$27(this.$6,false,false);var $2=MSLS.$create_LS$5(this.$2,this.$6.id,this.$6.$1,2,this.$4,this.$5);this.$27($2,false,true);if(this.$8.length!==$1.length){this.$1B();return;}for(var $3=0;$3<this.$8.length;$3++){if(this.$8[$3].id!==$1[$3].id||this.$8[$3].isPrimary!==$1[$3].isPrimary){this.$1B();return;}}},$20:function(){if(this.$9!=null){this.$9.dispose();this.$9=null;}},$21:function(){var $0=this.$23();var $1=null;var $2=[];for(var $3=0;$3<$0.length;$3++){if(this.$2A($0[$3])){if($1==null){$1=$0[$3];}}else if($0[$3].$2!==2){$2.add($0[$3].id);}else if($1==null||$0[$3].$1>$1.$1||this.$2A($1)){$1=$0[$3];}}if($1==null){var $4=0;while($2.contains($4.toString())){$4++;}$1=MSLS.$create_LS$5(this.$2,$4.toString(),Date.get_now(),0,this.$4,this.$5);}else{$1.$2=0;$1.$1=Date.get_now();$1.$3=this.$4;}this.$8=this.$22($0);this.$27($1,true,false);return $1;},$22:function($p0){var $0=[];var $1=0;var $enum1=ss.IEnumerator.getEnumerator($p0);while($enum1.moveNext()){var $2=$enum1.get_current();if($2.$2===1&&!this.$2A($2)){var $3=(this.$6!=null&&$2.id===this.$6.id);var $4=MC.$create_InstanceInfo($2.id,$3,false);if($0.length>1){var $5=$0[$1];if($5.id.compareTo($4.id)>0){$1=$0.length;}}$0.add($4);}}if($0.length>0){($0[$1]).isPrimary=true;}return MSH.CollectionHelper.toArray($0);},$23:function(){return this.$24(this.$28(null));},$24:function($p0){var $0=[];var $1=[];var $enum1=ss.IEnumerator.getEnumerator(this.$3);while($enum1.moveNext()){var $2=$enum1.get_current();if($p0==null||$2.startsWith($p0)){var $3=this.$25(this.$3.get_item($2));if($3!=null){$0.add($3);}else{$1.add($2);}}}var $enum2=ss.IEnumerator.getEnumerator($1);while($enum2.moveNext()){var $4=$enum2.get_current();this.$3.set_item($4,null);}return MSH.CollectionHelper.toArray($0);},$25:function($p0){if(String.isNullOrEmpty($p0)){return null;}var $0=$p0.split(';');if($0.length!==6){return null;}var $1=Date.parseDate($0[2]);return MSLS.$create_LS$5($0[0],$0[1],$1,parseInt($0[3]),$0[4],$0[5]);},$26:function($p0){var $enum1=ss.IEnumerator.getEnumerator($p0);while($enum1.moveNext()){var $0=$enum1.get_current();this.$3.set_item(this.$28($0),null);}},$27:function($p0,$p1,$p2){var $0=String.format('{0};{1};{2};{3};{4};{5}',$p0.$0,$p0.id,$p0.$1.toUTCString(),$p0.$2,$p0.$3,$p0.$4);var $1=this.$28($p0.id);if($p2){this.$3.addOnUnloadWrite($1,$0);}else{this.$3.set_item($1,$0);}if($p1){this.$3.flush();}},$28:function($p0){return this.$29(this.$2,this.$5,$p0);},$29:function($p0,$p1,$p2){var $0=new ss.StringBuilder($p0);if(!String.isNullOrEmpty($p1)){$0.append($p1);if(!String.isNullOrEmpty($p2)){$0.append('_id');$0.append($p2);}}return $0.toString();},$2A:function($p0){var $0=Date.get_now().getTime()-$p0.$1.getTime();return($0>MSLS.LS$7.$D);}}
MSLS.LS$6=function(){this.$5=0;this.$1={};this.$1['^']='^^';this.$2={};this.$2['^^']='^';}
MSLS.LS$6.$7=function($p0){var $0=new ss.StringBuilder();$0.append('(');var $1=true;var $dict1=$p0;for(var $key2 in $dict1){var $2={key:$key2,value:$dict1[$key2]};if(!$1){$0.append('|');}var $3=$2.key.replace(MSLS.LS$6.$0,'\\$1');$0.append($3);$1=false;}$0.append(')');return new RegExp($0.toString(),'g');}
MSLS.LS$6.$8=function($p0){var $0='0123456789abcdef';var $1=$p0/16;var $2=String.Empty;$2=$2+$0.charAt($1);$p0%=16;$2=$2+$0.charAt($p0);return'^'+$2;}
MSLS.LS$6.prototype={$1:null,$2:null,$3:null,$4:null,$5:0,$6:function($p0){var $enum1=ss.IEnumerator.getEnumerator($p0);while($enum1.moveNext()){var $0=$enum1.get_current();if($0.indexOf('^')>=0){throw Error.argumentOutOfRange('Replacements cannot contain the \'^\' character.');}var $1=MSLS.LS$6.$8(this.$5++);if($1.length>3){break;}this.$1[$0]=$1;this.$2[$1]=$0;}this.$3=MSLS.LS$6.$7(this.$1);this.$4=MSLS.LS$6.$7(this.$2);},$9:function($p0){return $p0.replace(this.$3,ss.Delegate.create(this,function($p1_0){return this.$1[$p1_0];}));},$A:function($p0){return $p0.replace(this.$4,ss.Delegate.create(this,function($p1_0){return this.$2[$p1_0];}));}}
MSLS.LS$9=function(){MSLS.LS$9.initializeBase(this);var $0=[];MSLS.LS$9.$B($0);this.$6($0);}
MSLS.LS$9.$B=function($p0){$p0.addRange(['/conversation/img/networkicons/live.png\"','/conversation/img/networkicons/','/conversation/img/emoticons/','edge.messenger.live.com','edge.messenger.live-int.com','false','@gmail.com','\"http://','www.hotmail.msn.com','https://login.live.com/login.srf','https://login.live-int.com/login.srf','@hotmail.com','livefilestore.com/storageservice/passport/challenge.aspx?silent=true','livefilestore-int.com/storageservice/passport/challenge.aspx?silent=true','livecontacts.live-int.com','livecontacts.live.com','Location=\\\"0\\\" Friendly=\\','messengerweb.live.com','messengerweb.live-int.com','\"MessengerLibrary\"','myprofile/expressionprofile/profilephoto','mail.live-int.com','mail.live.com','null','ReauthCompleted.html','reply=ReauthCompletedUrl','settings.messenger.live.com/static/200','storage.live.com','storage.live-int.com','settings.messenger.live.com','settings.messenger.live-int.com','true,','www.wlmessenger.net/static/200','Type=\\\"3\\\"','\"00000000-0000-0000-0000-000000000000\"','\"<msnobj Creator=\\\"','\"address\":','\"addresses\":','\"addressBook\":','\"applicationId\":','\"applicationDisplayName\":','\"applicationMessageIds\":','\"applicationPersonalMessage\":','\"capabilities\":','\"cid\":','\"clientConfiguration\":','\"contacts\":','\"displayName\":','\"displayPictureKey\":','\"displayPictureUrl\":','\"domain\":','\"emoticonUrl\":','\"endpointName\":','\"expressionProfile\":','\"Favorites\"','\"foldersUnread\":','\"foldersTotal\":','\"hasInbox\":','\"hasInboxChanged\":','\"hostName\":','\"httpRequestTimeout\":','\"id\":','\"identity\":','\"inboxUnread\":','\"inboxTotal\":','\"inviteMessage\":','\"isIdentityUnverified\":','\"isIdentityUnverifiedChanged\":','\"isProvisioned\":','\"isMpopDisabled\":','\"isMpopDisabledChanged\":','\"isSuspended\":','\"isEnabled\":','\"lcid\":','\"lcidChanged\":','\"maximumContactCount\":','\"maximumAllowedCount\":','\"maximumBlockedCount\":','\"maximumGroupCount\":','\"messageUrl\":','\"messengerSession\":','\"networkIconUrl\":','\"name\":','\"nickname\":','\"notification\":','\"OnPresenceChanged\"','\"OnSettingsChanged\"','\"pendingEvents\":','\"personalMessage\":','\"partnerId\":','\"presence\":','\"privacyOptions\":','\"properties\":','\"roleLists\":','\"silentReauthUrl\":','\"silentReauthUrlFormat\":','\"silentReauthDetectionUrl\":','\"status\":','\"server\":','\"sessionToken\":','\"settings\":','\"storageAuthUrl\":','\"transactionID\":','\"type\":','\"value\":','\"webProperties\":','\"emailAddress\":','\"lastName\":','\"firstName\":','\"favoritesOrder\":','\"network\":','\"isFan\":','\"pictureUrl\":','\"contactIds\":','\"isFavorites\":','\"Capabilities\":','\"service\":','\"endpointData\":','\"endpointId\":','\"CurrentMedia\":','\"Status\":','\"FriendlyName\":','\"ColorScheme\":','profile.ak.fbcdn.net','hprofile-ak-snc4','\"OnServiceDataChanged\"','static.ak.fbcdn.net','media.linkedin.com/mpr/mprx']);}
MSLS.LS$8=function(){MSLS.LS$8.initializeBase(this);var $0=[];MSLS.LS$8.$B($0);this.$6($0);}
MSLS.LS$8.$B=function($p0){$p0.addRange(['false','\"http://','true,','\"00000000-0000-0000-0000-000000000000\"','live.com','live-int.com','null','\"identity\":','\"liveId\":','\"endpointId\":','\"puid\":','\"cid\":','\"appId\":','\"authenticationInfo\":','\"authType\":','\"ticket\":','\"signInStatus\":','\"isAuthenticated\":','\"isAutoSignIn\":','\"isManualSignIn\":','\"isTrustedSignIn\":','\"isApplicationBlocked\":','\"isUnsupportedBrowser\":','\"isUserSignedInViaSpopClient\":','\"isUserSignedInViaMpopEndpoints\":','\"isMpopSettingEnabled\":','\"isUserBlocked\":','\"isTicketExpired\":','\"version\":','\"clientVersion\":','\"authInfo\":','\"autoSignInEnabled\":','\"audioEnabled\":','\"firstRunExperienceViewed\":']);}
MSLS.LS$3=function(name,scope,compressor){this.$0=name;this.$1=scope;this.$2=compressor;}
MSLS.LS$3.prototype={$0:null,$1:0,$2:null,get_$3:function(){return this.$0;},get_$4:function(){return this.$1;},$5:function($p0){if(this.$2!=null){$p0.add_serialized(ss.Delegate.create(this,this.$6));$p0.add_deserialized(ss.Delegate.create(this,this.$7));}},$6:function($p0,$p1){if(String.isNullOrEmpty($p1.get_serialization())){return;}$p1.set_serialization(this.$2.$9($p1.get_serialization()));},$7:function($p0,$p1){if(String.isNullOrEmpty($p1.get_serialization())){return;}$p1.set_serialization(this.$2.$A($p1.get_serialization()));}}
MSLS.LS$4=function(objectInfoList,namespaces){this.$1=objectInfoList;this.$2={};Microsoft.Live.Core.Internal.LocalStorageConfiguration.set_storageNamespaces(namespaces);this.$5=MSH.UriHelper.get_windowLocationProtocol()!=='https:'&&Microsoft.Live.Core.Loader.get_settings().httpsApplication&&MLC.Channel.getChannelType()===3&&Microsoft.Live.Core.Internal.LocalStorageConfiguration.get_isHtml5LocalStorageSupported()&&!(Sys.Browser.agent===Sys.Browser.InternetExplorer&&Sys.Browser.version===8);if(!MSH.TestingHelper.get_isUnitTest()){MSH.Scheduler.defer(ss.Delegate.create(this,function(){this.$D();}));}}
MSLS.LS$4.prototype={$1:null,$2:null,$3:0,$4:false,$5:false,$6:0,$7:0,add_$8:function($p0){this.$9=ss.Delegate.combine(this.$9,$p0);},remove_$8:function($p0){this.$9=ss.Delegate.remove(this.$9,$p0);},$9:null,get_$A:function(){return this.$2;},add_$B:function($p0){this.add_$8($p0);if(this.$3!==0){$p0.invoke(this,new Microsoft.Live.Core.LocalStorageInitializedEventArgs(this.$3));}},remove_$B:function($p0){this.remove_$8($p0);},get_$C:function(){return this.$5;},$D:function(){if(this.get_$C()){Microsoft.Live.Core.Internal.LocalStorageConfiguration.set_proxyChannelName('MessengerStorageChannel');Microsoft.Live.Core.Loader.onDocumentReady(ss.Delegate.create(this,function(){MLC.Channel.fromSibling('MessengerStorageChannel',MSH.UriHelper.removeParametersFromUrl(Microsoft.Live.Core.Loader.get_settings().messenger.getResourceUrl('LocalStorage.html','storageiframe')),ss.Delegate.create(this,this.$11));}));}else{this.$F(MSLS.LS$7.get_$10());}},$E:function($p0){if(this.$3===0){this.$3=$p0.get_status();if(this.$9!=null){this.$9.invoke(this,$p0);}}},$F:function($p0){var $0=this.$14($p0);if($p0.get_$3()==='Messenger2.INST'){$0.add_initialized(ss.Delegate.create(this,this.$10));}else if(this.get_$C()){$0.add_initialized(ss.Delegate.create(this,this.$13));}},$10:function($p0,$p1){var $0=$p0;$0.remove_initialized(ss.Delegate.create(this,this.$10));if($p1.get_status()!==1){this.$E($p1);return;}this.$4=($0.get_availableStorage()<1000000);if(this.get_$C()){this.$7++;}this.$12();if(!this.get_$C()){this.$E(new Microsoft.Live.Core.LocalStorageInitializedEventArgs(1));}},$11:function($p0){if($p0==null){this.$E(new Microsoft.Live.Core.LocalStorageInitializedEventArgs(2));return;}var $0=false;Microsoft.Live.Core.LocalStorageProxy.setChannel($0,'MessengerStorageChannel',$p0);this.$F(MSLS.LS$7.get_$10());},$12:function(){var $enum1=ss.IEnumerator.getEnumerator(this.$1);while($enum1.moveNext()){var $0=$enum1.get_current();this.$F($0);}},$13:function($p0,$p1){var $0=$p0;$0.remove_initialized(ss.Delegate.create(this,this.$13));if($p1.get_status()!==1){this.$E($p1);return;}this.$7++;if(this.$6===this.$7){this.$E($p1);}},$14:function($p0){var $0;if(this.get_$C()){this.$6++;if($p0.get_$4()===1){$0=new Microsoft.Live.Core.LocalStorageProxy($p0.get_$3(),null,1);}else{$0=new Microsoft.Live.Core.LocalStorageProxy($p0.get_$3(),null);}}else{if($p0.get_$4()===1){$0=new Microsoft.Live.Core.LocalStorage($p0.get_$3(),1);}else{$0=new Microsoft.Live.Core.LocalStorage($p0.get_$3());}}if(this.$4){$p0.$5($0);}this.$2[$p0.get_$3()]=$0;return $0;},get_item:function($p0){return this.$2[$p0];}}
MSLS.LocalStorageService=function(hostingDomain){this.$2=MSH.DateTimeHelper.minValue;this.$3=MSH.DateTimeHelper.minValue;this.$23=['live.com','live-int.com','msn.com','msn-int.com','microsoft.com','livejournal.com'];this.$6=0;this.$5={};this.$4B(hostingDomain);this.$8=[];this.$4=new MSLS.LS$7(MSLS.LocalStorageService.$4A(this.$9));this.$27=new Microsoft.Live.Core.LocalStorageInitializedEventArgs(0);MSLS.LocalStorageService.$1.add_$B(ss.Delegate.create(this,this.$2A));}
MSLS.LocalStorageService.$4A=function($p0){return MSCo.HashHelper.computeFastHash($p0,'domain');}
MSLS.LocalStorageService.prototype={$4:null,$5:null,$6:0,$8:null,$9:null,$A:null,$B:false,$C:null,$D:false,$24:null,add_$25:function($p0){this.$26=ss.Delegate.combine(this.$26,$p0);},remove_$25:function($p0){this.$26=ss.Delegate.remove(this.$26,$p0);},$26:null,$27:null,get_usesLocalStorageProxy:function(){return MSLS.LocalStorageService.$1.get_$C();},add_initialized:function(value){this.add_$25(value);if(this.$27.get_status()!==0){value.invoke(this,this.$27);}},remove_initialized:function(value){this.remove_$25(value);},add_dataWritten:function(value){this.$28=ss.Delegate.combine(this.$28,value);},remove_dataWritten:function(value){this.$28=ss.Delegate.remove(this.$28,value);},$28:null,add_dataRead:function(value){this.$29=ss.Delegate.combine(this.$29,value);},remove_dataRead:function(value){this.$29=ss.Delegate.remove(this.$29,value);},$29:null,add_instancesChanged:function(value){this.$4.add_$E(value);},remove_instancesChanged:function(value){this.$4.remove_$E(value);},get_status:function(){return this.$27.get_status();},$2A:function($p0,$p1){MSLS.LocalStorageService.$1.remove_$B(ss.Delegate.create(this,this.$2A));if($p1.get_status()===1){this.$4.$1A(MSLS.LocalStorageService.$1.get_item('Messenger2.INST'));this.$46();this.$47();this.$2E();this.$4C();}this.$27=$p1;if(this.$26!=null){this.$26.invoke(this,$p1);}},get_lastWriteTime:function(){this.$3F();return this.$3;},get_lastReadTime:function(){return this.$2;},get_revision:function(){return this.$6;},get_currentInstances:function(){return this.$4.get_$12();},get_signInStatusResponseInfo:function(){return this.$31(1,ss.Delegate.create(this,this.$37),ss.Delegate.create(this,this.$39),'Messenger2.SSR',null,0);},set_signInStatusResponseInfo:function(value){this.$30(value,1,ss.Delegate.create(this,this.$37),ss.Delegate.create(this,this.$39),'Messenger2.SSR',null,0);return value;},get_networks:function(){return this.$31(4,ss.Delegate.create(this,this.$37),ss.Delegate.create(this,this.$39),'Messenger2.ABN',null,0);},set_networks:function(value){this.$30(value,4,ss.Delegate.create(this,this.$37),ss.Delegate.create(this,this.$39),'Messenger2.ABN',null,0);return value;},get_groups:function(){return this.$31(3,ss.Delegate.create(this,this.$37),ss.Delegate.create(this,this.$39),'Messenger2.ABG',null,0);},set_groups:function(value){this.$30(value,3,ss.Delegate.create(this,this.$37),ss.Delegate.create(this,this.$39),'Messenger2.ABG',null,0);return value;},get_contacts:function(){return this.$31(2,ss.Delegate.create(this,this.$37),ss.Delegate.create(this,this.$39),'Messenger2.ABC',null,0);},set_contacts:function(value){this.$30(value,2,ss.Delegate.create(this,this.$37),ss.Delegate.create(this,this.$39),'Messenger2.ABC',null,0);return value;},get_userSettingsInfo:function(){return this.$31(5,ss.Delegate.create(this,this.$37),ss.Delegate.create(this,this.$39),'Messenger2.ABS',null,0);},set_userSettingsInfo:function(value){this.$30(value,5,ss.Delegate.create(this,this.$37),ss.Delegate.create(this,this.$39),'Messenger2.ABS',null,0);return value;},get_configurationInfo:function(){return this.$31(6,ss.Delegate.create(this,this.$37),ss.Delegate.create(this,this.$39),'Messenger2.CFG',null,0);},set_configurationInfo:function(value){this.$30(value,6,ss.Delegate.create(this,this.$37),ss.Delegate.create(this,this.$39),'Messenger2.CFG',null,0);return value;},get_messengerSessionState:function(){return this.$31(7,ss.Delegate.create(this,this.$37),ss.Delegate.create(this,this.$39),'Messenger1.SES',null,0);},set_messengerSessionState:function(value){this.$30(value,7,ss.Delegate.create(this,this.$37),ss.Delegate.create(this,this.$39),'Messenger1.SES',null,0);if(this.$4.get_$11()){if(ss.isNullOrUndefined(value)){if(this.$2F()){this.$43();}}else{var $0=false;switch(value.services){case 3:case 0:$0=true;break;}this.$4.$18($0);}}return value;},get_messengerSessionEvents:function(){return this.$31(8,ss.Delegate.create(this,this.$37),ss.Delegate.create(this,this.$39),'Messenger1.SEE',null,0);},set_messengerSessionEvents:function(value){this.$30(value,8,ss.Delegate.create(this,this.$37),ss.Delegate.create(this,this.$39),'Messenger1.SEE',null,0);return value;},get_signInResponseInfo:function(){var $0=null;var $1=MSCo.LocalStorageMemoryService.createMessengerSessionInfoFromStorage(this.get_messengerSessionState(),this.get_messengerSessionEvents());var $2=this.get_configurationInfo();var $3=this.get_contacts();var $4=this.get_groups();var $5=this.get_userSettingsInfo();var $6=this.get_networks();if($1!=null&&$2!=null&&$3!=null&&$4!=null&&$5!=null&&$6!=null){$0=MC.$create_SignInResponse($2,$1,$6,$4,$3,$5);}return $0;},set_signInResponseInfo:function(value){if(value!=null){this.set_groups(value.groups);this.set_contacts(value.contacts);this.set_networks(value.networks);this.set_configurationInfo(value.clientConfiguration);this.set_userSettingsInfo(value.settings);var $0=value.messengerSession;$0.services=value.services;this.set_messengerSessionEvents(MC.$create_MessengerSessionEvents($0.pendingEvents));this.set_messengerSessionState(MC.$create_MessengerSessionState($0.server,$0.sessionToken,$0.transactionID,$0.services,$0.disconnected));}else{this.set_groups(null);this.set_contacts(null);this.set_networks(null);this.set_configurationInfo(null);this.set_userSettingsInfo(null);this.set_messengerSessionEvents(null);this.set_messengerSessionState(null);}return value;},get_applicationInfo:function(){return this.$31(13,ss.Delegate.create(this,this.$37),ss.Delegate.create(this,this.$38),'Messenger2.APP',null,0);},set_applicationInfo:function(value){this.$30(value,13,ss.Delegate.create(this,this.$37),ss.Delegate.create(this,this.$38),'Messenger2.APP',null,0);return value;},get_appContactsTicketInfo:function(){return this.$31(14,ss.Delegate.create(this,this.$37),ss.Delegate.create(this,this.$38),'Messenger2.APC',null,0)||null;},set_appContactsTicketInfo:function(value){this.$30(value,14,ss.Delegate.create(this,this.$37),ss.Delegate.create(this,this.$38),'Messenger2.APC',null,0);return value;},get_appContactsPresenceInfo:function(){return this.$31(15,ss.Delegate.create(this,this.$37),ss.Delegate.create(this,this.$38),'Messenger2.APCI',null,0)||null;},set_appContactsPresenceInfo:function(value){this.$30(value,15,ss.Delegate.create(this,this.$37),ss.Delegate.create(this,this.$38),'Messenger2.APCI',null,0);return value;},get_conversations:function(){return this.$31(9,ss.Delegate.create(this,this.$37),ss.Delegate.create(this,this.$3E),'Messenger2.CONV',null,0);},set_conversations:function(value){this.$30(value,9,ss.Delegate.create(this,this.$37),ss.Delegate.create(this,this.$3E),'Messenger2.CONV',null,1);return value;},get_alerts:function(){return this.$31(12,ss.Delegate.create(this,this.$37),ss.Delegate.create(this,this.$39),'Messenger2.ALT',null,0)||null;},set_alerts:function(value){this.$30(value,12,ss.Delegate.create(this,this.$37),ss.Delegate.create(this,this.$39),'Messenger2.ALT',null,0);return value;},saveConversationMessage:function(conversationId,message){if(ss.isNullOrUndefined(message)||message.type===255){return;}var $0=(this.$5[conversationId]||0);this.$36(conversationId,message,$0++);this.$33(conversationId,$0);},deletePersistedConversationMessages:function(conversationId){var $0=this.$3D(null,conversationId);this.$44(MSLS.LocalStorageService.$1.get_item('Messenger2.CH'),$0);delete this.$5[conversationId];},updatePersistedConversationMessageIds:function(oldId,newId){var $0=this.getConversationPersistedMessages(oldId);if($0==null||$0.length===0){return;}this.deletePersistedConversationMessages(oldId);this.$5[newId]=$0.length;for(var $1=0;$1<$0.length;$1++){this.$36(newId,$0[$1],$1);}},getConversationPersistedMessages:function(conversationId){var $0=this.$35(conversationId);return $0;},clearUserSession:function(){if(!this.$4.get_$11()){this.$B=true;}else{this.set_networks(null);this.set_groups(null);this.set_contacts(null);this.set_userSettingsInfo(null);this.set_configurationInfo(null);this.set_messengerSessionState(null);this.set_messengerSessionEvents(null);this.set_signInStatusResponseInfo(null);this.set_appContactsTicketInfo(null);this.$B=false;}},clearAllPersistedData:function(){Object.clearKeys(this.$5);this.$45(null);},onSignedOut:function(preserveInstance){this.$4.$19(preserveInstance);},initializeUserStorage:function(userTicket,userId,callback){if(String.isNullOrEmpty(userId)&&(String.isNullOrEmpty(userTicket)||userTicket==='none')){callback.invoke(false);return;}this.$24=callback;if(!String.isNullOrEmpty(userTicket)){userTicket=MSCo.HashHelper.computeFastHash(userTicket,String.Empty);}if(!String.isNullOrEmpty(userId)){userId=MSCo.HashHelper.computeFastHash(userId,'_user');}this.$4.$16(userTicket,userId,ss.Delegate.create(this,this.$2C));},refreshConversationData:function(refreshCallback){this.$C=refreshCallback;this.$D=false;var $0=MSLS.LocalStorageService.$1.get_item('Messenger2.CONV');var $1=MSLS.LocalStorageService.$1.get_item('Messenger2.CH');$0.add_refreshed(ss.Delegate.create(this,this.$2D));$1.add_refreshed(ss.Delegate.create(this,this.$2D));Object.clearKeys(this.$5);$0.refresh();$1.refresh();},get_$2B:function(){return this.$8.length;},$2C:function($p0){var $0=this.$24;this.$24=null;if($p0){if(this.$B){this.clearUserSession();}var $1=this.$4.$17();var $enum1=ss.IEnumerator.getEnumerator($1);while($enum1.moveNext()){var $2=$enum1.get_current();this.$45($2);}}$0.invoke($p0);},$2D:function($p0,$p1){($p0).remove_refreshed(ss.Delegate.create(this,this.$2D));if(this.$D){var $0=this.$C;this.$C=null;$0.invoke();}else{this.$D=true;}},$2E:function(){if(!this.$8.contains(this.$9)){this.$8.enqueue(this.$9);this.$49();}},$2F:function(){var $0=this.$4.get_$12();var $1=this.$4.get_$13();var $enum1=ss.IEnumerator.getEnumerator($0);while($enum1.moveNext()){var $2=$enum1.get_current();if($2.id!==$1){return false;}}return true;},$30:function($p0,$p1,$p2,$p3,$p4,$p5,$p6){var $0=$p2.invoke($p4,$p5);var $1=$p3.invoke($p4,$p5);if($1==null){return;}var $2=($p6&1)===1;this.$4E($0,$1,$p0,$2);this.$48();if(($p6&2)!==2){this.$40($p1,$p0);}},$31:function($p0,$p1,$p2,$p3,$p4,$p5){var $0=$p1.invoke($p3,$p4);var $1=$p2.invoke($p3,$p4);if($1==null){return null;}this.$2=Date.get_now();var $2=this.$4F($0,$1);if(($p5&2)!==2){this.$42($p0,$2);}return $2;},$32:function($p0){if(Object.keyExists(this.$5,$p0)){return this.$5[$p0];}var $0=this.$31(10,ss.Delegate.create(this,this.$37),ss.Delegate.create(this,this.$3B),'Messenger2.CH',$p0,2);this.$5[$p0]=($0==null)?0:$0;return this.$5[$p0];},$33:function($p0,$p1){this.$30($p1,10,ss.Delegate.create(this,this.$37),ss.Delegate.create(this,this.$3B),'Messenger2.CH',$p0,2|1);this.$5[$p0]=$p1;},$34:function($p0,$p1){return this.$31(10,ss.Delegate.create(this,this.$37),ss.Delegate.create(this,function($p1_0,$p1_1){return this.$3D($p1_0,$p1_1)+'_'+$p1;}),'Messenger2.CH',$p0,2);},$35:function($p0){var $0=this.$32($p0);var $1=[];for(var $2=0;$2<$0;$2++){var $3=this.$34($p0,$2);if($3!=null){$1.add($3);}}return MSH.CollectionHelper.toArray($1);},$36:function($p0,$p1,$p2){this.$30($p1,10,ss.Delegate.create(this,this.$37),ss.Delegate.create(this,function($p1_0,$p1_1){return this.$3D($p1_0,$p1_1)+'_'+$p2;}),'Messenger2.CH',$p0,2|1);},$37:function($p0,$p1){return $p0;},$38:function($p0,$p1){return MSLS.LocalStorageService.$4A(this.$9);},$39:function($p0,$p1){if(!this.$4.get_$11()){return null;}return this.$3A(this.$4.get_$13());},$3A:function($p0){var $0=this.$3E(null,null);$0+='_id';$0+=$p0;return $0;},$3B:function($p0,$p1){return this.$3D($p0,$p1)+'_count';},$3C:function($p0,$p1){if(!this.$4.get_$11()){return null;}var $0=this.$39(null,null);$0+=MSCo.HashHelper.computeFastHash($p1,'_key');return $0;},$3D:function($p0,$p1){if(!this.$4.get_$11()){return null;}var $0=this.$3E(null,null);$0+=MSCo.HashHelper.computeFastHash($p1,'_key');return $0;},$3E:function($p0,$p1){if(!this.$4.get_$11()){return null;}var $0=MSLS.LocalStorageService.$4A(this.$9);$0+=this.$4.get_$14();return $0;},$3F:function(){if(this.$3.getTime()===0){var $0=this.$4F('Messenger2.StatusGroup',this.$3C(null,'LWT'));if(!ss.isNullOrUndefined($0)){this.$3=new Date($0);}}},$40:function($p0,$p1){this.$6++;this.$41();if(this.$28!=null){this.$28.invoke(this,new MC.LocalStorageDataReadWriteEventArgs(this.$6,$p0,$p1));}},$41:function(){this.$3=Date.get_now();this.$4E('Messenger2.StatusGroup',this.$3C(null,'LWT'),this.$3.getTime(),false);},$42:function($p0,$p1){this.$2=Date.get_now();if(this.$29!=null){this.$29.invoke(this,new MC.LocalStorageDataReadWriteEventArgs(this.$6,$p0,$p1));}},$43:function(){var $0=this.$3E(null,null);if($0==null){return;}Object.clearKeys(this.$5);this.$44(MSLS.LocalStorageService.$1.get_item('Messenger2.CH'),$0);this.$44(MSLS.LocalStorageService.$1.get_item('Messenger2.CONV'),$0);},$44:function($p0,$p1){if(String.isNullOrEmpty($p1)){$p0.clear();return;}var $0=[];var $enum1=ss.IEnumerator.getEnumerator($p0);while($enum1.moveNext()){var $1=$enum1.get_current();if($1.indexOf($p1)>=0){$0.enqueue($1);}}while($0.length>0){var $2=$0.dequeue().toString();$p0.set_item($2,null);}},$45:function($p0){var $0=MSLS.LocalStorageService.$1.get_$A();var $dict1=$0;for(var $key2 in $dict1){var $1={key:$key2,value:$dict1[$key2]};var $2=$1.value;this.$44($2,$p0);}},$46:function(){var $0=this.$4F('Messenger2.StatusGroup','VER');if(String.isNullOrEmpty($0)||$0!==MSCo.Configuration.get_clientVersion()){this.$45(null);this.$4E('Messenger2.StatusGroup','VER',MSCo.Configuration.get_clientVersion(),true);}},$47:function(){var $0=this.$4F('Messenger2.StatusGroup','SGAD');if(!ss.isNullOrUndefined($0)){for(var $1=0,$2=$0.length;$1<$2;$1++){this.$8.enqueue($0[$1]);}}},$48:function(){var $0=0;while(this.$8.length>2){var $1=this.$8.dequeue().toString();this.$45(MSLS.LocalStorageService.$4A($1));$0++;}if($0>0){this.$49();}},$49:function(){var $0=new Array(this.$8.length);var $1=[];var $2=0;while(this.$8.length>0){$0[$2]=this.$8.dequeue().toString();$1.enqueue($0[$2]);$2++;}this.$4E('Messenger2.StatusGroup','SGAD',$0,false);this.$8=$1;},$4B:function($p0){if(String.isNullOrEmpty($p0)){this.$9=document.domain;return;}this.$9=$p0.toLowerCase();for(var $0=0,$1=this.$23.length;$0<$1;$0++){var $2=this.$23[$0];if(this.$9===$2||this.$9.endsWith('.'+$2)){this.$9=this.$23[$0];break;}}if(this.$9==='msn.com'){this.$9='live.com';}if(this.$9==='msn-int.com'){this.$9='live-int.com';}},$4C:function(){this.$A=new MSH.Timer(ss.Delegate.create(this,this.$4D),null,60000,60000);},$4D:function($p0){this.$41();},$4E:function($p0,$p1,$p2,$p3){if($p1==null){return;}var $0=MSLS.LocalStorageService.$1.get_item($p0);$0.set_item($p1,$p2);if($p3){$0.flush();}},$4F:function($p0,$p1){if($p1==null){return null;}var $0=MSLS.LocalStorageService.$1.get_item($p0);var $1=$0.get_item($p1);return $1;}}
MSLS.LS$7.registerClass('MSLS.LS$7');MSLS.LS$6.registerClass('MSLS.LS$6');MSLS.LS$9.registerClass('MSLS.LS$9',MSLS.LS$6);MSLS.LS$8.registerClass('MSLS.LS$8',MSLS.LS$6);MSLS.LS$3.registerClass('MSLS.LS$3');MSLS.LS$4.registerClass('MSLS.LS$4');MSLS.LocalStorageService.registerClass('MSLS.LocalStorageService',null,MC.ILocalStorageService);MSLS.LS$7.$0='Messenger2.INST';MSLS.LS$7.$1=null;MSLS.LS$7.$C=5*1000;MSLS.LS$7.$D=2*60*1000;MSLS.LS$6.$0=null;(function(){MSLS.LS$6.$0=new RegExp('(\\$|\\^|\\/|\\.|\\*|\\+|\\?|\\||\\(|\\)|\\[|\\]|\\{|\\}|\\\\)','g');})();MSLS.LocalStorageService.$0=['Messenger1','Messenger2'];MSLS.LocalStorageService.$1=null;(function(){MSLS.LocalStorageService.$1=new MSLS.LS$4([new MSLS.LS$3('Messenger2.StatusGroup',1,null),new MSLS.LS$3('Messenger2.SSR',2,new MSLS.LS$8()),new MSLS.LS$3('Messenger2.CONV',1,null),new MSLS.LS$3('Messenger2.CH',1,null),new MSLS.LS$3('Messenger2.ALT',2,null),new MSLS.LS$3('Messenger2.APP',2,null),new MSLS.LS$3('Messenger2.APC',2,null),new MSLS.LS$3('Messenger2.APCI',2,null),new MSLS.LS$3('Messenger2.ABC',2,new MSLS.LS$9()),new MSLS.LS$3('Messenger2.ABG',2,new MSLS.LS$9()),new MSLS.LS$3('Messenger2.ABN',2,null),new MSLS.LS$3('Messenger2.ABS',2,null),new MSLS.LS$3('Messenger2.CFG',2,new MSLS.LS$9()),new MSLS.LS$3('Messenger1.SES',2,new MSLS.LS$9()),new MSLS.LS$3('Messenger1.SEE',2,new MSLS.LS$9()),new MSLS.LS$3('Messenger2.SST',2,null),new MSLS.LS$3('Messenger2.ANONA',2,null),new MSLS.LS$3('Messenger1.SIR',2,null)],MSLS.LocalStorageService.$0);})();});