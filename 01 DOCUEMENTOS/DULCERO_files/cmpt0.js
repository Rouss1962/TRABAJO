new function(){function a(d){function a(b,a,c){if(!b[a])b[a]=c}function b(b){b.__usingCompat=true;b.__lastKnownException=null;if(!b["FunctionHelper"])b["FunctionHelper"]={};a(b.Document.prototype,"contains",function(a){while(a!=null&&a!=this)a=a.parentNode;return a!=null})}function c(a){b(a)}c(d)}$Browser.addExtension(a)};new function(){function a(a){FunctionHelper.isSpecialMember=function b(b,a){return !b.hasOwnProperty(a)};FunctionHelper._wrapMethodImpl=function c(f,e,b,d){var c=function g(){try{return b.apply(this,arguments)}catch(c){if(a.__lastKnownException!==c){a.__lastKnownException=c;a.__stack=[]}b.args=[];var j=arguments.length;for(var g=0;g<j;g++)b.args.push(arguments[g]);if(d)a.__stack.push(b.__tcw);else a.__stack.push(b);if(d&&a.onerror){var i=c.lineNumber||c.line,h=c.fileName||c.sourceURL;a.onerror(String.format("{0}.{1} - {2}",f,e,c.message),h,i);return}throw c;}};if(d)b.__tcw=c;c.__original=b;c.__debugName=f+"."+e;return c};FunctionHelper.wrapMethod=function FunctionHelper$wrapMethod(b,a,c){return FunctionHelper._wrapMethodImpl(b,a,c,false)};FunctionHelper.wrapTopLevelMethod=function e(b,a,c){return FunctionHelper._wrapMethodImpl(b,a,c,true)};FunctionHelper.needsWrapping=function d(a){return typeof a=="function"&&a.__typeName===undefined&&a.__original===undefined}}$Browser.addExtension(a)};new function(){function a(a){if($B.SF_M2)return;a.HTMLElement.prototype.__defineGetter__("document",function(){return a.document})}$Browser.addExtension(a)};new function(){function a(a){if($B.SF_M2)return;var l=a.HTMLDocument.prototype;a.__oldCR=a.document.createRange;a.document.createRange=function m(){var b=a.__oldCR.call(a.document);return e(b)};function e(b){b.__defineGetter__("text",function(){return this.cloneContents().textContent||""});b.__defineSetter__("text",function(b){this.insertNode(a.document.createTextNode(b))});b.__defineGetter__("htmlText",function(){var b=a.document.createElement("div");b.appendChild(this.cloneContents());return b.innerHTML});b.__defineGetter__("parentElement",function(){return this.commonAncestorContainer});b.moveToElementText=function g(a){b.selectNodeContents(a)};b.execCommand=function j(c,d,b){return a.document.execCommand(c,d||false,b||null)};b.queryCommandEnabled=function f(b){return a.document.queryCommandEnabled(b)};b.queryCommandState=function h(b){try{return a.document.queryCommandState(b)||false}catch(c){return false}};b.queryCommandIndeterm=function e(b){return a.document.queryCommandIndeterm(b)};var c=["bold","italic","underline","fontname","fontsize","justifyleft","justifyright","justifycenter","insertorderedlist","insertunorderedlist","indent","outdent","createlink","forecolor","hilitecolor","inserthorizontalrule"];b.queryCommandSupported=function d(a){return c.exists(a)};b.queryCommandValue=function i(b){return a.document.queryCommandValue(b)};b.select=function l(){if(a.document.designMode=="on")a.focus();else{a.getSelection().removeAllRanges();a.getSelection().addRange(b)}};b.__defineGetter__("parentElement",function(){return function(){var a=this.commonAncestorContainer;if(a.nodeType==3)a=a.parentNode;return a}});b.pasteHTML=function k(a){b.execCommand("insertHTML",false,a)};return b}function c(){}function i(){a.getSelection().deleteFromDocument()}function j(){a.getSelection().removeAllRanges()}function f(){var b=a.getSelection();if(b.rangeCount==0)b.collapse(a.document.body,0);return e(b.getRangeAt(0))}c.prototype={clear:i,empty:j,createRange:f};c.prototype.__defineGetter__("type",function(){var b=a.getSelection();if(b.rangeCount>0)return "Text";return "None"});l.selection=new c;a.__selChangeTimeout=null;function h(a){while(a&&a.tagName!="BODY"){if(a.getAttribute&&a.getAttribute("contenteditable")=="true")return true;a=a.parentNode}return false}function b(b){if(a.document.designMode=="on"||h(b.srcElement)){if(a.__selChangeTimeout)clearTimeout(a.__selChangeTimeout);a.__selChangeTimeout=setTimeout(g,100)}}function g(){clearTimeout(a.__selChangeTimeout);a.__selChangeTimeout=null;k("selectionchange",a.document)}function k(c,d){var b=a.document.createEvent("Event");b.initEvent(c,true,false);d.dispatchEvent(b)}function d(){var c=a.document;c.addEventListener("DOMCharacterDataModified",b,false);c.addEventListener("mouseup",b,false);c.addEventListener("keydown",b,false);c.addEventListener("keyup",b,false)}if(!a.document.body)a.addEventListener("load",d,false);else d()}$Browser.addExtension(a)};new function(){function a(a){var h=a.HTMLElement.prototype.attachEvent;function d(b,c){if(b=="onresize"&&this!=a){if(this._onResized)return;this._onResized=true;if(c._isFirst)a.__firstElt={elt:this,width:-1,height:-1};else a.__eltsToScan.push({elt:this,width:-1,height:-1});b="__compatOnResize"}h.call(this,b,c)}var i=a.HTMLElement.prototype.detachEvent;function e(c,d){if(c=="onresize"&&this!=a)for(var b=a.__eltsToScan.length-1;b>=0;b--){if(a.__eltsToScan[b].elt!=this)continue;a.__eltsToScan.splice(b,1)}i.call(this,c,d)}a.attachEvent=a.HTMLDocument.prototype.attachEvent=d;a.detachEvent=a.HTMLDocument.prototype.detachEvent=e;if(!a._dontOverrideHtmlElementEvents){a.HTMLElement.prototype.attachEvent=d;a.HTMLElement.prototype.detachEvent=e}var k=false;a.__eltsToScan=[];a.__firstElt=null;function c(){var f=a.document.getElementsByTagName("S"),c;for(var b=f.length-1;b>=0;b--){c=f[b];if(c.getAttribute("ns")!="rs")continue;var g=c[c.getAttribute("ref")||"parentElement"],e=new Function(g.getAttribute("onresize"));e._isFirst=c.getAttribute("doFirst")!=null;g.attachEvent("onresize",e)}if(a.__firstElt&&!a.__checkElement(a.__firstElt,true))a.__firstElt=null;var d=a.__eltsToScan;for(var b=d.length-1;b>=0;b--)if(!a.__checkElement(d[b],false))d.splice(b,1);a.__forceUpdate=false}a.__checkElement=function l(b,e){if(!b)return false;var c=b.elt;while(c&&c.tagName!="HTML")c=c.parentElement;if(!c||!c.tagName)return false;if(a.__forceUpdate||b.elt.offsetWidth!=b.width||b.elt.offsetHeight!=b.height){var d=a.document.createEvent("UIEvents");d.initUIEvent("compatOnResize",false,false,a,1);b.elt.dispatchEvent(d);b.width=b.elt.offsetWidth;b.height=b.elt.offsetHeight;if(e)a.__forceUpdate=true}return true};a.__rsTimer=null;function g(){if(a.__rsTimer!=null){a.clearTimeout(a.__rsTimer);a.__rsTimer=null}}function b(){if(a.__rsTimer&&a.__rsTimer.type=="interval")return;g();a.__rsTimer=a.setTimeout(function(){c();g()},100);a.__rsTimer.type="timeout"}function f(){if(a.__rsTimer!=null){a.clearInterval(a.__rsTimer);a.__rsTimer=null}}function j(){f();a.__rsTimer=a.setInterval(c,250);a.__rsTimer.type="interval"}a.__scanUI=function(){a.__forceUpdate=true;b()};a.addEventListener("keydown",function(b){if(b.keyCode==17&&a.__rsTimer==null)j()},true);a.addEventListener("keyup",function(a){if(a.keyCode==17){c();f()}},true);a.addEventListener("resize",function(){b()},true);a.attachEvent("onresize",function(){b()});a.attachEvent("onfocusin",function(){if(a.__userLeftBrowser)c()});a.addEventListener("load",function(){if(!$B.Safari){var c=a.CSSStyleDeclaration;c._oldDisplay=c.prototype.__lookupSetter__("display");if(c._oldDisplay)c.prototype.__defineSetter__("display",function(a){c._oldDisplay.call(this,a);b()});c._oldHeight=c.prototype.__lookupSetter__("height");if(c._oldHeight)c.prototype.__defineSetter__("height",function(a){c._oldHeight.call(this,a);b()});c._oldWidth=c.prototype.__lookupSetter__("width");if(c.oldWidth)c.prototype.__defineSetter__("width",function(a){c._oldWidth.call(this,a);b()})}a.document.body.addEventListener("DOMAttrModified",function(){b()},true);a.document.body.addEventListener("DOMNodeInserted",function(){b()},true);a.document.body.addEventListener("DOMNodeRemoved",function(){b()},true);b()},false)}$Browser.addExtension(a)}