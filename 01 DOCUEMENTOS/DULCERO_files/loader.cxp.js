/* Copyright (C) 2011 Microsoft Corporation */if(!window.Microsoft)window.Microsoft={__namespace:true};if(!window.Microsoft.Live)window.Microsoft.Live={__namespace:true};if(!window.Microsoft.Live.Core)window.Microsoft.Live.Core={__namespace:true};Microsoft.Live.Core.Loader=function(){this._detectBrowsers();this._detectFlash();this._detectSecureConnection();this._addDocumentReadyListener();this._resolveMarket();this._resolveDirection();this._runtimeCheck()};Microsoft.Live.Core.Loader.prototype={_loadInitiated:false,_paused:false,_processing:false,_processScheduled:false,_loadRequests:[],_readyRequests:[],_errorRequests:[],_domRequests:[],_onLoad:null,_documentReady:false,_browser:{},_iframeResources:[],_settingRegEx:/(\{[^\}^\{]+\})/g,_startTime:(new Date).getTime(),_loadTime:null,_validRuntime:true,_resources:{Empty1:{filename:"{messenger.baseScriptUrl}/Empty.js?1",type:"script",browsers:function(a,b){return a["ie"]&&b["httpsApplication"]},dependencies:[]},Empty2:{filename:"{messenger.baseScriptUrl}/Empty.js?2",type:"script",browsers:function(a,b){return a["ie"]&&b["httpsApplication"]},dependencies:[]}},_settings:{environment:"production",direction:"ltr",configuration:"release",market:"en-us",resourceMarket:"en",customSettings:"",httpsApplication:false,httpsScope:"content",compatibility:{microsoftAjaxPropertyNames:true,version:"current"}},_supportedMarkets:["ar","ar-ploc-sa","bg","cs","da","de","el","en","es","et","fi","fr","he","hr","hu","it","ja","ja-ploc-jp","ko","lt","lv","nb-no","nl","pl","pt-br","pt-pt","ro","ru","sk","sl","sr","sv","th","tr","uk","zh-cn","zh-hk","zh-tw"],addScript:function(b,c,a){this._addFeature(b,"script",c,a)},addStyleSheet:function(a,c,b){this._addFeature(a,"stylesheet",c,b)},isFlashInstalled:function(a){return a<=this._browser.flashVersion},get_settings:function(){return this._settings},get_onLoad:function(){return this._onLoad},get_onLoadRegistered:function(){return this._onLoad!=null},get_documentReady:function(){return this._documentReady},get_scriptsLoadTime:function(){return this._loadTime},getIframeContainer:function(c){var b=this._resources[c];if(b&&b.containerId)for(var a=this._iframeResources.length-1;a>=0;a--)if(this._iframeResources[a].containerId==b.containerId)return this._iframeResources[a].frameContainer;return null},initialize:function(a){if(!a||!this._validRuntime)return;this._serializeSettings(a);if(a.environment&&a.environment!="production")for(var f in this._settings){var d=this._settings[f];if(!d)continue;var c=d[a.environment];if(c)for(var g in c)d[g]=c[g]}for(var b in a){var i=b.split("."),h=i.pop(),e=this._getSubSetting(i);if(!e||typeof e[h]=="undefined")throw new Error("Invalid setting: "+b);switch(b){case "market":this._tryUpdateMarket(a[b]);break;case "direction":this._tryUpdateDirection(a[b]);break;default:e[h]=a[b]}}for(var f in this._settings)if(this._settings[f].updateSettings)this._settings[f].updateSettings(this._settings,this._resources)},load:function(a,e){if(!this._validRuntime)return;if(typeof a=="string")a=[a];if(!a||a.length<=0)throw new Error("No features provided");var d=[];for(var c=0;c<a.length;c++){if(a[c].indexOf("_")>=0)throw new Error("Feature '%1' does not exist".replace("%1",a[c]));var b=this._normalizeName(a[c]);if(!this._resources[b])throw new Error("Feature '%1' does not exist".replace("%1",b));if(this._resources[b].httpOnly&&this._settings.httpsApplication)throw new Error("Feature '%1' is not supported in an HTTPS environment".replace("%1",b));d.push(b)}this._loadInitiated=true;this._loadRequests.push({resources:d,callback:e});this._process()},onReady:function(a){if(!a)throw new Error("No callback provided");if(this._loadInitiated&&this._loadRequests.length==0){this._invokeCallback(a);return}this._readyRequests.push({callback:a})},onError:function(a){if(!a)throw new Error("No callback provided");this._errorRequests.push({callback:a})},onLoad:function(a){if(!a)throw new Error("No callback provided");this._onLoad=a},fireOnLoad:function(){if(this._onLoad)this._onLoad()},onDocumentReady:function(a){if(!a)throw new Error("No callback provided");if(this._documentReady){this._invokeCallback(a);return}this._domRequests.push({callback:a})},pause:function(){this._paused=true},resume:function(){this._paused=false;this._process()},onResourceAvailable:function(b,c){var a=this._resources[b];if(!a)return;a.readyState="available";a.onAvailableCallback=c||null},_getResourceName:function(b){for(var a in this._resources)if(this._resources[a]===b)return a.replace(/_/g,".");return null},_addFeature:function(a,f,c,b){if(!a||a.length==0)throw new Error("featureName must not be empty");if(a.indexOf("_")>=0)throw new Error("featureName cannot contain '_'");if(!c||c.length==0)throw new Error("fileName must not be empty");a=this._normalizeName(a);if(this._resources[a])throw new Error("Feature already exists");var e=[];if(b){if(!this._isArray(b))throw new Error("dependencies must be an array of strings");for(var d=0;d<b.length;d++)e.push(this._normalizeName(b[d]))}this._resources[a]={url:c,type:f,dependencies:e}},_addManifest:function(g,c,b){if(!this._validRuntime)return;if(c){var f=["Empty1","Empty2"];for(var a in c){if(this._resources[a])throw new Error("Resource '%1' already exists".replace("%1",a));var e=c[a],d=e.dependencies;d.push.apply(d,f);this._resources[a]=e}}if(b){this._settings[g]=b;if(b.updateSettings)b.updateSettings(this._settings,this._resources,null)}},_normalizeName:function(a){return a.toLowerCase().replace(/\./g,"_")},_process:function(){if(this._paused)return;if(this._processing){this._processScheduled=true;return}this._processing=true;for(var b=0;b<this._loadRequests.length;b++){var a=this._loadRequests[b],c={async:0,sync:0};for(var d=0;d<a.resources.length;d++)this._loadResources(this._resources[a.resources[d]],c);var e=c.async+c.sync;if(e==0&&!this._loadTime)this._loadTime=(new Date).getTime()-this._startTime;if(e==0&&this._documentReady){if(a.callback)this._invokeCallback(a.callback);this._loadRequests.splice(b--,1)}}if(this._loadRequests.length==0)while(this._readyRequests.length>0){var f=this._readyRequests.shift();this._invokeCallback(f.callback)}this._processing=false;if(this._processScheduled){this._processScheduled=false;this._process()}},_loadResources:function(a,b){switch(a.readyState){case "loaded":break;case "loading":if(a.async)b.async++;else b.sync++;break;case "available":this._loadResourceDependencies(a,b);if(b.async==0&&b.sync==0){if(a.onAvailableCallback&&!a.onAvailableCallbackCalled){a.onAvailableCallbackCalled=true;a.onAvailableCallback.call()}a.readyState="loaded"}else b.async++;break;default:this._loadResourceDependencies(a,b);if(a.async){if(b.sync==0){this._loadResource(a);b.async++}}else if(b.async==0&&b.sync==0){this._loadResource(a);b.sync++}}},_loadResourceDependencies:function(c,d){for(var b=0;b<c.dependencies.length;b++){var a={async:0,sync:0};this._loadResources(this._resources[c.dependencies[b]],a);d.async+=a.async;d.sync+=a.sync}},_loadResource:function(a){a.readyState="loading";if(!a.filename&&!a.url){this._onResourceLoaded(a);return}if(!this._browserRequires(a)){this._onResourceLoaded(a);return}switch(a.type){case "script":this._loadScript(a);break;case "stylesheet":this._loadStyleSheet(a);break;case "channeliframe":case "storageiframe":this._loadIFrame(a)}},_shouldUseHttps:function(a){if(this._settings.httpsApplication){if(this._settings.httpsScope=="all")return true;if(this._settings.httpsScope=="content")switch(a){case "content":case "script":case "stylesheet":return true}if(a=="storageiframe")if(this._shouldProxyLocalStorage())return true}return false},_shouldProxyLocalStorage:function(){var b=!!(window.localStorage||window.globalStorage||window.sessionStorage),a=/msie 8/.test(navigator.userAgent.toLowerCase());return !!(this._settings.httpsApplication&&window.postMessage&&b&&!a)},_browserRequires:function(a){if(a.browsers)return a.browsers(this._browser,this._settings);return true},_loadScript:function(a){if(this._checkResourceLoaded(a))return;var c=this,b=this._createScriptElement();if(this._browser.ie)this._attachScriptEventsIE(b,c,a);else this._attachScriptEvents(b,c,a);if(a.async)this._setElementAttribute(b,"async","async");this._setScriptElementAttributes(b,a);this._appendScriptElement(b,a)},_checkResourceLoaded:function(a){if(a.isLoaded){this._onResourceLoaded(a);return true}return false},_createScriptElement:function(){return document.createElement("SCRIPT")},_attachScriptEvents:function(a,c,b){a.readyState="complete";a.addEventListener("load",function(a){c._onScriptLoad(a,b)},false);a.addEventListener("error",function(a){c._onScriptLoad(a,b)},false)},_attachScriptEventsIE:function(b,c,a){b.attachEvent("onreadystatechange",function(b){c._onScriptLoad(b,a)})},_setElementAttribute:function(a,c,b){a.setAttribute(c,b)},_setScriptElementAttributes:function(a,b){a.type="text/javascript";a.src=this._getResourceUrl(b)},_appendScriptElement:function(a){document.getElementsByTagName("HEAD")[0].appendChild(a)},_canPreloadIframe:function(b){switch(b.type){case "channeliframe":case "storageiframe":if(window.postMessage)return true;if(this.isFlashInstalled(8)&&!this._settings.channel.flashDisabled)return true;var a=document.domain.toLowerCase();if(a=="live.com"||a=="live-int.com")return true;return false;default:return true}},_loadIFrame:function(a){if(!a.containerId||!a.filename||!this._canPreloadIframe(a)){this._onResourceLoaded(a);return}var e=this._getResourceUrl(a),d=document.getElementById(a.containerId);if(!d){var b=document.createElement("div");b.id=a.containerId;b.style.height="1pt";b.style.width="1pt";b.style.position="absolute";b.style.top="-100px";d=b}var c=document.createElement("iframe");c.frameBorder="0";c.style.width="100%";c.style.height="100%";c.src=e;c.id=a.frameId;d.appendChild(c);a.frameContainer=d;this._iframeResources.push(a);this._appendIFrameResources();this._onResourceLoaded(a)},_loadStyleSheet:function(b){var a=document.createElement("LINK");a.type="text/css";a.rel="stylesheet";a.media="screen";a.href=this._getResourceUrl(b);this._appendChild(document.getElementsByTagName("HEAD")[0],a);this._onResourceLoaded(b)},_lookupSettings:function(c,g){var f=c.substring(1,c.length-1),d=f.split(".");if(d[0]=="resource")return c;var e=d.pop(),b=this._getSubSetting(d);if(b){var a=b[e];if(this._isArray(a))return this._hashSelect(a,g);if(typeof a==="function")return a.call(this);if(a||typeof a=="boolean"||typeof a=="number")return b[e]}return ""},_isArray:function(a){return a&&Object.prototype.toString.apply(a)==="[object Array]"},_hashSelect:function(b,c){var a=c.lastIndexOf("/");if(a<0)a=0;else a++;var d=this._computeFastHash(c.substring(a));return b[d%b.length]},_computeFastHash:function(b){if(!b||!b.length)return 0;var a=5381;for(var c=0,d=b.length;c<d;c++)a=(a<<5)+a+b.charCodeAt(c);if(a<0)a*=-1;return a},_getSubSetting:function(b){var a=this._settings;if(!b.length)return a;for(var c=0;c<b.length;c++){a=a[b[c]];if(!a)return null}return a},_getSecureUrl:function(a){if(a.indexOf("http:")==0)return a.replace("http:","https:");return a},_getResourceUrl:function(b){var a;if(b.url)a=b.url;else a=this._getUrlFromSettings(b.filename);if(this._shouldUseHttps(b.type))a=this._getSecureUrl(a);return a},_getUrl:function(c,b){var a=this._getUrlFromSettings(c);if(this._shouldUseHttps(b))a=this._getSecureUrl(a);return a},_getUrlFromSettings:function(b){var a=b,c=this;a=a.replace(this._settingRegEx,function(a){return c._lookupSettings(a,b)});a=a.replace(this._settingRegEx,function(a){return c._lookupSettings(a,b)});a=a.replace(/\/\//g,"/").replace(/:\//g,"://");return a},_onScriptLoad:function(b,a){if(a.readyState=="loaded")return;var c=b.srcElement||b.currentTarget;if(!c.readyState)c=b.currentTarget;if(c.readyState!="complete"&&c.readyState!="loaded")return;var d=b.type=="error"||a.async&&a.readyState!="available";if(d){if(this._retryLoadResource(a)){if(b.stopPropagation)b.stopPropagation()}else this._onResourceFailed(a);return}else if(a.async)this._onResourceAvailable(a);else this._onResourceLoaded(a)},_onResourceLoaded:function(a){a.readyState="loaded";this._process()},_onResourceAvailable:function(){this._process()},_retryLoadResource:function(a){if(a.loadFailCount===undefined)a.loadFailCount=0;a.loadFailCount++;if(a.loadFailCount<3){this._loadResource(a);return true}else return false},_onResourceFailed:function(c){var d=this._getResourceName(c);for(var a=0;a<this._errorRequests.length;a++){var b=this._errorRequests[a].callback;this._invokeCallback(function(){b(d)})}},_normalizeMarket:function(a){a=a||"";a=a.toLowerCase();if(this._getResourceMarket(a))return a;return null},_getResourceMarket:function(a,b){b=b||this._supportedMarkets;if(this._supportsMarket(a,b))return a;var c=a.lastIndexOf("-");if(c<0)return null;a=a.substr(0,c);if(this._supportsMarket(a,b))return a;return null},_supportsMarket:function(e,d){var b=0,a=d.length-1;while(b<=a){var c=Math.floor((b+a)/2),f=d[c];if(f<e){b=c+1;continue}if(f>e){a=c-1;continue}return true}return false},_resolveDirection:function(){var a=null,b=document.getElementsByTagName("html");if(b&&b.length>0)a=b[0].getAttribute("dir");if(a)this.initialize({direction:a})},_tryUpdateDirection:function(a){a=a||"";a=a.toLowerCase();switch(a){case "ltr":case "rtl":this._settings.direction=a;return true}return false},_resolveMarket:function(){var a=null,b=document.getElementsByTagName("html"),c=b&&b.length>0?b[0]:null;if(c){a=c.getAttribute("lang");if(a)this.initialize({market:a});a=c.getAttribute("xml:lang");if(a)this.initialize({market:a})}},_tryUpdateMarket:function(a){a=this._normalizeMarket(a);if(a){this._settings.market=a;this._settings.resourceMarket=this._getResourceMarket(a);return true}return false},_detectBrowsers:function(){var a=navigator.userAgent.toLowerCase();this._browser={firefox:/firefox/.test(a),"firefox1.5":/firefox\/1\.5/.test(a),firefox2:/firefox\/2/.test(a),firefox3:/firefox\/3/.test(a),ie:/msie/.test(a)&&!/opera/.test(a),ie6:false,ie7:false,ie8:false,ie9:false,opera:/opera/.test(a),webkit:/webkit/.test(a)};if(this._browser["ie"]){var b=0;if(document.documentMode)b=document.documentMode;else if(/msie 7/.test(a))b=7;b=Math.min(9,Math.max(b,6));this._browser["ie"+b]=true}},_detectSecureConnection:function(){if(document.location.protocol.toLowerCase()=="https:")this.initialize({httpsApplication:true,httpsScope:"all"})},_detectFlash:function(){var a=0;try{if(this._browser.ie){var j=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7"),e=j.GetVariable("$version"),h=e.split(" "),f=h[1],c=f.split(",");a=c[0]}else if(navigator.plugins&&navigator.plugins.length>0)if(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]){var i=navigator.plugins["Shockwave Flash 2.0"]?" 2.0":"",d=navigator.plugins["Shockwave Flash"+i].description,g=d.split(" "),b=g[2].split(".");a=b[0]}}catch(k){}this._browser.flashVersion=a;this._browser.flash=a>=8},_addDocumentReadyListener:function(){var a=this;if(document.body)switch(document.readyState){case "complete":this._onDocumentReady();return;case "loaded":if(this._browser.webkit){this._onDocumentReady();return}break;case "interactive":case undefined:if(this._browser.firefox||this._browser.webkit){this._onDocumentReady();return}}if(document.addEventListener){document.addEventListener("DOMContentLoaded",function(){a._onDocumentReady()},false);document.addEventListener("load",function(){a._onDocumentReady()},false)}else if(window.attachEvent)window.attachEvent("onload",function(){a._onDocumentReady()});if(this._browser.ie){document.attachEvent("onreadystatechange",function(){if(document.readyState==="complete"){document.detachEvent("onreadystatechange",arguments.callee);a._onDocumentReady()}});var b=false;try{b=window.frameElement==null}catch(c){}if(b&&document.documentElement.doScroll)this._doScrollCheck()}},_doScrollCheck:function(){if(this._documentReady)return;try{document.documentElement.doScroll("left")}catch(b){var a=this;setTimeout(function(){a._doScrollCheck()},1);return}this._onDocumentReady()},_invokeCallback:function(a){window.setTimeout(a,1)},_onDocumentReady:function(){if(this._documentReady==false){this._documentReady=true;this._appendIFrameResources();while(this._domRequests.length>0){var a=this._domRequests.shift();this._invokeCallback(a.callback)}this._process()}},_appendChild:function(b,c){var a=function(){b.appendChild(c)};if(this._browser.ie&&!this._documentReady)this._invokeCallback(a);else a()},_appendIFrameResources:function(){if(this._documentReady){var b=this._iframeResources;for(var a=b.length-1;a>=0;a--)if(b[a].hasParent!==true){b[a].hasParent=true;this._appendChild(document.body,b[a].frameContainer)}}},_serializeSettings:function(c){if(!c)return;var b=this._settings["customSettings"];for(var e in c){var f=b.length==0?"":"&",a,d=c[e];switch(typeof d){case "boolean":a="cb";break;case "number":a="cn";break;default:a="cs"}b+=f+a+":"+e+"="+encodeURIComponent(d)}this._settings["customSettings"]=b},_runtimeCheck:function(){for(var a in Object.prototype){this._validRuntime=false;break}}};Microsoft.Live.Core.Loader=new Microsoft.Live.Core.Loader;Microsoft.Live.Core.Loader._addManifest("microsoftAjax",{microsoft_ajax_core:{async:true,filename:"{microsoftAjax.baseScriptUrl}/MicrosoftAjaxCore.js",type:"script",isLoaded:!!(window.Type&&window.Type.registerClass&&window.Sys&&window.Sys.Debug),dependencies:[]},microsoft_ajax_compat:{async:true,filename:"{microsoftAjax.baseScriptUrl}/MicrosoftAjaxCompat.js",type:"script",browsers:function(a){return !a["ie"]||a["ie9"]},dependencies:[]},microsoft_ajax_extensions:{type:"script",dependencies:["microsoft_ajax_core","microsoft_ajax_compat"]},microsoft_ajax_base:{async:true,filename:"{microsoftAjax.baseScriptUrl}/MicrosoftAjaxBase.js",type:"script",isLoaded:!!(window.Sys&&window.Sys.UI),dependencies:["microsoft_ajax_core"]},microsoft_ajax_componentmodel:{type:"script",dependencies:["microsoft_ajax_base"]},microsoft_ajax_serialization:{type:"script",dependencies:["microsoft_ajax_base"]},microsoft_ajax_templates:{async:true,filename:"{microsoftAjax.baseScriptUrl}/MicrosoftAjaxTemplates.js",type:"script",isLoaded:!!(window.Sys&&window.Sys.UI&&window.Sys.UI.Template),dependencies:["microsoft_ajax_base"]},microsoft_ajax_globalization:{async:true,filename:"{microsoftAjax.baseLocalizedScriptUrl}/MicrosoftAjaxGlobalization.js",type:"script",isLoaded:!!Number._parse,dependencies:["microsoft_ajax_core"]},microsoft_ajax_history:{async:true,filename:"{microsoftAjax.baseScriptUrl}/MicrosoftAjaxHistory.js",type:"script",isLoaded:!!(window.Sys&&window.Sys.Application&&window.Sys.Application.get_stateString),dependencies:["microsoft_ajax_componentmodel","microsoft_ajax_serialization"]},json_parser:{async:true,filename:"{microsoftAjax.baseScriptUrl}/json2.js",type:"script",isLoaded:!!window.JSON,dependencies:[]}},{version:"3.0.31122",market:"en",resourcePath:["http://secure.wlxrs.com/_D/F$Live.SiteContent.MicrosoftAjax","http://js2.wlxrs.com/_D/F$Live.SiteContent.MicrosoftAjax"],baseScriptUrl:"{microsoftAjax.resourcePath}/{microsoftAjax.version}/{configuration}",baseLocalizedScriptUrl:"{microsoftAjax.resourcePath}/{microsoftAjax.version}/{configuration}/{microsoftAjax.market}","int":{resourcePath:["http://js.wlxrs-int.com/_D/F$Live.SiteContent.MicrosoftAjax","http://js2.wlxrs-int.com/_D/F$Live.SiteContent.MicrosoftAjax"]},f1:{resourcePath:["http://js.f1.wlxrs-int.com/_D/F$Live.SiteContent.MicrosoftAjax","http://js2.f1.wlxrs-int.com/_D/F$Live.SiteContent.MicrosoftAjax"]},updateSettings:function(a){var c=a.microsoftAjax,b=a.market;if(b){var e=Microsoft.Live.Core.Loader,d=["ar","ar-ae","ar-bh","ar-dz","ar-eg","ar-iq","ar-jo","ar-kw","ar-lb","ar-ly","ar-ma","ar-om","ar-ploc-sa","ar-qa","ar-sy","ar-tn","ar-ye","bg","cs","da","de","de-at","de-ch","el","en","en-au","en-ca","en-gb","en-ie","en-in","en-my","en-nz","en-ph","en-sg","en-za","es","es-ar","es-bo","es-cl","es-co","es-cr","es-do","es-ec","es-gt","es-hn","es-mx","es-ni","es-pa","es-pe","es-pr","es-py","es-sv","es-us","es-uy","es-ve","et","fi","fr","fr-be","fr-ca","fr-ch","he","hr","hu","it","ja","ja-ploc-jp","ko","lt","lv","nb-no","nl","nl-be","pl","pt-br","pt-pt","ro","ru","sk","sl","sr","sv","th","tr","uk","zh-cn","zh-hk","zh-tw"];c.market=e._getResourceMarket(b,d)||"en"}}});Microsoft.Live.Core.Loader._addManifest("channel",{microsoft_live_core_channel:{async:true,filename:"{messenger.baseScriptUrl}/Microsoft.Live.Core.Channel.js",type:"script",dependencies:["microsoft_live_core_channel_downlevel","json_parser","microsoft_ajax_extensions"]},microsoft_live_core_channel_downlevel:{async:true,filename:"{messenger.baseScriptUrl}/channel.js",type:"script",browsers:function(a,b){return !window.postMessage&&(!a.flash||b.channel.flashDisabled)},dependencies:[]}},{uniqueIdUrl:"http://{messenger.serviceHostName}/actions/getuniqueids",flashDisabled:false,getUniqueIdUrl:function(){return Microsoft.Live.Core.Loader._getUrl(this.uniqueIdUrl,"service")}});Microsoft.Live.Core.Loader._addManifest("messenger",{scriptsharp_compat:{type:"script",dependencies:["microsoft_ajax_core"]},scriptsharp:{type:"script",dependencies:["scriptsharp_compat"]},messenger_iframe:{type:"channeliframe",dependencies:[],containerId:"MsgrContainer1",frameId:"ifm"+Math.floor(Math.random()*1024*1024),filename:"{messenger.baseContentUrl}/Messenger.html#domain={messenger.domain}&loaderPath={messenger.loaderPath}{messenger.loaderName}&{customSettings}&{messenger.messengerChannelTypeQualifier}"},storage_iframe:{type:"storageiframe",dependencies:[],containerId:"MsgrStorageContainer1",frameId:"ifm"+Math.floor(Math.random()*1024*1024),filename:"{messenger.baseContentUrl}/LocalStorage.html#domain={messenger.domain}&loaderPath={messenger.loaderPath}{messenger.loaderName}&channelNames={messenger.storageChannelNames}&{customSettings}&{messenger.storageChannelTypeQualifier}"},messenger_common:{async:true,filename:"{messenger.baseScriptUrl}/Microsoft.Live.Messenger.Common.js",type:"script",dependencies:["microsoft_ajax_extensions","json_parser","microsoft_live_core_channel"]},messenger_core:{async:true,filename:"{messenger.baseLocalizedScriptUrl}/Microsoft.Live.Messenger.js",type:"script",dependencies:["messenger_common","messenger_services_loader","messenger_iframe","storage_iframe","core_localstorage"]},messenger_connect:{async:true,filename:"{messenger.baseScriptUrl}/Microsoft.Live.Messenger.Connect.js",type:"script",dependencies:["messenger_core"]},messenger_pubsub:{async:true,filename:"{messenger.baseScriptUrl}/Microsoft.Live.Messenger.PubSub.Client.js",type:"script",dependencies:["messenger_core","messenger_pubsub_common","messenger_pubsub_service"]},messenger_pubsub_service:{async:true,filename:"{messenger.baseScriptUrl}/Microsoft.Live.Messenger.PubSub.Service.js",type:"script",dependencies:["messenger_pubsub_common"]},messenger_pubsub_common:{async:true,filename:"{messenger.baseScriptUrl}/Microsoft.Live.Messenger.PubSub.Common.js",type:"script",dependencies:["messenger_common"]},messenger_extended:{type:"script",dependencies:["messenger_core","messenger_services_core","messenger_services_chat"]},messenger_services_loader:{async:true,filename:"{messenger.baseScriptUrl}/Microsoft.Live.Messenger.Services.Loader.js",type:"script",dependencies:["messenger_common","core_localstorage"]},messenger_services_core:{async:true,filename:"{messenger.baseScriptUrl}/Microsoft.Live.Messenger.Services.Core.js",type:"script",dependencies:["messenger_common"]},messenger_services_addressbook:{async:true,filename:"{messenger.baseScriptUrl}/Microsoft.Live.Messenger.Services.AddressBook.js",type:"script",dependencies:["messenger_common"]},messenger_services_chat:{async:true,filename:"{messenger.baseScriptUrl}/Microsoft.Live.Messenger.Services.Chat.js",type:"script",dependencies:["messenger_common"]},messenger_services_configuration:{async:true,filename:"{messenger.baseScriptUrl}/Microsoft.Live.Messenger.Services.Configuration.js",type:"script",dependencies:["messenger_common"]},messenger_services_expressionprofile:{async:true,filename:"{messenger.baseScriptUrl}/Microsoft.Live.Messenger.Services.ExpressionProfile.js",type:"script",dependencies:["messenger_common"]},messenger_services_identity:{async:true,filename:"{messenger.baseScriptUrl}/Microsoft.Live.Messenger.Services.Identity.js",type:"script",dependencies:["messenger_common"]},core_localstorage:{type:"script",dependencies:["core_localstorage_ie","core_localstorage_ff","core_localstorage_plugins","core_localstorage_userdata","core_localstorage_webkit"]},core_localstorage_ie:{async:true,filename:"{messenger.baseScriptUrl}/Microsoft.Live.Core.LocalStorage.IE.js",type:"script",browsers:function(a){return a["ie"]&&window.sessionStorage},dependencies:["messenger_common"]},core_localstorage_userdata:{async:true,filename:"{messenger.baseScriptUrl}/Microsoft.Live.Core.LocalStorage.UserData.js",type:"script",browsers:function(a,c){var b=(!c.httpsApplication||!a["flash"])&&a["ie"]&&!window.sessionStorage;return b},dependencies:["messenger_common"]},core_localstorage_ff:{async:true,filename:"{messenger.baseScriptUrl}/Microsoft.Live.Core.LocalStorage.FF.js",type:"script",browsers:function(a){return a["firefox"]&&window.globalStorage},dependencies:["messenger_common"]},core_localstorage_plugins:{async:true,filename:"{messenger.baseScriptUrl}/Microsoft.Live.Core.LocalStorage.Plugins.js",type:"script",browsers:function(a,c){var b=(c.httpsApplication&&a["flash"]||!a["ie"])&&!window.localStorage&&!window.globalStorage&&!window.sessionStorage;return b},dependencies:["messenger_common"]},core_localstorage_webkit:{async:true,filename:"{messenger.baseScriptUrl}/Microsoft.Live.Core.LocalStorage.WebKit.js",type:"script",browsers:function(a){return (a["webkit"]||a["opera"])&&window.localStorage},dependencies:["messenger_common"]}});Microsoft.Live.Core.Loader._addManifest("messenger",null,{version:"4.2.64250",versionOverride:"4.2.64250",loaderPath:"{messenger.resourcePath}/{messenger.version}/",loaderName:"loader.js",localizedMarket:"other",resourcePath:["http://secure.wlxrs.com/_D/F$Live.SiteContent.Messenger","http://js2.wlxrs.com/_D/F$Live.SiteContent.Messenger"],imageResourcePath:["http://secure.wlxrs.com/_D/F$Live.SiteContent.Messenger","http://js2.wlxrs.com/_D/F$Live.SiteContent.Messenger"],styleResourcePath:"http://secure.wlxrs.com/_D/F$Live.SiteContent.Messenger",audioResourcePath:"http://secure.wlxrs.com/_D/F$Live.SiteContent.Messenger",applicationPath:"http://secure.shared.live.com/_D/F$Live.SiteContent.Messenger",applicationHostName:"settings.messenger.live.com",consentHostName:"consent.messenger.services.live.com",baseScriptUrl:"{messenger.resourcePath}/{messenger.version}/{configuration}",baseLocalizedScriptUrl:"{messenger.resourcePath}/{messenger.version}/{configuration}/{resourceMarket}",baseStyleSheetUrl:"{messenger.styleResourcePath}/{messenger.version}/resources/styles/{direction}",baseContentUrl:"{messenger.applicationPath}/{messenger.versionOverride}",messengerChannelTypeQualifier:"",storageChannelTypeQualifier:"",storageChannelNames:"",serviceHostName:"geo.messenger.services.live.com",pubSubHostName:"geo.messenger.services.live.com",localStorageDisabled:false,sameDomainEndpointsAsLocalEnabled:false,testReportingEnabled:false,signInControlState:"",silentReauthDetectionUrl:"https://login.live.com/login.srf?wa=wsignin1.0&wp=MBI&wreply=http://messengerweb.live.com/&lc=1033&id=76215&aj=1",silentReauthUrlFormat:"https://login.live.com/login.srf?wa=wsignin1.0&checkda=1&wp=MBI&wreply={0}&lc=1033&id=76215",dogfood:{serviceHostName:"beta.messenger.services.live.com"},updateSettings:function(b,e){var a=b.messenger,f=Microsoft.Live.Core.Loader,d=["ar","ar-ploc-sa","ja","ja-ploc-jp","he","ko","th","zh-hk","zh-tw"];if(b.resourceMarket)for(var c=0;c<d.length;c++)if(b.resourceMarket==d[c]){this.localizedMarket=b.resourceMarket;break}a.domain=encodeURIComponent(document.location.hostname.toLowerCase());if(!window.postMessage){a.messengerChannelTypeQualifier="WLIFMi="+e["messenger_iframe"].frameId;a.storageChannelTypeQualifier="WLIFMi="+e["storage_iframe"].frameId}a.storageChannelNames="DefaultLocalStorageChannel";if(f._shouldProxyLocalStorage())a.storageChannelNames+=";MessengerStorageChannel"},_join:function(){return Array.prototype.join.call(arguments,"/")},getLoaderUrl:function(){return Microsoft.Live.Core.Loader._getUrl(this.loaderPath+this.loaderName,"script")},getResourceUrl:function(a,f){if(!a)a="";var e=Microsoft.Live.Core.Loader,c=e._settings.messenger,g=e._settings.configuration,d=c.resourcePath;if(a.match(/(\.jpg|\.gif|\.png)$/gi))d=c.imageResourcePath;else if(a.match(/(\.mp3|\.wav)$/gi))d=c.audioResourcePath;else if(a.match(/(\.html)$/gi))d=c.applicationPath;var b;if(!e._isArray(d))b=d;else{var h=e._computeFastHash(a);b=d[h%d.length]}if(a.charAt(0)=="/")a=a.substring(1);if((a.match(/(\.js)$/gi)||a.length==0)&&g)b=this._join(b,c.version,g,a);else if(a.match(/(\.html)$/gi))b=this._join(b,c.versionOverride,a);else b=this._join(b,c.version,a);if(f==null)if(b.match(/(\.html)$/gi))f="service";else f="content";if(e._shouldUseHttps(f))b=e._getSecureUrl(b);return b},getDistinctDomainResourcePaths:function(i){var f=Microsoft.Live.Core.Loader,d=f._settings.messenger,c=[],b=[];b.push(d.resourcePath);b.push(d.imageResourcePath);b.push(d.audioResourcePath);b.push(d.styleResourcePath);for(var a=0;a<b.length;a++){var e=b[a];if(f._isArray(e))for(var h=0;h<e.length;h++)c.push(e[h]);else c.push(e)}for(var a=0;a<c.length;a++){var g=this._join(c[a],d.version,i);if(f._settings.httpsApplication)g=f._getSecureUrl(g);c[a]=g}return c}});Microsoft.Live.Core.Loader.initialize({httpsApplication:true,"compatibility.microsoftAjaxPropertyNames":false,"messenger.loaderName":"loader.cxp.js","messenger.sameDomainEndpointsAsLocalEnabled":true});(function(){var a=window.Microsoft_Live_Core_Loader_onAvailable;if(a&&typeof a=="function")a(Microsoft.Live.Core.Loader)})()